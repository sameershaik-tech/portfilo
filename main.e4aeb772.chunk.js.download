(this["webpackJsonpfrictionless-web"]=this["webpackJsonpfrictionless-web"]||[]).push([[0],{1:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m}));var n=a(2),r=a.n(n),i=a(8),o=a(3),s=a(4),l=a(55),c=a(90),u=a(198),d=a(199),h=a(86),f=a(31),p=function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,[{key:"init",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(null===(t="cs,da,de,en,es,fi,fr,it,ja,ko,nb,nl,pl,pt,ru,sv,tr,zh_CN,zh_TW,zh_cn,zh_tw")?void 0:t.split(","))||["en"],(n=new u.a).addDetector({name:"fpsLanguageDetector",lookup:function(e){try{var t=f.a.parseCookies();if(t.international||t["creative-cloud-loc"]){var a=Object(l.normalize)(t.international||t["creative-cloud-loc"]);if(null===a||void 0===a?void 0:a.startsWith("zh-Hans"))return"zh_CN";if(null===a||void 0===a?void 0:a.startsWith("zh-Hant"))return"zh_TW";var n=Object(l.lang)(a);if(n)return n}}catch(r){}}}),e.abrupt("return",c.a.use(h.e).use(n).use(d.a).init({fallbackLng:"en",whitelist:a,load:"languageOnly",debug:!1,initImmediate:!0,saveMissing:!1,keySeparator:".",interpolation:{escapeValue:!1},react:{useSuspense:!1},detection:{lookupCookie:"lang",cookieDomain:"*.adobe.com",order:["querystring","path","fpsLanguageDetector","cookie","localStorage","navigator","htmlTag","subdomain"],checkWhitelist:!0}}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"translate",value:function(e,t){return c.a.t(e,t)}}],[{key:"getInstance",value:function(){return e.instance}}]),e}();function m(e,t){return p.getInstance().translate(e,t)}p.instance=new p},110:function(e,t,a){"use strict";var n=a(2),r=a.n(n),i=a(8),o=a(3),s=a(4),l=a(11),c=a(10),u=a(6),d=a(7),h=a(0),f=a.n(h),p=a(15),m=a.n(p),v=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],g=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function b(e,t,a,n){if(Number.isNaN(n)||n<1)return e;var r,i,o,s,l,c,u,d,h,f,p,m,b,E,w,x,k,S,O,C,P=new ImageData(new Uint8ClampedArray(e.data),e.width,e.height),T=P.data,A=n+n+1,j=t-1,I=a-1,M=n+1,R=M*(M+1)/2,_=new y,D=_;for(o=1;o<A;o++)if(D=D.next=new y,o===M)var L=D;D.next=_;var N=null,V=null;u=c=0;var U=v[n],F=g[n];for(i=0;i<a;i++){for(E=w=x=d=h=f=0,p=M*(k=T[c]),m=M*(S=T[c+1]),b=M*(O=T[c+2]),d+=R*k,h+=R*S,f+=R*O,D=_,o=0;o<M;o++)D.r=k,D.g=S,D.b=O,D=D.next;for(o=1;o<M;o++)s=c+((j<o?j:o)<<2),d+=(D.r=k=T[s])*(C=M-o),h+=(D.g=S=T[s+1])*C,f+=(D.b=O=T[s+2])*C,E+=k,w+=S,x+=O,D=D.next;for(N=_,V=L,r=0;r<t;r++)T[c]=d*U>>F,T[c+1]=h*U>>F,T[c+2]=f*U>>F,d-=p,h-=m,f-=b,p-=N.r,m-=N.g,b-=N.b,s=u+((s=r+n+1)<j?s:j)<<2,d+=E+=N.r=T[s],h+=w+=N.g=T[s+1],f+=x+=N.b=T[s+2],N=N.next,p+=k=V.r,m+=S=V.g,b+=O=V.b,E-=k,w-=S,x-=O,V=V.next,c+=4;u+=t}for(r=0;r<t;r++){for(w=x=E=h=f=d=0,p=M*(k=T[c=r<<2]),m=M*(S=T[c+1]),b=M*(O=T[c+2]),d+=R*k,h+=R*S,f+=R*O,D=_,o=0;o<M;o++)D.r=k,D.g=S,D.b=O,D=D.next;for(l=t,o=1;o<=n;o++)c=l+r<<2,d+=(D.r=k=T[c])*(C=M-o),h+=(D.g=S=T[c+1])*C,f+=(D.b=O=T[c+2])*C,E+=k,w+=S,x+=O,D=D.next,o<I&&(l+=t);for(c=r,N=_,V=L,i=0;i<a;i++)T[s=c<<2]=d*U>>F,T[s+1]=h*U>>F,T[s+2]=f*U>>F,d-=p,h-=m,f-=b,p-=N.r,m-=N.g,b-=N.b,s=r+((s=i+M)<I?s:I)*t<<2,d+=E+=N.r=T[s],h+=w+=N.g=T[s+1],f+=x+=N.b=T[s+2],N=N.next,p+=k=V.r,m+=S=V.g,b+=O=V.b,E-=k,w-=S,x-=O,V=V.next,c+=t}return P}function y(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var E=a(112),w=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e,n){var r;return Object(o.a)(this,a),(r=t.call(this,n)).status=void 0,r.status=e,r}return Object(s.a)(a,null,[{key:"fromResponse",value:function(e){return new a(e.status,e.statusText)}}]),a}(Object(E.a)(Error)),x=function(){function e(t){Object(o.a)(this,e),this.googleToken=void 0,this.googleToken=t}return Object(s.a)(e,[{key:"getAperitifData",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a,n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0,a=3;case 2:if(!(t<a)){e.next=23;break}return e.next=5,fetch("".concat("https://image.adobe.io/utils/aperitif","?num=2"),{method:"GET",headers:{"x-api-key":"ps-frictionless-web","x-recaptcha-token":this.googleToken,"content-type":"application/json"}});case 5:if(403!==(n=e.sent).status){e.next=8;break}throw w.fromResponse(n);case 8:if(401!==n.status){e.next=16;break}if((t+=1)!==a){e.next=12;break}throw w.fromResponse(n);case 12:return e.next=14,this.wait(200*t);case 14:e.next=21;break;case 16:if(200!==n.status){e.next=21;break}return e.next=19,n.json();case 19:return i=e.sent,e.abrupt("return",Promise.resolve(i.outputs));case 21:e.next=2;break;case 23:throw new Error("unspecified error");case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"wait",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}],[{key:"getAccessToken",value:function(e){return(null===e||void 0===e?void 0:e.authToken)?"Bearer ".concat(e.authToken):void 0}}]),e}(),k=a(60),S=a.n(k),O=a(18),C=a(1),P=a(113),T=function(){function e(t,a){Object(o.a)(this,e),this.imsToken=void 0,this.aperitifUrls=void 0,this.hasAWSPresignedUrls=!1,this.storageService=void 0,this.imsToken=t,this.aperitifUrls=a,this.storageService=new P.a(t)}return Object(s.a)(e,[{key:"createMask",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.create("mask",t,a,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"createCutout",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.create("cutout",t,a,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a,n,i){var o,s,l,c,u,d,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=S()(),s="/temp/cutout_upload_".concat(o),l="/temp/cutout_result_".concat(o),this.aperitifUrls&&2===this.aperitifUrls.length&&(this.hasAWSPresignedUrls=!0),e.prev=4,i&&i(Object(C.b)("CutoutService.ProgressState.Upload","Upload"),0),this.aperitifUrls&&this.hasAWSPresignedUrls&&(s=this.aperitifUrls[0].put),e.next=9,this.uploadInput(a,s,n);case 9:return i&&i(Object(C.b)("CutoutService.ProgressState.Process","Process"),25),this.aperitifUrls&&this.hasAWSPresignedUrls&&(s=this.aperitifUrls[0].get,l=this.aperitifUrls[1].put),e.next=13,this.startJob(t,s,l,n);case 13:return u=e.sent,e.next=16,this.checkJobFinished(u._links.self.href,n,i);case 16:if(d=e.sent,console.debug(d),d){e.next=20;break}return e.abrupt("return",Promise.resolve(null));case 20:if("succeeded"!==d.status){e.next=30;break}return i&&i(Object(C.b)("CutoutService.ProgressState.Download","Download"),75),this.aperitifUrls&&this.hasAWSPresignedUrls&&(l=this.aperitifUrls[1].get),e.next=25,this.downloadOutput(l,n);case 25:return h=e.sent,e.next=28,this.wait(100);case 28:return i&&i(Object(C.b)("CutoutService.ProgressState.Done","Done"),100),e.abrupt("return",Promise.resolve(h));case 30:console.error((null===(c=d.errors)||void 0===c?void 0:c.reason)||"Unknown error"),e.next=39;break;case 33:if(e.prev=33,e.t0=e.catch(4),"AbortError"!==e.t0.name){e.next=38;break}return console.debug("Server requests aborted"),e.abrupt("return",Promise.resolve(null));case 38:console.error(e.t0);case 39:return e.abrupt("return",Promise.reject(new Error("Job failed")));case 40:case"end":return e.stop()}}),e,this,[[4,33]])})));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"startJob",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a,n,i){var o,s,l,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:o=this.hasAWSPresignedUrls?"external":"adobe",s=0,l=3;case 5:if(!(s<l)){e.next=20;break}return e.next=8,fetch("".concat("https://image.adobe.io","/sensei/").concat(t),{method:"POST",headers:{"x-api-key":"ps-frictionless-web",authorization:this.imsToken,"content-type":"application/json"},body:JSON.stringify({input:{storage:o,href:a},output:{storage:o,href:n,mask:{format:"soft"}}}),signal:i.signal});case 8:if(202===(c=e.sent).status){e.next=17;break}if((s+=1)!==l){e.next=13;break}throw new Error(c.statusText);case 13:return e.next=15,this.wait(200*s);case 15:e.next=18;break;case 17:return e.abrupt("return",c.json());case 18:e.next=5;break;case 20:throw new Error("unspecified error");case 21:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"getJobStatus",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return console.debug("getJobStatus",t),e.next=5,fetch(t,{method:"GET",headers:{"x-api-key":"ps-frictionless-web",authorization:this.imsToken},signal:a.signal});case 5:if(200===(n=e.sent).status){e.next=8;break}throw new Error(n.statusText);case 8:return e.abrupt("return",n.json());case 9:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"checkJobFinished",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a,n){var i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getJobStatus(t,a);case 2:if("running"!==(i=e.sent).status&&"pending"!==i.status){e.next=8;break}return n&&n("running"===i.status?Object(C.b)("CutoutService.ProgressState.Running","Running"):Object(C.b)("CutoutService.ProgressState.Pending","Pending"),30),e.next=7,this.wait(1e3);case 7:return e.abrupt("return",this.checkJobFinished(i._links.self.href,a));case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"uploadInput",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a,n){var i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("updloadInput",a),e.next=3,O.a.createBlob(t,"image/jpeg",.75);case 3:if(i=e.sent,!this.hasAWSPresignedUrls){e.next=6;break}return e.abrupt("return",this.storageService.createOrUpdatePreSignedAWSResource(a,i,n));case 6:return e.abrupt("return",this.storageService.createOrUpdateResource(a,"image/jpeg",i,n));case 7:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"downloadOutput",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.debug("downloadOutput",t),!this.hasAWSPresignedUrls){e.next=7;break}return e.next=4,this.storageService.getPreSignedAWSResource(t,a);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,this.storageService.getResource(t,a);case 9:e.t0=e.sent;case 10:return n=e.t0,e.abrupt("return",O.a.createImageData(n));case 12:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"wait",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}]),e}(),A=a(36),j=a(54),I=a(48),M=a(74),R=a(16),_=(a(583),a(227));a.d(t,"a",(function(){return D})),a.d(t,"b",(function(){return L}));var D=["transparent","multi"],L=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,R.a.cutout,e)).undostack=void 0,n.cutoutService=void 0,n.autoCutoutProgress=void 0,n.backgroundColor=void 0,n.blurCanvas=void 0,n.appliedMaskDataUrl150=void 0,n.originalImageDataUrl150=void 0,n.blurRadius=void 0,n.abortController=void 0,n.baseImageService=void 0,n}return Object(s.a)(a,[{key:"createView",value:function(e){Object(l.a)(Object(c.a)(a.prototype),"createView",this).call(this,e),m.a.render(f.a.createElement(_.a,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&m.a.unmountComponentAtNode(this.container),Object(l.a)(Object(c.a)(a.prototype),"destroyView",this).call(this)}},{key:"isDirty",value:function(){return this.canUndo()}},{key:"startEditor",value:function(e){this.resetResources(),this.doc.getStage().setMaskData(void 0),this.blurCanvas=void 0,this.appliedMaskDataUrl150=void 0,this.originalImageDataUrl150=void 0,this.undostack=new j.a({backgroundColor:null},10),Object(l.a)(Object(c.a)(a.prototype),"startEditor",this).call(this,e)}},{key:"loadAperitif",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.grecaptcha){e.next=2;break}throw new Error("Error loading recaptcha");case 2:if(window.grecaptcha.recaptchaReady){e.next=4;break}throw new Error("Error loading aperitif as recaptcha can be executed only when it's ready.");case 4:return e.next=6,window.grecaptcha.execute({action:"test"});case 6:return t=e.sent,this.baseImageService=new x(t),e.abrupt("return",this.baseImageService.getAperitifData());case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"endEditor",value:function(){this.resetResources(),this.doc.getStage().setMaskData(void 0),Object(l.a)(Object(c.a)(a.prototype),"endEditor",this).call(this)}},{key:"hasUndoStack",value:function(){return!0}},{key:"undo",value:function(){var e,t,a,n;null===(e=this.undostack)||void 0===e||e.undo(),this.backgroundColor=null!==(t=null===(a=this.undostack)||void 0===a?void 0:a.getCurrent().backgroundColor)&&void 0!==t?t:void 0,this.blurRadius=null===(n=this.undostack)||void 0===n?void 0:n.getCurrent().blurRadius,this.update()}},{key:"redo",value:function(){var e,t,a,n;null===(e=this.undostack)||void 0===e||e.redo(),this.backgroundColor=null!==(t=null===(a=this.undostack)||void 0===a?void 0:a.getCurrent().backgroundColor)&&void 0!==t?t:void 0,this.blurRadius=null===(n=this.undostack)||void 0===n?void 0:n.getCurrent().blurRadius,this.update()}},{key:"canUndo",value:function(){var e,t,a;return null!==(e=(null===(t=this.undostack)||void 0===t?void 0:t.canUndo())&&(null===(a=this.undostack)||void 0===a?void 0:a.getLength())>1)&&void 0!==e&&e}},{key:"canRedo",value:function(){var e,t;return null!==(e=null===(t=this.undostack)||void 0===t?void 0:t.canRedo())&&void 0!==e&&e}},{key:"canReset",value:function(){return this.canUndo()}},{key:"reset",value:function(){var e,t,a;this.resetResources(),null===(e=this.undostack)||void 0===e||e.clear(),null===(t=this.undostack)||void 0===t||t.add({backgroundColor:null,blurRadius:void 0}),null===(a=this.undostack)||void 0===a||a.setCurrentStep(0),this.update()}},{key:"apply",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDirty()){e.next=3;break}return this.cancel(),e.abrupt("return");case 3:return e.next=5,new Promise((function(e,a){t.view.showProcessing(Object(i.a)(r.a.mark((function n(){var i,o,s,l;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(o=null===(i=t.doc.getStage().getCanvas())||void 0===i?void 0:i.getContext("2d"))){n.next=8;break}return s="transparent"===t.backgroundColor?Object(C.b)("CutoutView.InfoToast.Message.BackgroundRemoved","The background of your image was removed"):void 0!==t.blurRadius?Object(C.b)("CutoutView.InfoToast.Message.BackgroundBlurred","The background of your image was blurred"):Object(C.b)("CutoutView.InfoToast.Message.BGReplaced","The background of your image was replaced"),l=t.doc.getImageData(),n.next=6,t.doc.editorApply(o.getImageData(0,0,l.width,l.height),s);case 6:(new I.a).showSurveyEditor(R.a.cutout),e();case 8:a();case 9:case"end":return n.stop()}}),n)}))))}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.isDirty()&&(new I.a).showSurveyEditor(R.a.cutout),this.doc.editorCancel()}},{key:"getParams",value:function(){return{backgroundColor:this.backgroundColor,blurRadius:this.blurRadius,hasMask:!this.doc.getStage().isMaskCanvasEmpty(),autoCutoutProgress:this.autoCutoutProgress}}},{key:"autoCutout",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a){var n,i,o,s,l=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isProcessing()){e.next=35;break}if(A.b.getInstance().isSignedInUser()){e.next=17;break}return e.prev=2,e.next=5,this.loadAperitif();case 5:if(n=e.sent){e.next=9;break}return this.showSignInRequired(),e.abrupt("return");case 9:e.next=17;break;case 11:if(e.prev=11,e.t0=e.catch(2),console.error(e.t0),!(e.t0 instanceof w&&403===e.t0.status)){e.next=17;break}return new M.a(Object(C.b)("SigninDialog.Message.PSigninContinue","Please sign in to continue using this feature"),R.a.cutout).show(),e.abrupt("return");case 17:if(!this.doc.getStage().isMaskCanvasEmpty()){e.next=32;break}if(this.abortController=new AbortController,!(i=x.getAccessToken(n)||A.b.getInstance().getUserAccessToken())){e.next=32;break}return e.prev=21,this.cutoutService=new T(i,null===(o=n)||void 0===o?void 0:o.urls),e.next=25,this.cutoutService.createMask(this.doc.getImageData(),this.abortController,(function(e,t){l.autoCutoutProgress={state:e,percentage:t},l.updateViewParams()}));case 25:(s=e.sent)&&this.setAppliedMaskCanvas(O.a.applyMask(this.doc.getImageData(),s)),e.next=32;break;case 29:return e.prev=29,e.t1=e.catch(21),e.abrupt("return",Promise.reject(e.t1));case 32:this.doc.getStage().isMaskCanvasEmpty()||(a?this.setBlurredBackground(a):this.setBackgroundColor(t),this.update()),this.cutoutService=void 0,this.abortController=void 0;case 35:Promise.resolve();case 36:case"end":return e.stop()}}),e,this,[[2,11],[21,29]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"isProcessing",value:function(){return void 0!==this.cutoutService}},{key:"cancelAutoCutout",value:function(){var e;null===(e=this.abortController)||void 0===e||e.abort(),this.cutoutService=void 0}},{key:"getAutoCutoutProgress",value:function(){return this.autoCutoutProgress}},{key:"applyBackgroundColor",value:function(e){this.setBackgroundColor(e),this.blurRadius=void 0,this.update()}},{key:"applyBlurredBackground",value:function(e,t){this.blurRadius!==e?(this.setBlurredBackground(e,t),this.update()):t&&this.addUndo()}},{key:"getAppliedMaskDataUrl150",value:function(){if(!this.appliedMaskDataUrl150){var e=this.getAppliedMaskImageData();if(e){var t,a=O.a.getNonAlphaBoundingRect(e);a&&(t=O.a.copyImageData(e,a));var n=O.a.resizeImageDataMaxSize(t||e,150);n&&(this.appliedMaskDataUrl150=O.a.createDataUrl(n))}}return this.appliedMaskDataUrl150}},{key:"getOriginalImageDataUrl150",value:function(){if(!this.originalImageDataUrl150&&this.doc.getImageData()){var e,t=this.doc.getImageData(),a=this.getAppliedMaskImageData();if(a){var n=O.a.getNonAlphaBoundingRect(a);n&&(e=O.a.copyImageData(t,n))}var r=O.a.resizeImageDataMaxSize(e||t,150);r&&(this.originalImageDataUrl150=O.a.createDataUrl(r))}return this.originalImageDataUrl150}},{key:"addUndo",value:function(){var e;null===(e=this.undostack)||void 0===e||e.add({backgroundColor:this.backgroundColor,blurRadius:this.blurRadius})}},{key:"update",value:function(){this.drawImageData(),this.updateViewParams(),this.doc.getDocActions().update()}},{key:"updateViewParams",value:function(){this.view.setParams(this.getParams())}},{key:"getAppliedMaskImageData",value:function(){if(!this.doc.getStage().isMaskCanvasEmpty()){var e=this.doc.getStage().getMaskCanvas();if(e){var t=e.getContext("2d");if(t)return t.getImageData(0,0,e.width,e.height)}}}},{key:"setAppliedMaskCanvas",value:function(e){this.doc.getStage().setMaskData(e)}},{key:"resetResources",value:function(){this.autoCutoutProgress=void 0,this.backgroundColor=void 0,this.blurRadius=void 0,this.cutoutService=void 0}},{key:"setBackgroundColor",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.backgroundColor!==e&&(this.backgroundColor=e||void 0,t&&this.addUndo())}},{key:"setBlurredBackground",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this.doc.getImageData();this.blurCanvas||(this.blurCanvas=document.createElement("canvas"),this.blurCanvas.width=a.width,this.blurCanvas.height=a.height);var n=this.blurCanvas.getContext("2d");if(null!==n){n.putImageData(b(a,a.width,a.height,e),0,0);var r=n.createPattern(this.blurCanvas,"no-repeat");this.blurRadius=e,this.setBackgroundColor(r,t)}}},{key:"drawImageData",value:function(){var e=this.doc.getStage().getCanvas();if(e){var t=e.getContext("2d");if(t){var a,n=this.doc.getStage().getMaskCanvas(),r=this.backgroundColor;null===(null===(a=this.undostack)||void 0===a?void 0:a.getCurrent().backgroundColor)||null==n||this.doc.getStage().isMaskCanvasEmpty()?t.putImageData(this.doc.getImageData(),0,0):"transparent"!==r&&r?(t.fillStyle=r,t.fillRect(0,0,n.width,n.height),t.drawImage(n,0,0)):(t.clearRect(0,0,n.width,n.height),t.drawImage(n,0,0))}}}},{key:"showSignInRequired",value:function(){new M.a(Object(C.b)("SigninDialog.Message.PSignin","Please sign in to use this feature"),R.a.cutout).show()}}]),a}(R.b)},113:function(e,t,a){"use strict";var n=a(2),r=a.n(n),i=a(8),o=a(3),s=a(4),l=a(6),c=a(7),u=a(112),d=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e,n){var r;return Object(o.a)(this,a),(r=t.call(this,n)).status=void 0,r.status=e,r}return Object(s.a)(a,null,[{key:"fromResponse",value:function(e){return new a(e.status,e.statusText)}}]),a}(Object(u.a)(Error));a.d(t,"a",(function(){return h}));var h=function(){function e(t){Object(o.a)(this,e),this.imsToken=void 0,this.imsToken=t}return Object(s.a)(e,[{key:"createOrUpdateResource",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a,n,i){var o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return e.next=4,fetch("".concat("https://cc-api-storage-creativesdk.adobe.io").concat(t),{method:"PUT",headers:{"x-api-key":"FrictionlessPSWebApp1",authorization:this.imsToken,"content-type":a},body:n,signal:null===i||void 0===i?void 0:i.signal});case 4:if(201===(o=e.sent).status){e.next=7;break}throw d.fromResponse(o);case 7:return e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"createOrUpdatePreSignedAWSResource",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a,n){var i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"PUT",body:a,signal:null===n||void 0===n?void 0:n.signal});case 2:if(200===(i=e.sent).status){e.next=5;break}throw d.fromResponse(i);case 5:return e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"getResource",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return e.next=4,fetch("".concat("https://cc-api-storage-creativesdk.adobe.io").concat(t),{method:"GET",headers:{"x-api-key":"FrictionlessPSWebApp1",authorization:this.imsToken},signal:null===a||void 0===a?void 0:a.signal});case 4:if(200===(n=e.sent).status){e.next=7;break}throw d.fromResponse(n);case 7:return e.abrupt("return",n.blob());case 8:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getPreSignedAWSResource",value:function(){var e=Object(i.a)(r.a.mark((function e(t,a){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"GET",signal:null===a||void 0===a?void 0:a.signal});case 2:if(200===(n=e.sent).status){e.next=5;break}throw d.fromResponse(n);case 5:return e.abrupt("return",n.blob());case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}]),e}()},114:function(e,t,a){"use strict";var n=a(3),r=a(4),i=a(6),o=a(7),s=a(41),l=a.n(s),c=a(20),u=a(0),d=a.n(u),h=a(9),f=a(32),p=a(49),m=a.n(p),v=a(141),g=a.n(v),b=a(1),y=(a(598),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(n.a)(this,a);var i=(r=t.call(this,e)).props.startLabel;return r.state={label:i},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"setProgress",value:function(e,t){this.setState({label:e,value:t})}},{key:"render",value:function(){var e=this.props,t=e.controller,a=e.title,n=e.confirmLabel,r=e.isIndeterminate,i=this.state,o=i.label,s=i.value;return d.a.createElement(m.a,{open:!0,title:a,onConfirm:function(){return t.cancel()},confirmLabel:n||Object(b.b)("ProgressDialog.Label.Cancel","Cancel"),onCancel:function(){return t.cancel()},role:"dialog",className:"progressDialog"},r?d.a.createElement(g.a,{label:o,isIndeterminate:!0,labelPosition:"top"}):d.a.createElement(g.a,{label:o,value:s,labelPosition:"top",showPercent:!0}))}}]),a}(u.PureComponent));a.d(t,"a",(function(){return E}));var E=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e,r,i,o,s){var l;return Object(n.a)(this,a),(l=t.call(this)).dialogId=void 0,l.title=void 0,l.confirmLabel=void 0,l.onCancel=void 0,l.isIndeterminate=void 0,l.startLabel=void 0,l.title=e,l.confirmLabel=i,l.onCancel=r,l.isIndeterminate=s,l.startLabel=o,l}return Object(r.a)(a,[{key:"show",value:function(){this.dialogId=l.a.show(d.a.createElement(y,{controller:this,title:this.title,confirmLabel:this.confirmLabel,isIndeterminate:this.isIndeterminate,startLabel:this.startLabel}))}},{key:"close",value:function(){this.dialogId&&(l.a.hide(this.dialogId),this.dialogId=void 0)}},{key:"cancel",value:function(){this.onCancel&&this.onCancel(),Object(h.a)("progressDialog:".concat(Object(c.camelCase)(this.title),":cancel")),this.close()}},{key:"setProgress",value:function(e,t){var a;null===(a=this.getProgressView())||void 0===a||a.setProgress(e,t)}},{key:"getProgressView",value:function(){return this.view}}]),a}(f.a)},16:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return p}));var n,r=a(2),i=a.n(r),o=a(8),s=a(3),l=a(4),c=a(11),u=a(10),d=a(6),h=a(7),f=a(32);a(354);!function(e){e.crop="crop",e.spotheal="spotheal",e.resize="resize",e.adjust="adjust",e.cutout="cutout",e.effects="effects"}(n||(n={}));var p=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e,n){var r;return Object(s.a)(this,a),(r=t.call(this)).id=void 0,r.doc=void 0,r.alwaysPointerTracking=!1,r.id=e,r.doc=n,r}return Object(l.a)(a,[{key:"startEditor",value:function(e){this.doc.setLoading(!0),this.initStage(),this.createView(e)}},{key:"endEditor",value:function(){this.destroyView()}},{key:"viewDidMount",value:function(e){Object(c.a)(Object(u.a)(a.prototype),"viewDidMount",this).call(this,e),this.doc.setLoading(!1)}},{key:"getId",value:function(){return this.id}},{key:"isDirty",value:function(){return!1}},{key:"hasUndoStack",value:function(){return!1}},{key:"undo",value:function(){}},{key:"redo",value:function(){}},{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"apply",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){}},{key:"initStage",value:function(){this.doc.getStage().ensure2DCanvas(),this.doc.getStage().setImageData(this.doc.getImageData())}},{key:"needsAlwaysPointerTracking",value:function(){return this.alwaysPointerTracking}},{key:"onPointerDown",value:function(e){}},{key:"onPointerMove",value:function(e){}},{key:"onPointerUp",value:function(e){}},{key:"onPointerEnter",value:function(e){}},{key:"onPointerOut",value:function(e){}},{key:"onPointerLeave",value:function(e){}},{key:"onGestureStart",value:function(e){}},{key:"onGestureChange",value:function(e){}},{key:"onGestureEnd",value:function(e){}},{key:"onZoomChange",value:function(e){}},{key:"onContainerSizeChanged",value:function(e,t){}},{key:"onPanModeStart",value:function(){}},{key:"onPanModeEnd",value:function(){}},{key:"onZoomModeStart",value:function(){}},{key:"onZoomModeEnd",value:function(){}},{key:"onStageTransformChanged",value:function(){}},{key:"onKeyDown",value:function(e){}},{key:"onKeyUp",value:function(e){}}]),a}(f.a)},17:function(e,t,a){"use strict";var n,r;a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r})),function(e){e.JPG="jpg",e.PNG="png",e.SVG="svg"}(n||(n={})),function(e){e.JPG="jpg",e.PNG="png"}(r||(r={}))},18:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a.n(n),i=a(8),o=a(3),s=a(4),l=function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,null,[{key:"createHTMLCanvasElementForSize",value:function(e,t){var a=document.createElement("canvas");return a.width=e,a.height=t,a}},{key:"createHTMLCanvasElement",value:function(t){var a=e.createHTMLCanvasElementForSize(t.width,t.height),n=a.getContext("2d");return null!==n&&n.putImageData(t,0,0),a}},{key:"createBlob",value:function(){var t=Object(i.a)(r.a.mark((function t(a,n,i,o){var s,l;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.createHTMLCanvasElementForSize(a.width,a.height),t.abrupt("return",new Promise((function(t,r){var c=s.getContext("2d");if(c){var u;if(c.putImageData(a,0,0),o){var d=(l=e.createHTMLCanvasElementForSize(a.width,a.height)).getContext("2d");d&&(d.fillStyle=o,d.fillRect(0,0,s.width,s.height),d.drawImage(s,0,0))}e.toBlob(null!==(u=l)&&void 0!==u?u:s,(function(e){e?t(e):r(new Error("no blob"))}),n,i)}else r(new Error("no ctx"))})));case 2:case"end":return t.stop()}}),t)})));return function(e,a,n,r){return t.apply(this,arguments)}}()},{key:"createImageData",value:function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){var n=new Image,r=window.URL||window.webkitURL;n.onload=function(){r.revokeObjectURL(n.src);var t=document.createElement("canvas");t.width=n.width,t.height=n.height;var i=t.getContext("2d");if(i){i.drawImage(n,0,0);var o=i.getImageData(0,0,n.width,n.height);e(o)}else a(new Error("no ctx"))},n.onerror=function(e){console.error(e),a(e)},n.src="string"===typeof t||t instanceof String?t:r.createObjectURL(t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"createDataUrl",value:function(t,a,n){return e.createHTMLCanvasElement(t).toDataURL(a,n)}},{key:"applyMask",value:function(e,t){if(e.data.length!==t.data.length)throw new Error("cannot apply mask of different size");for(var a=new ImageData(new Uint8ClampedArray(e.data),e.width,e.height),n=a.data,r=t.data,i=0;i<n.length;i+=4)n[i+3]=r[i];return a}},{key:"resizeImageDataMinSize",value:function(t,a){if(!t||a<1)return null;var n=t.width,r=t.height;return n<=r?(n=a,r=Math.floor(t.height*n/t.width)):(r=a,n=Math.floor(t.width*r/t.height)),e.resizeImageData(t,n,r)}},{key:"resizeImageDataMaxSize",value:function(t,a){if(!t||a<1)return null;var n=t.width,r=t.height;return n>=r?(n=a,r=Math.floor(t.height*n/t.width)):(r=a,n=Math.floor(t.width*r/t.height)),e.resizeImageData(t,n,r)}},{key:"resizeImageDataToWidth",value:function(t,a){if(!t||a<1)return null;var n=a,r=Math.floor(t.height*n/t.width);return e.resizeImageData(t,n,r)}},{key:"resizeImageDataToHeight",value:function(t,a){if(!t||a<1)return null;var n=a,r=Math.floor(t.width*n/t.height);return e.resizeImageData(t,r,n)}},{key:"resizeImageData",value:function(t,a,n){if(!t||a<1||n<1)return null;if(t.width===a&&t.height===n)return t;var r=e.createHTMLCanvasElementForSize(t.width,t.height),i=r.getContext("2d"),o=e.createHTMLCanvasElementForSize(a,n),s=o.getContext("2d");return i&&s?(i.putImageData(t,0,0),s.drawImage(r,0,0,t.width,t.height,0,0,o.width,o.height),s.getImageData(0,0,o.width,o.height)):null}},{key:"createBitmask",value:function(e){for(var t=new Int8Array(e.width*e.height),a=0,n=0;a<e.data.length;a+=4,n+=1){var r=e.data[a]+e.data[a+1]+e.data[a+2];t[n]=r>0?255:0}return t}},{key:"doesImageExceedMaxLength",value:function(e,t){return e&&(e.width>t||e.height>t)}},{key:"toBlob",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;setTimeout((function(){for(var r=atob(e.toDataURL(a,n).split(",")[1]),i=r.length,o=new Uint8Array(i),s=0;s<i;s+=1)o[s]=r.charCodeAt(s);t(new Blob([o],{type:a||"image/png"}))}))}},{key:"getMaxViewportDimsWebGl",value:function(){var e=document.createElement("canvas").getContext("webgl"),t=null===e||void 0===e?void 0:e.getParameter(null===e||void 0===e?void 0:e.MAX_VIEWPORT_DIMS);return t&&2===t.length?[Math.floor(t[0]/2),Math.floor(t[1]/2)]:null}},{key:"renderIntoImageData",value:function(t,a,n){if(a&&t&&t.width===a.width&&t.height===a.height){var r=e.createHTMLCanvasElementForSize(t.width,t.height),i=r.getContext("2d");if(i)return i.drawImage(t,0,0,r.width,r.height),i.globalAlpha=n,i.drawImage(a,0,0,a.width,a.height),i.getImageData(0,0,r.width,r.height)}}},{key:"hasAlpha",value:function(e){for(var t=3;t<e.data.length;t+=4)if(255!==e.data[t])return!0;return!1}},{key:"flipPixels",value:function(e,t,a){for(var n=Math.floor(a/2),r=Math.floor(4*t),i=new Uint8Array(4*t),o=0;o<n;o+=1){var s=o*r,l=(a-o-1)*r;i.set(e.subarray(s,s+r)),e.copyWithin(s,l,l+r),e.set(i,l)}}},{key:"createRgbMaskFromGreyBuffer",value:function(e){for(var t=new Uint8ClampedArray(4*e.length),a=0,n=0;n<e.length;n++)255===e[n]?(t[a++]=255,t[a++]=255,t[a++]=255,t[a++]=0):(t[a++]=e[n],t[a++]=e[n],t[a++]=e[n],t[a++]=255);return t}},{key:"getNonAlphaBoundingRect",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=e.width,n=0,r=e.height,i=0,o=0;o<e.height;o+=1)for(var s=0;s<e.width;s+=1)e.data[o*e.width*4+4*s+3]>t&&(s<a&&(a=s),s>n&&(n=s),o<r&&(r=o),o>i&&(i=o));if(!(a===e.width||0===n||r===e.height||0===i||a>=n||r>=i))return{x:a,y:r,width:n-a,height:i-r}}},{key:"copyImageData",value:function(t,a){if(a.width===t.width&&a.height===t.height)return t;if(!(a.x+a.width>t.width||a.y+a.height>t.height)){var n=e.createHTMLCanvasElement(t).getContext("2d");return n?n.getImageData(a.x,a.y,a.width,a.height):void 0}}},{key:"addAlphaBorder",value:function(t,a){var n=t.width+2*a,r=t.height+2*a,i=e.createHTMLCanvasElementForSize(n,r).getContext("2d");if(i)return i.drawImage(e.createHTMLCanvasElement(t),a,a,t.width,t.height),i.getImageData(0,0,n,r)}},{key:"calcUncompressedImageSize",value:function(e,t){return e*t*3}},{key:"isEmptyImage",value:function(e){for(var t=0;t<e.data.length;t++)if(0!==e.data[t])return!1;return!0}}]),e}()},208:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return E}));var n=a(3),r=a(4),i=a(6),o=a(7),s=a(14),l=a.n(s),c=a(61),u=a.n(c),d=a(75),h=a(45),f=a.n(h),p=a(0),m=a.n(p),v=a(9),g=a(1),b=a(209),y=a(212),E=(a(578),function(t){Object(i.a)(s,t);var a=Object(o.a)(s);function s(e){var t;Object(n.a)(this,s);return(t=a.call(this,e)).state={selectedTabIdx:0,params:e.controller.getParams(),processing:!1},t}return Object(r.a)(s,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"setParams",value:function(e){this.setState({params:e})}},{key:"selectTab",value:function(e){this.setState({selectedTabIdx:e})}},{key:"showProcessing",value:function(t){this.setState({processing:!0},(function(){e.nextTick(t)}))}},{key:"render",value:function(){var e=this,t=this.props.controller,a=this.state,n=a.selectedTabIdx,r=a.params,i=a.processing;return m.a.createElement("div",{className:"editor-panel"},i&&m.a.createElement(f.a,{centered:!0}),m.a.createElement("div",{className:"settings-right adjust-settings-right"},m.a.createElement("div",{className:"settings-scrolling-content"},m.a.createElement("div",{className:"settings-header",style:{marginBottom:"0"}},m.a.createElement("div",{className:"title"},Object(g.b)("AdjustView.Title.AdjustImage","Adjust image")),m.a.createElement("div",{className:"reset-button"},m.a.createElement(l.a,{quiet:!0,variant:"action",onClick:function(){t.reset()},icon:m.a.createElement(u.a,null),disabled:!t.isDirty()},Object(g.b)("AdjustView.Button.Reset","Reset")))),m.a.createElement(d.TabView,{style:{marginLeft:"8px"},onSelect:function(t){return e.selectTab(t)},selectedIndex:n},m.a.createElement(d.Tab,{label:Object(g.b)("AdjustView.Tab.Presets","Presets"),className:"tab1class"},m.a.createElement(y.a,{controller:t,params:r})),m.a.createElement(d.Tab,{label:Object(g.b)("AdjustView.Tab.Details","Details")},m.a.createElement(b.a,{controller:t,params:r})))),m.a.createElement("div",{className:"action-button-container"},m.a.createElement(l.a,{onClick:function(){Object(v.a)("adjustCancel"),t.cancel()},title:Object(g.b)("AdjustView.Button.Cancel","Cancel")},Object(g.b)("AdjustView.Button.Cancel","Cancel")),m.a.createElement(l.a,{quiet:!0,variant:"cta",onClick:function(){Object(v.a)("adjust"),t.apply()},disabled:!t.isDirty(),title:Object(g.b)("AdjustView.Button.AdjustImage","Adjust image")},Object(g.b)("AdjustView.Button.AdjustImage","Adjust image")))))}}]),s}(p.PureComponent))}).call(this,a(79))},209:function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a(3),r=a(4),i=a(6),o=a(7),s=a(56),l=a(14),c=a.n(l),u=a(210),d=a.n(u),h=a(211),f=a.n(h),p=a(88),m=a.n(p),v=a(0),g=a.n(v),b=a(39),y=a.n(b),E=a(9),w=a(1),x=(a(534),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).state={showVignetteDetails:!1},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"refresh",value:function(){}},{key:"handleChange",value:function(e,t){this.props.controller.setAdjustParam(e,t,!1)}},{key:"handleChangeEnd",value:function(e,t){this.props.controller.setAdjustParam(e,t,!0),Object(E.a)("adjust:details:".concat(m()(e)))}},{key:"toggleVignetteDetails",value:function(){var e=this.state.showVignetteDetails;this.setState({showVignetteDetails:!e})}},{key:"render",value:function(){var e=this,t=this.state.showVignetteDetails,a=this.props.params;return g.a.createElement("div",{className:"details-panel"},g.a.createElement(s.Accordion,{multiselectable:!0,defaultSelectedIndex:0,style:{width:"100%"}},g.a.createElement(s.AccordionItem,{header:Object(w.b)("AdjustView.Controls.Slider.Header.Light","Light")},g.a.createElement(y.a,{renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Exposure","Exposure"),min:-5,max:5,step:.1,filled:!0,fillOffset:.01,value:a.exposure,onChange:function(t){return e.handleChange("exposure",t)},onChangeEnd:function(t){return e.handleChangeEnd("exposure",t)},className:"darkLight"}),g.a.createElement(y.a,{renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Contrast","Contrast"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.contrast,onChange:function(t){return e.handleChange("contrast",t)},onChangeEnd:function(t){return e.handleChangeEnd("contrast",t)},className:"lightDark"}),g.a.createElement(y.a,{renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Highlights","Highlights"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.highlights,onChange:function(t){return e.handleChange("highlights",t)},onChangeEnd:function(t){return e.handleChangeEnd("highlights",t)},className:"darkLight"}),g.a.createElement(y.a,{renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Shadows","Shadows"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.shadows,onChange:function(t){return e.handleChange("shadows",t)},onChangeEnd:function(t){return e.handleChangeEnd("shadows",t)},className:"darkLight"}),g.a.createElement(y.a,{renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Whites","Whites"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.whites,onChange:function(t){return e.handleChange("whites",t)},onChangeEnd:function(t){return e.handleChangeEnd("whites",t)},className:"darkLight"}),g.a.createElement(y.a,{renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Blacks","Blacks"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.blacks,onChange:function(t){return e.handleChange("blacks",t)},onChangeEnd:function(t){return e.handleChangeEnd("blacks",t)},className:"darkLight"})),g.a.createElement(s.AccordionItem,{header:Object(w.b)("AdjustView.Controls.Slider.Header.Color","Color")},g.a.createElement(y.a,{renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Temperature","Temperature"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.temperature,onChange:function(t){return e.handleChange("temperature",t)},onChangeEnd:function(t){return e.handleChangeEnd("temperature",t)},className:"temperature"}),g.a.createElement(y.a,{renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Tint","Tint"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.tint,onChange:function(t){return e.handleChange("tint",t)},onChangeEnd:function(t){return e.handleChangeEnd("tint",t)},className:"tint"}),g.a.createElement(y.a,{renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Vibrance","Vibrance"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.vibrance,onChange:function(t){return e.handleChange("vibrance",t)},onChangeEnd:function(t){return e.handleChangeEnd("vibrance",t)},className:"vibrance"}),g.a.createElement(y.a,{renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Saturation","Saturation"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.saturation,onChange:function(t){return e.handleChange("saturation",t)},onChangeEnd:function(t){return e.handleChangeEnd("saturation",t)},className:"vibrance"})),g.a.createElement(s.AccordionItem,{header:Object(w.b)("AdjustView.Controls.Slider.Header.Effects","Effects")},g.a.createElement(y.a,{renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Clarity","Clarity"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.clarity,onChange:function(t){return e.handleChange("clarity",t)},onChangeEnd:function(t){return e.handleChangeEnd("clarity",t)},className:"lightDark"}),g.a.createElement("div",{className:"vignette-slider-group"},g.a.createElement(c.a,{variant:"tool",icon:t?g.a.createElement(d.a,null):g.a.createElement(f.a,null),onClick:function(){return e.toggleVignetteDetails()},className:"vignette-details-button"}),g.a.createElement(y.a,{renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Vignette.Title","Vignette"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.vignette_amount,onChange:function(t){return e.handleChange("vignette_amount",t)},onChangeEnd:function(t){return e.handleChangeEnd("vignette_amount",t)},className:"vignette-amount darkLightDark"}),t&&g.a.createElement("div",{className:"vignette-slider-sub-group"},g.a.createElement(y.a,Object.assign({renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Vignette.Midpoint","Midpoint"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.vignette_midpoint,onChange:function(t){return e.handleChange("vignette_midpoint",t)},onChangeEnd:function(t){return e.handleChangeEnd("vignette_midpoint",t)},className:"darkLight"},0===a.vignette_amount&&{disabled:!0})),g.a.createElement(y.a,Object.assign({renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Vignette.Roundness","Roundness"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.vignette_roundness,onChange:function(t){return e.handleChange("vignette_roundness",t)},onChangeEnd:function(t){return e.handleChangeEnd("vignette_roundness",t)},className:"darkLightDark"},0===a.vignette_amount&&{disabled:!0})),g.a.createElement(y.a,Object.assign({renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Vignette.Feather","Feather"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.vignette_feather,onChange:function(t){return e.handleChange("vignette_feather",t)},onChangeEnd:function(t){return e.handleChangeEnd("vignette_feather",t)},className:"darkLight"},0===a.vignette_amount&&{disabled:!0})),g.a.createElement(y.a,Object.assign({renderLabel:!0,label:Object(w.b)("AdjustView.Controls.Slider.Vignette.Highlights","Highlights"),min:-100,max:100,step:1,filled:!0,fillOffset:.01,value:a.vignette_highlight,onChange:function(t){return e.handleChange("vignette_highlight",t)},onChangeEnd:function(t){return e.handleChangeEnd("vignette_highlight",t)}},(!a.vignette_amount||a.vignette_amount>=0)&&{disabled:!0})))))))}}]),a}(v.PureComponent))},21:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(3),r=a(4),i=a(17),o=a(16),s=/^(color|creative|vintage|bw|vignette)$/,l=/^(styletransfer|psaction|custom)$/,c=/^(invertcolor|pixelate|halftone|colorhalftone|posterize|colorcycle|lensflare|oilpaint|cartoon|popart|colorize|highresstyle)$/,u=new RegExp("^(".concat(Object.values(i.b).join("|"),")$")),d=new RegExp("^(".concat(Object.values(i.a).join("|"),")$")),h=new RegExp("^convert/(".concat(Object.values(i.a).join("|"),")$")),f=new RegExp("^convert/(".concat(Object.values(i.b).join("|"),")/(").concat(Object.values(i.a).join("|"),")$")),p=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,null,[{key:"getParams",value:function(){var t=sessionStorage.getItem(e.SESSION_STORAGE_KEY)||"{}";return JSON.parse(t)}},{key:"setParams",value:function(t){sessionStorage.setItem(e.SESSION_STORAGE_KEY,JSON.stringify(t))}},{key:"getParam",value:function(t){var a=e.getParams();if(a.queryString&&0!==a.queryString.length)return new URLSearchParams(a.queryString).get(t)||void 0}},{key:"parseParams",value:function(){var t={},a=new URLSearchParams(window.location.search);t.queryString=a.toString(),window.location.hash.length>0&&new URLSearchParams(window.location.hash).forEach((function(e,t){return a.append(t,e)})),a.forEach((function(e,a){switch(a){case"rctx":var n=JSON.parse(e.substring(0,e.indexOf("}")+1));n&&((t.ims=t.ims||{}).lastEditor=n.lastEditor);break;case"api":(t.ims=t.ims||{}).redirectAPI=e;break;case"prevent_interstitial":t.interstitial={preventInterstitial:"true"===e};break;case"prevent_upsell":t.upsell={preventUpsell:"true"===e};break;case"uitest":t.globalAction=t.globalAction||{},t.globalAction.isUITest="true"===e;break;case"action":t.globalAction=t.globalAction||{},t.globalAction.action=e;break;case"sourceformat":e.match(u)&&(t.globalAction=t.globalAction||{},t.globalAction.sourceFormat=e);break;case"targetformat":e.match(d)&&(t.globalAction=t.globalAction||{},t.globalAction.targetFormat=e);break;case"bg_color":t.cutout={bgColor:e};break;case"bg_blur_intensity":t.cutout={blurRadius:e};break;case"group":e.match(s)&&(t.adjustments=t.adjustments||{},t.adjustments.group=e),e.match(l)&&(t.effects=t.effects||{},t.effects.group=e);break;case"presetid":t.adjustments=t.adjustments||{},t.adjustments.presetid=parseInt(e,10)||0;break;case"effect":t.effects=t.effects||{},t.effects.effect=e;break;case"enlarger":t.resize={enlarger:"true"===e};break;case"spotheal_tooltips":t.spotheal={enableTooltips:"true"===e};break;case"show_experimental_effects":t.effects=t.effects||{},t.effects.showExperimental="true"===e}}));var n=window.location.pathname.slice(1).split("/");"embed"===n[0]?(t.globalAction=t.globalAction||{},t.globalAction.isEmbed=!0,n.shift()):n[0]in o.a&&(t.editor=n.shift());var r=n.join("/");switch(r){case"background/replace":var i=a.get("color");i&&(t.editor=o.a.cutout,t.cutout={bgColor:i});break;case"background/blur":var p=a.get("intensity");p&&(t.editor=o.a.cutout,t.cutout={blurRadius:p});break;case"compress":t.globalAction=t.globalAction||{},t.globalAction.action="compress";break;case(r.match(h)||{}).input:t.globalAction=t.globalAction||{},t.globalAction.action="convert",t.globalAction.targetFormat=n.pop();break;case(r.match(f)||{}).input:t.globalAction=t.globalAction||{},t.globalAction.action="convert",t.globalAction.targetFormat=n.pop(),t.globalAction.sourceFormat=n.pop();break;case"enlarger":t.resize={enlarger:!0};break;case(r.match(s)||{}).input:t.editor===o.a.adjust&&(t.adjustments=t.adjustments||{},t.adjustments.group=r);break;case(r.match(/^\d{1,2}$/)||{}).input:t.editor===o.a.adjust&&(t.adjustments=t.adjustments||{},t.adjustments.presetid=parseInt(r||"0",10));break;case(r.match(l)||{}).input:t.editor===o.a.effects&&(t.effects=t.effects||{},t.effects.group=r);break;case(r.match(c)||{}).input:t.editor===o.a.effects&&(t.effects=t.effects||{},t.effects.effect=r)}e.setParams(t)}}]),e}();p.SESSION_STORAGE_KEY="fps_query_params"},212:function(e,t,a){"use strict";a.d(t,"a",(function(){return P}));var n=a(3),r=a(4),i=a(6),o=a(7),s=a(56),l=a(14),c=a.n(l),u=a(89),d=a(213),h=a.n(d),f=a(50),p=a.n(f),m=a(59),v=a.n(m),g=a(20),b=a(88),y=a.n(b),E=a(0),w=a.n(E),x=a(39),k=a.n(x),S=a(9),O=a(1),C=a(85),P=(a(577),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"refresh",value:function(){}},{key:"renderGroups",value:function(){var e=this,t=this.props,a=t.controller,n=t.params;return a.getPresetGroups().map((function(t){return w.a.createElement(s.AccordionItem,{key:t.id,header:t.title},t.id===n.groupId&&e.renderPresets(t))}))}},{key:"renderPresets",value:function(e){var t=this.props,a=t.controller,n=t.params,r=[];return e.presets.forEach((function(e){var t=Object(g.find)(a.getPresets(),{id:e});t&&r.push(t)})),r.map((function(t){return w.a.createElement(u.Card,{key:t.id,id:"".concat(e.id,"-").concat(t.id),allowsSelection:!1,className:n.presetId===t.id?"image-card selected":"image-card",actionMenu:w.a.createElement(p.a,{delayShow:1500},w.a.createElement(c.a,{icon:w.a.createElement(h.a,null),variant:"tool",onClick:function(){return a.showDetails()}}),w.a.createElement(v.a,null,Object(O.b)("AdjustView.Presets.ViewMore","View more")))},w.a.createElement("div",{className:"spectrum-Card-coverPhoto",onClick:function(){a.setPreset(e,t,C.a,!0),Object(S.a)("adjust:".concat(y()(e.title).toLowerCase(),":").concat(y()(t.title)))},role:"presentation",style:{backgroundImage:"url('".concat(a.getPresetPreviewUrl(t),"')"),cursor:"pointer",width:"255px"}}),w.a.createElement(u.CardBody,{className:"presets-card-body",title:t.title},n.presetId===t.id&&t.hasIntensity&&w.a.createElement("div",{className:"base-slider"},w.a.createElement(k.a,{renderLabel:!0,label:Object(O.b)("AdjustView.Controls.Slider.Amount","Amount"),min:.1,max:2,step:.01,filled:!0,fillOffset:1,value:n.intensity,onChange:function(n){return a.setPreset(e,t,n,!1)},onChangeEnd:function(n){a.setPreset(e,t,n,!0),Object(S.a)("adjust:details:intensity")},getAriaValueText:function(e){return"".concat(Math.round(100*e)," %")}}))))}))}},{key:"render",value:function(){var e=this.props,t=e.controller,a=e.params,n=t.getPresetGroups(),r=a.groupId?Object(g.findIndex)(n,{id:a.groupId}):void 0;return w.a.createElement("div",{className:"presets-panel"},w.a.createElement(s.Accordion,{selectedIndex:r,onChange:function(e){return t.setGroup(null!==e?n[e]:void 0)}},this.renderGroups()))}}]),a}(E.PureComponent))},214:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return U}));var n=a(3),r=a(4),i=a(6),o=a(7),s=a(56),l=a(14),c=a.n(l),u=a(215),d=a.n(u),h=a(52),f=a.n(h),p=a(61),m=a.n(p),v=a(45),g=a.n(v),b=a(20),y=a(0),E=a.n(y),w=a(216),x=a(217),k=a(218),S=a(219),O=a(220),C=a(221),P=a(33),T=a(222),A=a(223),j=a(224),I=a(225),M=a(226),R=a(39),_=a.n(R),D=a(9),L=a(1),N=(a(581),a(35)),V=a(62),U=function(t){Object(i.a)(l,t);var a=Object(o.a)(l);function l(e){var t;return Object(n.a)(this,l),(t=a.call(this,e)).uiAspectRatios=void 0,t.rotateLeft=function(){t.props.controller.changeOrientation(-90)},t.rotateRight=function(){t.props.controller.changeOrientation(90)},t.flipHorizontally=function(){t.props.controller.flipHorizontally()},t.flipVertically=function(){t.props.controller.flipVertically()},t.setCropShape=function(e){t.props.controller.setCropShape(e)},t.changeAspectRatio=function(e){if("string"===typeof e||e instanceof String){var a,n=t.getAspectRatioInfoByKey(e);if(n)null===(a=t.props.controller)||void 0===a||a.changeAspectRatio(n.key,n.ratio)}},t.rotateAspectRatio=function(){t.props.controller.rotateAspectRatio()},t.uiAspectRatios=V.c.getUIAspectRatios(L.b,t.props.imageAspectRatio),t.state={straightening:0,aspectRatioKey:"",canReset:!1,cropShape:N.a.RECT,processing:!1},t}return Object(r.a)(l,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"getAspectRatioInfoByKey",value:function(e){return Object(b.flatMap)(this.uiAspectRatios,(function(e){return e.aspectRatios})).find((function(t){return t.key===e}))}},{key:"refresh",value:function(){var e,t=this.props.controller.getEditorState();this.setState({straightening:t.straightening,aspectRatioKey:null!==(e=t.aspectRatioKey)&&void 0!==e?e:"",canReset:this.props.controller.isDirty(),cropShape:t.cropShape})}},{key:"showProcessing",value:function(t){this.setState({processing:!0},(function(){e.nextTick(t)}))}},{key:"render",value:function(){var e=this,t=this.props.controller,a=this.state,n=a.straightening,r=a.aspectRatioKey,i=a.canReset,o=a.cropShape,l=a.processing;return E.a.createElement("div",{className:"editor-panel"},l&&E.a.createElement(g.a,{centered:!0}),E.a.createElement("div",{className:"settings-right crop-settings-right"},E.a.createElement("div",{className:"settings-scrolling-content"},E.a.createElement("div",{className:"settings-header"},E.a.createElement("div",{className:"title"},Object(L.b)("CropView.Title.CropImage","Crop image")),E.a.createElement("div",{className:"reset-button"},E.a.createElement(c.a,{quiet:!0,variant:"action",onClick:function(){t.reset()},icon:E.a.createElement(m.a,null),disabled:!i},Object(L.b)("CropView.Button.Reset","Reset")))),E.a.createElement("section",null,E.a.createElement(f.a,{label:Object(L.b)("CropView.Controls.ButtonGroup.Label.RotateAndFlip","Rotate & flip"),labelFor:"__"},E.a.createElement(c.a,{quiet:!0,variant:"action",title:Object(L.b)("CropView.Controls.Button.RotateL","Rotate Left"),onClick:this.rotateLeft,icon:E.a.createElement(P.a,{icon:E.a.createElement(j.a,null),size:"S"})}),E.a.createElement(c.a,{quiet:!0,variant:"action",title:Object(L.b)("CropView.Controls.Button.RotateR","Rotate Right"),onClick:this.rotateRight,icon:E.a.createElement(P.a,{icon:E.a.createElement(I.a,null),size:"S"})}),E.a.createElement(c.a,{quiet:!0,variant:"action",title:Object(L.b)("CropView.Controls.Button.FlipH","Flip Horizontal"),onClick:this.flipHorizontally,icon:E.a.createElement(P.a,{icon:E.a.createElement(T.a,null),size:"S"})}),E.a.createElement(c.a,{quiet:!0,variant:"action",title:Object(L.b)("CropView.Controls.Button.FlipV","Flip Vertical"),onClick:this.flipVertically,icon:E.a.createElement(P.a,{icon:E.a.createElement(A.a,null),size:"S"})}))),E.a.createElement("section",null,E.a.createElement(_.a,{renderLabel:!0,label:Object(L.b)("CropView.Controls.Slider.Label.Straighten","Straighten"),min:-45,max:45,step:.1,filled:!0,fillOffset:.01,value:n,onChange:function(e){return t.setStraightening(e)},onChangeEnd:function(e){return t.setStraightening(e,!0)}})),E.a.createElement("div",{className:"settings-section-divider"}),E.a.createElement(f.a,{label:Object(L.b)("CropView.Controls.Select.Label.AspectRatio","Aspect ratio"),className:"sectionless-fieldlabel",labelFor:"__"},E.a.createElement(c.a,{quiet:!0,variant:"action",icon:E.a.createElement(P.a,{icon:E.a.createElement(M.a,null),size:"S"}),"aria-label":"Rotate aspect ratio",className:"fieldlabel-button",onClick:this.rotateAspectRatio},Object(L.b)("CropView.Button.RotateAspectRatio","Rotate")),E.a.createElement(s.Accordion,{defaultSelectedIndex:void 0},this.uiAspectRatios.map((function(t){return E.a.createElement(s.AccordionItem,{key:t.key,header:t.name},E.a.createElement(d.a,{orientation:"vertical",className:"w-100",onChange:e.changeAspectRatio,value:"".concat(r)},t.aspectRatios.map((function(e){return E.a.createElement(c.a,{key:e.key,label:e.label,value:e.key,icon:e.icon})}))))})))),E.a.createElement("div",{className:"settings-section-divider"}),E.a.createElement(f.a,{label:Object(L.b)("CropView.Controls.Select.Label.Shapes","Shapes"),className:"sectionless-fieldlabel shapes",labelFor:"__"},E.a.createElement("section",null,E.a.createElement(c.a,{variant:"action",selected:o===N.a.RECT,title:Object(L.b)("CropView.Controls.Button.ShapeRectangle","Rectangle"),onClick:function(){return e.setCropShape(N.a.RECT)},icon:E.a.createElement(P.a,{icon:E.a.createElement(S.a,null),size:"XXL"})}),E.a.createElement(c.a,{variant:"action",selected:o===N.a.ROUNDED_RECT,title:Object(L.b)("CropView.Controls.Button.ShapeRoundedRectangle","Rounded Rectangle"),onClick:function(){return e.setCropShape(N.a.ROUNDED_RECT)},icon:E.a.createElement(P.a,{icon:E.a.createElement(O.a,null),size:"XXL"})}),E.a.createElement(c.a,{variant:"action",selected:o===N.a.ELLIPSE,title:Object(L.b)("CropView.Controls.Button.ShapeCircle","Circle"),onClick:function(){return e.setCropShape(N.a.ELLIPSE)},icon:E.a.createElement(P.a,{icon:E.a.createElement(w.a,null),size:"XXL"})}),E.a.createElement(c.a,{variant:"action",selected:o===N.a.HEART,title:Object(L.b)("CropView.Controls.Button.ShapeHeart","Heart"),onClick:function(){return e.setCropShape(N.a.HEART)},icon:E.a.createElement(P.a,{icon:E.a.createElement(x.a,null),size:"XXL"})}),E.a.createElement(c.a,{variant:"action",selected:o===N.a.STAR,title:Object(L.b)("CropView.Controls.Button.ShapeStar","Star"),onClick:function(){return e.setCropShape(N.a.STAR)},icon:E.a.createElement(P.a,{icon:E.a.createElement(C.a,null),size:"XXL"})}),E.a.createElement(c.a,{variant:"action",selected:o===N.a.OCTAGON,title:Object(L.b)("CropView.Controls.Button.ShapeOctagon","Octagon"),onClick:function(){return e.setCropShape(N.a.OCTAGON)},icon:E.a.createElement(P.a,{icon:E.a.createElement(k.a,null),size:"XXL"})})))),E.a.createElement("div",{className:"action-button-container"},E.a.createElement(c.a,{onClick:function(){Object(D.a)("cropCancel"),t.cancel()}},Object(L.b)("CropView.Button.Cancel","Cancel")),E.a.createElement(c.a,{quiet:!0,variant:"cta",onClick:function(){Object(D.a)("crop"),t.apply()},disabled:!i,title:Object(L.b)("CropView.Button.CropImage","Crop image")},Object(L.b)("CropView.Button.CropImage","Crop image")))))}}]),l}(y.PureComponent)}).call(this,a(79))},216:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},r.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.a.createElement("circle",{cx:19.9,cy:19.9,r:19.9}))),l=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({width:39.8,height:39.8,viewBox:"0 0 39.8 39.8",ref:t},n),a?r.a.createElement("title",null,a):null,s)},c=r.a.forwardRef((function(e,t){return r.a.createElement(l,i({svgRef:t},e))}));a.p},217:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},r.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.a.createElement("g",{id:"redheart"},r.a.createElement("g",{id:"heart"},r.a.createElement("path",{d:"M120.71,220.71c-35-75-65-60-100-100a70.71,70.71,0,0,1,100-100,70.71,70.71,0,0,1,100,100c-35,40-65,25-100,100"}))))),l=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({width:241.42,height:220.71,viewBox:"0 0 241.42 220.71",ref:t},n),a?r.a.createElement("title",null,a):null,s)},c=r.a.forwardRef((function(e,t){return r.a.createElement(l,i({svgRef:t},e))}));a.p},218:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},r.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.a.createElement("path",{d:"M277.44,80.64,197.68.88A3,3,0,0,0,195.55,0H82.76a3,3,0,0,0-2.13.88L.88,80.64A3,3,0,0,0,0,82.76v112.8a3,3,0,0,0,.88,2.12l79.75,79.77a3,3,0,0,0,2.13.87h112.8a3,3,0,0,0,2.12-.87l79.77-79.77a3,3,0,0,0,.87-2.12V82.76A3,3,0,0,0,277.44,80.64Z"}))),l=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({width:278.32,height:278.32,viewBox:"0 0 278.32 278.32",ref:t},n),a?r.a.createElement("title",null,a):null,s)},c=r.a.forwardRef((function(e,t){return r.a.createElement(l,i({svgRef:t},e))}));a.p},219:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},r.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.a.createElement("rect",{width:40,height:40}))),l=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({width:40,height:40,viewBox:"0 0 40 40",ref:t},n),a?r.a.createElement("title",null,a):null,s)},c=r.a.forwardRef((function(e,t){return r.a.createElement(l,i({svgRef:t},e))}));a.p},220:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},r.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.a.createElement("rect",{width:40,height:40,rx:6}))),l=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({width:40,height:40,viewBox:"0 0 40 40",ref:t},n),a?r.a.createElement("title",null,a):null,s)},c=r.a.forwardRef((function(e,t){return r.a.createElement(l,i({svgRef:t},e))}));a.p},221:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},r.a.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.a.createElement("path",{d:"M149.76,4.15l34.38,91,97.16,4.6a6.44,6.44,0,0,1,3.75,11.46l-75.9,60.84,25.63,93.84A6.44,6.44,0,0,1,225,273l-81.29-53.39L62.42,273a6.44,6.44,0,0,1-9.75-7.08l25.62-93.84L2.41,111.21A6.44,6.44,0,0,1,6.16,99.75l97.14-4.6,34.42-91a6.44,6.44,0,0,1,12,0Z"}))),l=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({width:287.46,height:274.03,viewBox:"0 0 287.46 274.03",ref:t},n),a?r.a.createElement("title",null,a):null,s)},c=r.a.forwardRef((function(e,t){return r.a.createElement(l,i({svgRef:t},e))}));a.p},222:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("rect",{className:"fill",x:16,y:2,width:2,height:2,rx:.5}),l=r.a.createElement("rect",{className:"fill",x:16,y:6,width:2,height:2,rx:.5}),c=r.a.createElement("rect",{className:"fill",x:16,y:10,width:2,height:2,rx:.5}),u=r.a.createElement("rect",{className:"fill",x:16,y:14,width:2,height:2,rx:.5}),d=r.a.createElement("rect",{className:"fill",x:16,y:18,width:2,height:2,rx:.5}),h=r.a.createElement("rect",{className:"fill",x:16,y:22,width:2,height:2,rx:.5}),f=r.a.createElement("rect",{className:"fill",x:16,y:26,width:2,height:2,rx:.5}),p=r.a.createElement("rect",{className:"fill",x:16,y:30,width:2,height:2,rx:.5}),m=r.a.createElement("path",{className:"fill",d:"M30.276,28.7,20.2,17.8a1.01,1.01,0,0,1,0-1.428L30.276,5.3A1.01,1.01,0,0,1,32,6.012V27.988A1.01,1.01,0,0,1,30.276,28.7Z"}),v=r.a.createElement("path",{className:"fill",d:"M3.845,8.079l8.168,8.843L3.845,25.9ZM3.044,5A1.009,1.009,0,0,0,2.027,6.012V27.988A1.009,1.009,0,0,0,3.045,29a.987.987,0,0,0,.706-.3L13.823,17.633a1.01,1.01,0,0,0,0-1.428L3.751,5.3A.989.989,0,0,0,3.044,5Z"}),g=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({id:"icons",width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?r.a.createElement("title",null,a):null,s,l,c,u,d,h,f,p,m,v)},b=r.a.forwardRef((function(e,t){return r.a.createElement(g,i({svgRef:t},e))}));a.p},223:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("rect",{className:"fill",x:2,y:16,width:2,height:2,rx:.5}),l=r.a.createElement("rect",{className:"fill",x:6,y:16,width:2,height:2,rx:.5}),c=r.a.createElement("rect",{className:"fill",x:10,y:16,width:2,height:2,rx:.5}),u=r.a.createElement("rect",{className:"fill",x:14,y:16,width:2,height:2,rx:.5}),d=r.a.createElement("rect",{className:"fill",x:18,y:16,width:2,height:2,rx:.5}),h=r.a.createElement("rect",{className:"fill",x:22,y:16,width:2,height:2,rx:.5}),f=r.a.createElement("rect",{className:"fill",x:26,y:16,width:2,height:2,rx:.5}),p=r.a.createElement("rect",{className:"fill",x:30,y:16,width:2,height:2,rx:.5}),m=r.a.createElement("path",{className:"fill",d:"M5.3,30.249,16.2,20.177a1.01,1.01,0,0,1,1.428,0L28.7,30.249a1.01,1.01,0,0,1-.714,1.724H6.012A1.01,1.01,0,0,1,5.3,30.249Z"}),v=r.a.createElement("path",{className:"fill",d:"M25.921,3.818l-8.843,8.168L8.1,3.818ZM29,3.017A1.009,1.009,0,0,0,27.988,2H6.012A1.009,1.009,0,0,0,5,3.018a.987.987,0,0,0,.3.706L16.367,13.8a1.01,1.01,0,0,0,1.428,0L28.7,3.724A.989.989,0,0,0,29,3.017Z"}),g=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({id:"icons",width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?r.a.createElement("title",null,a):null,s,l,c,u,d,h,f,p,m,v)},b=r.a.forwardRef((function(e,t){return r.a.createElement(g,i({svgRef:t},e))}));a.p},224:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("path",{className:"fill",d:"M18,2A16.03,16.03,0,0,0,4.644,9.228L1,7.521a.69.69,0,0,0-.531-.027.7.7,0,0,0-.424.9L3.053,16.7a.5.5,0,0,0,.589.276l8.311-3.008a.7.7,0,0,0,.42-.9.686.686,0,0,0-.361-.39L8.335,10.958a11.971,11.971,0,1,1-.161,13.917,2,2,0,0,0-3.274,2.3A16,16,0,1,0,18,2Z"}),l=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({id:"icons",width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?r.a.createElement("title",null,a):null,s)},c=r.a.forwardRef((function(e,t){return r.a.createElement(l,i({svgRef:t},e))}));a.p},225:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("path",{className:"fill",d:"M18,2A16.03,16.03,0,0,1,31.356,9.228L35,7.521a.69.69,0,0,1,.531-.027.7.7,0,0,1,.424.9L32.947,16.7a.5.5,0,0,1-.589.276l-8.311-3.008a.7.7,0,0,1-.42-.9.686.686,0,0,1,.361-.39l3.677-1.723a11.971,11.971,0,1,0,.161,13.917,2,2,0,0,1,3.274,2.3A16,16,0,1,1,18,2Z"}),l=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({id:"icons",width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?r.a.createElement("title",null,a):null,s)},c=r.a.forwardRef((function(e,t){return r.a.createElement(l,i({svgRef:t},e))}));a.p},226:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("path",{className:"fill",d:"M33,10H11a1,1,0,0,0-1,1V33a1,1,0,0,0,1,1H33a1,1,0,0,0,1-1V11A1,1,0,0,0,33,10Z"}),l=r.a.createElement("path",{className:"fill",d:"M7.5,15h-2V12a6,6,0,0,1,6-6h2a1,1,0,0,0,1-1V4a1,1,0,0,0-1-1h-2a9,9,0,0,0-9,9v3H.5a.5.5,0,0,0-.5.5.49.49,0,0,0,.147.35l3.537,4.033a.5.5,0,0,0,.632,0l3.537-4.033A.49.49,0,0,0,8,15.5.5.5,0,0,0,7.5,15Z"}),c=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({id:"icons",width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?r.a.createElement("title",null,a):null,s,l)},u=r.a.forwardRef((function(e,t){return r.a.createElement(c,i({svgRef:t},e))}));a.p},227:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return z}));var n=a(44),r=a(2),i=a.n(r),o=a(8),s=a(3),l=a(4),c=a(6),u=a(7),d=a(14),h=a.n(d),f=a(49),p=a.n(f),m=a(52),v=a.n(m),g=a(63),b=a(61),y=a.n(b),E=a(41),w=a.n(E),x=a(50),k=a.n(x),S=a(102),O=a.n(S),C=a(45),P=a.n(C),T=a(0),A=a.n(T),j=a(72),I=a.n(j),M=a(33),R=a(228),_=a(39),D=a.n(_),L=a(36),N=a(9),V=a(1),U=a(21),F=a(229),B=a(114),H=a(110),z=(a(599),function(t){Object(c.a)(r,t);var a=Object(u.a)(r);function r(e){var t;return Object(s.a)(this,r),(t=a.call(this,e)).progressDialogRef=void 0,t.loginDialogId=void 0,t.colorList=["transparent","#000000","#FFFFFF","#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#D4C4FB","multi"],t.state={params:e.controller.getParams(),processing:!1},t.loginDialogId=0,t}return Object(l.a)(r,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),this.initEditorView()}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"setParams",value:function(e){this.setState({params:e});var t,a=e.autoCutoutProgress;a&&(null===(t=this.progressDialogRef)||void 0===t||t.setProgress(a.state,a.percentage))}},{key:"refresh",value:function(){}},{key:"initEditorView",value:function(){var e,t=U.a.getParams(),a=sessionStorage.getItem("fps_cutout_color_return")||(null===(e=t.cutout)||void 0===e?void 0:e.bgColor),n=!1;if(a){var r;sessionStorage.removeItem("fps_cutout_color_return");var i=!1;(null===(r=t.cutout)||void 0===r?void 0:r.bgColor)&&(t.cutout.bgColor=void 0,U.a.setParams(t),i=!0),(L.b.getInstance().isSignedInUser()||i)&&(n=!0,this.process(a))}else{var o,s=sessionStorage.getItem("fps_cutout_blur_return")||(null===(o=t.cutout)||void 0===o?void 0:o.blurRadius);if(s){var l;sessionStorage.removeItem("fps_cutout_blur_return");var c=!1;(null===(l=t.cutout)||void 0===l?void 0:l.blurRadius)&&(t.cutout.blurRadius=void 0,U.a.setParams(t),c=!0),(L.b.getInstance().isSignedInUser()||c)&&(n=!0,this.process(void 0,parseInt(s,10)))}}n||this.applyBackgroundColor("transparent")}},{key:"process",value:function(){var e=Object(o.a)(i.a.mark((function e(t,a){var n,r,o,s,l,c,u=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props.controller,(r=t)&&!H.a.includes(r)&&(o=I()(r)).isValid()&&(r=o.toHexString().toUpperCase()),null===n||void 0===n?void 0:n.isProcessing()){e.next=18;break}return s=!1,this.progressDialogRef||(this.progressDialogRef=new B.a(r&&r.startsWith("#")?Object(V.b)("CutoutView.ProgressDialog.Title.ReplaceBackground","Replace background"):Object(V.b)("CutoutView.ProgressDialog.Title.RemoveBackground","Remove background"),(function(){s=!0,null===n||void 0===n||n.cancelAutoCutout(),u.progressDialogRef=void 0}),void 0,Object(V.b)("CutoutService.ProgressState.Upload","Upload"))),this.progressDialogRef.show(),e.prev=7,e.next=10,null===n||void 0===n?void 0:n.autoCutout(r,a);case 10:e.next=17;break;case 12:e.prev=12,e.t0=e.catch(7),console.error(e.t0),l=Object(V.b)("CutoutView.ModalDialog.Error.GenericErrorMessageTryAgain","An error has occurred. Please try again later."),w.a.show(A.a.createElement(p.a,{title:Object(V.b)("CutoutView.ModalDialog.Error.Title","Error"),variant:"error",confirmLabel:Object(V.b)("CutoutView.ModalDialog.Error.Confirm","OK"),role:"dialog",onClose:function(){return null===n||void 0===n?void 0:n.cancelAutoCutout()}},A.a.createElement("span",null,l)));case 17:s||(null===(c=this.progressDialogRef)||void 0===c||c.close(),this.progressDialogRef=void 0);case 18:return e.abrupt("return",Promise.resolve());case 19:case"end":return e.stop()}}),e,this,[[7,12]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"applyBackgroundColor",value:function(e){var t=this.props.controller;this.state.params.hasMask?t.applyBackgroundColor(e):this.process(e)}},{key:"applyBackgroundBlur",value:function(e,t){var a=this.props.controller;this.state.params.hasMask?a.applyBlurredBackground(e,t):this.process(void 0,e)}},{key:"showProcessing",value:function(t){this.setState({processing:!0},(function(){e.nextTick(t)}))}},{key:"renderColorRow",value:function(e,t){var a=this,r=this.state.params,i=void 0!==r.blurRadius,o=r.backgroundColor&&"string"===typeof r.backgroundColor&&r.backgroundColor.startsWith("#")?r.backgroundColor:"ff0000";return t.map((function(t){return"multi"===t?A.a.createElement(k.a,{trigger:"click",placement:"top"},A.a.createElement("div",{id:"color-picker-container",className:"multicolor-box bg-box ".concat(i||!r.backgroundColor||"string"!==typeof r.backgroundColor||a.colorList.includes(r.backgroundColor)?"":"selected"),key:"".concat(t,"-bg")}),A.a.createElement(O.a,{variant:"default",style:{minWidth:"0px",padding:"0"}},A.a.createElement(F.a,{startColorCode:o,onColorChange:function(e){return a.applyBackgroundColor("#".concat(e.toUpperCase()))}}))):A.a.createElement("div",{className:"bg-box ".concat("transparent"===t?"bg-box bg-box-transparent":""," ").concat(i||r.backgroundColor!==t?"":"selected"),key:"".concat(t,"-bg"),onClick:function(){return a.applyBackgroundColor(t)},role:"presentation",style:Object(n.a)({},"transparent"!==t?{background:t}:{})},A.a.createElement("div",{className:e?"grid-box grid-box-bg-image":"grid-box",key:"".concat(t,"-bg-img"),style:Object(n.a)({},e?{backgroundImage:"url('".concat(e,"')")}:{})}))}))}},{key:"renderGridColorRows",value:function(){for(var e=this.props.controller,t=null===e||void 0===e?void 0:e.getAppliedMaskDataUrl150(),a=[],n=0;n<this.colorList.length;n+=3)a.push(A.a.createElement(g.GridRow,{key:"colorrow_".concat(n),align:"left",valign:"top",distribution:"between",className:"grid-row"},this.renderColorRow(t,this.colorList.slice(n,n+3))));return a}},{key:"renderBlurPresetRow",value:function(e){var t=this,a=this.props.controller,n=null===a||void 0===a?void 0:a.getAppliedMaskDataUrl150(),r=null===a||void 0===a?void 0:a.getOriginalImageDataUrl150(),i=this.state.params;return e.map((function(e){return A.a.createElement("div",{key:"".concat(e,"-blur-bg-mask"),className:"grid-box bg-box blur-box ".concat(e===i.blurRadius?"selected":""),role:"presentation",onClick:function(){t.applyBackgroundBlur(e,e!==i.blurRadius)}},A.a.createElement("img",{src:r,alt:"blur preset",className:"grid-box-blur-image",style:{filter:"blur(".concat(e/10,"px)")}}),A.a.createElement("img",{className:"grid-box-blur-image",src:n,alt:"blur preset"}))}))}},{key:"render",value:function(){var e=this,t=this.props.controller,a=this.state,n=a.params,r=a.processing,i=void 0!==n.blurRadius,o=void 0!==n.backgroundColor,s=i||o;return A.a.createElement("div",{className:"editor-panel"},r&&A.a.createElement(P.a,{centered:!0}),A.a.createElement("div",{className:"settings-right cutout-settings-right"},A.a.createElement("div",{className:"settings-scrolling-content"},A.a.createElement("div",{className:"settings-header"},A.a.createElement("div",{className:"title"},Object(V.b)("CutoutView.Title.RemoveBackground","Remove background")),A.a.createElement("div",{className:"reset-button"},A.a.createElement(h.a,{quiet:!0,variant:"action",onClick:function(){t.reset()},icon:A.a.createElement(y.a,null),disabled:!t.isDirty()},Object(V.b)("CutoutView.Button.Reset","Reset")))),A.a.createElement("div",{className:"editor-button-bar"},n.hasMask?A.a.createElement("div",null,A.a.createElement(v.a,{label:Object(V.b)("CutoutView.Settings.Label.BGBlur","Blur background"),className:"sectionless-fieldlabel",labelFor:"__"},A.a.createElement(g.Grid,{style:{marginTop:"15px"}},A.a.createElement(g.GridRow,{align:"left",valign:"top",distribution:"between",className:"grid-row"},this.renderBlurPresetRow([0,50,100]))),A.a.createElement("section",{style:{marginBottom:"0.5rem"}},A.a.createElement(D.a,{renderLabel:!0,label:Object(V.b)("AdjustView.Controls.Slider.Amount","Amount"),filled:!0,fillOffset:0,min:0,max:100,value:n.blurRadius||0,onChange:function(t){e.applyBackgroundBlur(t,!1)},onChangeEnd:function(t){return e.applyBackgroundBlur(t,!0)},className:i?"blur-slider":"blur-slider hidden"}))),A.a.createElement(v.a,{label:Object(V.b)("CutoutView.Settings.Label.BGColor","Replace background"),className:"sectionless-fieldlabel",labelFor:"__"},A.a.createElement(g.Grid,{style:{marginTop:"15px"}},this.renderGridColorRows()))):A.a.createElement("section",null,A.a.createElement(h.a,{variant:"action",onClick:function(){e.applyBackgroundColor("transparent")},icon:A.a.createElement(M.a,{icon:A.a.createElement(R.a,null),size:"S"})},Object(V.b)("CutoutView.Settings.Button.RemoveBackground","Remove background"))))),A.a.createElement("div",{className:"action-button-container"},A.a.createElement(h.a,{onClick:function(){Object(N.a)("cutoutCancel"),t.cancel()}},Object(V.b)("CutoutView.Button.Cancel.RemoveBackground","Cancel")),A.a.createElement(h.a,{quiet:!0,variant:"cta",onClick:function(){Object(N.a)("cutout"),t.apply()},disabled:!s},Object(V.b)("CutoutView.Button.Apply.RemoveBackground","Apply")))))}}]),r}(T.PureComponent))}).call(this,a(79))},228:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("g",{id:"Group_151830","data-name":"Group 151830"},r.a.createElement("g",{id:"Group_151828","data-name":"Group 151828"},r.a.createElement("path",{id:"Path_60995","data-name":"Path 60995",d:"M5.629,13.482a.241.241,0,0,1-.324-.1L4.723,12.3c.088-.047.177-.093.266-.138-.037-.091-.073-.183-.107-.276l1.151-.427a.242.242,0,0,1,.309.14c.083.207.174.41.27.607l.229.468a.244.244,0,0,1-.127.333l-.482.2C6.03,13.29,5.828,13.382,5.629,13.482Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),r.a.createElement("path",{id:"Path_60996","data-name":"Path 60996",d:"M4.594,9.748a.248.248,0,0,1-.281-.212c-.028-.238-.049-.477-.06-.713v-.14c0-.294.012-.578.037-.856a.244.244,0,0,1,.272-.218l.974.113a.241.241,0,0,1,.212.262c-.02.225-.029.453-.029.682v.1c.008.18.025.372.047.565A.244.244,0,0,1,5.56,9.6ZM17.41,9.724l-.967-.138a.244.244,0,0,1-.206-.271c.022-.189.038-.378.047-.564v-.1c0-.225-.01-.458-.03-.688a.241.241,0,0,1,.212-.263l.971-.113a.246.246,0,0,1,.275.22c.025.283.038.571.038.862v.137c-.012.241-.032.475-.059.706a.247.247,0,0,1-.281.212ZM5.99,5.9l-.908-.366A.247.247,0,0,1,4.947,5.2a7.151,7.151,0,0,1,.888-1.5.247.247,0,0,1,.352-.034l.751.628a.24.24,0,0,1,.033.333A5.694,5.694,0,0,0,6.3,5.767a.242.242,0,0,1-.31.133Zm9.71-.154a5.582,5.582,0,0,0-.664-1.113.24.24,0,0,1,.029-.33l.928-.817.018.02a7.07,7.07,0,0,1,1.04,1.674.248.248,0,0,1-.134.327l-.908.368a.242.242,0,0,1-.309-.129ZM8.34,3.117l-.487-.846a.249.249,0,0,1,.1-.342,6.374,6.374,0,0,1,1.666-.593.248.248,0,0,1,.291.2l.161.963a.244.244,0,0,1-.193.278,4.906,4.906,0,0,0-1.208.429A.244.244,0,0,1,8.34,3.117Zm4.981.085a4.941,4.941,0,0,0-1.212-.425.244.244,0,0,1-.194-.277l.158-.964a.248.248,0,0,1,.291-.2,6.415,6.415,0,0,1,1.667.586.247.247,0,0,1,.1.341l-.482.849a.244.244,0,0,1-.328.088Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),r.a.createElement("path",{id:"Path_60997","data-name":"Path 60997",d:"M16.7,13.38a.242.242,0,0,1-.324.1q-.3-.15-.6-.275l-.482-.2a.244.244,0,0,1-.127-.333L15.4,12.2c.1-.2.187-.4.27-.607a.242.242,0,0,1,.309-.14l1.151.426c-.034.093-.07.186-.107.278.089.044.178.09.266.137Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),r.a.createElement("path",{id:"Path_60998","data-name":"Path 60998",d:"M.3,19.673a3.687,3.687,0,0,1-.05-.583c0-.068,0-.136.006-.2l.007-.1a8.313,8.313,0,0,1,.2-1.2.246.246,0,0,1,.306-.176l.941.262a.241.241,0,0,1,.169.292,6.9,6.9,0,0,0-.154.945v.177a2.149,2.149,0,0,0,.028.348Zm21.412-.04-1.449-.219a2.178,2.178,0,0,0,.024-.324c0-.039,0-.079,0-.119l-.006-.075a6.785,6.785,0,0,0-.16-.961.241.241,0,0,1,.169-.292l.94-.265a.247.247,0,0,1,.307.175,8.409,8.409,0,0,1,.2,1.221l.008.1c0,.081.006.147.006.212a3.666,3.666,0,0,1-.047.547ZM2.476,15.946l-.827-.524a.248.248,0,0,1-.074-.345A8.212,8.212,0,0,1,2.7,13.755a.247.247,0,0,1,.352.017l.654.728a.242.242,0,0,1-.016.337A6.762,6.762,0,0,0,2.8,15.876a.24.24,0,0,1-.327.07Zm16.7-.1a6.763,6.763,0,0,0-.891-1.035.242.242,0,0,1-.018-.338l.651-.731a.248.248,0,0,1,.352-.017,8.218,8.218,0,0,1,1.133,1.318.248.248,0,0,1-.074.345l-.824.527a.241.241,0,0,1-.329-.069Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"})),r.a.createElement("g",{id:"Group_151829","data-name":"Group 151829"},r.a.createElement("path",{id:"Path_60999","data-name":"Path 60999",d:"M5.629,13.482a.241.241,0,0,1-.324-.1L4.723,12.3c.088-.047.177-.093.266-.138-.037-.091-.073-.183-.107-.276l1.151-.427a.242.242,0,0,1,.309.14c.083.207.174.41.27.607l.229.468a.244.244,0,0,1-.127.333l-.482.2C6.03,13.29,5.828,13.382,5.629,13.482Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),r.a.createElement("path",{id:"Path_61000","data-name":"Path 61000",d:"M4.594,9.748a.248.248,0,0,1-.281-.212c-.028-.238-.049-.477-.06-.713v-.14c0-.294.012-.578.037-.856a.244.244,0,0,1,.272-.218l.974.113a.241.241,0,0,1,.212.262c-.02.225-.029.453-.029.682v.1c.008.18.025.372.047.565A.244.244,0,0,1,5.56,9.6ZM17.41,9.724l-.967-.138a.244.244,0,0,1-.206-.271c.022-.189.038-.378.047-.564v-.1c0-.225-.01-.458-.03-.688a.241.241,0,0,1,.212-.263l.971-.113a.246.246,0,0,1,.275.22c.025.283.038.571.038.862v.137c-.012.241-.032.475-.059.706a.247.247,0,0,1-.281.212ZM5.99,5.9l-.908-.366A.247.247,0,0,1,4.947,5.2a7.151,7.151,0,0,1,.888-1.5.247.247,0,0,1,.352-.034l.751.628a.24.24,0,0,1,.033.333A5.694,5.694,0,0,0,6.3,5.767a.242.242,0,0,1-.31.133Zm9.71-.154a5.582,5.582,0,0,0-.664-1.113.24.24,0,0,1,.029-.33l.928-.817.018.02a7.07,7.07,0,0,1,1.04,1.674.248.248,0,0,1-.134.327l-.908.368a.242.242,0,0,1-.309-.129ZM8.34,3.117l-.487-.846a.249.249,0,0,1,.1-.342,6.374,6.374,0,0,1,1.666-.593.248.248,0,0,1,.291.2l.161.963a.244.244,0,0,1-.193.278,4.906,4.906,0,0,0-1.208.429A.244.244,0,0,1,8.34,3.117Zm4.981.085a4.941,4.941,0,0,0-1.212-.425.244.244,0,0,1-.194-.277l.158-.964a.248.248,0,0,1,.291-.2,6.415,6.415,0,0,1,1.667.586.247.247,0,0,1,.1.341l-.482.849a.244.244,0,0,1-.328.088Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),r.a.createElement("path",{id:"Path_61001","data-name":"Path 61001",d:"M16.7,13.38a.242.242,0,0,1-.324.1q-.3-.15-.6-.275l-.482-.2a.244.244,0,0,1-.127-.333L15.4,12.2c.1-.2.187-.4.27-.607a.242.242,0,0,1,.309-.14l1.151.426c-.034.093-.07.186-.107.278.089.044.178.09.266.137Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),r.a.createElement("path",{id:"Path_61002","data-name":"Path 61002",d:"M.3,19.673a3.687,3.687,0,0,1-.05-.583c0-.068,0-.136.006-.2l.007-.1a8.313,8.313,0,0,1,.2-1.2.246.246,0,0,1,.306-.176l.941.262a.241.241,0,0,1,.169.292,6.9,6.9,0,0,0-.154.945v.177a2.149,2.149,0,0,0,.028.348Zm21.412-.04-1.449-.219a2.178,2.178,0,0,0,.024-.324c0-.039,0-.079,0-.119l-.006-.075a6.785,6.785,0,0,0-.16-.961.241.241,0,0,1,.169-.292l.94-.265a.247.247,0,0,1,.307.175,8.409,8.409,0,0,1,.2,1.221l.008.1c0,.081.006.147.006.212a3.666,3.666,0,0,1-.047.547ZM2.476,15.946l-.827-.524a.248.248,0,0,1-.074-.345A8.212,8.212,0,0,1,2.7,13.755a.247.247,0,0,1,.352.017l.654.728a.242.242,0,0,1-.016.337A6.762,6.762,0,0,0,2.8,15.876a.24.24,0,0,1-.327.07Zm16.7-.1a6.763,6.763,0,0,0-.891-1.035.242.242,0,0,1-.018-.338l.651-.731a.248.248,0,0,1,.352-.017,8.218,8.218,0,0,1,1.133,1.318.248.248,0,0,1-.074.345l-.824.527a.241.241,0,0,1-.329-.069Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}))),l=r.a.createElement("path",{id:"Path_61003","data-name":"Path 61003",d:"M18.264,19.777a.49.49,0,0,0,.353-.151.483.483,0,0,0,.132-.361c-.321-3.489-3.9-4.679-4.993-4.774-.8-.07-.813-.713-.813-1.516a7.31,7.31,0,0,0,1.716-4.352c0-2.636-1.5-4.393-3.658-4.393S7.342,5.987,7.342,8.623a7.3,7.3,0,0,0,1.716,4.352c0,.8-.013,1.446-.814,1.516-1.094.1-4.671,1.285-4.993,4.774a.486.486,0,0,0,.484.512Z",transform:"translate(-0.25 -1.332)",fill:"#6e6e6e"}),c=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({id:"mockups_exploration","data-name":"mockups / exploration",width:21,height:18,viewBox:"0 0 21 18",ref:t},n),a?r.a.createElement("title",null,a):null,s,l)},u=r.a.forwardRef((function(e,t){return r.a.createElement(c,i({svgRef:t},e))}));a.p},229:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(3),r=a(4),i=a(38),o=a(6),s=a(7),l=a(0),c=a.n(l),u=a(72),d=a.n(u),h=a(230),f=a.n(h),p=a(231),m=a.n(p),v=(a(593),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var r;Object(n.a)(this,a),r=t.call(this,e);var o=d()(e.startColorCode||"ff0000").toHsv();return r.state={hexColorHue:e.startColorCode||"ff0000",hexColor:e.startColorCode||"ff0000",h:o.h,s:100*o.s,v:100*o.v},r.handleHueChange=r.handleHueChange.bind(Object(i.a)(r)),r.handleHSVChange=r.handleHSVChange.bind(Object(i.a)(r)),r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"refresh",value:function(){}},{key:"handleHueChange",value:function(e,t){var a=this.state,n=a.s,r=a.v,i=d.a.fromRatio({h:t/360,s:n/100,v:r/100,a:1}).toHex();this.setState({hexColorHue:e,h:t,hexColor:i}),this.props.onColorChange(i)}},{key:"handleHSVChange",value:function(e,t){var a=this.state.h,n=d.a.fromRatio({h:a/360,s:e/100,v:t/100}).toHex();this.setState({s:e,v:t,hexColor:n}),this.props.onColorChange(n)}},{key:"render",value:function(){var e=this,t=this.state,a=t.hexColorHue,n=t.hexColor,r=t.h,i=t.s,o=t.v;return c.a.createElement("div",{className:"cp-container"},c.a.createElement("span",{className:"cp-area"},c.a.createElement(f.a,{hsvHue:r,hsvSaturation:i,hsvValue:o,onChange:function(t,a){e.handleHSVChange(t,a)}})),c.a.createElement(m.a,{orientation:"vertical",colorValue:a,variant:"h",onChange:function(t,a){e.handleHueChange(t,a)}}),this.props.debug&&c.a.createElement("div",null,"Hex ColorCode Hue: ",a,c.a.createElement("br",null),"HSV Hue Value: ",r,c.a.createElement("br",null),"HSV Saturation Value: ",i,c.a.createElement("br",null),"HSV Lightning / V Value: ",o,c.a.createElement("br",null),c.a.createElement("br",null),"Final Hex ColorCode: ",n))}}]),a}(l.PureComponent))},230:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,i,o=a(100),s=w(a(22)),l=w(a(42)),c=w(a(46)),u=a(70),d=w(a(19)),h=w(a(0)),f=a(72);function p(e){return(p="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function v(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function w(e){return e&&e.__esModule?e:{default:e}}var x={"cs-CZ":w(a(118)).default,"da-DK":w(a(119)).default,"de-DE":w(a(120)).default,"en-US":w(a(121)).default,"es-ES":w(a(122)).default,"fi-FI":w(a(123)).default,"fr-FR":w(a(124)).default,"hu-HU":w(a(125)).default,"it-IT":w(a(126)).default,"ja-JP":w(a(127)).default,"ko-KR":w(a(128)).default,"nb-NO":w(a(129)).default,"nl-NL":w(a(130)).default,"pl-PL":w(a(131)).default,"pt-BR":w(a(132)).default,"ru-RU":w(a(133)).default,"sv-SE":w(a(134)).default,"tr-TR":w(a(135)).default,"uk-UA":w(a(136)).default,"zh-CN":w(a(137)).default,"zh-TW":w(a(138)).default};a(189),a(588),a(190),a(589),a(191);(0,u.messageFormatter)(x);var k=(0,l.default)((i=r=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=g(t).call(this,e),a=!r||"object"!==p(r)&&"function"!==typeof r?b(n):r,E(b(a),"state",{startValueS:null,startValueV:null,draggingHandle:null,focusedHandle:null,channelMin:0,channelMax:100,channelStepSize:1}),E(b(a),"onPointerDown",(function(e,t){t?e.stopPropagation():t="startHandleS";var n=a.keyControlInput;n&&n.focus(),e.persist(),a.setState({sliderHandle:null,isMouseUp:!1,draggingHandle:t},(function(){return a.onPointerMove(e)})),window.addEventListener("pointerup",a.onPointerUp),window.addEventListener("pointermove",a.onPointerMove),document.body.classList.add(a.isDraggedBodyClassName)})),E(b(a),"onPointerUp",(function(e){var t=a.state.draggingHandle,n=t&&a[t+"Input"];n&&n.blur(),n=a.keyControlInput,a.setState({isMouseUp:!0,draggingHandle:null},(function(){n&&n.focus()})),a.props.onChangeEnd&&a.props.onChangeEnd(a.state.startValueS,a.state.startValueV),window.removeEventListener("pointerup",a.onPointerUp),window.removeEventListener("pointermove",a.onPointerMove),document.body.classList.remove(a.isDraggedBodyClassName)})),E(b(a),"calculateHandlePosition",(function(e,t){var n=a.props,r=a.state.channelMin,i=a.state.channelMax,s=n.step,l=a.dom.getBoundingClientRect(),c=t?l.top:l.left,u=((t?e.clientY:e.clientX)-c)/(t?l.height:l.width);u=(0,o.clamp)(u,0,1),t&&(u=1-u);var d=r+(i-r)*u;return t&&(d=i-d),s&&(d=Math.round(d/s)*s),d})),E(b(a),"onPointerMove",(function(e){e.preventDefault();var t=a.calculateHandlePosition(e,!1),n=a.calculateHandlePosition(e,!0);a.updateValues(t,n,"startHandle")})),E(b(a),"updateValues",(function(e,t){var n=a.props,r=a.state.channelMin,i=a.state.channelMax,s=a.state.channelStepSize,l=n.onChange;if(null!=e&&(e=(0,o.snapValueToStep)(e,r,i,s)),null!=t&&(t=i-(0,o.snapValueToStep)(t,r,i,s)),l&&(e!==a.state.startValueS||t!==a.state.startValueV)){var c=null!=e&&e!==a.state.startValueS?e:a.state.startValueS,u=null!=t&&t!==a.state.startValueV?t:a.state.startValueV;l(c,u)}})),E(b(a),"onChange",(function(e,t){var n=a.props,r=(n.step,n.variant,a.state),i=r.startValueS,o=r.startValueV,s="startHandle"===t,l=+e.target.value;s&&l!==i?a.updateValues(l,null,t):s||l===o||a.updateValues(null,l,t)})),E(b(a),"onKeyDown",(function(e,t){a.props;var n,r,i=a.state.channelMin,s=a.state.channelMax,l=a.state.channelStepSize;switch(e.keyCode){case 37:if(e.preventDefault(),a.state.startValueS==i)return;n=(0,o.snapValueToStep)(this.state.startValueS-l,i,s,l),a.updateValues(n);break;case 39:if(e.preventDefault(),a.state.startValueS==s)return;n=(0,o.snapValueToStep)(this.state.startValueS+l,i,s,l),a.updateValues(n);break;case 38:case 36:case 33:if(e.preventDefault(),a.state.startValueV==s)return;r=s-(0,o.snapValueToStep)(this.state.startValueV+l,i,s,l),a.updateValues(null,r,null);break;case 40:case 34:case 35:if(e.preventDefault(),a.state.startValueV==i)return;r=s-(0,o.snapValueToStep)(this.state.startValueV-l,i,s,l),a.updateValues(null,r,null)}})),E(b(a),"onFocus",(function(e,t){a.setState({focusedHandle:a.state.isMouseUp?null:"keyControl",topHandle:t,isMouseUp:!1})})),E(b(a),"onBlur",(function(e,t){a.setState({focusedHandle:null})})),E(b(a),"getAriaLabelledby",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=a.props,n=t.label,r=t["aria-labelledby"],i=t["aria-label"],o=[];return r&&o.push(r),(n||i)&&o.push(a.getLabelId()),e&&o.push(a.getSliderHandleInputId(e)),o.join(" ")})),E(b(a),"renderSliderHandle",(function(){var e=a.props,t=e.disabled,n=(e.variant,e["aria-label"]),r=e["aria-describedby"],i=e.getAriaValueText,o=(e.hsvSaturation,a.state),l=o.draggingHandle,c=(o.focusedHandle,o.topHandle),u=o.startValueS,d=o.startValueV,f=o.channelMin,p=o.channelMax,m=o.channelStepSize,v=(u-f)/(p-f),g=1-(d-f)/(p-f),b="startHandleS"===l,y="startHandleS"===l,E="startHandleS"===c;return h.default.createElement("div",{id:"handle",className:(0,s.default)("spectrum-ColorHandle spectrum-ColorArea-handle",{"is-dragged":b,"is-focused":y,"is-tophandle":E}),style:{left:100*v+"%",top:100*g+"%"},"touch-action":"none",role:"button"},h.default.createElement("div",{id:"custom-colorHandle",className:"spectrum-ColorHandle-color",style:{backgroundColor:this.getBackgroundColor(u,d)}},h.default.createElement("input",{id:a.getSliderHandleInputId("startHandleS"),ref:function(e){return a.startHandleSInput=e},type:"range",className:"spectrum-Slider-input",step:m,max:p,min:f,disabled:t,"aria-label":n||null,"aria-labelledby":a.getAriaLabelledby(null),"aria-describedby":r,"aria-valuemin":null,"aria-valuemax":null,"aria-valuetext":i(u),defaultValue:void 0,value:u,onChange:t?null:function(e){return a.onChange(e,"startHandleS")},onFocus:t?null:function(e){return a.onFocus(e,"startHandleS")},onBlur:t?null:function(e){return a.onBlur(e,"startHandleS")}}),h.default.createElement("input",{id:a.getSliderHandleInputId("valueVHandle"),ref:function(e){return a.startHandleVInput=e},type:"range",className:"spectrum-Slider-input",step:m,max:p,min:f,disabled:t,"aria-label":n||null,"aria-labelledby":a.getAriaLabelledby(null),"aria-describedby":r,"aria-valuemin":null,"aria-valuemax":null,"aria-valuetext":i(d),defaultValue:void 0,value:d,onChange:t?null:function(e){return a.onChange(e,"startHandleV")},onFocus:t?null:function(e){return a.onFocus(e,"startHandleV")},onBlur:t?null:function(e){return a.onBlur(e,"startHandleV")}}),h.default.createElement("input",{id:"keyControl",ref:function(e){return a.keyControlInput=e},type:"text",className:"spectrum-Slider-input",disabled:t,onKeyDown:function(e){return a.onKeyDown(e)}})))})),E(b(a),"setDOMReference",(function(e){return a.dom=e})),a.sliderId=(0,c.default)(),a}var a,n,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,e),a=t,(n=[{key:"UNSAFE_componentWillMount",value:function(){this.UNSAFE_componentWillReceiveProps(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t,a;null!==e.hsvSaturation&&(t=Math.min(e.hsvSaturation,this.state.channelMax)),null!==e.hsvValue&&(a=Math.min(e.hsvValue,this.state.channelMax)),null!=t&&this.setState({startValueS:t}),null!=a&&this.setState({startValueV:a}),this.isDraggedBodyClassName="u-isGrabbing"}},{key:"getLabelId",value:function(){return this.sliderId+"-label"}},{key:"getBackgroundGradient",value:function(){return"\n           linear-gradient(to top, black 0%, rgba(0, 0, 0, 0) 100%),\n           linear-gradient(to right, white 0%, rgba(0, 0, 0, 0) 100%),\n           hsl(".concat(this.props.hsvHue,",100%,50%)\n        ")}},{key:"getBackgroundColor",value:function(e,t){return f.fromRatio({h:this.props.hsvHue/360,s:e/100,v:t/100}).toHexString()}},{key:"getSliderHandleInputId",value:function(e){var t=this.props.id,a=void 0===t?this.sliderId:t;return"sliderHandleS"===e?a:a+"-"+e+"Input"}},{key:"render",value:function(){var e=this,t=this.props,a=t.children,n=t.disabled,r=t.id,i=(void 0===r&&this.sliderId,t.label,t.renderLabel,t.variant,t["aria-label"],t.getAriaValueText),o=(m(t,["children","disabled","id","label","renderLabel","variant","aria-label","getAriaValueText","hsvHue","hsvSaturation","hsvValue"]),this.state.startValueS),l=(0,s.default)("spectrum-ColorArea",this.props.className,{"is-disabled":n}),c=this.getAriaLabelledby();return i(f({h:o,s:1,v:1,a:1}).toHexString()),h.default.createElement("div",{className:l,ref:this.setDOMReference,role:"presentation","aria-labelledby":c,onPointerDown:n?null:function(t){return e.onPointerDown(t)}},h.default.createElement("div",{className:"spectrum-ColorArea-gradient",role:"presentation",style:{background:this.getBackgroundGradient()}},a,this.renderSliderHandle()))}}])&&v(a.prototype,n),r&&v(a,r),t}(h.default.Component),E(r,"propTypes",{disabled:d.default.bool,renderLabel:d.default.bool,label:d.default.node,variant:d.default.oneOf([null,"h","r","g","b","a"]),size:d.default.oneOf([null,"S","L"]),hsvHue:d.default.number,hsvSaturation:d.default.number,hsvValue:d.default.number,onChange:d.default.func,getAriaValueText:d.default.func}),E(r,"defaultProps",{disabled:!1,renderLabel:!1,label:null,variant:null,size:null,hsvHue:0,hsvSaturation:100,hsvValue:100,onChange:function(){},getAriaValueText:function(e){return e}}),n=i))||n;t.default=k},231:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,i,o=a(100),s=w(a(22)),l=w(a(42)),c=w(a(46)),u=a(70),d=w(a(19)),h=w(a(0)),f=a(72);function p(e){return(p="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function v(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function w(e){return e&&e.__esModule?e:{default:e}}var x={"cs-CZ":w(a(118)).default,"da-DK":w(a(119)).default,"de-DE":w(a(120)).default,"en-US":w(a(121)).default,"es-ES":w(a(122)).default,"fi-FI":w(a(123)).default,"fr-FR":w(a(124)).default,"hu-HU":w(a(125)).default,"it-IT":w(a(126)).default,"ja-JP":w(a(127)).default,"ko-KR":w(a(128)).default,"nb-NO":w(a(129)).default,"nl-NL":w(a(130)).default,"pl-PL":w(a(131)).default,"pt-BR":w(a(132)).default,"ru-RU":w(a(133)).default,"sv-SE":w(a(134)).default,"tr-TR":w(a(135)).default,"uk-UA":w(a(136)).default,"zh-CN":w(a(137)).default,"zh-TW":w(a(138)).default};a(189),a(590),a(190),a(591),a(191),a(592);var k=(0,u.messageFormatter)(x),S={FILL:{horizontal:"width",vertical:"height"},OFFSET:{horizontal:"left",vertical:"top"},OPPOSITE_OFFSET:{horizontal:"right",vertical:"top"}},O=(0,l.default)((i=r=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=g(t).call(this,e),a=!r||"object"!==p(r)&&"function"!==typeof r?b(n):r,E(b(a),"state",{startValue:null,draggingHandle:null,focusedHandle:null,channelMode:"h",channelMin:0,channelMax:359,channelName:"hue",channelStepSize:1,channelUnit:null}),E(b(a),"onPointerDown",(function(e,t){t?e.stopPropagation():t="startHandle";var n=a[t+"Input"];n&&n.focus(),e.persist(),a.setState({sliderHandle:null,isMouseUp:!1,draggingHandle:t},(function(){return a.onPointerMove(e)})),window.addEventListener("pointerup",a.onPointerUp),window.addEventListener("pointermove",a.onPointerMove),document.body.classList.add(a.isDraggedBodyClassName)})),E(b(a),"onPointerUp",(function(e){var t=a.state.draggingHandle,n=t&&a[t+"Input"];if(n&&n.blur(),a.setState({isMouseUp:!0,draggingHandle:null},(function(){n&&n.focus()})),a.props.onChangeEnd){a.getExportValue(a.state.startValue);a.props.onChangeEnd(expo,"a"==a.state.channelMode?1-startValue:startValue)}window.removeEventListener("pointerup",a.onPointerUp),window.removeEventListener("pointermove",a.onPointerMove),document.body.classList.remove(a.isDraggedBodyClassName)})),E(b(a),"calculateHandlePosition",(function(e){var t=a.props,n=a.state.channelMin,r=a.state.channelMax,i=t.orientation,s=t.step,l="vertical"===i,c=a.dom.getBoundingClientRect(),u=l?c.top:c.left,d=((l?e.clientY:e.clientX)-u)/(l?c.height:c.width);d=(0,o.clamp)(d,0,1),l&&(d=1-d);var h=n+(r-n)*d;return l&&(h=r-h),s&&(h=Math.round(h/s)*s),h})),E(b(a),"onPointerMove",(function(e){e.preventDefault();var t=a.calculateHandlePosition(e);a.updateValues(t,null,"startHandle")})),E(b(a),"updateValues",(function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=a.props,r=a.state.channelMin,i=a.state.channelMax,s=a.state.channelStepSize,l=n.onChange;if(e=(0,o.snapValueToStep)(e,r,i,s),l&&e!==a.state.startValue){var c=a.getExportValue(e);l(c,"a"==a.state.channelMode?1-e:e)}null==a.props.value&&a.setState({startValue:"a"==a.state.channelMode?1-e:e,focusedHandle:a.state.isMouseUp?null:t})})),E(b(a),"onKeyDown",(function(e,t){a.props;var n,r,i=a.state.channelMin,s=a.state.channelMax,l=a.state.channelStepSize,c="vertical"==a.props.orientation,u="a"==a.state.channelMode;switch(e.keyCode){case 37:if(c)return;if(e.preventDefault(),a.state.startValue==i)return;n=u?(0,o.snapValueToStep)(s-this.state.startValue-l,i,s,l):(0,o.snapValueToStep)(this.state.startValue-l,i,s,l),a.updateValues(n);break;case 39:if(c)return;if(e.preventDefault(),a.state.startValue==s)return;n=u?(0,o.snapValueToStep)(s-this.state.startValue+l,i,s,l):(0,o.snapValueToStep)(this.state.startValue+l,i,s,l),a.updateValues(n);break;case 38:case 36:case 33:if(!c)return;if(e.preventDefault(),a.state.startValue==s)return;r=u?(0,o.snapValueToStep)(s-this.state.startValue-l,i,s,l):(0,o.snapValueToStep)(this.state.startValue-l,i,s,l),a.updateValues(r);break;case 40:case 34:case 35:if(!c)return;if(e.preventDefault(),a.state.startValue==i)return;r=u?(0,o.snapValueToStep)(s-this.state.startValue+l,i,s,l):(0,o.snapValueToStep)(this.state.startValue+l,i,s,l),a.updateValues(r)}})),E(b(a),"onFocus",(function(e,t){a.setState({focusedHandle:a.state.isMouseUp?null:t,topHandle:t,isMouseUp:!1})})),E(b(a),"onBlur",(function(e,t){a.setState({focusedHandle:null})})),E(b(a),"onClickSliderValue",(function(e){window.getSelection();a.startHandleInput.focus()})),E(b(a),"getAriaLabelledby",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=a.props,n=t.label,r=t["aria-labelledby"],i=t["aria-label"],o=[];return r&&o.push(r),(n||i)&&o.push(a.getLabelId()),e&&o.push(a.getSliderHandleInputId(e)),o.join(" ")})),E(b(a),"renderSliderHandle",(function(e){var t=a.props,n=t.disabled,r=t.orientation,i=(t.variant,t["aria-label"]),o=t["aria-describedby"],l=t.getAriaValueText,c=t.colorValue,u=a.state,d=u.draggingHandle,p=(u.focusedHandle,u.topHandle),m=u.startValue,v=u.channelMin,g=u.channelMax,b=u.channelStepSize,y="startHandle"===e,w=m,x=(w-v)/(g-v);if(c)switch(a.state.channelMode){case"h":w=Math.min(f(c).toHsv().h,g);break;case"a":w=Math.min(1-f(c).getAlpha(),g),x=1-x;break;case"r":w=Math.min(f(c).toRgb().r,g);break;case"g":w=Math.min(f(c).toRgb().g,g);break;case"b":w=Math.min(f(c).toRgb().b,g)}var O="vertical"===r,C=d===e,P=d===e,T=p===e,A=S.OFFSET[r];k(y?"minimum":"maximum");return h.default.createElement("div",{className:(0,s.default)("spectrum-ColorHandle spectrum-ColorSlider-handle",{"is-dragged":C,"is-focused":P,"is-tophandle":T}),style:E({},A,100*x+"%"),"touch-action":"none",role:"presentation"},h.default.createElement("div",{id:"custom-colorHandle",className:"spectrum-ColorHandle-color",style:{backgroundColor:a.getBackgroundColor(),opacity:"a"==a.state.channelMode?f(c).getAlpha():1}},h.default.createElement("input",{id:a.getSliderHandleInputId(e),ref:function(t){return a[e+"Input"]=t},type:"range",className:"spectrum-Slider-input",step:b,max:g,min:v,disabled:n,"aria-orientation":O?r:null,"aria-label":i||null,"aria-labelledby":a.getAriaLabelledby(null),"aria-describedby":o,"aria-valuemin":null,"aria-valuemax":null,"aria-valuetext":l(w),defaultValue:void 0,value:w,onChange:n?null:function(e){},onKeyDown:n?null:function(e){return a.onKeyDown(e)},onFocus:n?null:function(t){return a.onFocus(t,e)},onBlur:n?null:function(t){return a.onBlur(t,e)}})))})),E(b(a),"setDOMReference",(function(e){return a.dom=e})),a.sliderId=(0,c.default)(),a}var a,n,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,e),a=t,(n=[{key:"UNSAFE_componentWillMount",value:function(){this.UNSAFE_componentWillReceiveProps(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=null==e.variant?"h":e.variant,a=359,n=1;"r"==t||"g"==t||"b"==t?a=255:"a"==t&&(n=.01,a=1),this.setState({channelMode:t,channelMax:a,channelStepSize:n});var r=e.value;if(null==r&&null!==e.colorValue)switch(t){case"h":r=Math.min(f(e.colorValue).toHsv().h,a);break;case"a":r=Math.min(f(e.colorValue).getAlpha(),a);break;case"r":r=Math.min(f("props.colorValue").toRgb().r,a);break;case"g":r=Math.min(f(e.colorValue).toRgb().g,a);break;case"b":r=Math.min(f(e.colorValue).toRgb().b,a)}null!=r&&this.setState({startValue:r}),this.isDraggedBodyClassName="u-isGrabbing"}},{key:"getLabelId",value:function(){return this.sliderId+"-label"}},{key:"getBackgroundGradient",value:function(e){var t,a,n="vertical"===e?"bottom":"right",r=f(this.props.colorValue?this.props.colorValue:"00000000");switch(this.state.channelMode){case"a":t=r.clone().setAlpha(1),a=r.clone().setAlpha(0);break;case"r":t=f({r:0,g:r.toRgb().g,b:r.toRgb().b}),a=f({r:255,g:r.toRgb().g,b:r.toRgb().b});break;case"g":t=f({r:r.toRgb().r,g:0,b:r.toRgb().b}),a=f({r:r.toRgb().r,g:255,b:r.toRgb().b});break;case"b":t=f({r:r.toRgb().r,g:r.toRgb().g,b:0}),a=f({r:r.toRgb().r,g:r.toRgb().g,b:255})}switch(this.state.channelMode){case"h":return"linear-gradient(to ".concat(n,", rgb(255, 0, 0) 0%, rgb(255, 255, 0) 17%, rgb(0, 255, 0) 33%, rgb(0, 255, 255) 50%, rgb(0, 0, 255) 67%, rgb(255, 0, 255) 83%, rgb(255, 0, 0) 100%)");default:return"linear-gradient(to ".concat(n,", ").concat(t.toRgbString()," 0%, ").concat(a.toRgbString()," 100%)")}}},{key:"getBackgroundColor",value:function(){var e=f(this.props.colorValue?this.props.colorValue:"00000000");switch(this.state.channelMode){case"a":return e.setAlpha(this.state.startColor),e.toRgbString();case"r":return f({r:this.state.startColor,g:e.toRgb().g,b:e.toRgb().b}).toRgbString();case"g":return f({r:e.toRgb().r,g:this.state.startColor,b:e.toRgb().b}).toRgbString();case"b":return f({r:e.toRgb().r,g:e.toRgb().g,b:this.state.startColor}).toRgbString();default:return f({h:this.state.startValue,s:1,v:1,a:1}).toRgbString()}}},{key:"getExportValue",value:function(e){var t,a,n=f(this.props.colorValue);switch(this.state.channelMode){case"a":return n.setAlpha(1-e),n.toHex8();case"r":a=n.toRgb(),t=f({r:e,g:a.g,b:a.b,a:a.a});break;case"g":a=n.toRgb(),t=f({r:n.r,g:e,b:n.b,a:n.a});break;case"b":a=n.toRgb(),t=f({r:n.r,g:n.g,b:e,a:n.a});break;default:t=f({h:e,s:1,v:1,a:n.getAlpha()})}return this.props.useAlpha?t.toHex8():t.toHex()}},{key:"getSliderHandleInputId",value:function(e){var t=this.props.id,a=void 0===t?this.sliderId:t;return"startHandle"===e?a:a+"-"+e+"Input"}},{key:"render",value:function(){var e=this,t=this.props,a=t.children,n=t.disabled,r=t.id,i=void 0===r?this.sliderId:r,o=t.label,l=t.orientation,c=t.renderLabel,u=(t.variant,t["aria-label"]),d=t.getAriaValueText,p=(t.colorValue,m(t,["children","disabled","id","label","orientation","renderLabel","variant","aria-label","getAriaValueText","colorValue","useAlpha"])),v=this.state.startValue,g="vertical"===l,b=(0,s.default)("spectrum-ColorSlider",this.props.className,{"spectrum-ColorSlider--vertical":g,"is-disabled":n}),y=c&&o,E=this.getAriaLabelledby(),w=d(f({h:v,s:1,v:1,a:1}).toHexString());return h.default.createElement("div",{className:b,ref:this.setDOMReference,"aria-labelledby":E},(y||o&&E||u)&&h.default.createElement("div",{className:"spectrum-Slider-labelContainer"},h.default.createElement("label",{id:this.getLabelId(),className:"spectrum-Slider-label",htmlFor:i,hidden:!y||null,"aria-label":p["aria-labelledby"]?null:u},o),y&&h.default.createElement("div",{className:"spectrum-Slider-value",style:{outline:0},role:"textbox",tabIndex:-1,"aria-readonly":"true","aria-labelledby":E,onClick:n?null:function(t){return e.onClickSliderValue(t)}},w)),h.default.createElement("div",{className:"spectrum-ColorSlider-checkerboard",role:"presentation",onPointerDown:n?null:function(t){return e.onPointerDown(t)}},h.default.createElement("div",{className:"spectrum-Slider-custom-controls spectrum-ColorSlider-gradient",style:{background:this.getBackgroundGradient(l)}},a,this.renderSliderHandle("startHandle"))))}}])&&v(a.prototype,n),r&&v(a,r),t}(h.default.Component),E(r,"propTypes",{disabled:d.default.bool,orientation:d.default.oneOf(["horizontal","vertical"]),renderLabel:d.default.bool,label:d.default.node,variant:d.default.oneOf([null,"h","r","g","b","a"]),size:d.default.oneOf([null,"S","L"]),colorValue:d.default.node,useAlpha:d.default.bool,onChange:d.default.func,getAriaValueText:d.default.func}),E(r,"defaultProps",{disabled:!1,orientation:"horizontal",renderLabel:!1,label:null,variant:null,size:null,colorValue:"ff000000",useAlpha:!1,onChange:function(){},getAriaValueText:function(e){return e}}),n=i))||n;t.default=O},232:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return I}));var n=a(3),r=a(4),i=a(6),o=a(7),s=a(56),l=a(14),c=a.n(l),u=a(89),d=a(61),h=a.n(d),f=a(50),p=a.n(f),m=a(59),v=a.n(m),g=a(45),b=a.n(g),y=a(20),E=a(0),w=a.n(E),x=a(33),k=a(233),S=a(39),O=a.n(S),C=a(234),P=a(36),T=a(9),A=a(1),j=a(21),I=(a(601),function(t){Object(i.a)(l,t);var a=Object(o.a)(l);function l(e){var t;return Object(n.a)(this,l),(t=a.call(this,e)).state={params:e.controller.getParams(),processing:!1},t}return Object(r.a)(l,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"setParams",value:function(e){this.setState({params:e})}},{key:"refresh",value:function(){}},{key:"showProcessing",value:function(t){this.setState({processing:!0},(function(){e.nextTick(t)}))}},{key:"renderGroups",value:function(){var e=this,t=this.props.controller,a=this.state.params;return t.getEffectsGroups().map((function(t){var n;if(!t.isExperimental||Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_GOOGLE_CAPTCHA_URL:"https://www.google.com/recaptcha/api.js",REACT_APP_STORAGE_API_URL:"https://cc-api-storage-creativesdk.adobe.io",REACT_APP_PM_WASM_HASH:"a888ee0586ced614e2b443c111d9b1882cb0c3061b15b473ec822c76ad6f47c8",REACT_APP_IMS_ENV:"prod",REACT_APP_RUNNING_ENV:"production",REACT_APP_NAME:"frictionless-web",REACT_APP_PRIVACY_OTDOMAINID:"7a5eb705-95ed-4cc4-a11d-0cc5760e93db",REACT_APP_IMS_API_KEY:"ps-frictionless-web",REACT_APP_UTILITYNAV_CSS_URL:"https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.css",REACT_APP_CC_COMPARE_PLANS:"https://www.adobe.com/products/photoshop-lightroom/compare-plans.html",REACT_APP_UTILITYNAV_JS_URL:"https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.js",REACT_APP_USERTESTS:"agedashi:app:available_editors",REACT_APP_BUILD_SHA:"020e20bc1941",REACT_APP_IMAGE_API_KEY:"ps-frictionless-web",REACT_APP_TARGET_CLIENT:"adobeinternalmobiles",REACT_APP_IMS_LIB_URL:"https://static.adobelogin.com/imslib/imslib.min.js",REACT_APP_CROP_FLIP_AXIS_REFERENCE:"cropbox",REACT_APP_BUILD_TIME:"Wed Apr  7 14:34:54 UTC 2021",REACT_APP_IMS_API_URL:"https://ims-na1.adobelogin.com",REACT_APP_AVAILABLE_EDITORS:"resize,crop,spotheal,adjust,cutout,effects",REACT_APP_CC_LEARN_MORE:"https://www.adobe.com/creativecloud/photography.html",REACT_APP_GLOBAL_TESTING_PROPERTY_TOKEN:"2bb70f5a-cc1f-79c3-a659-66e4e32dc3fc",REACT_APP_GLOBAL_TESTING_MBOXES:"agedashi:app:downloads",REACT_APP_DUNAMIS_PROJECT:"",REACT_APP_IMAGE_API_URL:"https://image.adobe.io",REACT_APP_ANONYMOUS_USER_DOWNLOADS_EACH_MS:"31536000000",REACT_APP_ANONYMOUS_USER_DOWNLOADS:"1",REACT_APP_WHITELISTED_LANGUAGES:"cs,da,de,en,es,fi,fr,it,ja,ko,nb,nl,pl,pt,ru,sv,tr,zh_CN,zh_TW,zh_cn,zh_tw",REACT_APP_CROP_ROTATE_PIVOT:"cropcenter",REACT_APP_APERITIF_API_URL:"https://image.adobe.io/utils/aperitif",REACT_APP_FREE_USER_DOWNLOADS_EACH_MS:"86400000",REACT_APP_DUNAMIS_ENV:"prod",REACT_APP_GOOGLE_CAPTCHA_SITEKEY:"6Lch52caAAAAAMm2P5EFnvVbOzzX9oVXtUC0r1A-",REACT_APP_FREE_USER_DOWNLOADS:"1",REACT_APP_DUNAMIS_API_KEY:"",REACT_APP_PRIVACY_JS_URL:"https://www.adobe.com/etc/beagle/public/globalnav/adobe-privacy/latest/privacy.min.js",REACT_APP_CROP_ROTATE_WITH_CROPBOX:"true",REACT_APP_NEWRELIC_AGENT_FILE:"agedashi-prod",REACT_APP_VERSION:"0.1.0",REACT_APP_STORAGE_API_KEY:"FrictionlessPSWebApp1",REACT_APP_ADOBE_BASE_GOURL:"https://www.adobe.com/go/",REACT_APP_GLOBAL_TRACKING_ENV:"production",REACT_APP_CROP_RATIOCHANGE_REFERENCE:"cropbox",REACT_APP_DUNAMIS_API_URL:"https://cc-api-data.adobe.io"}).REACT_APP_SHOW_EXPERIMENTAL_FEATURES||(null===(n=j.a.getParams().effects)||void 0===n?void 0:n.showExperimental))return w.a.createElement(s.AccordionItem,{key:t.id,header:t.title},t.id===a.groupId&&e.renderEffects(t))}))}},{key:"renderEffects",value:function(e){var t=this.props.controller,a=this.state.params,n=[];return e.effectIds.forEach((function(a){var r,i=Object(y.find)(t.getEffects(),(function(e){return e.getId()===a}));i&&e.effectIds.includes(i.getId())&&(!i.isExperimental()||Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_GOOGLE_CAPTCHA_URL:"https://www.google.com/recaptcha/api.js",REACT_APP_STORAGE_API_URL:"https://cc-api-storage-creativesdk.adobe.io",REACT_APP_PM_WASM_HASH:"a888ee0586ced614e2b443c111d9b1882cb0c3061b15b473ec822c76ad6f47c8",REACT_APP_IMS_ENV:"prod",REACT_APP_RUNNING_ENV:"production",REACT_APP_NAME:"frictionless-web",REACT_APP_PRIVACY_OTDOMAINID:"7a5eb705-95ed-4cc4-a11d-0cc5760e93db",REACT_APP_IMS_API_KEY:"ps-frictionless-web",REACT_APP_UTILITYNAV_CSS_URL:"https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.css",REACT_APP_CC_COMPARE_PLANS:"https://www.adobe.com/products/photoshop-lightroom/compare-plans.html",REACT_APP_UTILITYNAV_JS_URL:"https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.js",REACT_APP_USERTESTS:"agedashi:app:available_editors",REACT_APP_BUILD_SHA:"020e20bc1941",REACT_APP_IMAGE_API_KEY:"ps-frictionless-web",REACT_APP_TARGET_CLIENT:"adobeinternalmobiles",REACT_APP_IMS_LIB_URL:"https://static.adobelogin.com/imslib/imslib.min.js",REACT_APP_CROP_FLIP_AXIS_REFERENCE:"cropbox",REACT_APP_BUILD_TIME:"Wed Apr  7 14:34:54 UTC 2021",REACT_APP_IMS_API_URL:"https://ims-na1.adobelogin.com",REACT_APP_AVAILABLE_EDITORS:"resize,crop,spotheal,adjust,cutout,effects",REACT_APP_CC_LEARN_MORE:"https://www.adobe.com/creativecloud/photography.html",REACT_APP_GLOBAL_TESTING_PROPERTY_TOKEN:"2bb70f5a-cc1f-79c3-a659-66e4e32dc3fc",REACT_APP_GLOBAL_TESTING_MBOXES:"agedashi:app:downloads",REACT_APP_DUNAMIS_PROJECT:"",REACT_APP_IMAGE_API_URL:"https://image.adobe.io",REACT_APP_ANONYMOUS_USER_DOWNLOADS_EACH_MS:"31536000000",REACT_APP_ANONYMOUS_USER_DOWNLOADS:"1",REACT_APP_WHITELISTED_LANGUAGES:"cs,da,de,en,es,fi,fr,it,ja,ko,nb,nl,pl,pt,ru,sv,tr,zh_CN,zh_TW,zh_cn,zh_tw",REACT_APP_CROP_ROTATE_PIVOT:"cropcenter",REACT_APP_APERITIF_API_URL:"https://image.adobe.io/utils/aperitif",REACT_APP_FREE_USER_DOWNLOADS_EACH_MS:"86400000",REACT_APP_DUNAMIS_ENV:"prod",REACT_APP_GOOGLE_CAPTCHA_SITEKEY:"6Lch52caAAAAAMm2P5EFnvVbOzzX9oVXtUC0r1A-",REACT_APP_FREE_USER_DOWNLOADS:"1",REACT_APP_DUNAMIS_API_KEY:"",REACT_APP_PRIVACY_JS_URL:"https://www.adobe.com/etc/beagle/public/globalnav/adobe-privacy/latest/privacy.min.js",REACT_APP_CROP_ROTATE_WITH_CROPBOX:"true",REACT_APP_NEWRELIC_AGENT_FILE:"agedashi-prod",REACT_APP_VERSION:"0.1.0",REACT_APP_STORAGE_API_KEY:"FrictionlessPSWebApp1",REACT_APP_ADOBE_BASE_GOURL:"https://www.adobe.com/go/",REACT_APP_GLOBAL_TRACKING_ENV:"production",REACT_APP_CROP_RATIOCHANGE_REFERENCE:"cropbox",REACT_APP_DUNAMIS_API_URL:"https://cc-api-data.adobe.io"}).REACT_APP_SHOW_EXPERIMENTAL_FEATURES||(null===(r=j.a.getParams().effects)||void 0===r?void 0:r.showExperimental))&&n.push(i)})),n.map((function(n){return w.a.createElement(u.Card,{key:n.getId(),id:"".concat(e.id,"-").concat(n.getId()),allowsSelection:!1,className:a.effectId===n.getId()?"image-card selected":"image-card"},w.a.createElement("div",{className:"spectrum-Card-coverPhoto",onClick:function(){n.hasLoginNeeded()&&!P.b.getInstance().isSignedInUser()||(t.setEffect(n),Object(T.a)("effects:".concat(Object(y.camelCase)(n.getTitle()))))},role:"presentation",style:{backgroundImage:"url(".concat(n.getPreview(),")"),cursor:"pointer",width:"265px"}}),n.hasLoginNeeded()&&!P.b.getInstance().isSignedInUser()&&w.a.createElement("div",{className:"signin-required"},w.a.createElement("div",{className:"grey-bg",onClick:function(){return t.showSignInRequired()},role:"presentation",style:{cursor:"pointer"}}),w.a.createElement("div",{className:"lock-icon"},w.a.createElement(p.a,null,w.a.createElement(c.a,{quiet:!0,variant:"tool",onClick:function(){t.showSignInRequired(),document.activeElement instanceof HTMLElement&&document.activeElement.blur()},icon:w.a.createElement(x.a,{icon:w.a.createElement(k.a,{style:{width:"var(--spectrum-global-dimension-size-175)",height:"var(--spectrum-global-dimension-size-175)",top:"var(--spectrum-global-dimension-size-100)",left:"var(--spectrum-global-dimension-size-100)"}})})}),w.a.createElement(v.a,null,Object(A.b)("EffectsView.Tooltip.PSignin","Please sign in to use this feature"))))),w.a.createElement(C.a,{className:"presets-card-body",title:n.getTitle(),creator:n.getCreatorName()?"\xa9 ".concat(n.getCreatorName()):void 0},a.effectId===n.getId()&&n.hasIntensityEnabled()&&w.a.createElement("div",{className:"base-slider"},w.a.createElement(O.a,{renderLabel:!0,label:n.getIntensityLabel(),min:0,max:1,step:.01,filled:!0,fillOffset:1,value:n.getIntensity(),onChange:function(e){return t.setIntensity(e,!1)},onChangeEnd:function(e){t.setIntensity(e,!0),Object(T.a)("effects:".concat(Object(y.camelCase)(n.getTitle())))},getAriaValueText:function(e){return n.getAriaIntensityValue(e)}}))))}))}},{key:"render",value:function(){var e=this.props.controller,t=this.state,a=t.params,n=t.processing,r=e.getEffectsGroups(),i=a.groupId?Object(y.findIndex)(r,{id:a.groupId}):void 0;return w.a.createElement("div",{className:"editor-panel"},n&&w.a.createElement(b.a,{centered:!0}),w.a.createElement("div",{className:"settings-right"},w.a.createElement("div",{className:"settings-scrolling-content"},w.a.createElement("div",{className:"settings-header"},w.a.createElement("div",{className:"title"},Object(A.b)("EffectsView.Title.ArtEffects","Art effects")),w.a.createElement("div",{className:"reset-button"},w.a.createElement(c.a,{quiet:!0,variant:"action",onClick:function(){e.reset()},icon:w.a.createElement(h.a,null),disabled:!e.isDirty()},Object(A.b)("EffectsView.Button.Reset","Reset")))),w.a.createElement("div",{className:"presets-panel"},w.a.createElement(s.Accordion,{selectedIndex:i,onChange:function(t){return e.setGroup(null!==t?r[t]:void 0)}},this.renderGroups()))),w.a.createElement("div",{className:"action-button-container"},w.a.createElement(c.a,{onClick:function(){Object(T.a)("effectsCancel"),e.cancel()}},Object(A.b)("EffectsView.Button.Cancel","Cancel")),w.a.createElement(c.a,{quiet:!0,variant:"cta",onClick:function(){Object(T.a)("effects"),e.apply()},disabled:!e.isDirty()},Object(A.b)("EffectsView.Button.Apply","Apply")))))}}]),l}(E.PureComponent))}).call(this,a(79))},233:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("defs",null,r.a.createElement("style",null,"\n      .blue-600 {\n        fill: #0d66d0;\n      }\n\n      .signin-1 {\n        fill: #fff;\n      }\n    ")),l=r.a.createElement("g",{id:"icons"},r.a.createElement("path",{className:"blue-600",d:"M16,0A16,16,0,1,0,32,16,16,16,0,0,0,16,0Z"}),r.a.createElement("path",{className:"signin-1",d:"M27.793,9.285,23.481,4.971a1,1,0,0,0-1.416,0h0l-9.184,9.184a5.925,5.925,0,0,0-2.787-.717A6.08,6.08,0,1,0,15.4,16.686l5.291-5.412,2.5,2.5a.5.5,0,0,0,.708,0l1.427-1.309-2.85-2.849.822-.821,2.849,2.849,1.648-1.648a.5.5,0,0,0,0-.706h0ZM9.093,22.447a2,2,0,1,1,2-2,2,2,0,0,1-2,2Z"})),c=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({width:32,height:32,viewBox:"0 0 32 32",ref:t},n),a?r.a.createElement("title",null,a):null,s,l)},u=r.a.forwardRef((function(e,t){return r.a.createElement(c,i({svgRef:t},e))}));a.p},234:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(3),r=a(4),i=a(6),o=a(7),s=a(19),l=a.n(s),c=a(0),u=a.n(c),d=(a(600),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.subtitle,n=e.description,r=e.children,i=e.creator,o=this.context,s=o.cardVariant,l=o.actionMenu,c=o.id,d=a?u.a.createElement("div",{className:"spectrum-Card-subtitle",id:"".concat(c,"-subtitle")},a):null,h=n?u.a.createElement("div",{className:"spectrum-Card-description",id:"".concat(c,"-description")},n):null;return u.a.createElement("div",{className:"spectrum-Card-body"},t||l?u.a.createElement("div",{className:"effect-Card-header"},t?u.a.createElement("div",{className:"effect-title"},t):null,i?u.a.createElement("div",{className:"effect-creator"},i):null,l?u.a.createElement("div",{className:"spectrum-Card-actionButton"},u.a.cloneElement(l,{alignRight:!0})):null):null,"gallery"!==s&&(a||n)?u.a.createElement("div",{className:"spectrum-Card-content"},d,h):null,r)}}]),a}(u.a.Component));d.displayName="EffectCardBody",d.contextTypes={cardVariant:l.a.string,actionMenu:l.a.element,id:l.a.string}},235:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return _}));var n=a(3),r=a(4),i=a(6),o=a(7),s=a(14),l=a.n(s),c=a(52),u=a.n(c),d=a(61),h=a.n(d),f=a(50),p=a.n(f),m=a(59),v=a.n(m),g=a(45),b=a.n(g),y=a(0),E=a.n(y),w=a(236),x=a(237),k=a(91),S=a.n(k),O=a(9),C=a(1),P=a(21),T=a(31),A=a(238),j=(a(651),99999),I=99999,M=1,R=["-","+","e",".",","],_=function(t){Object(i.a)(s,t);var a=Object(o.a)(s);function s(e){var t,r,i;Object(n.a)(this,s),i=a.call(this,e);var o=P.a.getParams(),l=(null===(t=o.resize)||void 0===t?void 0:t.enlarger)||!1;return i.state={params:e.controller.getParams(),canReset:!1,showEnlargerTooltip:l,processing:!1},(null===(r=o.resize)||void 0===r?void 0:r.enlarger)&&(o.resize.enlarger=void 0,P.a.setParams(o)),i}return Object(r.a)(s,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"setParams",value:function(e,t){this.setState({params:e,canReset:t})}},{key:"showProcessing",value:function(t){this.setState({processing:!0},(function(){e.nextTick(t)}))}},{key:"refresh",value:function(){}},{key:"testNumberInput",value:function(e){R.includes(e.key)&&e.preventDefault()}},{key:"handleInputKeyUp",value:function(e){var t=this.props.controller;"Enter"===e.key&&t.doResize(!0)}},{key:"hideTooltip",value:function(){this.setState({showEnlargerTooltip:!1})}},{key:"render",value:function(){var e=this,t=this.props.controller,a=this.state,n=a.params,r=a.canReset,i=a.showEnlargerTooltip,o=a.processing;return E.a.createElement("div",{className:"editor-panel"},o&&E.a.createElement(b.a,{centered:!0}),E.a.createElement("div",{className:"settings-right resize-settings-right"},E.a.createElement("div",{className:"settings-scrolling-content"},E.a.createElement("div",{className:"settings-header"},E.a.createElement("div",{className:"title"},Object(C.b)("ResizeView.Title.ResizeImage","Resize image")),E.a.createElement("div",{className:"reset-button"},E.a.createElement(l.a,{quiet:!0,variant:"action",onClick:function(){t.reset()},icon:E.a.createElement(h.a,null),disabled:!r},Object(C.b)("ResizeView.Button.Reset","Reset")))),E.a.createElement("section",{style:{marginBottom:"0.5rem"}},E.a.createElement("div",{className:"size-params-left"},E.a.createElement("div",{className:"label-units-wrapper"},E.a.createElement(u.a,{label:Object(C.b)("ResizeView.Controls.Field.Label.Width","Width")},E.a.createElement(S.a,{id:"input-currentWidth",value:n.width,min:M,max:j,step:1,locale:T.a.getNormalizedCurrentLocale(),onChange:function(e){t.changeWidth(e)},onProgrammaticChange:function(){return t.doResize(!1)},onProgrammaticChangeStop:function(){return t.finishResize()},onBlur:function(e){t.changeWidth(Number(e.target.value).valueOf(),!0)},onKeyDown:this.testNumberInput,onKeyUp:function(t){return e.handleInputKeyUp(t)}})),E.a.createElement("div",{className:"label-units"},"px")),E.a.createElement("div",{className:"label-units-wrapper"},E.a.createElement(u.a,{label:Object(C.b)("ResizeView.Controls.Field.Label.Height","Height")},E.a.createElement(S.a,{id:"input-currentHeight",value:n.height,min:M,max:j,step:1,locale:T.a.getNormalizedCurrentLocale(),onChange:function(e){return t.changeHeight(e)},onProgrammaticChange:function(){return t.doResize(!1)},onProgrammaticChangeStop:function(){return t.finishResize()},onBlur:function(e){t.changeHeight(Number(e.target.value).valueOf(),!0)},onKeyDown:this.testNumberInput,onKeyUp:function(t){return e.handleInputKeyUp(t)}})),E.a.createElement("div",{className:"label-units"},"px")),E.a.createElement("div",{id:"aspect-ratio"},E.a.createElement(l.a,{quiet:!0,variant:"action",onClick:function(){return t.toogleAspectRatio()},icon:n.hasAspectRatioFixed?E.a.createElement(w.a,null):E.a.createElement(x.a,null),tabIndex:-1,"aria-label":"Toggle Aspect Ratio",className:"aspect-ratio"}))),E.a.createElement("div",{className:"size-params-right"},E.a.createElement("div",{className:"label-units-wrapper"},E.a.createElement(p.a,{placement:"top",show:i,delayHide:100,onClick:function(){e.hideTooltip()},onHide:function(){e.hideTooltip()}},E.a.createElement(u.a,{label:Object(C.b)("ResizeView.Controls.Field.Label.ScaleX","X-scale")},E.a.createElement(S.a,{id:"input-scaleX",value:n.scaleX,min:M,max:I,step:1,locale:T.a.getNormalizedCurrentLocale(),onChange:function(e){t.changeScaleX(e)},onProgrammaticChange:function(){return t.doResize(!1)},onProgrammaticChangeStop:function(){t.finishResize()},onBlur:function(e){t.changeScaleX(Number(e.target.value).valueOf(),!0)},onKeyDown:this.testNumberInput,onKeyUp:function(t){return e.handleInputKeyUp(t)}})),E.a.createElement(v.a,{placement:"top"},Object(C.b)("ResizeView.Tooltip.Enlarger","Click arrow to desired enlargement"))),E.a.createElement("div",{className:"label-units"},"%")),E.a.createElement("div",{className:"label-units-wrapper"},E.a.createElement(u.a,{label:Object(C.b)("ResizeView.Controls.Field.Label.ScaleY","Y-scale")},E.a.createElement(S.a,{id:"input-scaleY",value:n.scaleY,min:M,max:I,step:1,locale:T.a.getNormalizedCurrentLocale(),onChange:function(e){return t.changeScaleY(e)},onProgrammaticChange:function(){return t.doResize(!1)},onProgrammaticChangeStop:function(){return t.finishResize()},onBlur:function(e){t.changeScaleY(Number(e.target.value).valueOf(),!0)},onKeyDown:this.testNumberInput,onKeyUp:function(t){return e.handleInputKeyUp(t)}})),E.a.createElement("div",{className:"label-units"},"%")))),E.a.createElement("section",null,E.a.createElement("div",{className:"image-size-container"},E.a.createElement("span",{className:"label"},Object(C.b)("ResizeView.Controls.ImageSize","Image size")),E.a.createElement("span",{className:"image-size"},n.imageSize))),E.a.createElement("div",{className:"settings-section-divider"}),E.a.createElement(A.a,null)),E.a.createElement("div",{className:"action-button-container"},E.a.createElement(l.a,{onClick:function(){Object(O.a)("resizeCancel"),t.cancel()}},Object(C.b)("ResizeView.Button.Cancel","Cancel")),E.a.createElement(l.a,{quiet:!0,variant:"cta",onClick:function(){Object(O.a)("resize"),t.apply()},disabled:!r,title:Object(C.b)("ResizeView.Button.ResizeImage","Resize image")},Object(C.b)("ResizeView.Button.ResizeImage","Resize image")))))}}]),s}(y.PureComponent)}).call(this,a(79))},236:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("style",{type:"text/css"},"\n\t.st0{fill:none;stroke:var(--spectrum-global-color-gray-700);stroke-linecap:round;}\n\t.st1{fill:var(--spectrum-global-color-gray-700);}\n"),l=r.a.createElement("g",{transform:"translate(-1125 -182)"},r.a.createElement("g",{transform:"translate(1125.5 182.5)"},r.a.createElement("line",{className:"st0",x1:0,y1:0,x2:14,y2:0}),r.a.createElement("line",{className:"st0",x1:14,y1:0,x2:14,y2:11})),r.a.createElement("g",{transform:"translate(1125.5 211.538)"},r.a.createElement("line",{className:"st0",x1:0,y1:19,x2:14,y2:19}),r.a.createElement("line",{className:"st0",x1:14,y1:8,x2:14,y2:19})),r.a.createElement("path",{className:"st1",d:"M1145,205.8h-0.5v-1c0-2.8-2.2-5-5-5s-5,2.2-5,5v1h-0.5c-0.3,0-0.5,0.2-0.5,0.5v8c0,0.3,0.2,0.5,0.5,0.5h11 c0.3,0,0.5-0.2,0.5-0.5v-8C1145.5,206,1145.3,205.8,1145,205.8z M1136.5,204.8c0-1.7,1.3-3,3-3s3,1.3,3,3v1h-6V204.8z  M1140.5,210.9v1.4c0,0.3-0.2,0.5-0.5,0.5h-1c-0.3,0-0.5-0.2-0.5-0.5v-1.4c-0.6-0.6-0.7-1.5-0.1-2.1c0.6-0.6,1.5-0.7,2.1-0.1 c0.6,0.6,0.7,1.5,0.1,2.1C1140.6,210.8,1140.5,210.8,1140.5,210.9z"})),c=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({width:22,height:49.038,viewBox:"0 0 22 49.038",ref:t},n),a?r.a.createElement("title",null,a):null,s,l)},u=r.a.forwardRef((function(e,t){return r.a.createElement(c,i({svgRef:t},e))}));a.p},237:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(0),r=a.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=r.a.createElement("style",{type:"text/css"},"\n\t.st0{fill:none;stroke:var(--spectrum-global-color-gray-700);stroke-width:1;stroke-linecap:round;stroke-miterlimit:3.9998;}\n\t.st1{fill:var(--spectrum-global-color-gray-700);}\n"),l=r.a.createElement("line",{className:"st0",x1:.5,y1:.5,x2:14.5,y2:.5}),c=r.a.createElement("line",{className:"st0",x1:14.5,y1:.5,x2:14.5,y2:11.5}),u=r.a.createElement("line",{className:"st0",x1:.5,y1:48.5,x2:14.5,y2:48.5}),d=r.a.createElement("line",{className:"st0",x1:14.5,y1:37.5,x2:14.5,y2:48.5}),h=r.a.createElement("path",{className:"st1",d:"M19.8,23.8h-8.6v-2.8c0-1.7,1.3-3.1,3-3.2c0,0,0,0,0,0c1.2,0,2.2,0.7,2.8,1.7c0.2,0.3,0.1,0.6,0.4,0.6 c0,0,0.1,0,0.1,0l1.3-0.5c0.1,0,0.2-0.1,0.2-0.2c0-0.7-1.7-3.4-4.7-3.4c-2.8,0.1-5,2.3-5,5v2.9H8.8c-0.3,0-0.5,0.2-0.5,0.5v8 c0,0.3,0.2,0.5,0.5,0.5h11c0.3,0,0.5-0.2,0.5-0.5v-8C20.3,24,20,23.8,19.8,23.8z M15.3,28.9v1.4c0,0.3-0.2,0.5-0.5,0.5h-1 c-0.3,0-0.5-0.2-0.5-0.5v-1.4c-0.6-0.6-0.7-1.5-0.1-2.1c0.6-0.6,1.5-0.7,2.1-0.1c0.6,0.6,0.7,1.5,0.1,2.1 C15.3,28.8,15.3,28.8,15.3,28.9z"}),f=function(e){var t=e.svgRef,a=e.title,n=o(e,["svgRef","title"]);return r.a.createElement("svg",i({width:22,height:49.038,viewBox:"0 0 22 49.04",ref:t},n),a?r.a.createElement("title",null,a):null,s,l,c,u,d,h)},p=r.a.forwardRef((function(e,t){return r.a.createElement(f,i({svgRef:t},e))}));a.p},238:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(3),r=a(4),i=a(38),o=a(6),s=a(7),l=a(53),c=a.n(l),u=a(13),d=a(0),h=a.n(d),f=a(1),p=a(31),m=(a(650),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).state={showMetricSystem:!p.a.hasUSEnglish()},r.toggleSystemInfo=r.toggleSystemInfo.bind(Object(i.a)(r)),r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"refresh",value:function(){}},{key:"toggleSystemInfo",value:function(){var e=this.state.showMetricSystem;this.setState({showMetricSystem:!e})}},{key:"render",value:function(){var e=this.state.showMetricSystem;return h.a.createElement("div",{className:"info-content"},e?h.a.createElement(u.Table,{className:"table-content",quiet:!0},h.a.createElement(u.THead,null,h.a.createElement(u.TH,null,Object(f.b)("ResizeView.Help.PhotoSizes.Title","Common Photo Sizes")," (",h.a.createElement(c.a,{href:"#",onClick:this.toggleSystemInfo},Object(f.b)("ResizeView.Help.PhotoSizes.Inches","Inches")),"/",h.a.createElement("strong",null,Object(f.b)("ResizeView.Help.PhotoSizes.Centimeters","cm")),")"),h.a.createElement(u.TH,null,Object(f.b)("ResizeView.Help.PhotoSizes.GoodQuality","Good Quality")," (",Object(f.b)("ResizeView.Help.PhotoSizes.Pixels","Pixels"),")"),h.a.createElement(u.TH,null,Object(f.b)("ResizeView.Help.PhotoSizes.BetterQuality","Better Quality")," (",Object(f.b)("ResizeView.Help.PhotoSizes.Pixels","Pixels"),")")),h.a.createElement(u.TBody,null,h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"9 \xd7 13"),h.a.createElement(u.TD,null,"630 \xd7 900"),h.a.createElement(u.TD,null,"1050 \xd7 1500")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"10 \xd7 15"),h.a.createElement(u.TD,null,"720 \xd7 1080"),h.a.createElement(u.TD,null,"1200 \xd7 1800")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"13 \xd7 18"),h.a.createElement(u.TD,null,"900 \xd7 1260"),h.a.createElement(u.TD,null,"1500 \xd7 2100")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"15 \xd7 21"),h.a.createElement(u.TD,null,"1080 \xd7 1530"),h.a.createElement(u.TD,null,"1800 \xd7 2550")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"18 \xd7 24"),h.a.createElement(u.TD,null,"1260 \xd7 1710"),h.a.createElement(u.TD,null,"2100 \xd7 2850")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"20 \xd7 25"),h.a.createElement(u.TD,null,"1400 \xd7 1770"),h.a.createElement(u.TD,null,"2340 \xd7 2940")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"21 \xd7 30"),h.a.createElement(u.TD,null,"1500 \xd7 2110"),h.a.createElement(u.TD,null,"2490 \xd7 3510")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"30 \xd7 40"),h.a.createElement(u.TD,null,"2160 \xd7 2850"),h.a.createElement(u.TD,null,"3600 \xd7 4740")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"30 \xd7 45"),h.a.createElement(u.TD,null,"2160 \xd7 3240"),h.a.createElement(u.TD,null,"3600 \xd7 5400")))):h.a.createElement(u.Table,{className:"table-content",quiet:!0},h.a.createElement(u.THead,null,h.a.createElement(u.TH,null,Object(f.b)("ResizeView.Help.PhotoSizes.Title","Common Photo Sizes")," (",h.a.createElement("strong",null,Object(f.b)("ResizeView.Help.PhotoSizes.Inches","Inches")),"/",h.a.createElement(c.a,{href:"#",onClick:this.toggleSystemInfo},Object(f.b)("ResizeView.Help.PhotoSizes.Centimeters","cm")),")"),h.a.createElement(u.TH,null,Object(f.b)("ResizeView.Help.PhotoSizes.GoodQuality","Good Quality")," (",Object(f.b)("ResizeView.Help.PhotoSizes.Pixels","Pixels"),")"),h.a.createElement(u.TH,null,Object(f.b)("ResizeView.Help.PhotoSizes.BetterQuality","Better Quality")," (",Object(f.b)("ResizeView.Help.PhotoSizes.Pixels","Pixels"),")")),h.a.createElement(u.TBody,null,h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"3.5 \xd7 5"),h.a.createElement(u.TD,null,"630 \xd7 900"),h.a.createElement(u.TD,null,"1050 \xd7 1500")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"4 \xd7 6"),h.a.createElement(u.TD,null,"720 \xd7 1080"),h.a.createElement(u.TD,null,"1200 \xd7 1800")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"5 \xd7 7"),h.a.createElement(u.TD,null,"900 \xd7 1260"),h.a.createElement(u.TD,null,"1500 \xd7 2100")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"6 \xd7 8"),h.a.createElement(u.TD,null,"1080 \xd7 1440"),h.a.createElement(u.TD,null,"1800 \xd7 2400")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"8 \xd7 10"),h.a.createElement(u.TD,null,"1440 \xd7 1800"),h.a.createElement(u.TD,null,"2400 \xd7 3000")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"8.5 \xd7 11"),h.a.createElement(u.TD,null,"1530 \xd7 1980"),h.a.createElement(u.TD,null,"2550 \xd7 3300")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"10 \xd7 14"),h.a.createElement(u.TD,null,"1800 \xd7 2520"),h.a.createElement(u.TD,null,"3000 \xd7 4200")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"11 \xd7 14"),h.a.createElement(u.TD,null,"1980 \xd7 2520"),h.a.createElement(u.TD,null,"3300 \xd7 4200")),h.a.createElement(u.TR,null,h.a.createElement(u.TD,null,"12 \xd7 18"),h.a.createElement(u.TD,null,"2160 \xd7 3240"),h.a.createElement(u.TD,null,"3600 \xd7 5400")))))}}]),a}(d.PureComponent))},249:function(e,t,a){e.exports=a(694)},277:function(e,t){},31:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(104),r=a(111),i=a(2),o=a.n(i),s=a(8),l=a(3),c=a(4),u=a(55),d=a(90),h=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"loadScript",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.getElementById(t)){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return e.abrupt("return",new Promise((function(e,n){var r=document.createElement("script");r.src=a,r.id=t,r.onload=function(){e()},r.onerror=function(e){n(e)},document.body.appendChild(r)})));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"loadCSS",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.getElementById(t)){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return e.abrupt("return",new Promise((function(e,n){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.href=a,r.id=t;var i=document.getElementsByTagName("head")[0];r.onload=function(){e()},r.onerror=function(){n()},i.appendChild(r)})));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"cancelablePromise",value:function(e){var t=function(){};return{promise:new Promise((function(a,n){var r=!1,i=new Promise((function(e,a){t=function(){r||a()}}));i.catch((function(){return n(new Error("Canceled"))})),e((function(e){r=!0,a(e)}),(function(e){r=!0,n(e)}),(function(e){i.catch(e)}))})),cancel:t}}},{key:"waitUntilWithCancel",value:function(t){return e.cancelablePromise((function(e,a,n){var r=setInterval((function(){var a;try{a=t()}catch(n){}!0===a&&(clearInterval(r),e())}),10);n((function(){return clearInterval(r)}))}))}},{key:"waitUntilWithTimeout",value:function(t,a){var n=e.waitUntilWithCancel(a);return setTimeout(n.cancel,t),n.promise}},{key:"waitForPromiseWithTimeout",value:function(t,a){var n=e.cancelablePromise((function(e,t){a.then(e).catch(t)}));return setTimeout(n.cancel,t),n.promise}},{key:"deduper",value:function(){var e=new Map;return function(t,a){clearTimeout(e.get(t)),e.set(t,setTimeout(a,50))}}},{key:"openInNewTab",value:function(e){Object.assign(document.createElement("a"),{target:"_blank",href:e}).click()}},{key:"isLocalhost",value:function(){return Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))}},{key:"humanFileSize",value:function(t){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=a?1e3:1024;if(Math.abs(t)<n)return"".concat(t," B");var r=a?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],i=-1,o=t;do{o/=n,i+=1}while(Math.abs(o)>=n&&i<r.length-1);return"".concat((Math.round(10*o)/10).toLocaleString(e.getCurrentLanguage().replace("_","-"))," ").concat(r[i])}},{key:"getCurrentLanguage",value:function(){return d.a.language||localStorage.i18nextLng||"en"}},{key:"getNormalizedCurrentLocale",value:function(){return u.normalize(e.getCurrentLanguage())}},{key:"hasUSEnglish",value:function(){var t=e.parseCookies();return void 0!==t.international?"en-US"===u.normalize(t.international,"adobedotcom"):void 0!==t["creative-cloud-loc"]?"en-US"===u.normalize(t["creative-cloud-loc"],"cchome"):"en-US"===e.getNormalizedCurrentLocale()}},{key:"getLocalizedURL",value:function(t){var a=e.getNormalizedCurrentLocale();return u.getLocalizedURL(t,a)}},{key:"parseCookies",value:function(e){var t;return Object.assign.apply(Object,[{}].concat(Object(r.a)(null===(t=null!==e&&void 0!==e?e:document.cookie)||void 0===t?void 0:t.split(";").map((function(e){var t,a,r=null===(t=e.split("=")[0])||void 0===t?void 0:t.trim(),i=null===(a=e.split("=")[1])||void 0===a?void 0:a.trim();return Object(n.a)({},r,i)})))))}},{key:"getFileExt",value:function(e){return e.trim().toLowerCase().split(".").pop()}},{key:"hasSupportedFileExt",value:function(t){var a=e.getFileExt(t);return!!a&&null!==a.match(/^(jpe?g)?(png)?$/)}},{key:"isEnOrRunningInLocEnv",value:function(){return e.hasUSEnglish()||!1}},{key:"rgbToHex",value:function(e,t,a){return"#".concat(((1<<24)+(e<<16)+(t<<8)+a).toString(16).slice(1))}},{key:"hexToRgb",value:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:void 0}},{key:"wait",value:function(e){return new Promise((function(t,a){return setTimeout(t,e)}))}}]),e}()},32:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(3),r=a(4),i=function(){function e(){Object(n.a)(this,e),this.container=void 0,this.view=void 0}return Object(r.a)(e,[{key:"createView",value:function(e){this.container=e}},{key:"destroyView",value:function(){this.container=void 0}},{key:"viewDidMount",value:function(e){this.view=e}},{key:"viewWillUnmount",value:function(e){this.view=void 0}},{key:"ensureHTMLElement",value:function(e){var t=document.getElementById(e);if(!t)throw new Error("missing element ".concat(e));return t}}]),e}()},33:function(e,t,a){"use strict";var n=a(68),r=a.n(n),i=a(0),o=a.n(i);t.a=function(e){var t=e.icon,a=e.size;return o.a.createElement(r.a,{size:a},t)}},35:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n,r=a(3);!function(e){e[e.RECT=1]="RECT",e[e.ELLIPSE=2]="ELLIPSE",e[e.ROUNDED_RECT=3]="ROUNDED_RECT",e[e.HEART=4]="HEART",e[e.OCTAGON=5]="OCTAGON",e[e.STAR=6]="STAR"}(n||(n={}));var i=function e(){Object(r.a)(this,e)};i.HEART='<svg xmlns="http://www.w3.org/2000/svg"\n                          width="241.42" height="220.71"\n                          preserveAspectRatio="none"\n                          viewBox="0 0 241.42 220.71">\n                          <g id="Layer_2"\n                            data-name="Layer 2">\n                            <g id="Layer_1-2"\n                              data-name="Layer 1">\n                              <g id="redheart">\n                                <g id="heart">\n                                  <path d="M120.71,220.71c-35-75-65-60-100-100a70.71,70.71,0,0,1,100-100,70.71,70.71,0,0,1,100,100c-35,40-65,25-100,100"/>\n                                </g>\n                              </g>\n                            </g>\n                          </g>\n                        </svg>',i.OCTAGON='<svg xmlns="http://www.w3.org/2000/svg"\n                            width="278.32" height="278.32"\n                            preserveAspectRatio="none"\n                            viewBox="0 0 278.32 278.32">\n                            <g id="Layer_2"\n                              data-name="Layer 2">\n                              <g id="Layer_1-2"\n                                data-name="Layer 1">\n                                <path d="M277.44,80.64,197.68.88A3,3,0,0,0,195.55,0H82.76a3,3,0,0,0-2.13.88L.88,80.64A3,3,0,0,0,0,82.76v112.8a3,3,0,0,0,.88,2.12l79.75,79.77a3,3,0,0,0,2.13.87h112.8a3,3,0,0,0,2.12-.87l79.77-79.77a3,3,0,0,0,.87-2.12V82.76A3,3,0,0,0,277.44,80.64Z"/>\n                              </g>\n                            </g>\n                          </svg>',i.STAR='<svg xmlns="http://www.w3.org/2000/svg"\n                          width="287.46" height="274.03"\n                          preserveAspectRatio="none"\n                          viewBox="0 0 287.46 274.03">\n                          <g id="Layer_2"\n                            data-name="Layer 2">\n                            <g id="Layer_1-2"\n                              data-name="Layer 1">\n                              <path d="M149.76,4.15l34.38,91,97.16,4.6a6.44,6.44,0,0,1,3.75,11.46l-75.9,60.84,25.63,93.84A6.44,6.44,0,0,1,225,273l-81.29-53.39L62.42,273a6.44,6.44,0,0,1-9.75-7.08l25.62-93.84L2.41,111.21A6.44,6.44,0,0,1,6.16,99.75l97.14-4.6,34.42-91a6.44,6.44,0,0,1,12,0Z"/>\n                            </g>\n                          </g>\n                        </svg>',i.ROUNDED_RECT='<svg xmlns="http://www.w3.org/2000/svg"\n                                width="40" height="40"\n                                preserveAspectRatio="none"\n                                viewBox="0 0 40 40">\n                                <g id="Layer_2"\n                                  data-name="Layer 2">\n                                  <g id="Layer_1-2"\n                                    data-name="Layer 1">\n                                    <rect width="40"\n                                      height="40"\n                                      rx="6"/>\n                                  </g>\n                                </g>\n                              </svg>',i.HEART_BASE64=btoa(i.HEART),i.OCTAGON_BASE64=btoa(i.OCTAGON),i.STAR_BASE64=btoa(i.STAR),i.ROUNDED_RECT_BASE64=btoa(i.ROUNDED_RECT)},354:function(e,t,a){},36:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return u}));var n,r=a(2),i=a.n(r),o=a(8),s=a(3),l=a(4),c=a(31);!function(e){e[e.anonymous=0]="anonymous",e[e.free=1]="free",e[e.paid=2]="paid"}(n||(n={}));var u=function(){function e(){var t=this;Object(s.a)(this,e),this.imsReady=void 0,window.adobeid={locale:"en_US",client_id:"ps-frictionless-web",scope:"AdobeID,openid,creative_sdk",uses_redirect_mode:!0,onReady:function(){console.log("IMS lib initialized."),t.imsReady&&t.imsReady()}}}return Object(l.a)(e,null,[{key:"getInstance",value:function(){return e.instance}}]),Object(l.a)(e,[{key:"load",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:e.next=4;break;case 4:e.prev=4,c.a.loadScript("ims","https://static.adobelogin.com/imslib/imslib.min.js"),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(4),e.abrupt("return",Promise.reject(e.t0));case 11:return e.abrupt("return",new Promise((function(e){t.imsReady=e})));case 12:case"end":return e.stop()}}),e,null,[[4,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"getUserProfile",value:function(){var e,t=null===(e=window.adobeIMS)||void 0===e?void 0:e.getUserProfile();if(t)return t.created=1e3*parseInt(t.userId.substring(8,16),16),t}},{key:"loginUser",value:function(e){var t;this.isSignedInUser()||(null===(t=window.adobeIMS)||void 0===t||t.signIn({},{lastEditor:e}))}},{key:"logoutUser",value:function(){var e;this.isSignedInUser()&&(null===(e=window.adobeIMS)||void 0===e||e.signOut())}},{key:"signUpUser",value:function(e){var t;this.isSignedInUser()||(null===(t=window.adobeIMS)||void 0===t||t.signUp())}},{key:"isSignedInUser",value:function(){var e;return null===(e=window.adobeIMS)||void 0===e?void 0:e.isSignedInUser()}},{key:"getUserAccessToken",value:function(){var e,t=null===(e=window.adobeIMS)||void 0===e?void 0:e.getAccessToken();return t?"Bearer ".concat(t):void 0}},{key:"getUserPictureURL",value:function(){var e;return null===(e=window.adobeIMS)||void 0===e?void 0:e.getUserPictureURL()}},{key:"getUserAccessLevel",value:function(){var e=this.getUserProfile();return e?e.serviceAccounts.some((function(e){return"ACTIVE"===e.serviceStatus&&"CS_LVL_2"===e.serviceLevel&&"creative_cloud"===e.serviceCode}))?n.paid:n.free:n.anonymous}}]),e}();u.instance=new u},365:function(e,t,a){},374:function(e,t,a){},39:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,i,o=a(100),s=w(a(22)),l=w(a(42)),c=w(a(46)),u=a(70),d=w(a(19)),h=w(a(0));function f(e){return(f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var a=[],n=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(l){r=!0,i=l}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function v(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function w(e){return e&&e.__esModule?e:{default:e}}var x={"cs-CZ":w(a(118)).default,"da-DK":w(a(119)).default,"de-DE":w(a(120)).default,"en-US":w(a(121)).default,"es-ES":w(a(122)).default,"fi-FI":w(a(123)).default,"fr-FR":w(a(124)).default,"hu-HU":w(a(125)).default,"it-IT":w(a(126)).default,"ja-JP":w(a(127)).default,"ko-KR":w(a(128)).default,"nb-NO":w(a(129)).default,"nl-NL":w(a(130)).default,"pl-PL":w(a(131)).default,"pt-BR":w(a(132)).default,"ru-RU":w(a(133)).default,"sv-SE":w(a(134)).default,"tr-TR":w(a(135)).default,"uk-UA":w(a(136)).default,"zh-CN":w(a(137)).default,"zh-TW":w(a(138)).default};a(464),a(465),a(466);var k=(0,u.messageFormatter)(x),S={FILL:{horizontal:"width",vertical:"height"},OFFSET:{horizontal:"left",vertical:"bottom"},OPPOSITE_OFFSET:{horizontal:"right",vertical:"top"}},O=(0,l.default)((i=r=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=g(t).call(this,e),a=!r||"object"!==f(r)&&"function"!==typeof r?b(n):r,E(b(a),"state",{startValue:null,endValue:null,draggingHandle:null,focusedHandle:null}),E(b(a),"findNearestHandle",(function(e,t){var n=1/0,r="startHandle";return"range"!==a.props.variant||["startHandle","endHandle"].forEach((function(i){var o=a[i+"Input"].getBoundingClientRect(),s=o.top+window.pageYOffset,l=o.left+window.pageXOffset,c=Math.floor(Math.sqrt(Math.pow(e-(l+o.width/2),2)+Math.pow(t-(s+o.height/2),2)));c<n&&(n=c,r=i)})),r})),E(b(a),"onPointerDown",(function(e,t){t?e.stopPropagation():t=a.findNearestHandle(e.pageX,e.pageY);var n=a[t+"Input"];n&&n.focus(),e.persist(),a.setState({sliderHandle:null,isMouseUp:!1,draggingHandle:t},(function(){return a.onPointerMove(e)})),window.addEventListener("pointerup",a.onPointerUp),window.addEventListener("pointermove",a.onPointerMove),document.body.classList.add(a.isDraggedBodyClassName)})),E(b(a),"onPointerUp",(function(e){var t=a.state.draggingHandle,n=t&&a[t+"Input"];n&&n.blur(),a.setState({isMouseUp:!0,draggingHandle:null},(function(){n&&n.focus()})),a.props.onChangeEnd&&("range"===a.props.variant?a.props.onChangeEnd(a.state.startValue,a.state.endValue):a.props.onChangeEnd(a.state.startValue)),window.removeEventListener("pointerup",a.onPointerUp),window.removeEventListener("pointermove",a.onPointerMove),document.body.classList.remove(a.isDraggedBodyClassName)})),E(b(a),"calculateHandlePosition",(function(e){var t=a.props,n=t.min,r=t.max,i=t.orientation,s=t.step,l="vertical"===i,c=a.dom.getBoundingClientRect(),u=l?c.top:c.left,d=((l?e.clientY:e.clientX)-u)/(l?c.height:c.width);d=(0,o.clamp)(d,0,1),l&&(d=1-d);var h=n+(r-n)*d;return s&&(h=Math.round(h/s)*s),h})),E(b(a),"getHandleValues",(function(e,t){var n=a.state,r=n.draggingHandle,i=n.startValue,o=n.endValue;return"startHandle"===r&&(i=e),"endHandle"===r&&(o=e),+i+(t=t||1)>o?[a.state.startValue,a.state.endValue]:[i,o]})),E(b(a),"onPointerMove",(function(e){e.preventDefault();var t=a.calculateHandlePosition(e);if("range"===a.props.variant){var n=m(a.getHandleValues(t,a.props.step),2),r=n[0],i=n[1];a.updateValues(r,i,a.state.draggingHandle)}else a.updateValues(t,null,"startHandle")})),E(b(a),"updateValues",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=a.props,i=r.min,s=r.max,l=r.step,c=r.variant,u=r.onChange;e=(0,o.snapValueToStep)(e,i,s,l),"range"===c?(t=(0,o.snapValueToStep)(t,i,s,l),!u||e===a.state.startValue&&t===a.state.endValue||u(e,t),null==a.props.startValue&&null==a.props.endValue&&a.setState({startValue:e,endValue:t,focusedHandle:a.state.isMouseUp?null:n})):(u&&e!==a.state.startValue&&u(e),null==a.props.value&&a.setState({startValue:e,focusedHandle:a.state.isMouseUp?null:n}))})),E(b(a),"onChange",(function(e,t){var n=a.props,r=n.step,i=n.variant,o=a.state,s=o.startValue,l=o.endValue,c="startHandle"===t?s:l,u=+e.target.value;u!==c&&("range"===i?a.setState({draggingHandle:t},(function(){var e=m(a.getHandleValues(u,r),2),n=e[0],i=e[1];a.updateValues(n,i,t),a.setState({draggingHandle:null})})):a.updateValues(u,null,t))})),E(b(a),"onFocus",(function(e,t){a.setState({focusedHandle:a.state.isMouseUp?null:t,topHandle:t,isMouseUp:!1})})),E(b(a),"onBlur",(function(e,t){a.setState({focusedHandle:null})})),E(b(a),"onKeyUp",(function(e,t){e.keyCode>=33&&e.keyCode<=40&&a.props.onChangeEnd&&("range"===a.props.variant?a.props.onChangeEnd(a.state.startValue,a.state.endValue):a.props.onChangeEnd(a.state.startValue))})),E(b(a),"onClickSliderValue",(function(e){var t=window.getSelection(),n="startHandle";"range"===a.props.variant&&t.focusOffset>e.target.textContent.indexOf("\u2013")&&(n="endHandle"),a[n+"Input"].focus()})),E(b(a),"getAriaLabelledby",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=a.props,n=t.label,r=t["aria-labelledby"],i=t["aria-label"],o=[];return r&&o.push(r),(n||i)&&o.push(a.getLabelId()),e&&o.push(a.getSliderHandleInputId(e)),o.join(" ")})),E(b(a),"renderSliderHandle",(function(e){var t=a.props,n=t.disabled,r=t.max,i=t.min,o=t.orientation,l=t.step,c=t.variant,u=t["aria-label"],d=t["aria-describedby"],f=t.getAriaValueText,p=a.state,m=p.draggingHandle,v=p.focusedHandle,g=p.topHandle,b=p.startValue,y=p.endValue,w="startHandle"===e,x=w?b:y,O=(x-i)/(r-i),C="range"===c,P="vertical"===o,T=m===e,A=v===e,j=g===e,I=S.OFFSET[o],M=k(w?"minimum":"maximum"),R=null,_=null;return C&&(u=M,R=w?i:b,_=w?y:r),h.default.createElement("div",{className:(0,s.default)("spectrum-Slider-handle",{"is-dragged":T,"is-focused":A,"is-tophandle":j}),onPointerDown:!n&&C?function(t){return a.onPointerDown(t,e)}:null,style:E({},I,100*O+"%"),"touch-action":"none",role:"presentation"},h.default.createElement("input",{id:a.getSliderHandleInputId(e),ref:function(t){return a[e+"Input"]=t},type:"range",className:"spectrum-Slider-input",step:l,max:r,min:i,disabled:n,"aria-orientation":P?o:null,"aria-label":u||null,"aria-labelledby":a.getAriaLabelledby(C?e:null),"aria-describedby":d,"aria-valuemin":R,"aria-valuemax":_,"aria-valuetext":f(x),defaultValue:void 0,value:x,onChange:n?null:function(t){return a.onChange(t,e)},onFocus:n?null:function(t){return a.onFocus(t,e)},onBlur:n?null:function(t){return a.onBlur(t,e)},onKeyUp:n?null:function(t){return a.onKeyUp(t,e)}}))})),E(b(a),"setDOMReference",(function(e){return a.dom=e})),a.sliderId=(0,c.default)(),a}var a,n,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,e),a=t,(n=[{key:"UNSAFE_componentWillMount",value:function(){this.UNSAFE_componentWillReceiveProps(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if("range"===e.variant){var t=null==e.startValue?e.defaultStartValue:e.startValue,a=null==e.endValue?e.defaultEndValue:e.endValue;null!=t||null!=this.state.startValue&&this.props.min===e.min||(t=e.min),null!=a||null!=this.state.endValue&&this.props.max===e.max||(a=e.max),null!=t&&null!=a&&this.setState({startValue:t,endValue:a})}else{var n=null==e.value?e.defaultValue:e.value;null!=n||null!=this.state.startValue&&this.props.max===e.max&&this.props.min===e.min||(n=e.min+(e.max-e.min)/2),null!=n&&this.setState({startValue:n})}this.isDraggedBodyClassName="u-isGrabbing"}},{key:"getLabelId",value:function(){return this.sliderId+"-label"}},{key:"getSliderHandleInputId",value:function(e){var t=this.props.id,a=void 0===t?this.sliderId:t;return"startHandle"===e?a:a+"-"+e+"Input"}},{key:"render",value:function(){var e,t,a=this,n=this.props,r=n.children,i=n.disabled,o=n.filled,l=n.fillOffset,c=n.id,u=void 0===c?this.sliderId:c,d=n.label,f=n.max,m=n.min,v=n.orientation,g=n.renderLabel,b=n.variant,y=n["aria-label"],w=n.getAriaValueText,x=p(n,["children","disabled","filled","fillOffset","id","label","max","min","orientation","renderLabel","variant","aria-label","getAriaValueText"]),k=this.state,O=k.startValue,C=k.endValue,P="ramp"===b,T="range"===b,A="vertical"===v,j=(0,s.default)("spectrum-Slider",this.props.className,{"spectrum-Slider--vertical":A,"spectrum-Slider--ramp":P,"spectrum-Slider--range":T,"spectrum-Slider--filled":o&&!l,"is-disabled":i}),I=g&&d,M=this.getAriaLabelledby(),R=T?"".concat(w(O),"\u2013").concat(w(C)):w(O),_=(T?C-O:O-m)/(f-m),D=S.FILL[v],L=S.OFFSET[v],N=S.OPPOSITE_OFFSET[v],V=(O-m)/(f-m),U=(C-m)/(f-m),F=(l-m)/(f-m),B=Math.min(V,F),H=Math.max(V,F);return P&&(r=null),T&&!o&&(o=!0),h.default.createElement("div",{className:j,ref:this.setDOMReference,role:T?"group":"presentation","aria-labelledby":T?M:null},(I||d&&M||y)&&h.default.createElement("div",{className:"spectrum-Slider-labelContainer"},h.default.createElement("label",{id:this.getLabelId(),className:"spectrum-Slider-label",htmlFor:u,hidden:!I||null,"aria-label":x["aria-labelledby"]?null:y},d),I&&h.default.createElement("div",{className:"spectrum-Slider-value",style:{outline:0},role:"textbox",tabIndex:-1,"aria-readonly":"true","aria-labelledby":M,onClick:i?null:function(e){return a.onClickSliderValue(e)}},R)),h.default.createElement("div",{className:"spectrum-Slider-controls",role:"presentation",onPointerDown:i?null:function(e){return a.onPointerDown(e)}},h.default.createElement("div",{className:"spectrum-Slider-background",role:"presentation"}),!P&&h.default.createElement("div",{className:"spectrum-Slider-track",role:"presentation",style:E({},D,100*(T?V:_)+"%")}),P&&h.default.createElement("div",{className:"spectrum-Slider-ramp"},h.default.createElement("svg",{width:"100%",viewBox:"0 0 240 16",preserveAspectRatio:"none","aria-hidden":"true",focusable:"false"},h.default.createElement("path",{d:"M240,4v8c0,2.3-1.9,4.1-4.2,4L1,9C0.4,9,0,8.5,0,8c0-0.5,0.4-1,1-1l234.8-7C238.1-0.1,240,1.7,240,4z"}))),r,this.renderSliderHandle("startHandle"),T&&h.default.createElement("div",{className:"spectrum-Slider-track",role:"presentation",style:(e={},E(e,L,100*V+"%"),E(e,N,100*(1-U)+"%"),e)}),T?this.renderSliderHandle("endHandle"):null,!P&&h.default.createElement("div",{className:"spectrum-Slider-track",role:"presentation",style:E({},D,100*(1-(T?U:_))+"%")}),o&&l?h.default.createElement("div",{className:(0,s.default)("spectrum-Slider-fill",{"spectrum-Slider-fill--right":V>F}),role:"presentation",style:(t={},E(t,L,100*B+"%"),E(t,D,100*(H-B)+"%"),t)}):null))}}])&&v(a.prototype,n),r&&v(a,r),t}(h.default.Component),E(r,"propTypes",{min:d.default.number,max:d.default.number,step:d.default.number,disabled:d.default.bool,orientation:d.default.oneOf(["horizontal","vertical"]),renderLabel:d.default.bool,label:d.default.node,filled:d.default.bool,fillOffset:d.default.number,variant:d.default.oneOf([null,"ramp","range"]),size:d.default.oneOf([null,"S","L"]),onChange:d.default.func,getAriaValueText:d.default.func}),E(r,"defaultProps",{min:0,max:100,step:0,disabled:!1,orientation:"horizontal",renderLabel:!1,label:null,filled:!1,fillOffset:0,variant:null,size:null,onChange:function(){},getAriaValueText:function(e){return e}}),n=i))||n;t.default=O},467:function(e,t,a){},474:function(e,t,a){},475:function(e,t,a){},48:function(e,t,a){"use strict";var n=a(3),r=a(4),i=a(6),o=a(7),s=a(41),l=a.n(s),c=a(0),u=a.n(c),d=a(9),h=a(21),f=a(31),p=a(32),m=a(16),v=a(49),g=a.n(v),b=(a(365),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.controller;e.viewDidMount(this),Object(d.b)("userSurvey:".concat(e.sourceName,":modal"))}},{key:"componentWillUnmount",value:function(){var e=this.props.controller;e.viewWillUnmount(this),Object(d.c)("userSurvey:".concat(e.sourceName,":modal"))}},{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.controller,a=e.message;return u.a.createElement(g.a,{cancelLabel:"No thanks",confirmLabel:"Continue",onConfirm:function(){return t.openSurvey()},onCancel:function(){return t.cancel()},className:"interstitial-dialog",keyboardConfirm:!0,role:"dialog"},u.a.createElement("span",null,a))}}]),a}(c.PureComponent));a.d(t,"a",(function(){return O}));var y="https://selfserve.decipherinc.com/survey/selfserve/9d5/g012/200603?list=1&key=1",E="https://selfserve.decipherinc.com/survey/selfserve/9d5/g012/200603?list=1&key=2",w="https://selfserve.decipherinc.com/survey/selfserve/9d5/g012/200603?list=1&key=3",x="https://selfserve.decipherinc.com/survey/selfserve/9d5/g012/200603?list=1&key=4",k="https://selfserve.decipherinc.com/survey/selfserve/9d5/g012/200603?list=1&key=5",S="https://selfserve.decipherinc.com/survey/selfserve/9d5/g012/200603?list=1&key=6",O=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a),(e=t.call(this)).dialogId=void 0,e.lastPopup=0,e.hasDownloaded=!1,e.url=void 0,e.sourceName=void 0;var r=JSON.parse(localStorage.getItem(a.EVENT_KEY)||"{}");return r.lastPopup&&(e.lastPopup=r.lastPopup),r.hasDownloaded&&(e.hasDownloaded=!!r.hasDownloaded),e}return Object(r.a)(a,[{key:"show",value:function(e){this.dialogId=l.a.show(u.a.createElement(b,{controller:this,message:e}))}},{key:"cancel",value:function(){Object(d.a)("userSurvey:".concat(this.sourceName,":cancel")),this.close()}},{key:"close",value:function(){this.dialogId&&l.a.hide(this.dialogId)}},{key:"showSurveyEditor",value:function(e){var t,a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;var r=Date.now(),i=null!==(t=null===(a=h.a.getParams().interstitial)||void 0===a?void 0:a.preventInterstitial)&&void 0!==t&&t;if(!(!f.a.hasUSEnglish||this.lastPopup>r-2592e6||i)&&!(Math.random()<n)){switch(this.lastPopup=r,this.updateLocalStorage(),e){case m.a.spotheal:this.url=y;break;case m.a.crop:this.url=E;break;case m.a.resize:this.url=w;break;case m.a.adjust:this.url=x;break;case m.a.cutout:this.url=k;break;case m.a.effects:this.url=S;break;default:return}this.sourceName=e,this.show("Tell us how Photoshop Express performed! If you have time to answer 3 questions, please continue.")}}},{key:"showSurveyDownload",value:function(){var e,t;var a=Date.now(),n=null!==(e=null===(t=h.a.getParams().interstitial)||void 0===t?void 0:t.preventInterstitial)&&void 0!==e&&e;!f.a.hasUSEnglish||this.hasDownloaded||this.lastPopup>a-2592e6||n||(this.hasDownloaded=!0,this.lastPopup=a,this.updateLocalStorage(),this.sourceName="download",this.url="https://selfserve.decipherinc.com/survey/selfserve/9d5/g012/200600?list=1&key=1",this.show("Tell us about your overall experience using Photoshop Express and be entered into a raffle for a $100 Amazon Gift Card!"))}},{key:"openSurvey",value:function(){this.url&&f.a.openInNewTab(this.url),Object(d.a)("userSurvey:".concat(this.sourceName,":open")),this.close()}},{key:"updateLocalStorage",value:function(){try{localStorage.setItem(a.EVENT_KEY,JSON.stringify({lastPopup:this.lastPopup,hasDownloaded:this.hasDownloaded}))}catch(e){}}}]),a}(p.a);O.EVENT_KEY="fps_interstitial"},485:function(e,t,a){},492:function(e,t,a){},493:function(e,t,a){},494:function(e,t,a){},495:function(e,t,a){},534:function(e,t,a){},54:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(3),r=a(4),i=function(){function e(t,a){Object(n.a)(this,e),this.steps=void 0,this.currentStep=void 0,this.maxSteps=void 0,this.steps=new Array,this.steps.push(t),this.currentStep=0,this.maxSteps=a}return Object(r.a)(e,[{key:"getCurrent",value:function(){return this.steps[this.currentStep]}},{key:"getLength",value:function(){return this.steps.length}},{key:"clear",value:function(){this.steps=new Array,this.currentStep=0}},{key:"add",value:function(e){this.currentStep<this.steps.length-1&&this.steps.splice(this.currentStep+1),this.steps.push(e),this.currentStep+=1,this.steps.length>this.maxSteps&&(this.steps.splice(0,1),this.currentStep-=1)}},{key:"canUndo",value:function(){return this.currentStep>0}},{key:"undo",value:function(){this.currentStep>0&&(this.currentStep-=1)}},{key:"canRedo",value:function(){return this.currentStep<this.getLength()-1}},{key:"redo",value:function(){this.currentStep<this.getLength()-1&&(this.currentStep+=1)}},{key:"setCurrentStep",value:function(e){e<this.getLength()&&(this.currentStep=e)}}]),e}()},577:function(e,t,a){},578:function(e,t,a){},581:function(e,t,a){},582:function(e,t,a){},583:function(e,t,a){},592:function(e,t,a){},593:function(e,t,a){},598:function(e,t,a){},599:function(e,t,a){},600:function(e,t,a){},601:function(e,t,a){},602:function(e,t,a){},62:function(e,t,a){"use strict";var n=a(3),r=a(4),i=a(0),o=a.n(i),s=a(33);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var u=o.a.createElement("defs",null,o.a.createElement("clipPath",{id:"a"},o.a.createElement("path",{d:"M.06-981.96h36v-36H.06Z",transform:"translate(-0.06 1017.96)",fill:"#6e6e6e"})),o.a.createElement("clipPath",{id:"b"},o.a.createElement("rect",{width:36.002,height:36.009,fill:"#6e6e6e"})),o.a.createElement("clipPath",{id:"c"},o.a.createElement("path",{d:"M36-999.889A18.056,18.056,0,0,0,18-1018,18.056,18.056,0,0,0,0-999.889,18.082,18.082,0,0,0,15.188-982v-12.655H10.618v-5.235h4.571v-3.99c0-4.539,2.687-7.046,6.8-7.046a27.521,27.521,0,0,1,4.029.354v4.457h-2.27a2.61,2.61,0,0,0-2.934,2.828v3.4h4.992l-.8,5.235H20.814V-982A18.082,18.082,0,0,0,36-999.889",transform:"translate(0 1018)",fill:"#6e6e6e",clipRule:"evenodd"})),o.a.createElement("clipPath",{id:"d"},o.a.createElement("path",{d:"M0-981.991H36V-1018H0Z",transform:"translate(0 1018)",fill:"#6e6e6e"})),o.a.createElement("clipPath",{id:"f"},o.a.createElement("rect",{width:36,height:36}))),d=o.a.createElement("g",{clipPath:"url(#b)"},o.a.createElement("g",{clipPath:"url(#c)"},o.a.createElement("g",{clipPath:"url(#d)"},o.a.createElement("path",{d:"M-5-1023H31.354v36.355H-5Z",transform:"translate(4.824 1022.823)",fill:"#6e6e6e"})))),h=function(e){var t=e.svgRef,a=e.title,n=c(e,["svgRef","title"]);return o.a.createElement("svg",l({width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?o.a.createElement("title",null,a):null,u,o.a.createElement("g",{id:"e",clipPath:"url(#f)"},o.a.createElement("g",{transform:"translate(-0.06 1017.96)"},o.a.createElement("g",{transform:"translate(0.06 -1017.96)",clipPath:"url(#a)"},o.a.createElement("g",{transform:"translate(-0.002 -0.001)",style:{isolation:"isolate"}},d)))))},f=o.a.forwardRef((function(e,t){return o.a.createElement(h,l({svgRef:t},e))}));a.p;function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function m(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var v=o.a.createElement("defs",null,o.a.createElement("clipPath",{id:"a"},o.a.createElement("path",{d:"M0-467.845H36v-36H0Z",transform:"translate(0 503.841)",fill:"#6e6e6e"})),o.a.createElement("clipPath",{id:"b"},o.a.createElement("rect",{width:36.011,height:36.011,fill:"#6e6e6e"})),o.a.createElement("clipPath",{id:"c"},o.a.createElement("path",{d:"M18-503.841c-4.889,0-5.5.021-7.421.108a13.212,13.212,0,0,0-4.369.837,8.823,8.823,0,0,0-3.188,2.076,8.822,8.822,0,0,0-2.076,3.188,13.209,13.209,0,0,0-.837,4.369C.021-491.342,0-490.729,0-485.841s.021,5.5.108,7.421a13.21,13.21,0,0,0,.837,4.369,8.823,8.823,0,0,0,2.076,3.188,8.826,8.826,0,0,0,3.188,2.076,13.213,13.213,0,0,0,4.369.837c1.92.088,2.533.108,7.421.108s5.5-.021,7.421-.108a13.213,13.213,0,0,0,4.369-.837,8.826,8.826,0,0,0,3.188-2.076,8.825,8.825,0,0,0,2.076-3.188,13.212,13.212,0,0,0,.837-4.369c.088-1.92.108-2.533.108-7.421s-.021-5.5-.108-7.421a13.212,13.212,0,0,0-.837-4.369,8.823,8.823,0,0,0-2.076-3.188,8.823,8.823,0,0,0-3.188-2.076,13.212,13.212,0,0,0-4.369-.837C23.5-503.82,22.889-503.841,18-503.841Zm0,3.243c4.806,0,5.375.018,7.274.1a9.959,9.959,0,0,1,3.342.62,5.576,5.576,0,0,1,2.07,1.347,5.576,5.576,0,0,1,1.346,2.07,9.959,9.959,0,0,1,.62,3.342c.087,1.9.1,2.467.1,7.274s-.018,5.375-.1,7.273a9.959,9.959,0,0,1-.62,3.342,5.576,5.576,0,0,1-1.346,2.07,5.577,5.577,0,0,1-2.07,1.346,9.959,9.959,0,0,1-3.342.62c-1.9.087-2.467.1-7.274.1s-5.376-.018-7.274-.1a9.959,9.959,0,0,1-3.342-.62,5.577,5.577,0,0,1-2.07-1.346,5.577,5.577,0,0,1-1.346-2.07,9.959,9.959,0,0,1-.62-3.342c-.087-1.9-.1-2.467-.1-7.273s.018-5.376.1-7.274a9.959,9.959,0,0,1,.62-3.342,5.576,5.576,0,0,1,1.346-2.07,5.576,5.576,0,0,1,2.07-1.347,9.959,9.959,0,0,1,3.342-.62c1.9-.087,2.467-.1,7.274-.1Z",transform:"translate(0 503.841)",fill:"#6e6e6e",clipRule:"evenodd"})),o.a.createElement("clipPath",{id:"d"},o.a.createElement("path",{d:"M0-467.989H36.011V-504H0Z",transform:"translate(0 504)",fill:"#6e6e6e"})),o.a.createElement("clipPath",{id:"e"},o.a.createElement("path",{d:"M131.8-366.042a6,6,0,0,1-6-6,6,6,0,0,1,6-6,6,6,0,0,1,6,6A6,6,0,0,1,131.8-366.042Zm0-15.243a9.243,9.243,0,0,0-9.243,9.243A9.243,9.243,0,0,0,131.8-362.8a9.243,9.243,0,0,0,9.243-9.243,9.243,9.243,0,0,0-9.243-9.243Z",transform:"translate(-122.556 381.285)",fill:"#6e6e6e",clipRule:"evenodd"})),o.a.createElement("clipPath",{id:"g"},o.a.createElement("path",{d:"M360.486-414.467a2.16,2.16,0,0,1-2.16,2.16,2.16,2.16,0,0,1-2.16-2.16,2.16,2.16,0,0,1,2.16-2.16,2.16,2.16,0,0,1,2.16,2.16",transform:"translate(-356.166 416.627)",fill:"#6e6e6e",clipRule:"evenodd"})),o.a.createElement("clipPath",{id:"j"},o.a.createElement("rect",{width:36,height:36}))),g=o.a.createElement("g",{clipPath:"url(#b)"},o.a.createElement("g",{transform:"translate(0 0.011)",clipPath:"url(#c)"},o.a.createElement("g",{transform:"translate(0 -0.011)",clipPath:"url(#d)"},o.a.createElement("path",{d:"M-5-508.841H31.715v36.715H-5Z",transform:"translate(4.643 508.495)",fill:"#6e6e6e"})))),b=o.a.createElement("g",{transform:"translate(8.757 8.757)",clipPath:"url(#e)"},o.a.createElement("g",{transform:"translate(-8.757 -8.768)",clipPath:"url(#d)"},o.a.createElement("path",{d:"M117.556-386.285h19.2v19.2h-19.2Z",transform:"translate(-109.156 394.696)",fill:"#6e6e6e"}))),y=o.a.createElement("g",{transform:"translate(25.448 6.232)",clipPath:"url(#g)"},o.a.createElement("g",{transform:"translate(-25.448 -6.243)",clipPath:"url(#d)"},o.a.createElement("path",{d:"M351.166-421.627H356.2v5.035h-5.035Z",transform:"translate(-326.075 427.513)",fill:"#6e6e6e"}))),E=function(e){var t=e.svgRef,a=e.title,n=m(e,["svgRef","title"]);return o.a.createElement("svg",p({width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?o.a.createElement("title",null,a):null,v,o.a.createElement("g",{id:"i",clipPath:"url(#j)"},o.a.createElement("g",{transform:"translate(240 240)"},o.a.createElement("g",{transform:"translate(-240 -240)"},o.a.createElement("g",{transform:"translate(0 0)",clipPath:"url(#a)"},o.a.createElement("g",{transform:"translate(0 -0.011)",style:{isolation:"isolate"}},g)),b,y))))},w=o.a.forwardRef((function(e,t){return o.a.createElement(E,p({svgRef:t},e))}));a.p;function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function k(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var S=o.a.createElement("defs",null,o.a.createElement("clipPath",{id:"a"},o.a.createElement("path",{d:"M0-108H36v-36H0Z",transform:"translate(0 144)",fill:"#6e6e6e"})),o.a.createElement("clipPath",{id:"b"},o.a.createElement("rect",{width:36.249,height:36.015,fill:"#6e6e6e"})),o.a.createElement("clipPath",{id:"c"},o.a.createElement("path",{d:"M30.682-113.305H25.27V-122.7c0-2.772-1.178-3.626-2.7-3.626-1.606,0-3.18,1.209-3.18,3.7v9.326H13.981v-17.2h5.2v2.383h.069a5.9,5.9,0,0,1,5.144-2.867c3.02,0,6.283,1.792,6.283,7.046ZM8.024-132.9A3.064,3.064,0,0,1,4.9-136.01a3.065,3.065,0,0,1,3.12-3.109,3.066,3.066,0,0,1,3.12,3.109A3.064,3.064,0,0,1,8.024-132.9ZM5.318-113.318H10.73v-17.2H5.318ZM33.343-144H2.657A2.658,2.658,0,0,0,0-141.341v30.7a2.658,2.658,0,0,0,2.657,2.659H33.343A2.658,2.658,0,0,0,36-110.644v-30.7A2.658,2.658,0,0,0,33.343-144Z",transform:"translate(0 144)",fill:"#6e6e6e",clipRule:"evenodd"})),o.a.createElement("clipPath",{id:"d"},o.a.createElement("path",{d:"M0-107.985H36V-144H0Z",transform:"translate(0 144)",fill:"#6e6e6e"})),o.a.createElement("clipPath",{id:"f"},o.a.createElement("rect",{width:36,height:36}))),O=o.a.createElement("g",{clipPath:"url(#b)"},o.a.createElement("g",{clipPath:"url(#c)"},o.a.createElement("g",{clipPath:"url(#d)"},o.a.createElement("path",{d:"M-5-149H33.5v38.516H-5Z",transform:"translate(3.75 147.749)",fill:"#6e6e6e"})))),C=function(e){var t=e.svgRef,a=e.title,n=k(e,["svgRef","title"]);return o.a.createElement("svg",x({width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?o.a.createElement("title",null,a):null,S,o.a.createElement("g",{id:"e",clipPath:"url(#f)"},o.a.createElement("g",{transform:"translate(0 144)"},o.a.createElement("g",{transform:"translate(0 -144)",clipPath:"url(#a)"},o.a.createElement("g",{transform:"translate(0 0)",style:{isolation:"isolate"}},O)))))},P=o.a.forwardRef((function(e,t){return o.a.createElement(C,x({svgRef:t},e))}));a.p;function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function A(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var j=o.a.createElement("defs",null,o.a.createElement("clipPath",{id:"a"},o.a.createElement("path",{d:"M.06-206.991h36V-243H.06Z",transform:"translate(-0.06 243)",fill:"#6e6e6e"})),o.a.createElement("clipPath",{id:"b"},o.a.createElement("rect",{width:36.009,height:36.009,fill:"#6e6e6e"})),o.a.createElement("clipPath",{id:"c"},o.a.createElement("path",{d:"M18-243A18,18,0,0,0,0-225a18.014,18.014,0,0,0,11.443,16.772,17.3,17.3,0,0,1,.062-5.17c.327-1.405,2.111-8.949,2.111-8.949a6.5,6.5,0,0,1-.539-2.673c0-2.5,1.451-4.372,3.258-4.372a2.262,2.262,0,0,1,2.278,2.536c0,1.545-.984,3.854-1.491,5.995a2.614,2.614,0,0,0,2.666,3.254c3.2,0,5.66-3.374,5.66-8.245,0-4.311-3.1-7.325-7.521-7.325a7.793,7.793,0,0,0-8.13,7.813,7,7,0,0,0,1.34,4.109.538.538,0,0,1,.125.516c-.137.569-.44,1.792-.5,2.042-.079.33-.261.4-.6.241-2.249-1.047-3.655-4.334-3.655-6.975,0-5.68,4.127-10.9,11.9-10.9,6.246,0,11.1,4.451,11.1,10.4,0,6.205-3.912,11.2-9.343,11.2a4.819,4.819,0,0,1-4.126-2.067s-.9,3.438-1.122,4.28a20.111,20.111,0,0,1-2.238,4.72,18,18,0,0,0,5.331.8,18,18,0,0,0,18-18,18,18,0,0,0-18-18",transform:"translate(0 243)",fill:"#6e6e6e",clipRule:"evenodd"})),o.a.createElement("clipPath",{id:"d"},o.a.createElement("path",{d:"M0-206.991H36.009V-243H0Z",transform:"translate(0 243)",fill:"#6e6e6e"})),o.a.createElement("clipPath",{id:"f"},o.a.createElement("rect",{width:36,height:36}))),I=o.a.createElement("g",{clipPath:"url(#b)"},o.a.createElement("g",{clipPath:"url(#c)"},o.a.createElement("g",{clipPath:"url(#d)"},o.a.createElement("path",{d:"M-5-248H32.491v37.491H-5Z",transform:"translate(4.259 247.259)",fill:"#6e6e6e"})))),M=function(e){var t=e.svgRef,a=e.title,n=A(e,["svgRef","title"]);return o.a.createElement("svg",T({width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?o.a.createElement("title",null,a):null,j,o.a.createElement("g",{id:"e",clipPath:"url(#f)"},o.a.createElement("g",{transform:"translate(-0.06 243)"},o.a.createElement("g",{transform:"translate(0.06 -243)",clipPath:"url(#a)"},o.a.createElement("g",{transform:"translate(-0.009 0)",style:{isolation:"isolate"}},I)))))},R=o.a.forwardRef((function(e,t){return o.a.createElement(M,T({svgRef:t},e))}));a.p;function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function D(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var L=o.a.createElement("defs",null,o.a.createElement("clipPath",{id:"b"},o.a.createElement("rect",{width:36,height:36}))),N=o.a.createElement("g",{id:"a",clipPath:"url(#b)"},o.a.createElement("g",{transform:"translate(-54.305 -55.32)"},o.a.createElement("path",{d:"M90.176,81.252a2.5,2.5,0,0,0-1.269-1.347c-.1-.06-.2-.108-.276-.144-.162-.084-.327-.165-.492-.25a10.742,10.742,0,0,1-3.928-3.369,7.639,7.639,0,0,1-.674-1.2.566.566,0,0,1-.018-.466.759.759,0,0,1,.216-.225c.291-.192.59-.387.794-.519.362-.235.649-.42.834-.552a4.549,4.549,0,0,0,1.484-1.578A3.143,3.143,0,0,0,87,69a3.087,3.087,0,0,0-2.988-1.962,4.117,4.117,0,0,0-.869.092c-.076.017-.153.034-.227.053.013-.828-.006-1.7-.079-2.562a9.341,9.341,0,0,0-2.424-5.872,9.658,9.658,0,0,0-2.464-1.983,11.753,11.753,0,0,0-11.282,0A9.623,9.623,0,0,0,64.2,58.749a9.348,9.348,0,0,0-2.424,5.872c-.074.86-.092,1.738-.08,2.562-.075-.019-.15-.037-.226-.053a4.116,4.116,0,0,0-.869-.092A3.086,3.086,0,0,0,57.61,69a3.147,3.147,0,0,0,.152,2.613,4.561,4.561,0,0,0,1.485,1.578c.184.129.472.315.834.552.2.127.482.313.763.5a.819.819,0,0,1,.245.246.58.58,0,0,1-.027.489,7.57,7.57,0,0,1-.663,1.171,10.712,10.712,0,0,1-3.815,3.311c-.867.46-1.769.767-2.15,1.8a2.277,2.277,0,0,0,.63,2.418h0a3.646,3.646,0,0,0,.92.7,9.965,9.965,0,0,0,2.251.9,1.487,1.487,0,0,1,.454.2c.266.233.228.583.582,1.1a2.557,2.557,0,0,0,.666.677,4.371,4.371,0,0,0,2.463.579,9.369,9.369,0,0,1,2.74.407,7.037,7.037,0,0,1,1.39.736A10.157,10.157,0,0,0,78.1,88.965a7.164,7.164,0,0,1,1.371-.724,9.339,9.339,0,0,1,2.74-.407,4.371,4.371,0,0,0,2.463-.579,2.565,2.565,0,0,0,.758-.828c.255-.433.248-.736.488-.947a1.409,1.409,0,0,1,.427-.2,10,10,0,0,0,2.281-.909,3.587,3.587,0,0,0,.966-.756l.009-.011A2.248,2.248,0,0,0,90.176,81.252Zm-2.523,1.356c-1.539.85-2.562.759-3.357,1.271-.676.435-.276,1.373-.767,1.712-.6.417-2.387-.029-4.691.731-1.9.628-3.113,2.435-6.531,2.435s-4.6-1.8-6.533-2.439c-2.3-.761-4.087-.315-4.691-.731-.49-.338-.092-1.277-.767-1.712-.8-.512-1.819-.421-3.357-1.267-.98-.541-.424-.876-.1-1.034,5.574-2.7,6.463-6.865,6.5-7.174a.985.985,0,0,0-.311-1.049c-.4-.368-2.165-1.462-2.655-1.8-.811-.567-1.168-1.132-.905-1.828a1.091,1.091,0,0,1,1.1-.662,2.051,2.051,0,0,1,.442.05c.89.193,1.755.639,2.254.76a.8.8,0,0,0,.184.025c.267,0,.361-.134.342-.44a32.55,32.55,0,0,1-.041-4.647,7.367,7.367,0,0,1,1.932-4.72A9.311,9.311,0,0,1,78.9,60.073a7.352,7.352,0,0,1,1.932,4.72,31.744,31.744,0,0,1-.041,4.647c-.021.321.075.44.342.44a.788.788,0,0,0,.184-.025c.5-.12,1.365-.567,2.255-.76a2.052,2.052,0,0,1,.442-.05,1.092,1.092,0,0,1,1.1.662c.263.7-.092,1.261-.9,1.828-.49.342-2.257,1.435-2.655,1.8a.983.983,0,0,0-.311,1.049c.04.314.928,4.48,6.5,7.174C88.077,81.728,88.633,82.063,87.653,82.608Z",fill:"#6e6e6e"}))),V=function(e){var t=e.svgRef,a=e.title,n=D(e,["svgRef","title"]);return o.a.createElement("svg",_({width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?o.a.createElement("title",null,a):null,L,N)},U=o.a.forwardRef((function(e,t){return o.a.createElement(V,_({svgRef:t},e))}));a.p;function F(){return(F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function B(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var H=o.a.createElement("rect",{className:"cls-1",x:28,y:22,width:2,height:36}),z=o.a.createElement("rect",{className:"cls-1",x:50,y:22,width:2,height:36}),G=o.a.createElement("path",{className:"fill",d:"M78,18H2a2,2,0,0,0-2,2V60a2,2,0,0,0,2,2H78a2,2,0,0,0,2-2V20A2,2,0,0,0,78,18ZM76,58H4V22H76Z"}),W=function(e){var t=e.svgRef,a=e.title,n=B(e,["svgRef","title"]);return o.a.createElement("svg",F({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},n),a?o.a.createElement("title",null,a):null,H,z,G)},Z=o.a.forwardRef((function(e,t){return o.a.createElement(W,F({svgRef:t},e))}));a.p;function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function K(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var X=o.a.createElement("rect",{className:"cls-1",x:24,y:20,width:2,height:40}),q=o.a.createElement("rect",{className:"cls-1",x:54,y:20,width:2,height:40}),J=o.a.createElement("path",{className:"fill",d:"M74,16H6a2,2,0,0,0-2,2V62a2,2,0,0,0,2,2H74a2,2,0,0,0,2-2V18A2,2,0,0,0,74,16ZM72,60H8V20H72Z"}),Q=function(e){var t=e.svgRef,a=e.title,n=K(e,["svgRef","title"]);return o.a.createElement("svg",Y({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},n),a?o.a.createElement("title",null,a):null,X,q,J)},$=o.a.forwardRef((function(e,t){return o.a.createElement(Q,Y({svgRef:t},e))}));a.p;function ee(){return(ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function te(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var ae=o.a.createElement("rect",{className:"cls-1",x:22,y:20,width:2,height:40}),ne=o.a.createElement("rect",{className:"cls-1",x:56,y:20,width:2,height:40}),re=o.a.createElement("path",{className:"fill",d:"M70,16H10a2,2,0,0,0-2,2V62a2,2,0,0,0,2,2H70a2,2,0,0,0,2-2V18A2,2,0,0,0,70,16ZM68,60H12V20H68Z"}),ie=function(e){var t=e.svgRef,a=e.title,n=te(e,["svgRef","title"]);return o.a.createElement("svg",ee({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},n),a?o.a.createElement("title",null,a):null,ae,ne,re)},oe=o.a.forwardRef((function(e,t){return o.a.createElement(ie,ee({svgRef:t},e))}));a.p;function se(){return(se=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function le(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var ce=o.a.createElement("rect",{className:"cls-1",x:22,y:20,width:2,height:40}),ue=o.a.createElement("rect",{className:"cls-1",x:56,y:20,width:2,height:40}),de=o.a.createElement("path",{className:"fill",d:"M68,16H12a2,2,0,0,0-2,2V62a2,2,0,0,0,2,2H68a2,2,0,0,0,2-2V18A2,2,0,0,0,68,16ZM66,60H14V20H66Z"}),he=function(e){var t=e.svgRef,a=e.title,n=le(e,["svgRef","title"]);return o.a.createElement("svg",se({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},n),a?o.a.createElement("title",null,a):null,ce,ue,de)},fe=o.a.forwardRef((function(e,t){return o.a.createElement(he,se({svgRef:t},e))}));a.p;function pe(){return(pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function me(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var ve=o.a.createElement("rect",{className:"cls-1",x:24,y:20,width:2,height:40}),ge=o.a.createElement("rect",{className:"cls-1",x:54,y:20,width:2,height:40}),be=o.a.createElement("path",{className:"fill",d:"M72,16H8a2,2,0,0,0-2,2V62a2,2,0,0,0,2,2H72a2,2,0,0,0,2-2V18A2,2,0,0,0,72,16ZM70,60H10V20H70Z"}),ye=function(e){var t=e.svgRef,a=e.title,n=me(e,["svgRef","title"]);return o.a.createElement("svg",pe({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},n),a?o.a.createElement("title",null,a):null,ve,ge,be)},Ee=o.a.forwardRef((function(e,t){return o.a.createElement(ye,pe({svgRef:t},e))}));a.p;function we(){return(we=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function xe(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var ke=o.a.createElement("path",{className:"fill",d:"M69.63,16H10.37A2.385,2.385,0,0,0,8,18.4V61.6A2.385,2.385,0,0,0,10.37,64H69.63A2.385,2.385,0,0,0,72,61.6V18.4A2.385,2.385,0,0,0,69.63,16ZM68,60H12V20H68Z"}),Se=o.a.createElement("path",{id:"arrow_fill","data-name":"arrow fill",className:"fill",d:"M33.373,34.622,28.242,29.49l1.975-1.978a.5.5,0,0,0-.354-.854H24v5.864a.5.5,0,0,0,.854.354L26.829,30.9l5.134,5.132a.5.5,0,0,0,.707,0l.7-.711A.5.5,0,0,0,33.373,34.622Z"}),Oe=o.a.createElement("path",{id:"arrow_fill-2","data-name":"arrow fill",className:"fill",d:"M44.627,46.694l5.131,5.132L47.783,53.8a.5.5,0,0,0,0,.707.494.494,0,0,0,.355.147H54V48.794a.5.5,0,0,0-.854-.354l-1.975,1.975-5.134-5.132a.5.5,0,0,0-.707,0l-.7.711A.5.5,0,0,0,44.627,46.694Z"}),Ce=o.a.createElement("path",{id:"arrow_fill-3","data-name":"arrow fill",className:"fill",d:"M44.627,34.622l5.131-5.132-1.975-1.978a.5.5,0,0,1,.354-.854H54v5.864a.5.5,0,0,1-.854.354L51.171,30.9l-5.134,5.132a.5.5,0,0,1-.707,0l-.7-.711A.5.5,0,0,1,44.627,34.622Z"}),Pe=o.a.createElement("path",{id:"arrow_fill-4","data-name":"arrow fill",className:"fill",d:"M33.373,46.694l-5.131,5.132L30.217,53.8a.5.5,0,0,1,0,.707.494.494,0,0,1-.355.147H24V48.794a.5.5,0,0,1,.854-.354l1.975,1.975,5.134-5.132a.5.5,0,0,1,.707,0l.7.711A.5.5,0,0,1,33.373,46.694Z"}),Te=function(e){var t=e.svgRef,a=e.title,n=xe(e,["svgRef","title"]);return o.a.createElement("svg",we({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},n),a?o.a.createElement("title",null,a):null,ke,Se,Oe,Ce,Pe)},Ae=o.a.forwardRef((function(e,t){return o.a.createElement(Te,we({svgRef:t},e))}));a.p;function je(){return(je=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Ie(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Me=o.a.createElement("rect",{className:"cls-1",x:23,y:20,width:2,height:40}),Re=o.a.createElement("rect",{className:"cls-1",x:55,y:20,width:2,height:40}),_e=o.a.createElement("path",{className:"fill",d:"M69.63,16H10.37A2.385,2.385,0,0,0,8,18.4V61.6A2.385,2.385,0,0,0,10.37,64H69.63A2.385,2.385,0,0,0,72,61.6V18.4A2.385,2.385,0,0,0,69.63,16ZM68,60H12V20H68Z"}),De=function(e){var t=e.svgRef,a=e.title,n=Ie(e,["svgRef","title"]);return o.a.createElement("svg",je({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},n),a?o.a.createElement("title",null,a):null,Me,Re,_e)},Le=o.a.forwardRef((function(e,t){return o.a.createElement(De,je({svgRef:t},e))}));a.p;function Ne(){return(Ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Ve(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Ue=o.a.createElement("path",{className:"fill",d:"M61.63,16H18.37A2.385,2.385,0,0,0,16,18.4V61.6A2.385,2.385,0,0,0,18.37,64H61.63A2.385,2.385,0,0,0,64,61.6V18.4A2.385,2.385,0,0,0,61.63,16ZM60,60H20V20H60Z"}),Fe=function(e){var t=e.svgRef,a=e.title,n=Ve(e,["svgRef","title"]);return o.a.createElement("svg",Ne({id:"icons",width:80,height:80,viewBox:"0 0 80 80",ref:t},n),a?o.a.createElement("title",null,a):null,Ue)},Be=o.a.forwardRef((function(e,t){return o.a.createElement(Fe,Ne({svgRef:t},e))}));a.p;function He(){return(He=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ze(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Ge=o.a.createElement("defs",null,o.a.createElement("clipPath",{id:"b"},o.a.createElement("rect",{width:36,height:36}))),We=o.a.createElement("g",{id:"a",clipPath:"url(#b)"},o.a.createElement("rect",{width:36,height:36,fill:"none"}),o.a.createElement("path",{d:"M82.076,116.733A13.045,13.045,0,0,0,95.21,103.6c0-.2,0-.4-.014-.6a9.392,9.392,0,0,0,2.3-2.389,9.214,9.214,0,0,1-2.651.726,4.632,4.632,0,0,0,2.029-2.553,9.251,9.251,0,0,1-2.931,1.12,4.621,4.621,0,0,0-7.867,4.21,13.106,13.106,0,0,1-9.514-4.823A4.62,4.62,0,0,0,78,105.455a4.582,4.582,0,0,1-2.1-.578v.059a4.618,4.618,0,0,0,3.7,4.525,4.609,4.609,0,0,1-2.084.079,4.621,4.621,0,0,0,4.313,3.206,9.263,9.263,0,0,1-5.733,1.98,9.393,9.393,0,0,1-1.1-.067,13.069,13.069,0,0,0,7.076,2.07",transform:"translate(-68.25 -89.59)",fill:"#6e6e6e"})),Ze=function(e){var t=e.svgRef,a=e.title,n=ze(e,["svgRef","title"]);return o.a.createElement("svg",He({width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?o.a.createElement("title",null,a):null,Ge,We)},Ye=o.a.forwardRef((function(e,t){return o.a.createElement(Ze,He({svgRef:t},e))}));a.p;function Ke(){return(Ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Xe(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var qe=o.a.createElement("defs",null,o.a.createElement("clipPath",{id:"b"},o.a.createElement("rect",{width:36,height:36}))),Je=o.a.createElement("g",{id:"a",clipPath:"url(#b)"},o.a.createElement("g",{transform:"translate(-0.06 128.959)"},o.a.createElement("path",{d:"M17.994,25.364c-.028,0-2.852,0-5.982-.095-1.839-.055-3.421-.131-4.7-.225a20.861,20.861,0,0,1-3.383-.438A4.525,4.525,0,0,1,.74,21.4a23.468,23.468,0,0,1-.567-3.98C.064,15.988.018,14.591,0,13.672V11.684c.018-.919.064-2.316.173-3.75A23.462,23.462,0,0,1,.74,3.954,4.524,4.524,0,0,1,3.924.749C6.116.158,13.481.028,16.545,0h2.9c3.064.028,10.428.158,12.621.749a4.524,4.524,0,0,1,3.184,3.2,27.833,27.833,0,0,1,.659,5.422c.093,1.807.094,3.287.094,3.3s0,1.5-.094,3.3a30.576,30.576,0,0,1-.659,5.422,4.525,4.525,0,0,1-3.184,3.2,20.862,20.862,0,0,1-3.383.438c-1.283.094-2.866.17-4.7.225C20.845,25.363,18.022,25.364,17.994,25.364ZM14.311,7.323V18.032l9.412-5.354Z",transform:"translate(0.06 -123.959)",fill:"#6e6e6e"}))),Qe=function(e){var t=e.svgRef,a=e.title,n=Xe(e,["svgRef","title"]);return o.a.createElement("svg",Ke({width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?o.a.createElement("title",null,a):null,qe,Je)},$e=o.a.forwardRef((function(e,t){return o.a.createElement(Qe,Ke({svgRef:t},e))})),et=(a.p,a(35));a.d(t,"a",(function(){return at})),a.d(t,"b",(function(){return tt})),a.d(t,"c",(function(){return nt}));var tt,at="custom";!function(e){e[e.KEEP=0]="KEEP",e[e.CUTOUT=1]="CUTOUT"}(tt||(tt={}));var nt=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,null,[{key:"getUIAspectRatios",value:function(e,t){return[{key:"photos",name:e("CropView.Controls.Select.AspectRatio.Group.Photos","Photos"),aspectRatios:[{icon:o.a.createElement(s.a,{size:"M",icon:o.a.createElement(Le,null)}),key:"original",label:e("CropView.Controls.Select.AspectRatio.Original","Original"),ratio:t},{icon:o.a.createElement(s.a,{size:"M",icon:o.a.createElement(Ae,null)}),key:at,label:e("CropView.Controls.Select.AspectRatio.Custom","Custom"),ratio:0},{icon:o.a.createElement(s.a,{size:"M",icon:o.a.createElement(Be,null)}),key:"square",label:e("CropView.Controls.Select.AspectRatio.Square","Square"),ratio:1},{icon:o.a.createElement(s.a,{size:"M",icon:o.a.createElement(fe,null)}),key:"5x4",label:e("CropView.Controls.Select.AspectRatio.5x4","5:4"),ratio:1.25},{icon:o.a.createElement(s.a,{size:"M",icon:o.a.createElement(oe,null)}),key:"4x3",label:e("CropView.Controls.Select.AspectRatio.4x3","4:3"),ratio:1.3333333333333333},{icon:o.a.createElement(s.a,{size:"M",icon:o.a.createElement($,null)}),key:"3x2",label:e("CropView.Controls.Select.AspectRatio.3x2","3:2"),ratio:1.5},{icon:o.a.createElement(s.a,{size:"M",icon:o.a.createElement(Ee,null)}),key:"7x5",label:e("CropView.Controls.Select.AspectRatio.7x5","7:5"),ratio:1.4},{icon:o.a.createElement(s.a,{size:"M",icon:o.a.createElement(Z,null)}),key:"16x9",label:e("CropView.Controls.Select.AspectRatio.16x9","16:9"),ratio:1.7777777777777777}]},{key:"facebook",name:e("CropView.Controls.Select.AspectRatio.Group.Facebook","Facebook"),aspectRatios:[{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(f,null)}),key:"fb_profile",label:e("CropView.Controls.Select.AspectRatio.FBProfile","Facebook profile"),ratio:1,width:180,height:180},{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(f,null)}),key:"fb_profile_cover",label:e("CropView.Controls.Select.AspectRatio.FBProfileCover","Facebook profile cover"),ratio:2.628205128205128,width:820,height:312},{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(f,null)}),key:"fb_event",label:e("CropView.Controls.Select.AspectRatio.FBEvent","Facebook event"),ratio:1.7777777777777777,width:1920,height:1080}]},{key:"linkedin",name:e("CropView.Controls.Select.AspectRatio.Group.LinkedIn","LinkedIn"),aspectRatios:[{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(P,null)}),key:"li_profile",label:e("CropView.Controls.Select.AspectRatio.LIProfile","LinkedIn profile"),ratio:1,width:400,height:400},{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(P,null)}),key:"li_background",label:e("CropView.Controls.Select.AspectRatio.LIBackground","LinkedIn background"),ratio:4,width:1584,height:396}]},{key:"youtube",name:e("CropView.Controls.Select.AspectRatio.Group.Youtube","Youtube"),aspectRatios:[{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement($e,null)}),key:"yt_profile",label:e("CropView.Controls.Select.AspectRatio.YTProfile","Youtube profile"),ratio:1,width:800,height:800},{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement($e,null)}),key:"yt_cover",label:e("CropView.Controls.Select.AspectRatio.YTCover","Youtube cover"),ratio:1.7777777777777777,width:2560,height:1440},{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement($e,null)}),key:"yt_thumbnail",label:e("CropView.Controls.Select.AspectRatio.YTThumbnail","Youtube thumbnail"),ratio:1.7777777777777777,width:1280,height:720}]},{key:"twitter",name:e("CropView.Controls.Select.AspectRatio.Group.Twitter","Twitter"),aspectRatios:[{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(Ye,null)}),key:"tw_header",label:e("CropView.Controls.Select.AspectRatio.TWHeader","Twitter header"),ratio:3,width:1500,height:500},{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(Ye,null)}),key:"tw_post",label:e("CropView.Controls.Select.AspectRatio.TWPost","Twitter post"),ratio:2,width:440,height:220},{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(Ye,null)}),key:"tw_profile",label:e("CropView.Controls.Select.AspectRatio.TWProfile","Twitter profile"),ratio:1,width:400,height:400}]},{key:"instagram",name:e("CropView.Controls.Select.AspectRatio.Group.Instagram","Instagram"),aspectRatios:[{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(w,null)}),key:"ig_profile",label:e("CropView.Controls.Select.AspectRatio.IGProfile","Instagram profile"),ratio:1,width:110,height:110},{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(w,null)}),key:"ig_stories",label:e("CropView.Controls.Select.AspectRatio.IGStories","Instagram stories"),ratio:.5625,width:1080,height:1920},{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(w,null)}),key:"ig_post",label:e("CropView.Controls.Select.AspectRatio.IGPost","Instagram post"),ratio:1,width:1080,height:1080}]},{key:"pinterest",name:e("CropView.Controls.Select.AspectRatio.Group.Pinterest","Pinterest"),aspectRatios:[{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(R,null)}),key:"p_profile",label:e("CropView.Controls.Select.AspectRatio.PProfile","Pinterest profile"),ratio:1,width:165,height:165}]},{key:"snapchat",name:e("CropView.Controls.Select.AspectRatio.Group.Snapchat","Snapchat"),aspectRatios:[{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(U,null)}),key:"sc_snap",label:e("CropView.Controls.Select.AspectRatio.SCSnap","Snapchat snap"),ratio:.5625,width:1080,height:1920},{icon:o.a.createElement(s.a,{size:"S",icon:o.a.createElement(U,null)}),key:"sc_story",label:e("CropView.Controls.Select.AspectRatio.SCStory","Snapchat story"),ratio:.5625,width:1080,height:1920}]}]}},{key:"loadShapes",value:function(){this.images.heart.src="data:image/svg+xml;base64,".concat(et.b.HEART_BASE64),this.images.octagon.src="data:image/svg+xml;base64,".concat(et.b.OCTAGON_BASE64),this.images.roundedRect.src="data:image/svg+xml;base64,".concat(et.b.ROUNDED_RECT_BASE64),this.images.star.src="data:image/svg+xml;base64,".concat(et.b.STAR_BASE64)}},{key:"applyShape",value:function(e,t,a,n,r,i,o){var s;switch(t){case et.a.HEART:s=this.images.heart;break;case et.a.OCTAGON:s=this.images.octagon;break;case et.a.ROUNDED_RECT:s=this.images.roundedRect;break;case et.a.STAR:s=this.images.star;break;default:return}var l=e.globalCompositeOperation,c=e.globalAlpha;switch(a){case tt.CUTOUT:e.globalAlpha=1,e.globalCompositeOperation="destination-out";break;case tt.KEEP:default:e.globalAlpha=1,e.globalCompositeOperation="destination-in"}e.drawImage(s,n,r,i,o),e.globalCompositeOperation=l,e.globalAlpha=c}}]),e}();nt.images={heart:document.createElement("img"),octagon:document.createElement("img"),roundedRect:document.createElement("img"),star:document.createElement("img")},nt.loadShapes()},650:function(e,t,a){},651:function(e,t,a){},652:function(e,t,a){},653:function(e,t,a){},661:function(e,t,a){},672:function(e,t,a){},675:function(e,t,a){},678:function(e,t,a){},679:function(e,t,a){},686:function(e,t,a){},687:function(e,t,a){},688:function(e,t,a){},689:function(e,t){window.NREUM||(NREUM={}),__nr_require=function(e,t,a){function n(a){if(!t[a]){var r=t[a]={exports:{}};e[a][0].call(r.exports,(function(t){return n(e[a][1][t]||t)}),r,r.exports)}return t[a].exports}if("function"==typeof __nr_require)return __nr_require;for(var r=0;r<a.length;r++)n(a[r]);return n}({1:[function(e,t,a){function n(e){try{s.console&&console.log(e)}catch(t){}}var r,i=e("ee"),o=e(25),s={};try{r=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(s.console=!0,-1!==r.indexOf("dev")&&(s.dev=!0),-1!==r.indexOf("nr_dev")&&(s.nrDev=!0))}catch(l){}s.nrDev&&i.on("internal-error",(function(e){n(e.stack)})),s.dev&&i.on("fn-err",(function(e,t,a){n(a.stack)})),s.dev&&(n("NR AGENT IN DEVELOPMENT MODE"),n("flags: "+o(s,(function(e,t){return e})).join(", ")))},{}],2:[function(e,t,a){function n(e,t,a){this.message=e||"Uncaught error with no additional information",this.sourceURL=t,this.line=a}function r(e,t){var a=t?null:l.now();i("err",[e,a])}var i=e("handle"),o=e(26),s=e("ee"),l=e("loader"),c=e("gos"),u=window.onerror,d=!1,h="nr@seenError",f=0;l.features.err=!0,e(1),window.onerror=function(e,t,a,s,h){try{f?f-=1:r(h||new n(e,t,a),!0)}catch(c){try{i("ierr",[c,l.now(),!0])}catch(d){}}return"function"==typeof u&&u.apply(this,o(arguments))};try{throw new Error}catch(p){"stack"in p&&(e(13),e(12),"addEventListener"in window&&e(6),l.xhrWrappable&&e(14),d=!0)}s.on("fn-start",(function(e,t,a){d&&(f+=1)})),s.on("fn-err",(function(e,t,a){d&&!a[h]&&(c(a,h,(function(){return!0})),this.thrown=!0,r(a))})),s.on("fn-end",(function(){d&&!this.thrown&&f>0&&(f-=1)})),s.on("internal-error",(function(e){i("ierr",[e,l.now(),!0])}))},{}],3:[function(e,t,a){e("loader").features.ins=!0},{}],4:[function(e,t,a){function n(){I++,j=b.hash,this[u]=y.now()}function r(){I--,b.hash!==j&&i(0,!0);var e=y.now();this[p]=~~this[p]+e-this[u],this[d]=e}function i(e,t){x.emit("newURL",[""+b,t])}function o(e,t){e.on(t,(function(){this[t]=y.now()}))}var s="-start",l="-end",c="-body",u="fn"+s,d="fn"+l,h="cb"+s,f="cb"+l,p="jsTime",m="fetch",v="addEventListener",g=window,b=g.location,y=e("loader");if(g[v]&&y.xhrWrappable){var E=e(10),w=e(11),x=e(8),k=e(6),S=e(13),O=e(7),C=e(14),P=e(9),T=e("ee"),A=T.get("tracer");e(16),y.features.spa=!0;var j,I=0;T.on(u,n),T.on(h,n),T.on(d,r),T.on(f,r),T.buffer([u,d,"xhr-done","xhr-resolved"]),k.buffer([u]),S.buffer(["setTimeout"+l,"clearTimeout"+s,u]),C.buffer([u,"new-xhr","send-xhr"+s]),O.buffer([m+s,m+"-done",m+c+s,m+c+l]),x.buffer(["newURL"]),E.buffer([u]),w.buffer(["propagate",h,f,"executor-err","resolve"+s]),A.buffer([u,"no-"+u]),P.buffer(["new-jsonp","cb-start","jsonp-error","jsonp-end"]),o(C,"send-xhr"+s),o(T,"xhr-resolved"),o(T,"xhr-done"),o(O,m+s),o(O,m+"-done"),o(P,"new-jsonp"),o(P,"jsonp-end"),o(P,"cb-start"),x.on("pushState-end",i),x.on("replaceState-end",i),g[v]("hashchange",i,!0),g[v]("load",i,!0),g[v]("popstate",(function(){i(0,I>1)}),!0)}},{}],5:[function(e,t,a){function n(e){}if(window.performance&&window.performance.timing&&window.performance.getEntriesByType){var r=e("ee"),i=e("handle"),o=e(13),s=e(12),l="learResourceTimings",c="addEventListener",u="resourcetimingbufferfull",d="bstResource",h="resource",f="-start",p="-end",m="fn"+f,v="fn"+p,g="bstTimer",b="pushState",y=e("loader");y.features.stn=!0,e(8),"addEventListener"in window&&e(6);var E=NREUM.o.EV;r.on(m,(function(e,t){e[0]instanceof E&&(this.bstStart=y.now())})),r.on(v,(function(e,t){var a=e[0];a instanceof E&&i("bst",[a,t,this.bstStart,y.now()])})),o.on(m,(function(e,t,a){this.bstStart=y.now(),this.bstType=a})),o.on(v,(function(e,t){i(g,[t,this.bstStart,y.now(),this.bstType])})),s.on(m,(function(){this.bstStart=y.now()})),s.on(v,(function(e,t){i(g,[t,this.bstStart,y.now(),"requestAnimationFrame"])})),r.on(b+f,(function(e){this.time=y.now(),this.startPath=location.pathname+location.hash})),r.on(b+p,(function(e){i("bstHist",[location.pathname+location.hash,this.startPath,this.time])})),c in window.performance&&(window.performance["c"+l]?window.performance[c](u,(function(e){i(d,[window.performance.getEntriesByType(h)]),window.performance["c"+l]()}),!1):window.performance[c]("webkit"+u,(function(e){i(d,[window.performance.getEntriesByType(h)]),window.performance["webkitC"+l]()}),!1)),document[c]("scroll",n,{passive:!0}),document[c]("keypress",n,!1),document[c]("click",n,!1)}},{}],6:[function(e,t,a){function n(e){for(var t=e;t&&!t.hasOwnProperty(u);)t=Object.getPrototypeOf(t);t&&r(t)}function r(e){s.inPlace(e,[u,d],"-",i)}function i(e,t){return e[1]}var o=e("ee").get("events"),s=e("wrap-function")(o,!0),l=e("gos"),c=XMLHttpRequest,u="addEventListener",d="removeEventListener";t.exports=o,"getPrototypeOf"in Object?(n(document),n(window),n(c.prototype)):c.prototype.hasOwnProperty(u)&&(r(window),r(c.prototype)),o.on(u+"-start",(function(e,t){var a=e[1],n=l(a,"nr@wrapped",(function(){var e={object:function(){if("function"==typeof a.handleEvent)return a.handleEvent.apply(a,arguments)},function:a}[typeof a];return e?s(e,"fn-",null,e.name||"anonymous"):a}));this.wrapped=e[1]=n})),o.on(d+"-start",(function(e){e[1]=this.wrapped||e[1]}))},{}],7:[function(e,t,a){function n(e,t,a){var n=e[t];"function"==typeof n&&(e[t]=function(){var e,t=i(arguments),o={};r.emit(a+"before-start",[t],o),o[p]&&o[p].dt&&(e=o[p].dt);var s=n.apply(this,t);return r.emit(a+"start",[t,e],s),s.then((function(e){return r.emit(a+"end",[null,e],s),e}),(function(e){throw r.emit(a+"end",[e],s),e}))})}var r=e("ee").get("fetch"),i=e(26),o=e(25);t.exports=r;var s=window,l="fetch-",c=l+"body-",u=s.Request,d=s.Response,h=s.fetch,f="prototype",p="nr@context";u&&d&&h&&(o(["arrayBuffer","blob","json","text","formData"],(function(e,t){n(u[f],t,c),n(d[f],t,c)})),n(s,"fetch",l),r.on(l+"end",(function(e,t){var a=this;if(t){var n=t.headers.get("content-length");null!==n&&(a.rxSize=n),r.emit(l+"done",[null,t],a)}else r.emit(l+"done",[e],a)})))},{}],8:[function(e,t,a){var n=e("ee").get("history"),r=e("wrap-function")(n);t.exports=n;var i=window.history&&window.history.constructor&&window.history.constructor.prototype,o=window.history;i&&i.pushState&&i.replaceState&&(o=i),r.inPlace(o,["pushState","replaceState"],"-")},{}],9:[function(e,t,a){function n(e){var t=e.match(l);return t?t[1]:null}function r(e,t){var a=e.match(u),n=a[1],i=a[3];return i?r(i,t[n]):t[n]}function i(e){var t=e.match(c);return t&&t.length>=3?{key:t[2],parent:r(t[1],window)}:{key:e,parent:window}}var o=e("ee").get("jsonp"),s=e("wrap-function")(o);if(t.exports=o,"addEventListener"in window){var l=/[?&](?:callback|cb)=([^&#]+)/,c=/(.*)\.([^.]+)/,u=/^(\w+)(\.|$)(.*)$/,d=["appendChild","insertBefore","replaceChild"];Node&&Node.prototype&&Node.prototype.appendChild?s.inPlace(Node.prototype,d,"dom-"):(s.inPlace(HTMLElement.prototype,d,"dom-"),s.inPlace(HTMLHeadElement.prototype,d,"dom-"),s.inPlace(HTMLBodyElement.prototype,d,"dom-")),o.on("dom-start",(function(e){!function(e){function t(){o.emit("jsonp-end",[],c),e.removeEventListener("load",t,!1),e.removeEventListener("error",a,!1)}function a(){o.emit("jsonp-error",[],c),o.emit("jsonp-end",[],c),e.removeEventListener("load",t,!1),e.removeEventListener("error",a,!1)}if(e&&"string"==typeof e.nodeName&&"script"===e.nodeName.toLowerCase()&&"function"==typeof e.addEventListener){var r=n(e.src);if(r){var l=i(r);if("function"==typeof l.parent[l.key]){var c={};s.inPlace(l.parent,[l.key],"cb-",c),e.addEventListener("load",t,!1),e.addEventListener("error",a,!1),o.emit("new-jsonp",[e.src],c)}}}}(e[0])}))}},{}],10:[function(e,t,a){var n=e("ee").get("mutation"),r=e("wrap-function")(n),i=NREUM.o.MO;t.exports=n,i&&(window.MutationObserver=function(e){return this instanceof i?new i(r(e,"fn-")):i.apply(this,arguments)},MutationObserver.prototype=i.prototype)},{}],11:[function(e,t,a){function n(e){var t=i.context(),a=o(e,"executor-",t),n=new l(a);return i.context(n).getCtx=function(){return t},i.emit("new-promise",[n,t],t),n}var r=e("wrap-function"),i=e("ee").get("promise"),o=r(i),s=e(25),l=NREUM.o.PR;t.exports=i,l&&(window.Promise=n,["all","race"].forEach((function(e){var t=l[e];l[e]=function(a){function n(e){return function(){i.emit("propagate",[null,!r],o),r=r||!e}}var r=!1;s(a,(function(t,a){Promise.resolve(a).then(n("all"===e),n(!1))}));var o=t.apply(l,arguments),c=l.resolve(o);return c}})),["resolve","reject"].forEach((function(e){var t=l[e];l[e]=function(e){var a=t.apply(l,arguments);return e!==a&&i.emit("propagate",[e,!0],a),a}})),l.prototype.catch=function(e){return this.then(null,e)},l.prototype=Object.create(l.prototype,{constructor:{value:n}}),s(Object.getOwnPropertyNames(l),(function(e,t){try{n[t]=l[t]}catch(a){}})),i.on("executor-start",(function(e){e[0]=o(e[0],"resolve-",this),e[1]=o(e[1],"resolve-",this)})),i.on("executor-err",(function(e,t,a){e[1](a)})),o.inPlace(l.prototype,["then"],"then-",(function(e,t){return t})),i.on("then-start",(function(e,t){this.promise=t,e[0]=o(e[0],"cb-",this),e[1]=o(e[1],"cb-",this)})),i.on("then-end",(function(e,t,a){this.nextPromise=a;var n=this.promise;i.emit("propagate",[n,!0],a)})),i.on("cb-end",(function(e,t,a){i.emit("propagate",[a,!0],this.nextPromise)})),i.on("propagate",(function(e,t,a){this.getCtx&&!t||(this.getCtx=function(){if(e instanceof Promise)var t=i.context(e);return t&&t.getCtx?t.getCtx():this})})),n.toString=function(){return""+l})},{}],12:[function(e,t,a){var n=e("ee").get("raf"),r=e("wrap-function")(n),i="equestAnimationFrame";t.exports=n,r.inPlace(window,["r"+i,"mozR"+i,"webkitR"+i,"msR"+i],"raf-"),n.on("raf-start",(function(e){e[0]=r(e[0],"fn-")}))},{}],13:[function(e,t,a){var n=e("ee").get("timer"),r=e("wrap-function")(n),i="setTimeout",o="setInterval",s="clearTimeout",l="-start";t.exports=n,r.inPlace(window,[i,"setImmediate"],i+"-"),r.inPlace(window,[o],o+"-"),r.inPlace(window,[s,"clearImmediate"],s+"-"),n.on(o+l,(function(e,t,a){e[0]=r(e[0],"fn-",null,a)})),n.on(i+l,(function(e,t,a){this.method=a,this.timerDuration=isNaN(e[1])?0:+e[1],e[0]=r(e[0],"fn-",this,a)}))},{}],14:[function(e,t,a){function n(e,t){c.inPlace(t,["onreadystatechange"],"fn-",o)}function r(){var e=this,t=l.context(e);e.readyState>3&&!t.resolved&&(t.resolved=!0,l.emit("xhr-resolved",[],e)),c.inPlace(e,v,"fn-",o)}function i(){for(var e=0;e<g.length;e++)n(0,g[e]);g.length&&(g=[])}function o(e,t){return t}e(6);var s=e("ee"),l=s.get("xhr"),c=e("wrap-function")(l),u=NREUM.o,d=u.XHR,h=u.MO,f=u.PR,p=u.SI,m="readystatechange",v=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],g=[];t.exports=l;var b=window.XMLHttpRequest=function(e){var t=new d(e);try{l.emit("new-xhr",[t],t),t.addEventListener(m,r,!1)}catch(a){try{l.emit("internal-error",[a])}catch(n){}}return t};if(function(e,t){for(var a in e)t[a]=e[a]}(d,b),b.prototype=d.prototype,c.inPlace(b.prototype,["open","send"],"-xhr-",o),l.on("send-xhr-start",(function(e,t){n(0,t),function(e){g.push(e),h&&(y?y.then(i):p?p(i):(E=-E,w.data=E))}(t)})),l.on("open-xhr-start",n),h){var y=f&&f.resolve();if(!p&&!f){var E=1,w=document.createTextNode(E);new h(i).observe(w,{characterData:!0})}}else s.on("fn-end",(function(e){e[0]&&e[0].type===m||i()}))},{}],15:[function(e,t,a){function n(e){var t=!1,a=!1,n={};if("init"in NREUM&&"distributed_tracing"in NREUM.init&&(a=!!(n=NREUM.init.distributed_tracing).enabled),a)if(e.sameOrigin)t=!0;else if(n.allowed_origins instanceof Array)for(var r=0;r<n.allowed_origins.length;r++){var o=i(n.allowed_origins[r]);if(e.hostname===o.hostname&&e.protocol===o.protocol&&e.port===o.port){t=!0;break}}return a&&t}var r=e(23),i=e(17);t.exports={generateTracePayload:function(e){if(!n(e))return null;var t=window.NREUM;if(!t.loader_config)return null;var a=(t.loader_config.accountID||"").toString()||null,i=(t.loader_config.agentID||"").toString()||null,o=(t.loader_config.trustKey||"").toString()||null;if(!a||!i)return null;var s=r.generateCatId(),l=r.generateCatId(),c=Date.now();return{header:function(e,t,a,n,r,i){if(!("btoa"in window)||"function"!=typeof window.btoa)return null;var o={v:[0,1],d:{ty:"Browser",ac:n,ap:r,id:e,tr:t,ti:a}};return i&&n!==i&&(o.d.tk=i),btoa(JSON.stringify(o))}(s,l,c,a,i,o),guid:s,traceId:l,timestamp:c}},shouldGenerateTrace:n}},{}],16:[function(e,t,a){function n(e){var t=this.params,a=this.metrics;if(!this.ended){this.ended=!0;for(var n=0;n<d;n++)e.removeEventListener(u[n],this.listener,!1);t.aborted||(a.duration=i.now()-this.startTime,this.loadCaptureCalled||4!==e.readyState?null==t.status&&(t.status=0):r(this,e),a.cbTime=this.cbTime,c.emit("xhr-done",[e],e),o("xhr",[t,a,this.startTime]))}}function r(e,t){e.params.status=t.status;var a=m(t,e.lastSize);if(a&&(e.metrics.rxSize=a),e.sameOrigin){var n=t.getResponseHeader("X-NewRelic-App-Data");n&&(e.params.cat=n.split(", ").pop())}e.loadCaptureCalled=!0}var i=e("loader");if(i.xhrWrappable){var o=e("handle"),s=e(17),l=e(15).generateTracePayload,c=e("ee"),u=["load","error","abort","timeout"],d=u.length,h=e("id"),f=e(21),p=e(20),m=e(18),v=window.XMLHttpRequest;i.features.xhr=!0,e(14),e(7),c.on("new-xhr",(function(e){var t=this;t.totalCbs=0,t.called=0,t.cbTime=0,t.end=n,t.ended=!1,t.xhrGuids={},t.lastSize=null,t.loadCaptureCalled=!1,e.addEventListener("load",(function(a){r(t,e)}),!1),f&&(f>34||f<10)||window.opera||e.addEventListener("progress",(function(e){t.lastSize=e.loaded}),!1)})),c.on("open-xhr-start",(function(e){this.params={method:e[0]},function(e,t){var a=s(t),n=e.params;n.host=a.hostname+":"+a.port,n.pathname=a.pathname,e.parsedOrigin=s(t),e.sameOrigin=e.parsedOrigin.sameOrigin}(this,e[1]),this.metrics={}})),c.on("open-xhr-end",(function(e,t){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&t.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid);var a=l(this.parsedOrigin);a&&a.header&&(t.setRequestHeader("newrelic",a.header),this.dt=a)})),c.on("send-xhr-start",(function(e,t){var a=this.metrics,n=e[0],r=this;if(a&&n){var o=p(n);o&&(a.txSize=o)}this.startTime=i.now(),this.listener=function(e){try{"abort"!==e.type||r.loadCaptureCalled||(r.params.aborted=!0),("load"!==e.type||r.called===r.totalCbs&&(r.onloadCalled||"function"!=typeof t.onload))&&r.end(t)}catch(a){try{c.emit("internal-error",[a])}catch(n){}}};for(var s=0;s<d;s++)t.addEventListener(u[s],this.listener,!1)})),c.on("xhr-cb-time",(function(e,t,a){this.cbTime+=e,t?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof a.onload||this.end(a)})),c.on("xhr-load-added",(function(e,t){var a=""+h(e)+!!t;this.xhrGuids&&!this.xhrGuids[a]&&(this.xhrGuids[a]=!0,this.totalCbs+=1)})),c.on("xhr-load-removed",(function(e,t){var a=""+h(e)+!!t;this.xhrGuids&&this.xhrGuids[a]&&(delete this.xhrGuids[a],this.totalCbs-=1)})),c.on("addEventListener-end",(function(e,t){t instanceof v&&"load"===e[0]&&c.emit("xhr-load-added",[e[1],e[2]],t)})),c.on("removeEventListener-end",(function(e,t){t instanceof v&&"load"===e[0]&&c.emit("xhr-load-removed",[e[1],e[2]],t)})),c.on("fn-start",(function(e,t,a){t instanceof v&&("onload"===a&&(this.onload=!0),("load"===(e[0]&&e[0].type)||this.onload)&&(this.xhrCbStart=i.now()))})),c.on("fn-end",(function(e,t){this.xhrCbStart&&c.emit("xhr-cb-time",[i.now()-this.xhrCbStart,this.onload,t],t)})),c.on("fetch-before-start",(function(e){var t,a=e[1]||{};"string"==typeof e[0]?t=e[0]:e[0]&&e[0].url&&(t=e[0].url),t&&(this.parsedOrigin=s(t),this.sameOrigin=this.parsedOrigin.sameOrigin);var n=l(this.parsedOrigin);if(n&&n.header){var r=n.header;if("string"==typeof e[0]){var i={};for(var o in a)i[o]=a[o];i.headers=new Headers(a.headers||{}),i.headers.set("newrelic",r),this.dt=n,e.length>1?e[1]=i:e.push(i)}else e[0]&&e[0].headers&&(e[0].headers.append("newrelic",r),this.dt=n)}}))}},{}],17:[function(e,t,a){var n={};t.exports=function(e){if(e in n)return n[e];var t=document.createElement("a"),a=window.location,r={};t.href=e,r.port=t.port;var i=t.href.split("://");!r.port&&i[1]&&(r.port=i[1].split("/")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===i[0]?"443":"80"),r.hostname=t.hostname||a.hostname,r.pathname=t.pathname,r.protocol=i[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname);var o=!t.protocol||":"===t.protocol||t.protocol===a.protocol,s=t.hostname===document.domain&&t.port===a.port;return r.sameOrigin=o&&(!t.hostname||s),"/"===r.pathname&&(n[e]=r),r}},{}],18:[function(e,t,a){var n=e(20);t.exports=function(e,t){var a=e.responseType;return"json"===a&&null!==t?t:"arraybuffer"===a||"blob"===a||"json"===a?n(e.response):"text"===a||"document"===a||""===a||void 0===a?n(e.responseText):void 0}},{}],19:[function(e,t,a){function n(){}function r(e,t,a){return function(){return i(e,[c.now()].concat(s(arguments)),t?null:this,a),t?void 0:this}}var i=e("handle"),o=e(25),s=e(26),l=e("ee").get("tracer"),c=e("loader"),u=NREUM;"undefined"==typeof window.newrelic&&(newrelic=u);var d="api-",h=d+"ixn-";o(["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],(function(e,t){u[t]=r(d+t,!0,"api")})),u.addPageAction=r(d+"addPageAction",!0),u.setCurrentRouteName=r(d+"routeName",!0),t.exports=newrelic,u.interaction=function(){return(new n).get()};var f=n.prototype={createTracer:function(e,t){var a={},n=this,r="function"==typeof t;return i(h+"tracer",[c.now(),e,a],n),function(){if(l.emit((r?"":"no-")+"fn-start",[c.now(),n,r],a),r)try{return t.apply(this,arguments)}catch(e){throw l.emit("fn-err",[arguments,this,e],a),e}finally{l.emit("fn-end",[c.now()],a)}}}};o("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),(function(e,t){f[t]=r(h+t)})),newrelic.noticeError=function(e,t){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now(),!1,t])}},{}],20:[function(e,t,a){t.exports=function(e){if("string"==typeof e&&e.length)return e.length;if("object"==typeof e){if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer&&e.byteLength)return e.byteLength;if("undefined"!=typeof Blob&&e instanceof Blob&&e.size)return e.size;if(!("undefined"!=typeof FormData&&e instanceof FormData))try{return JSON.stringify(e).length}catch(t){return}}}},{}],21:[function(e,t,a){var n=0,r=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);r&&(n=+r[1]),t.exports=n},{}],22:[function(e,t,a){function n(e){if(e instanceof l&&!c){var t,a=Math.round(e.timeStamp);t=a>1e12?Date.now()-a:s.now()-a,c=!0,o("timing",["fi",a,{type:e.type,fid:t}])}}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&!1===NREUM.init.page_view_timing.enabled)){var r,i,o=e("handle"),s=e("loader"),l=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){r=new PerformanceObserver((function(e,t){e.getEntries().forEach((function(e){"first-paint"===e.name?o("timing",["fp",Math.floor(e.startTime)]):"first-contentful-paint"===e.name&&o("timing",["fcp",Math.floor(e.startTime)])}))})),i=new PerformanceObserver((function(e,t){var a=e.getEntries();a.length>0&&o("lcp",[a[a.length-1]])}));try{r.observe({entryTypes:["paint"]}),i.observe({entryTypes:["largest-contentful-paint"]})}catch(u){}}if("addEventListener"in document){var c=!1;["click","keydown","mousedown","pointerdown","touchstart"].forEach((function(e){document.addEventListener(e,n,!1)}))}}},{}],23:[function(e,t,a){t.exports={generateUuid:function(){function e(){return t?15&t[a++]:16*Math.random()|0}var t=null,a=0,n=window.crypto||window.msCrypto;n&&n.getRandomValues&&(t=n.getRandomValues(new Uint8Array(31)));for(var r,i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="",s=0;s<i.length;s++)"x"===(r=i[s])?o+=e().toString(16):"y"===r?o+=(r=3&e()|8).toString(16):o+=r;return o},generateCatId:function(){var e=null,t=0,a=window.crypto||window.msCrypto;a&&a.getRandomValues&&Uint8Array&&(e=a.getRandomValues(new Uint8Array(31)));for(var n=[],r=0;r<16;r++)n.push((e?15&e[t++]:16*Math.random()|0).toString(16));return n.join("")}}},{}],24:[function(e,t,a){var n=null,r=null;if(navigator.userAgent){var i=navigator.userAgent,o=i.match(/Version\/(\S+)\s+Safari/);o&&-1===i.indexOf("Chrome")&&-1===i.indexOf("Chromium")&&(n="Safari",r=o[1])}t.exports={agent:n,version:r,match:function(e,t){if(!n)return!1;if(e!==n)return!1;if(!t)return!0;if(!r)return!1;for(var a=r.split("."),i=t.split("."),o=0;o<i.length;o++)if(i[o]!==a[o])return!1;return!0}}},{}],25:[function(e,t,a){var n=Object.prototype.hasOwnProperty;t.exports=function(e,t){var a=[],r="",i=0;for(r in e)n.call(e,r)&&(a[i]=t(r,e[r]),i+=1);return a}},{}],26:[function(e,t,a){t.exports=function(e,t,a){t||(t=0),"undefined"==typeof a&&(a=e?e.length:0);for(var n=-1,r=a-t||0,i=Array(r<0?0:r);++n<r;)i[n]=e[t+n];return i}},{}],27:[function(e,t,a){t.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,t,a){function n(){}function r(){return new n}function i(){(c.api||c.feature)&&(d.aborted=!0,c=d.backlog={})}var o="nr@context",s=e("gos"),l=e(25),c={},u={},d=t.exports=function e(t){function a(e){return e&&e instanceof n?e:e?s(e,o,r):r()}function h(e,n,r,i){if(!d.aborted||i){t&&t(e,n,r);for(var o=a(r),s=p(e),l=s.length,u=0;u<l;u++)s[u].apply(o,n);var h=c[v[e]];return h&&h.push([g,e,n,o]),o}}function f(e,t){m[e]=p(e).concat(t)}function p(e){return m[e]||[]}var m={},v={},g={on:f,addEventListener:f,removeEventListener:function(e,t){var a=m[e];if(a)for(var n=0;n<a.length;n++)a[n]===t&&a.splice(n,1)},emit:h,get:function(t){return u[t]=u[t]||e(h)},listeners:p,context:a,buffer:function(e,t){l(e,(function(e,a){t=t||"feature",v[a]=t,t in c||(c[t]=[])}))},abort:i,aborted:!1};return g}();d.backlog=c},{}],gos:[function(e,t,a){var n=Object.prototype.hasOwnProperty;t.exports=function(e,t,a){if(n.call(e,t))return e[t];var r=a();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[t]=r,r}},{}],handle:[function(e,t,a){function n(e,t,a,n){r.buffer([e],n),r.emit(e,t,a)}var r=e("ee").get("handle");t.exports=n,n.ee=r},{}],id:[function(e,t,a){var n=1,r="nr@id",i=e("gos");t.exports=function(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:i(e,r,(function(){return n++}))}},{}],loader:[function(e,t,a){function n(){if(!w++){var e=E.info=NREUM.info,t=h.getElementsByTagName("script")[0];if(setTimeout(c.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&t))return c.abort();l(b,(function(t,a){e[t]||(e[t]=a)})),s("mark",["onload",i()+E.offset],null,"api");var a=h.createElement("script");a.src="https://"+e.agent,t.parentNode.insertBefore(a,t)}}function r(){s("mark",["domContent",i()+E.offset],null,"api")}function i(){return x.exists&&performance.now?Math.round(performance.now()):(o=Math.max((new Date).getTime(),o))-E.offset}var o=(new Date).getTime(),s=e("handle"),l=e(25),c=e("ee"),u=e(24),d=window,h=d.document,f="addEventListener",p="attachEvent",m=d.XMLHttpRequest,v=m&&m.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:m,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var g=""+location,b={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-spa-1167.min.js"},y=m&&v&&v[f]&&!/CriOS/.test(navigator.userAgent),E=t.exports={offset:o,now:i,origin:g,features:{},xhrWrappable:y,userAgent:u};e(19),e(22),h[f]?(h[f]("DOMContentLoaded",r,!1),d[f]("load",n,!1)):(h[p]("onreadystatechange",(function(){"complete"===h.readyState&&r()})),d[p]("onload",n)),s("mark",["firstbyte",o],null,"api");var w=0,x=e(27)},{}],"wrap-function":[function(e,t,a){function n(e){return!(e&&e instanceof Function&&e.apply&&!e[o])}var r=e("ee"),i=e(26),o="nr@original",s=Object.prototype.hasOwnProperty,l=!1;t.exports=function(e,t){function a(e,t,a,r){function l(){var n,o,s,l;try{o=this,n=i(arguments),s="function"==typeof a?a(n,o):a||{}}catch(d){u([d,"",[n,o,r],s])}c(t+"start",[n,o,r],s);try{return l=e.apply(o,n)}catch(h){throw c(t+"err",[n,o,h],s),h}finally{c(t+"end",[n,o,l],s)}}return n(e)?e:(t||(t=""),l[o]=e,function(e,t){if(Object.defineProperty&&Object.keys)try{return Object.keys(e).forEach((function(a){Object.defineProperty(t,a,{get:function(){return e[a]},set:function(t){return e[a]=t,t}})})),t}catch(n){u([n])}for(var a in e)s.call(e,a)&&(t[a]=e[a])}(e,l),l)}function c(a,n,r){if(!l||t){var i=l;l=!0;try{e.emit(a,n,r,t)}catch(o){u([o,a,n,r])}l=i}}function u(t){try{e.emit("internal-error",t)}catch(a){}}return e||(e=r),a.inPlace=function(e,t,r,i){r||(r="");var o,s,l,c="-"===r.charAt(0);for(l=0;l<t.length;l++)n(o=e[s=t[l]])||(e[s]=a(o,c?s+r:r,i,s))},a.flag=o,a}},{}]},{},["loader",2,16,5,3,4]),NREUM.loader_config={accountID:"2617885",trustKey:"1322840",agentID:"635596742",licenseKey:"NRJS-ded7a5b2c46fbe94259",applicationID:"635596742"},NREUM.info={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",licenseKey:"NRJS-ded7a5b2c46fbe94259",applicationID:"635596742",sa:1}},690:function(e,t,a){},694:function(e,t,a){"use strict";a.r(t);a(250);var n,r=a(67),i=a(2),o=a.n(i),s=a(8),l=a(3),c=a(4),u=a(38),d=a(11),h=a(10),f=a(6),p=a(7),m=a(0),v=a.n(m),g=a(15),b=a.n(g),y=a(47),E=a(17),w=a(36),x=a(18),k=a(31),S=parseInt("1",10),O=parseInt("31536000000",10),C=function(){function e(t){Object(l.a)(this,e),this.doc=void 0,this.doc=t}return Object(c.a)(e,[{key:"download",value:function(){var t=Object(s.a)(o.a.mark((function t(a,n,r){var i,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.doc.getImageData(),t.next=3,e.downloadImageData(i,a,n,r);case 3:if(!this.doc.isFileSampleImage()&&(s=this.getQuota()))try{localStorage.setItem("fps_quota",JSON.stringify({timestamp:s.timestamp,count:s.count+1,last:w.b.getInstance().getUserAccessLevel()}))}catch(o){}case 4:case"end":return t.stop()}}),t,this)})));return function(e,a,n){return t.apply(this,arguments)}}()},{key:"canDownload",value:function(){return this.doc.isFileSampleImage()||0!==this.getNumberOfRemainingDownloads()}},{key:"getNumberOfRemainingDownloads",value:function(){var e=w.b.getInstance().getUserAccessLevel();if(e===w.a.paid||e===w.a.free)return-1;var t=this.getQuota(e);return t&&e===w.a.anonymous?Math.max(0,S-t.count):0}},{key:"getQuota",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{var t=JSON.parse(localStorage.getItem("fps_quota")||"{}");if(!t.count)return{timestamp:Date.now(),count:0};var a=e||w.b.getInstance().getUserAccessLevel(),n=t.timestamp,r=t.count,i=t.last,o=Date.now();return a===w.a.anonymous&&o>n+O&&(n=o,r=0),{timestamp:n,count:r,last:i}}catch(s){return null}}}],[{key:"downloadImageData",value:function(){var t=Object(s.a)(o.a.mark((function t(a,n,r,i){var s,l,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r,t.next=t.t0===E.a.PNG?3:t.t0===E.a.JPG?7:11;break;case 3:return t.next=5,x.a.createBlob(a,"image/png");case 5:return s=t.sent,t.abrupt("break",12);case 7:return t.next=9,x.a.createBlob(a,"image/jpeg",i,"white");case 9:return s=t.sent,t.abrupt("break",12);case 11:throw new Error("unknown format");case 12:l=n,e.hasCorrectFileExt(l,r)||(l+=e.getFileExt(r,!0)),c=document.createElement("a"),document.body.appendChild(c),c.download=l,c.href=window.URL.createObjectURL(s),c.click();case 19:case"end":return t.stop()}}),t)})));return function(e,a,n,r){return t.apply(this,arguments)}}()},{key:"getFileExt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t?".":"";return e===E.a.JPG?a+="jpg":e===E.a.PNG&&(a+="png"),a}},{key:"hasCorrectFileExt",value:function(e,t){return t===E.a.PNG?"png"===k.a.getFileExt(e):t===E.a.JPG&&"jpg"===k.a.getFileExt(e)}}]),e}(),P=a(41),T=a.n(P),A=a(195),j=a.n(A),I=a(20),M=a(60),R=a.n(M);!function(e){e.click="click",e.display="display"}(n||(n={}));var _=function(){function e(){Object(l.a)(this,e),this.tests=void 0}return Object(c.a)(e,[{key:"loadTests",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,a,n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.tests=new Map,"".concat("agedashi:app:downloads").split(",").forEach((function(e){var t;null===(t=n.tests)||void 0===t||t.set(e,void 0)})),t=Object(I.map)(Array.from(this.tests.keys()),(function(e,t){return{index:t+1,name:e}})),a=0;case 5:if(!(a<10)||void 0!==window.adobe&&void 0!==window.adobe.target){e.next=11;break}return e.next=8,k.a.wait(100);case 8:a+=1,e.next=5;break;case 11:if(void 0!==window.adobe&&void 0!==window.adobe.target){e.next=14;break}return console.error("target could not be loaded"),e.abrupt("return",Promise.resolve());case 14:return e.abrupt("return",new Promise((function(e,a){window.adobe.target.getOffers({request:{property:{token:"2bb70f5a-cc1f-79c3-a659-66e4e32dc3fc"},prefetch:{mboxes:t}},timeout:3e3}).then((function(t){console.log("getOffers",t),t.prefetch&&t.prefetch.mboxes.forEach((function(e){var t;e.options&&e.options.length>0&&"json"===e.options[0].type&&(null===(t=n.tests)||void 0===t||t.set(e.name,e))})),e()})).catch((function(t){console.error(t),e()}))})));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTestContent",value:function(e){if(!this.tests)throw new Error("load tests first!");var t=this.tests.get(e);return null===t||void 0===t?void 0:t.options[0].content}},{key:"sendNotification",value:function(e,t){if(!this.tests)throw new Error("load tests first!");var a=this.tests.get(e);a&&window.adobe.target.sendNotifications({request:{notifications:[{id:R.a.v4(),type:t,timestamp:Date.now(),tokens:a.options.map((function(e){return e.eventToken})),mbox:{name:a.name,state:a.state}}]}})}}],[{key:"getInstance",value:function(){return e.instance}}]),e}();_.instance=new _;var D=a(21),L=a(32),N=a(48),V=a(14),U=a.n(V),F=a(49),B=a.n(F),H=a(196),z=a.n(H),G=a(71),W=a.n(G),Z=a(197),Y=a.n(Z),K=a(9),X=a(1),q=(a(374),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),Object(K.b)("postDownloadupsell:modal")}},{key:"componentWillUnmount",value:function(){var e=this.props.controller;e.viewWillUnmount(this),e.clearDialogId(),Object(K.c)("postDownloadupsell:modal")}},{key:"refresh",value:function(){}},{key:"handleClose",value:function(){Object(K.a)("postDownloadupsell:close"),this.props.controller.close()}},{key:"render",value:function(){var e=this,t=this.props.controller;return v.a.createElement(B.a,{className:"postDownloadModal"},v.a.createElement("div",{className:"dialog-close"},v.a.createElement(U.a,{variant:"tool",onClick:function(){return e.handleClose()},icon:v.a.createElement(W.a,{className:"close-icon"})})),v.a.createElement("div",{className:"postDownload"},v.a.createElement(z.a,{size:"XL",className:"icon"}),v.a.createElement("h1",{className:"title"},Object(X.b)("PostDownloadUpsell.DownloadStarted","Your download has started")),v.a.createElement(Y.a,{variant:"medium"}),v.a.createElement("div",{className:"image"},v.a.createElement("img",{src:"https://static-assets.photoshop.adobe.com/sample/dialogs/PostDownloadUpsellAsset_bird_256x191.png",alt:"Start free trial"})),v.a.createElement("h2",{className:"ctaTitle"},Object(X.b)("PostDownloadUpsell.WantNextLevel","Want to take your edits to the next level?")),v.a.createElement("div",{className:"ctaSubtitle"},Object(X.b)("PostDownloadUpsell.TryPS","Get the power of Photoshop and Photoshop Lightroom on desktop and mobile to create amazing photos anywhere and transform them into anything you can imagine.")),v.a.createElement("div",{className:"cta-buttons"},v.a.createElement(U.a,{onClick:function(){Object(K.a)("postDownloadupsell:learnMore"),t.learnMore()}},Object(X.b)("PostDownloadUpsell.Button.LearnMore","Learn more")),v.a.createElement(U.a,{autoFocus:!0,onClick:function(){Object(K.a)("postDownloadupsell:startFreeTrial"),t.startFreeTrial()},variant:"cta"},Object(X.b)("PostDownloadUpsell.Button.StartFreeTrial","Start free trial")))))}}]),a}(m.PureComponent)),J=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"show",value:function(){void 0===a.dialogId&&(a.dialogId=T.a.show(v.a.createElement(q,{controller:this})))}},{key:"close",value:function(){a.dialogId&&T.a.hide(a.dialogId)}},{key:"clearDialogId",value:function(){a.dialogId=void 0}},{key:"learnMore",value:function(){var e=k.a.getLocalizedURL("https://www.adobe.com/creativecloud/photography.html");k.a.openInNewTab(e),this.close()}},{key:"startFreeTrial",value:function(){var e=k.a.getLocalizedURL("https://www.adobe.com/products/photoshop-lightroom/compare-plans.html");k.a.openInNewTab(e),this.close()}}]),a}(L.a);J.dialogId=void 0;var Q,$=a(52),ee=a.n($),te=a(200),ae=a.n(te),ne=a(106),re=a.n(ne),ie=a(201),oe=a.n(ie),se=a(50),le=a.n(se),ce=a(75),ue=a(140),de=a.n(ue),he=a(59),fe=a.n(he),pe=a(39),me=a.n(pe),ve=(a(467),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,e)).imgRef=Object(m.createRef)(),n.formatIds=void 0,n.previewImageData=void 0;var r=n.props,i=r.fileName,o=r.saveInitMode,s=r.targetFormat,c=r.imageData,u=o===Q.COMPRESS;n.formatIds=new Map,n.formatIds.set(0,E.a.JPG),n.formatIds.set(1,E.a.PNG);var d=n.getIdByFormat(null!==s&&void 0!==s?s:E.a.JPG);return o===Q.COMPRESS&&(d=n.getIdByFormat(E.a.JPG)),n.state={quality:92,qualityString:Object(X.b)("SaveAs.JPG.GoodQuality","Good"),qualityClass:"quality-good",fileName:i,fileSize:"",fileTypeId:d,imageWidth:0,imageHeight:0,showTooltip:u},n.previewImageData=x.a.resizeImageDataToWidth(c,400)||c,n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),this.loadImageData(),Object(K.b)("download:modal")}},{key:"componentWillUnmount",value:function(){var e=this.props.controller;e.viewWillUnmount(this),e.clearDialogId(),Object(K.c)("download:modal")}},{key:"refresh",value:function(){}},{key:"getIdByFormat",value:function(e){var t=0;return this.formatIds.forEach((function(a,n){e===a&&(t=n)})),t}},{key:"handleFileFormatChange",value:function(e){var t=this,a=this.state.quality;this.setState({fileTypeId:e},(function(){switch(t.formatIds.get(e)){case E.a.JPG:t.setState({qualityString:t.getQualityString(a),qualityClass:t.getQualityClassname(a)}),Object(K.a)("selectDownloadFileFormat",{action:"JPG"});break;case E.a.PNG:t.setState({qualityString:t.getQualityString(100),qualityClass:t.getQualityClassname(100)}),Object(K.a)("selectDownloadFileFormat",{action:"PNG"});break;default:throw new Error("unknown format")}t.calcSize(),t.refreshPreview(a)}))}},{key:"handleSaveFile",value:function(){var e=this.props.controller,t=this.state,a=t.fileName,n=t.quality,r=t.fileTypeId,i=a.trim();k.a.hasSupportedFileExt(i)&&(i=i.split(".").slice(0,-1).join(".")),e.saveImage(i,this.formatIds.get(r)||E.a.JPG,n)}},{key:"handleCancel",value:function(){this.props.controller.close()}},{key:"handleClose",value:function(){this.props.controller.close()}},{key:"handleNameChange",value:function(e){this.setState({fileName:e})}},{key:"handleQualityChange",value:function(e){var t=this;this.setState({quality:e,qualityString:this.getQualityString(e),qualityClass:this.getQualityClassname(e)},(function(){return t.refreshPreview(e)}))}},{key:"refreshPreview",value:function(e){var t=this.state.fileTypeId,a=e;this.getIdByFormat(E.a.PNG)===t&&(a=100);var n=x.a.createDataUrl(this.previewImageData,"image/jpeg",a/100);this.imgRef&&this.imgRef.current&&(this.imgRef.current.style.backgroundImage="url(".concat(n,")"))}},{key:"onKeyUp",value:function(e){switch(e.key.toLowerCase()){case"enter":Object(K.a)("downloadImage"),this.handleSaveFile()}}},{key:"getQualityString",value:function(e){var t=this.state.fileTypeId;return 100===e&&this.formatIds.get(t)===E.a.PNG?Object(X.b)("SaveAs.JPG.ExtremelyHighQuality","Extremely high quality image"):e>=80?Object(X.b)("SaveAs.JPG.GoodQuality","Good quality image"):e>=50?Object(X.b)("SaveAs.JPG.LowQuality","Low quality image"):Object(X.b)("SaveAs.JPG.ExtremelyLowQuality","Extremely low quality image")}},{key:"getQualityClassname",value:function(e){return e>=80?"quality-good":e>=50?"quality-low":"quality-extreme-low"}},{key:"calcSize",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,a,n,r,i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.imageData,a=this.state,n=a.quality,r=a.fileTypeId,i=null,(s=this.formatIds.get(r))!==E.a.JPG){e.next=10;break}return e.next=7,x.a.createBlob(t,"image/jpeg",n/100,"white");case 7:i=e.sent,e.next=14;break;case 10:if(s!==E.a.PNG){e.next=14;break}return e.next=13,x.a.createBlob(t,"image/png");case 13:i=e.sent;case 14:i&&this.setState({fileSize:k.a.humanFileSize(i.size)});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadImageData",value:function(){var e=this.props.targetFormat,t=this.props.imageData,a=x.a.hasAlpha(t)?this.getIdByFormat(E.a.PNG):this.getIdByFormat(E.a.JPG);e&&(a=this.getIdByFormat(e)),this.handleFileFormatChange(a),this.setState({imageWidth:t.width,imageHeight:t.height});var n=x.a.createDataUrl(this.previewImageData);this.imgRef&&this.imgRef.current&&(this.imgRef.current.style.backgroundImage="url(".concat(n,")"))}},{key:"hideTooltip",value:function(){this.setState({showTooltip:!1})}},{key:"render",value:function(){var e=this,t=this.state,a=t.fileName,n=t.fileTypeId,r=t.quality,i=t.qualityString,o=t.qualityClass,s=t.fileSize,l=t.imageWidth,c=t.imageHeight,u=t.showTooltip,d=this.props.saveInitMode,h=v.a.createElement(re.a,{size:"XL"}),f=Object(X.b)("SaveAs.Title","Download Image");switch(d){case Q.CONVERT:h=v.a.createElement(oe.a,{size:"XL"}),f=Object(X.b)("SaveAs.TitleConvert","Convert Image");break;case Q.COMPRESS:h=v.a.createElement(ae.a,{size:"XL"}),f=Object(X.b)("SaveAs.TitleCompress","Compress Image")}return v.a.createElement(B.a,{className:"image-edit-confirm"},v.a.createElement("div",{className:"dialog-close"},v.a.createElement(U.a,{variant:"tool",onClick:function(){return e.handleClose()},icon:v.a.createElement(W.a,{style:{color:"var(--spectrum-global-color-gray-50)"}})})),v.a.createElement("div",null,v.a.createElement("div",{className:"base"},v.a.createElement("div",{className:"left",ref:this.imgRef}),v.a.createElement("div",{className:"right"},h,v.a.createElement("h1",null,f),v.a.createElement("section",{className:"saveas-section"},v.a.createElement(ee.a,{label:Object(X.b)("SaveAs.Filename","File name")},v.a.createElement(de.a,{value:a,onChange:function(t){return e.handleNameChange(t)},onKeyUp:function(t){return e.onKeyUp(t)}})),v.a.createElement(ee.a,{label:Object(X.b)("SaveAs.Fileformat","File format"),className:"file-format-label"},v.a.createElement(ce.TabView,{selectedIndex:n,onSelect:function(t){return e.handleFileFormatChange(t)}},v.a.createElement(ce.Tab,{label:Object(X.b)("SaveAs.Label.JPG","JPG"),className:"saveas-tab"},v.a.createElement(le.a,{placement:"top",show:u,delayHide:100,onClick:function(){e.hideTooltip()},onHide:function(){e.hideTooltip()}},v.a.createElement(me.a,{renderLabel:!0,label:Object(X.b)("SaveAs.Quality","Quality"),className:"quality-slider",min:1,max:100,step:1,filled:!0,fillOffset:.01,value:r,onChange:function(t){return e.handleQualityChange(t)},onChangeEnd:function(){return e.calcSize()}}),v.a.createElement(fe.a,{placement:"top"},Object(X.b)("SaveAs.Slider.Tooltip","Move slider to determine file size and image quality."))),v.a.createElement("div",null,Object(X.b)("SaveAs.Filesize","File size"),": ",s," - ",v.a.createElement("span",{className:o},i))),v.a.createElement(ce.Tab,{label:"PNG",className:"saveas-tab"},v.a.createElement("div",null,Object(X.b)("SaveAs.Filesize","File size"),": ",s," - ",v.a.createElement("span",{className:o},i))))),v.a.createElement(ee.a,{label:Object(X.b)("SaveAs.Dimensions","Dimensions"),labelFor:"dimension"},v.a.createElement("div",{id:"dimension"},l," \xd7 ",c," ",Object(X.b)("SaveAs.Label.Pixel","Pixel"))),v.a.createElement("div",{className:"saveas-buttons"},v.a.createElement(U.a,{onClick:function(){Object(K.a)("downloadImage:cancel"),e.handleCancel()}},Object(X.b)("SaveAs.Button.Cancel","Cancel")),v.a.createElement(U.a,{autoFocus:!0,onClick:function(){Object(K.a)("downloadImage"),e.handleSaveFile()},className:"button-choosefile",variant:"cta"},Object(X.b)("SaveAs.Button.Download","Download"))))))))}}]),a}(m.PureComponent));!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.CONVERT=1]="CONVERT",e[e.COMPRESS=2]="COMPRESS"}(Q||(Q={}));var ge=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).doc=void 0,n.doc=e,n}return Object(c.a)(a,[{key:"show",value:function(){var e,t,n=D.a.getParams(),r=Q.DEFAULT;switch(null===(e=n.globalAction)||void 0===e?void 0:e.action){case"convert":r=Q.CONVERT;break;case"compress":r=Q.COMPRESS}void 0===a.dialogId&&(a.dialogId=T.a.show(v.a.createElement(ve,{controller:this,imageData:this.doc.getImageData(),fileName:this.doc.getFileName(),targetFormat:null===(t=n.globalAction)||void 0===t?void 0:t.targetFormat,saveInitMode:r})))}},{key:"clearDialogId",value:function(){a.dialogId=void 0}},{key:"close",value:function(){a.dialogId&&T.a.hide(a.dialogId)}},{key:"saveImage",value:function(e,t,a){var n=this.doc.saveImage(e,t,a/100);!this.showPostDownloadUpsellDialog()&&n&&(new N.a).showSurveyDownload(),this.close()}},{key:"showPostDownloadUpsellDialog",value:function(){var e,t,a=null!==(e=null===(t=D.a.getParams().upsell)||void 0===t?void 0:t.preventUpsell)&&void 0!==e&&e,r=null!==sessionStorage.getItem("fps_post_download_upsell_dialog"),i=!1;if(!a&&!r)try{var o=_.getInstance().getTestContent("agedashi:app:downloads");_.getInstance().sendNotification("agedashi:app:downloads",n.display),i=!!o&&o.showPostDownloadUpsell}catch(s){console.error("Error during target test evaluation: ",s)}return!(!i&&"true"!==D.a.getParam("showPostDownloadUpsell"))&&((new J).show(),sessionStorage.setItem("fps_post_download_upsell_dialog","true"),!0)}}]),a}(L.a);ge.dialogId=void 0;var be,ye,Ee=function(){function e(t,a){Object(l.a)(this,e),this.maxSteps=void 0,this.docPersister=void 0,this.inMemoryUndoStack=void 0,this.inMemoryUndoStack=t,this.docPersister=a,this.maxSteps=this.inMemoryUndoStack.maxSteps}return Object(c.a)(e,[{key:"getCurrent",value:function(){return this.inMemoryUndoStack.getCurrent()}},{key:"getLength",value:function(){return this.inMemoryUndoStack.getLength()}},{key:"clear",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.inMemoryUndoStack.clear(),this.docPersister.clear();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"canUndo",value:function(){return this.inMemoryUndoStack.canUndo()}},{key:"canRedo",value:function(){return this.inMemoryUndoStack.canRedo()}},{key:"undo",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.inMemoryUndoStack.undo(),this.docPersister.undo();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"redo",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.inMemoryUndoStack.redo(),this.docPersister.redo();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inMemoryUndoStack.add(t),e.abrupt("return",this.docPersister.add(t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),we=a(5),xe=a(202),ke=a.n(xe),Se=a(203),Oe=a.n(Se),Ce=a(204),Pe=a.n(Ce),Te=a(695),Ae=(a(474),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={hidden:!1,canZoomIn:!0,canZoomOut:!0,zoomValue:100,isPanning:!1},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"setPanning",value:function(e){this.setState({isPanning:e})}},{key:"setZoomValue",value:function(e,t,a){this.setState({zoomValue:e,canZoomIn:t,canZoomOut:a})}},{key:"setHidden",value:function(e){this.setState({hidden:e})}},{key:"render",value:function(){var e=this.props.controller,t=this.state,a=t.canZoomIn,n=t.canZoomOut,r=t.zoomValue,i=t.isPanning,o=t.hidden?"stage-actions no-display":"stage-actions";return v.a.createElement("div",{className:o},v.a.createElement("div",{className:"zoom-bar"},v.a.createElement(le.a,{delayShow:1500},v.a.createElement(U.a,{quiet:!0,variant:"action",icon:v.a.createElement(ke.a,null),selected:i,onClick:function(){e.togglePanning(),document.activeElement instanceof HTMLElement&&document.activeElement.blur()},className:i?"actions-button-selected":"actions-button"}),v.a.createElement(fe.a,null,v.a.createElement(Te.a,null,(function(e){return v.a.createElement("p",null,e("Stage.PanAndZoom.HandTool","Drag image"))})))),v.a.createElement(U.a,{quiet:!0,variant:"action",icon:v.a.createElement(Pe.a,null),disabled:!n,onClick:function(){e.zoomOut(),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}}),v.a.createElement(U.a,{quiet:!0,variant:"action",className:"zoom-text",onClick:function(){e.zoomToggleFit(),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}},r,"%"),v.a.createElement(U.a,{quiet:!0,variant:"action",icon:v.a.createElement(Oe.a,null),disabled:!a,onClick:function(){e.zoomIn(),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}})))}}]),a}(m.PureComponent)),je=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).stage=void 0,n.stage=e,n}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e),b.a.render(v.a.createElement(Ae,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&b.a.unmountComponentAtNode(this.container),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"viewDidMount",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"viewDidMount",this).call(this,e)}},{key:"viewWillUnmount",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"viewWillUnmount",this).call(this,e)}},{key:"setPanning",value:function(e){var t;null===(t=this.getStageActionsView())||void 0===t||t.setPanning(e)}},{key:"setZoomValue",value:function(e,t,a){var n;null===(n=this.getStageActionsView())||void 0===n||n.setZoomValue(e,t,a)}},{key:"setHidden",value:function(e){var t;null===(t=this.getStageActionsView())||void 0===t||t.setHidden(e)}},{key:"togglePanning",value:function(){this.stage.togglePanning()}},{key:"zoomIn",value:function(){this.stage.zoomIn()}},{key:"zoomOut",value:function(){this.stage.zoomOut()}},{key:"zoomToggleFit",value:function(){this.stage.zoomFit()}},{key:"getStageActionsView",value:function(){return this.view}}]),a}(L.a);a(475);!function(e){e[e.CORE=1]="CORE",e[e.NORMAL=2]="NORMAL"}(be||(be={})),function(e){e[e.NONE=0]="NONE",e[e.ZOOMIN=1]="ZOOMIN",e[e.ZOOMOUT=2]="ZOOMOUT"}(ye||(ye={}));var Ie=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).doc=void 0,n.canvas=void 0,n.maskCanvas=void 0,n.maskCanvasEmpty=void 0,n.toolLayer=void 0,n.containerSize=void 0,n.transformMode=void 0,n.transformOffset=void 0,n.transformScale=void 0,n.transformMatrix=void 0,n.isPanning=void 0,n.zoomStart=void 0,n.zoomMode=ye.NONE,n.startPanMouse=void 0,n.startPanPosition=void 0,n.panTracking=void 0,n.stageActions=void 0,we.a.setMatrixArrayType(Array),n.doc=e,n.containerSize=we.e.create(),n.transformMode=be.NORMAL,n.transformOffset=we.e.create(),n.transformScale=1,n.transformMatrix=we.b.create(),n.isPanning=!1,n.zoomStart=-1,n.startPanMouse=we.e.create(),n.startPanPosition=we.e.create(),n.panTracking=!1,n.maskCanvasEmpty=!0,n.stageActions=new je(Object(u.a)(n)),n.onResize=n.onResize.bind(Object(u.a)(n)),n.onPointerDown=n.onPointerDown.bind(Object(u.a)(n)),n.onPointerMove=n.onPointerMove.bind(Object(u.a)(n)),n.onPointerUp=n.onPointerUp.bind(Object(u.a)(n)),n.onPointerEnter=n.onPointerEnter.bind(Object(u.a)(n)),n.onPointerOut=n.onPointerOut.bind(Object(u.a)(n)),n.onPointerLeave=n.onPointerLeave.bind(Object(u.a)(n)),n.onMouseWheel=n.onMouseWheel.bind(Object(u.a)(n)),n.onGestureStart=n.onGestureStart.bind(Object(u.a)(n)),n.onGestureChange=n.onGestureChange.bind(Object(u.a)(n)),n.onGestureEnd=n.onGestureEnd.bind(Object(u.a)(n)),n.onDrop=n.onDrop.bind(Object(u.a)(n)),n}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e);var t=document.createElement("div");t.id="stage-image-container",e.appendChild(t);var n=this.doc.getImageData();this.canvas=x.a.createHTMLCanvasElement(n),this.canvas.id="main-canvas",this.canvas.className="main-canvas",t.appendChild(this.canvas),this.maskCanvasEmpty=!0,this.maskCanvas=document.createElement("canvas"),this.maskCanvas.id="main-mask-canvas",this.maskCanvas.className="main-mask-canvas",t.appendChild(this.maskCanvas),this.toolLayer=document.createElement("div"),this.toolLayer.id="main-tool-layer",this.toolLayer.className="main-tool-layer",t.appendChild(this.toolLayer),this.containerSize[0]=e.clientWidth,this.containerSize[1]=e.clientHeight,window.addEventListener("resize",this.onResize),t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),t.addEventListener("pointerenter",this.onPointerEnter),t.addEventListener("pointerout",this.onPointerOut),t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("wheel",this.onMouseWheel),t.addEventListener("gesturestart",this.onGestureStart),t.addEventListener("gesturechange",this.onGestureChange),t.addEventListener("gestureend",this.onGestureEnd),t.addEventListener("drop",this.onDrop),t.addEventListener("dragover",this.onDragOver),t.onselectstart=function(){return!1};var r=document.createElement("div");r.id="stage-actions-container",e.appendChild(r),this.stageActions.createView(r)}},{key:"destroyView",value:function(){if(this.stageActions.destroyView(),this.container){this.container.innerHTML="",window.removeEventListener("resize",this.onResize);var e=this.ensureHTMLElement("stage-image-container");e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),e.removeEventListener("pointerenter",this.onPointerEnter),e.removeEventListener("pointerout",this.onPointerOut),e.removeEventListener("pointerleave",this.onPointerLeave),e.removeEventListener("wheel",this.onMouseWheel),e.removeEventListener("gesturestart",this.onGestureStart),e.removeEventListener("gesturechange",this.onGestureChange),e.removeEventListener("gestureend",this.onGestureEnd)}Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"setTransformMode",value:function(e){this.transformMode=e}},{key:"getTransformOffset",value:function(){return this.transformOffset}},{key:"setTransformOffset",value:function(e){we.e.copy(this.transformOffset,e)}},{key:"getTransformScale",value:function(){return this.transformScale}},{key:"setTransformScale",value:function(e){this.transformScale=e}},{key:"getTransformMatrix",value:function(){return this.transformMatrix}},{key:"setTransformMatrix",value:function(e){we.b.copy(this.transformMatrix,e)}},{key:"centerContent",value:function(){this.transformMode===be.NORMAL&&this.canvas&&this.container&&(this.containerSize[0]=this.container.clientWidth,this.containerSize[1]=this.container.clientHeight,this.transformOffset[0]=(this.container.clientWidth-this.canvas.width*this.transformScale)/2,this.transformOffset[1]=(this.container.clientHeight-this.canvas.height*this.transformScale)/2,this.updateTransform())}},{key:"checkScroll",value:function(){if(this.transformMode===be.NORMAL&&this.canvas&&this.container){var e=this.transformOffset[0],t=this.transformOffset[1],a=this.canvas.width*this.transformScale,n=this.canvas.height*this.transformScale,r=this.container.clientWidth,i=this.container.clientHeight;a>r?(e>0&&(e=0),e+a<r&&(e=r-a)):e=(r-a)/2,n>i?(t>0&&(t=0),t+n<i&&(t=i-n)):t=(i-n)/2,this.transformOffset[0]=e,this.transformOffset[1]=t,this.updateTransform()}}},{key:"scrollContent",value:function(e,t){this.transformOffset[0]+=e,this.transformOffset[1]+=t,this.checkScroll()}},{key:"containerSizeChanged",value:function(){if(this.container){var e=this.container.clientWidth,t=this.container.clientHeight,a=this.containerSize[0]-e,n=this.containerSize[1]-t;this.containerSize[0]=e,this.containerSize[1]=t,this.transformMode===be.NORMAL&&(this.transformOffset[0]-=a/2,this.transformOffset[1]-=n/2,this.checkScroll()),this.doc.onContainerSizeChanged(e,t)}}},{key:"updateTransform",value:function(){var e=Math.floor(this.transformOffset[0]),t=Math.floor(this.transformOffset[1]);this.canvas&&(this.canvas.style.imageRendering=this.transformScale>=2?"pixelated":"auto",this.canvas.style.transformOrigin="".concat(0," ",0),this.transformMode===be.NORMAL&&(this.canvas.style.transform="translate(".concat(e,"px, ").concat(t,"px) scale(").concat(this.transformScale,")")),this.transformMode===be.CORE&&(this.canvas.style.transform="matrix(".concat(this.transformMatrix[0],", ").concat(this.transformMatrix[1],", ").concat(this.transformMatrix[2],", ").concat(this.transformMatrix[3],", ").concat(this.transformMatrix[4],", ").concat(this.transformMatrix[5],")"))),this.maskCanvas&&(this.maskCanvas.style.imageRendering=this.transformScale>=2?"pixelated":"auto",this.maskCanvas.style.transformOrigin="".concat(0," ",0),this.transformMode===be.NORMAL&&(this.maskCanvas.style.transform="translate(".concat(e,"px, ").concat(t,"px) scale(").concat(this.transformScale,")")),this.transformMode===be.CORE&&(this.maskCanvas.style.transform="matrix(".concat(this.transformMatrix[0],", ").concat(this.transformMatrix[1],", ").concat(this.transformMatrix[2],", ").concat(this.transformMatrix[3],", ").concat(this.transformMatrix[4],", ").concat(this.transformMatrix[5],")")));var a=this.doc.getCurrentEditor();a&&a.onStageTransformChanged()}},{key:"editorChanged",value:function(){this.container&&this.canvas&&this.containerSizeChanged(),this.setZoomMode(ye.NONE)}},{key:"setImageData",value:function(e){if(this.ensure2DCanvas(),this.canvas){this.canvas.width=e.width,this.canvas.height=e.height;var t=this.canvas.getContext("2d");null!==t&&t.putImageData(e,0,0),this.maskCanvas&&(this.maskCanvas.width=e.width,this.maskCanvas.height=e.height)}}},{key:"getCanvas",value:function(){return this.canvas}},{key:"setMaskData",value:function(e){if(this.canvas&&this.maskCanvas){var t=this.maskCanvas.getContext("2d");if(null!==t){if(!e)return t.clearRect(0,0,this.maskCanvas.width,this.maskCanvas.height),this.maskCanvasEmpty=!0,void(this.maskCanvas.style.opacity="0");if(e.width!==this.canvas.width||e.height!==this.canvas.height)return void console.error("mask size invalid",e.width,e.height,this.canvas.width,this.canvas.height);this.maskCanvas.width=e.width,this.maskCanvas.height=e.height,t.putImageData(e,0,0),this.maskCanvas.style.opacity="1",this.maskCanvasEmpty=!1}}}},{key:"getMaskCanvas",value:function(){return this.maskCanvas}},{key:"isMaskCanvasEmpty",value:function(){return this.maskCanvasEmpty}},{key:"getToolLayer",value:function(){return this.toolLayer}},{key:"togglePanning",value:function(){this.isPanning=!this.isPanning,this.stageActions.setPanning(this.isPanning),this.setZoomMode(ye.NONE),this.container&&(this.isPanning?(this.container.classList.add("cursor-pan"),this.doc.onPanModeStart()):(this.container.classList.remove("cursor-pan"),this.doc.onPanModeEnd()))}},{key:"setStageActionsVisible",value:function(e){this.stageActions.setHidden(!e)}},{key:"isPanningMode",value:function(){return this.isPanning}},{key:"setZoomFactor",value:function(e,t){if(t){var a=t[0],n=t[1],r=a+e*(this.transformOffset[0]-a)/this.transformScale,i=n+e*(this.transformOffset[1]-n)/this.transformScale;this.transformOffset[0]=r,this.transformOffset[1]=i,this.transformScale=e,this.checkScroll()}else this.transformScale=e,this.centerContent();this.stageActions.setZoomValue(Math.round(100*e),void 0!==this.getNextZoomIn(this.transformScale),void 0!==this.getNextZoomOut(this.transformScale)),this.onZoomChange(Math.round(100*e))}},{key:"getMaxZoom",value:function(){return a.zoomFactors[a.zoomFactors.length-1]/100}},{key:"getMinZoom",value:function(){return a.zoomFactors[0]/100}},{key:"getNextZoomIn",value:function(e){if(!(100*e>=a.zoomFactors[a.zoomFactors.length-1]))for(var t=a.zoomFactors.length-1;t>=0;t-=1)if(a.zoomFactors[t]<=100*e&&t<a.zoomFactors.length-1)return a.zoomFactors[t+1]/100}},{key:"getNextZoomOut",value:function(e){if(!(100*e<=a.zoomFactors[0]))for(var t=0;t<a.zoomFactors.length;t+=1)if(a.zoomFactors[t]>=100*e&&t>0)return a.zoomFactors[t-1]/100}},{key:"getZoomFactor",value:function(){return this.transformScale}},{key:"zoomIn",value:function(){var e,t=this.getNextZoomIn(this.transformScale);if(this.container){var a=this.container.clientWidth/2,n=this.container.clientHeight/2;e=we.e.fromValues(a,n)}void 0!==t&&this.setZoomFactor(t,e)}},{key:"zoomOut",value:function(){var e,t=this.getNextZoomOut(this.transformScale);if(this.container){var a=this.container.clientWidth/2,n=this.container.clientHeight/2;e=we.e.fromValues(a,n)}void 0!==t&&this.setZoomFactor(t,e)}},{key:"zoomToggleFit",value:function(){1===this.transformScale?this.zoomFit():this.setZoomFactor(1)}},{key:"zoomFit",value:function(){var e=this.doc.getImageData(),t=e.width,a=e.height,n=this.containerSize[0]/t,r=this.containerSize[1]/a,i=Math.min(n,r);if(i<1){var o,s,l=null!==(o=this.getNextZoomOut(null!==(s=this.getNextZoomIn(i))&&void 0!==s?s:i))&&void 0!==o?o:1;this.setZoomFactor(l)}else this.setZoomFactor(1)}},{key:"doPointerZoom",value:function(e){var t,a=this.eventToLocal(e);switch(this.zoomMode){case ye.ZOOMIN:t=this.getNextZoomIn(this.transformScale);break;case ye.ZOOMOUT:t=this.getNextZoomOut(this.transformScale);break;default:return}void 0!==t&&this.setZoomFactor(t,a)}},{key:"getZoomMode",value:function(){return this.zoomMode}},{key:"setZoomMode",value:function(e){if(this.zoomMode=e,this.container)switch(this.container.classList.remove("cursor-zoom-out"),this.container.classList.remove("cursor-zoom-in"),e){case ye.ZOOMIN:this.isPanningMode()&&this.togglePanning(),this.container.classList.add("cursor-zoom-in"),this.doc.onZoomModeStart();break;case ye.ZOOMOUT:this.container.classList.add("cursor-zoom-out");break;case ye.NONE:this.doc.onZoomModeEnd()}}},{key:"ensure2DCanvas",value:function(){this.canvas&&null!==this.canvas.getContext("2d")||(this.canvas=this.createNewCanvas(),this.canvas.getContext("2d"))}},{key:"ensureWebGLCanvas",value:function(e){!e&&this.canvas&&null!==this.canvas.getContext("webgl")||(this.canvas=this.createNewCanvas(),this.canvas.getContext("webgl",e))}},{key:"createNewCanvas",value:function(){var e,t=document.createElement("canvas");t.id="main-canvas",t.className="main-canvas";var a=this.doc.getImageData();t.width=a.width,t.height=a.height;var n=null===(e=this.container)||void 0===e?void 0:e.firstChild;return this.canvas&&(null===n||void 0===n?void 0:n.contains(this.canvas))?null===n||void 0===n||n.replaceChild(t,this.canvas):null===n||void 0===n||n.appendChild(t),t}},{key:"getBoundingBox",value:function(){var e,t=null===(e=this.getCanvas())||void 0===e?void 0:e.getBoundingClientRect();if(t){var a=this.pointToLocal(we.e.fromValues(t.left,t.top)),n=this.pointToLocal(we.e.fromValues(t.right,t.bottom));return{left:a[0],top:a[1],right:n[0],bottom:n[1]}}}},{key:"eventToLocal",value:function(e){return this.pointToLocal(we.e.fromValues(e.clientX,e.clientY))}},{key:"pointToLocal",value:function(e){var t=this.container;if(null==t)return we.e.create();var a=0,n=0;for(n=0;null!=t;a+=t.offsetLeft,n+=t.offsetTop,t=t.offsetParent);var r=we.e.clone(e);return r[0]-=a-window.pageXOffset,r[1]-=n-window.pageYOffset,r}},{key:"eventToStage",value:function(e){var t=this.eventToLocal(e),a=we.e.create();return this.transformMode===be.NORMAL&&(a[0]=(t[0]-this.transformOffset[0])/this.transformScale,a[1]=(t[1]-this.transformOffset[1])/this.transformScale),this.transformMode===be.CORE&&we.e.transformMat2d(a,t,we.b.invert(we.b.create(),this.transformMatrix)),a}},{key:"pointToStage",value:function(e){var t=we.e.create();return this.transformMode===be.NORMAL&&(t[0]=(e[0]-this.transformOffset[0])/this.transformScale,t[1]=(e[1]-this.transformOffset[1])/this.transformScale),this.transformMode===be.CORE&&we.e.transformMat2d(t,e,we.b.invert(we.b.create(),this.transformMatrix)),t}},{key:"pointFromStage",value:function(e){var t=we.e.create();return this.transformMode===be.NORMAL&&(t[0]=e[0]*this.transformScale+this.transformOffset[0],t[1]=e[1]*this.transformScale+this.transformOffset[1]),this.transformMode===be.CORE&&we.e.transformMat2d(t,e,this.transformMatrix),t}},{key:"onResize",value:function(e){this.containerSizeChanged()}},{key:"onPointerDown",value:function(e){e.target instanceof Element&&e.target.setPointerCapture(e.pointerId),this.zoomMode!==ye.NONE&&this.doPointerZoom(e),this.isPanning?(this.startPanMouse=this.eventToLocal(e),this.startPanPosition=we.e.clone(this.transformOffset),this.panTracking=!0):this.doc.onPointerDown(e)}},{key:"onPointerMove",value:function(e){var t;if(this.isPanning&&this.panTracking){var a=this.eventToLocal(e);this.transformOffset[0]=this.startPanPosition[0]+a[0]-this.startPanMouse[0],this.transformOffset[1]=this.startPanPosition[1]+a[1]-this.startPanMouse[1],this.checkScroll()}this.isPanning&&this.panTracking&&!(null===(t=this.doc.getCurrentEditor())||void 0===t?void 0:t.needsAlwaysPointerTracking())||this.doc.onPointerMove(e)}},{key:"onPointerUp",value:function(e){e.target instanceof Element&&e.target.releasePointerCapture(e.pointerId),this.isPanning&&this.panTracking?this.panTracking=!1:this.doc.onPointerUp(e)}},{key:"onPointerEnter",value:function(e){this.doc.onPointerEnter(e)}},{key:"onPointerOut",value:function(e){this.doc.onPointerOut(e)}},{key:"onPointerLeave",value:function(e){this.doc.onPointerLeave(e)}},{key:"onMouseWheel",value:function(e){if(this.transformMode===be.NORMAL)if(e.ctrlKey||e.altKey){e.preventDefault();var t=this.eventToLocal(e),a=this.transformScale-.01*e.deltaY*this.transformScale;a<this.getMinZoom()&&(a=this.getMinZoom()),a>this.getMaxZoom()&&(a=this.getMaxZoom()),this.setZoomFactor(a,t)}else e.preventDefault(),this.scrollContent(-e.deltaX,-e.deltaY)}},{key:"onGestureStart",value:function(e){e.preventDefault(),this.transformMode===be.NORMAL&&-1===this.zoomStart&&(this.zoomStart=this.transformScale)}},{key:"onGestureChange",value:function(e){if(e.preventDefault(),this.transformMode===be.NORMAL){var t=this.eventToLocal(e),a=this.zoomStart*e.scale;a<this.getMinZoom()&&(a=this.getMinZoom()),a>this.getMaxZoom()&&(a=this.getMaxZoom()),this.setZoomFactor(a,t)}}},{key:"onGestureEnd",value:function(e){e.preventDefault(),this.transformMode===be.NORMAL&&(this.zoomStart=-1)}},{key:"onZoomChange",value:function(e){this.doc.onZoomChange(e)}},{key:"onDrop",value:function(e){if(e.preventDefault(),e.dataTransfer){var t=e.dataTransfer.files.item(0);if(t){if(!We.isAllowedMimetype(t.type))return Object(y.error)(Object(X.b)("Importer.DragAndDrop.ErrorToast.Message","Sorry - this file type is currently not supported."),{timeout:3e3}),void Object(K.a)("imageUploadFailed",{action:"dragDrop",error:"incorrectFileFormat",doc:{mimeType:t.type}});Object(K.a)("imageUploadSuccess",{action:"dragDrop",doc:{action:"store",mimeType:t.type}}),this.doc.openDragImage(t)}}}},{key:"onDragOver",value:function(e){e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")}}],[{key:"getMaxCanvasSizes",value:function(){if(0===a.maxWidth||0===a.maxHeight){var e=x.a.getMaxViewportDimsWebGl();a.maxWidth=e?Math.min(e[0],5400):5400,a.maxHeight=e?Math.min(e[1],5400):5400}return[a.maxWidth,a.maxHeight]}}]),a}(L.a);Ie.maxWidth=0,Ie.maxHeight=0,Ie.zoomFactors=[1,1.5,2,3,4,5,12.5,25,100/3,50,100/3*2,100,150,200,250,300,400,600,800];var Me=a(54),Re=a(142),_e=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"openSessionDB",value:function(){var t=Object(s.a)(o.a.mark((function t(a){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a||e.getSessionDBName()||"".concat(e.DB_NAME_PREFIX).concat(R()()),sessionStorage.setItem(e.DB_NAME_KEY,n),localStorage.setItem("_dbName_".concat(n),JSON.stringify({timestamp:Date.now(),active:!0})),t.abrupt("return",Object(Re.b)(n,e.dbVersion,{upgrade:function(e,t,a){console.debug("upgrading the object store form version ".concat(t," to version ").concat(a)),e.objectStoreNames.contains("undostack")&&e.deleteObjectStore("undostack"),e.objectStoreNames.contains("props")&&e.deleteObjectStore("props"),e.createObjectStore("undostack",{autoIncrement:!1}),t<=2&&e.createObjectStore("props")},terminated:function(){e.onClose()}}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getSessionDBName",value:function(){return sessionStorage.getItem(e.DB_NAME_KEY)}},{key:"getSessionDBs",value:function(){for(var t=new Array,a=0;a<localStorage.length;a+=1){var n=localStorage.key(a);if(null===n||void 0===n?void 0:n.startsWith("_dbName_".concat(e.DB_NAME_PREFIX))){var r=n.substring("_dbName_".length);if(r&&r!==e.getSessionDBName()){var i=this.getSessionDBInfo(r),o=i.timestamp||-1,s=i.active&&Date.now()-6048e5<o;t.push({dbName:r,timestamp:o,active:s})}}}for(var l=new Array,c=new Array,u=t.sort((function(e,t){return e.timestamp<t.timestamp?1:-1})),d=0;d<u.length;d+=1){var h=u[d];h&&(h.active?l.push({name:h.dbName,timestamp:h.timestamp}):c.push({name:h.dbName,timestamp:h.timestamp}))}return{opened:l,closed:c}}},{key:"getSessionDBInfo",value:function(e){var t=JSON.parse(localStorage.getItem("_dbName_".concat(e))||"{}");return{timestamp:t.timestamp||-1,active:t.active}}},{key:"getActiveSessionDB",value:function(){var t=Object(s.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.database){t.next=4;break}return t.next=3,e.openSessionDB();case 3:e.database=t.sent;case 4:return t.abrupt("return",{sessionDB:e.database,timestamp:e.getSessionDBInfo(e.database.name).timestamp});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"getLastClosedSessionDB",value:function(){var t=Object(s.a)(o.a.mark((function t(){var a,n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=null===(a=e.getSessionDBs())||void 0===a?void 0:a.closed)||!n[0]){t.next=6;break}return t.next=4,e.openSessionDB(n[0].name);case 4:return r=t.sent,t.abrupt("return",{sessionDB:r,timestamp:n[0].timestamp});case 6:return t.abrupt("return",Promise.reject());case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"onClose",value:function(){if(e.hasValidSessionDB()){localStorage.setItem("_dbName_".concat(e.getSessionDBName()),JSON.stringify({timestamp:Date.now(),active:!1}));try{var t;null===(t=e.database)||void 0===t||t.close()}catch(a){console.debug("error while closing session DB")}e.database=null}}},{key:"cleanupUnusedSessionDBs",value:function(){for(var t=e.getSessionDBs(),a=0;a<t.closed.length;a+=1)Object(Re.a)(t.closed[a].name),localStorage.removeItem("_dbName_".concat(t.closed[a].name))}},{key:"hasValidSessionDB",value:function(){return null!==sessionStorage.getItem(e.DB_NAME_KEY)}},{key:"switchToSessionDB",value:function(){var t=Object(s.a)(o.a.mark((function t(a){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=12;break}return e.onClose(),t.prev=2,t.next=5,e.openSessionDB(a);case 5:e.database=t.sent,t.next=12;break;case 8:return t.prev=8,t.t0=t.catch(2),console.error("Error while switching the database: ".concat(t.t0)),t.abrupt("return",!1);case 12:return t.abrupt("return",!0);case 13:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}()}]),e}();_e.dbVersion=3,_e.DB_NAME_PREFIX="fps-",_e.DB_NAME_KEY="fps_db",_e.database=null;var De=function(){function e(t){Object(l.a)(this,e),this.maxSteps=void 0,this.currentStep=void 0,this.endStep=void 0,this.startStep=void 0,this.maxSteps=t,this.currentStep=-1,this.endStep=-1,this.startStep=0}return Object(c.a)(e,[{key:"getCurrent",value:function(){throw new Error("method not implemented")}},{key:"clear",value:function(){var t=Object(s.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.clearAll();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"add",value:function(){var t=Object(s.a)(o.a.mark((function t(a){var n,r,i,s,l,c,u,d,h=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=h.length>1&&void 0!==h[1]?h[1]:void 0,r=h.length>2&&void 0!==h[2]?h[2]:void 0,i=h.length>3&&void 0!==h[3]?h[3]:void 0,s=h.length>4&&void 0!==h[4]&&h[4],l=-1,c=-1,!s){t.next=11;break}return t.next=9,this.clear();case 9:t.next=13;break;case 11:this.getLength()+1>this.maxSteps&&this.currentStep===this.endStep&&(l=this.startStep,this.startStep+=1,this.currentStep=Math.max(this.currentStep,this.startStep)),this.currentStep<this.endStep&&(c=this.currentStep+1,this.endStep=this.currentStep);case 13:return this.currentStep+=1,this.endStep+=1,localStorage.setItem(e.LS_CURRENT_STEP_KEY,this.currentStep.toString()),localStorage.setItem(e.LS_START_STEP_KEY,this.startStep.toString()),localStorage.setItem(e.LS_END_STEP_KEY,this.endStep.toString()),null!=n&&localStorage.setItem(e.LS_FILE_NAME_KEY,n),r&&localStorage.setItem(e.LS_FILE_TYPE_KEY,r),null!=i&&localStorage.setItem(e.LS_IS_SAMPLE_IMAGE_KEY,String(i)),t.next=23,_e.getActiveSessionDB();case 23:return u=t.sent.sessionDB,(d=u.transaction(["undostack"],"readwrite")).objectStore("undostack").put(x.a.createHTMLCanvasElement(a).toDataURL(r),this.currentStep),l>=0&&d.objectStore("undostack").delete(l),c>=0&&d.objectStore("undostack").delete(IDBKeyRange.lowerBound(c,!0)),t.next=30,d.done;case 30:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"undo",value:function(){var t=Object(s.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.canUndo()&&(this.currentStep-=1,localStorage.setItem(e.LS_CURRENT_STEP_KEY,this.currentStep.toString()),Promise.resolve());case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"redo",value:function(){var t=Object(s.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.canRedo()&&(this.currentStep+=1,localStorage.setItem(e.LS_CURRENT_STEP_KEY,this.currentStep.toString()),Promise.resolve());case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"restore",value:function(){var t=Object(s.a)(o.a.mark((function t(a){var n,r,i,s,l,c,u,d,h,f,p,m,v,g,b,y,E;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_e.switchToSessionDB(a);case 2:if(t.sent){t.next=4;break}return t.abrupt("return",Promise.resolve(null));case 4:if(n=localStorage.getItem(e.LS_END_STEP_KEY),r=localStorage.getItem(e.LS_START_STEP_KEY),n&&r){t.next=8;break}return t.abrupt("return",Promise.resolve(null));case 8:return i=Number.parseInt(n,10),s=Number.parseInt(r,10),l=[],t.next=13,_e.getActiveSessionDB();case 13:for(c=t.sent.sessionDB,u=c.transaction(["undostack"],"readonly"),d=s;d<=i;d+=1)l.push(u.objectStore("undostack").get(d));return t.next=18,u.done;case 18:return h=[],t.next=21,Promise.all(l).then((function(e){h=e.filter(Boolean)}));case 21:if(f=localStorage.getItem(e.LS_CURRENT_STEP_KEY),p=localStorage.getItem(e.LS_FILE_NAME_KEY),m=localStorage.getItem(e.LS_FILE_TYPE_KEY),v=localStorage.getItem(e.LS_IS_SAMPLE_IMAGE_KEY),0!==h.length&&v&&p&&m&&f){t.next=27;break}return t.abrupt("return",Promise.resolve(null));case 27:for(this.endStep=i,this.startStep=s,this.currentStep=parseInt(f,10),g=[],b=0;b<h.length;b+=1)(y=h[b])&&g.push(x.a.createImageData(y));return E=[],t.next=35,Promise.all(g).then((function(e){E=e}));case 35:return t.abrupt("return",Promise.resolve({imageDatas:E,currentIndex:this.currentStep,fileName:p,fileType:m,isSampleImage:"true"===v}));case 36:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"canRedo",value:function(){return this.currentStep<this.endStep}},{key:"canUndo",value:function(){return this.currentStep>this.startStep}},{key:"getLength",value:function(){return this.endStep-this.startStep+1}}],[{key:"getLastStoredDocument",value:function(){var t=Object(s.a)(o.a.mark((function t(){var a,n,r,i,s,l,c,u,d;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a={},n=!1,!_e.hasValidSessionDB()){t.next=9;break}return t.next=6,_e.getActiveSessionDB();case 6:a=t.sent,t.next=13;break;case 9:return t.next=11,_e.getLastClosedSessionDB();case 11:a=t.sent,n=!0;case 13:return r=Number.parseInt(localStorage.getItem(e.LS_CURRENT_STEP_KEY)||"0",10),i=a.sessionDB.transaction(["undostack"],"readonly"),s=i.objectStore("undostack").get(r),t.next=18,i.done;case 18:return n&&a.sessionDB.close(),l=localStorage.getItem(e.LS_FILE_NAME_KEY),c=localStorage.getItem(e.LS_IS_SAMPLE_IMAGE_KEY),t.next=23,s;case 23:if(u=t.sent,l&&c&&u){t.next=26;break}return t.abrupt("return",Promise.reject());case 26:return t.next=28,x.a.createImageData(u);case 28:return d=t.sent,t.abrupt("return",Promise.resolve({imageData:d,fileName:l,sessionDBName:a.sessionDB.name,timestamp:a.timestamp,isSampleImage:"true"===c}));case 32:return t.prev=32,t.t0=t.catch(0),t.abrupt("return",Promise.reject());case 35:case"end":return t.stop()}}),t,null,[[0,32]])})));return function(){return t.apply(this,arguments)}}()},{key:"clearAll",value:function(){var t=Object(s.a)(o.a.mark((function t(){var a,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_e.getActiveSessionDB();case 2:return a=t.sent.sessionDB,_e.cleanupUnusedSessionDBs(),(n=a.transaction(["undostack"],"readwrite")).objectStore("undostack").clear(),t.next=8,n.done;case 8:e.clearLocalStorageValues();case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"clearLocalStorageValues",value:function(){localStorage.removeItem(e.LS_CURRENT_STEP_KEY),localStorage.removeItem(e.LS_START_STEP_KEY),localStorage.removeItem(e.LS_END_STEP_KEY),localStorage.removeItem(e.LS_FILE_NAME_KEY),localStorage.removeItem(e.LS_FILE_TYPE_KEY),localStorage.removeItem(e.LS_IS_SAMPLE_IMAGE_KEY)}}]),e}();De.LS_START_STEP_KEY="fps_pus_start",De.LS_END_STEP_KEY="fps_pus_end",De.LS_CURRENT_STEP_KEY="fps_pus_current",De.LS_FILE_NAME_KEY="fps_pus_name",De.LS_FILE_TYPE_KEY="fps_pus_type",De.LS_IS_SAMPLE_IMAGE_KEY="fps_pus_sample";var Le=a(44),Ne=function(){function e(){Object(l.a)(this,e),this.staticData=void 0,this.isConsentGiven=!1,this.staticData=Object(Le.a)(Object(Le.a)({},this.getSourceData()),this.getEnvironmentData())}return Object(c.a)(e,null,[{key:"getInstance",value:function(){return e.instance}}]),Object(c.a)(e,[{key:"track",value:function(e,t,a,n){}},{key:"trackError",value:function(e,t){this.track(e,void 0,void 0,t)}},{key:"sendTrackingData",value:function(e){}},{key:"getDefaultEventData",value:function(e){var t;return{"event.guid":R.a.v4(),"event.category":"WEB","event.dts_end":(new Date).toISOString(),"event.user_agent":navigator.userAgent,"event.language":k.a.getNormalizedCurrentLocale(),"event.session_guid":this.getSessionId(),"event.mcid_guid":this.getVisitorGuid(),"event.url":window.location.href,"event.referrer":window.document.referrer,"event.pagename":"webApp:photoshop.adobe.com:".concat(e["event.type"],":").concat(e["event.subtype"]),"event.user_guid":null===(t=w.b.getInstance().getUserProfile())||void 0===t?void 0:t.userId,"event.visitor_guid":this.getVisitorGuid()}}},{key:"getSourceData",value:function(){var e=new r.UAParser;return{"source.client_id":"ps-frictionless-web","source.name":"Agedashi","source.version":"1.0","source.platform":"Web","source.device":e.getDevice().type||"desktop","source.os_version":e.getOS().version}}},{key:"getEnvironmentData",value:function(){var e=new r.UAParser;return{"env.com.name":e.getBrowser().name,"env.com.version":e.getBrowser().version}}},{key:"getUserData",value:function(){var e;if(!w.b.getInstance().isSignedInUser())return{};var t=null===(e=w.b.getInstance().getUserProfile())||void 0===e?void 0:e.serviceAccounts.find((function(e){return"creative_cloud"===e.serviceCode}));return{"user.service_code":null===t||void 0===t?void 0:t.serviceCode,"user.service_level":null===t||void 0===t?void 0:t.serviceLevel}}},{key:"getSessionId",value:function(){var e=window.sessionStorage.getItem("usertracking-sessionId");return e||(e=R.a.v4(),window.sessionStorage.setItem("usertracking-sessionId",e)),e}},{key:"isTrackingConsentGiven",value:function(){return this.isConsentGiven||(this.isConsentGiven=window._satellite&&"function"===typeof window._satellite.getVar&&"true"===window._satellite.getVar("isConsentGiven").toString()),this.isConsentGiven}},{key:"getVisitorGuid",value:function(){var e=window.sessionStorage.getItem("usertracking-vistorId");if(!e){try{window._satellite&&"function"===typeof window._satellite.getVisitorId&&window._satellite.getVisitorId().isAllowed()&&(e=window._satellite.getVisitorId().getAnalyticsVisitorID()||window._satellite.getVisitorId().getMarketingCloudVisitorID())}catch(t){}e||(e=R()()),window.sessionStorage.setItem("usertracking-vistorId",e)}return e}}]),e}();Ne.instance=new Ne;var Ve=a(107),Ue=a.n(Ve),Fe=a(45),Be=a.n(Fe),He=a(16),ze=(a(485),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).inputFileRef=void 0,n.mounted=void 0,n.handleFileInputChange=function(e){var t=n.props.controller,a=e.target.files;if(a&&a[0]){if(!We.isAllowedMimetype(a[0].type))return Object(y.error)(Object(X.b)("Importer.DragAndDrop.ErrorToast.Message","Sorry - this file type is currently not supported."),{timeout:5e3}),void Object(K.a)("imageUploadFailed",{action:"fileInput",error:"incorrectFileFormat",doc:{mimeType:a[0].type}});t.startReadFile(a[0],a[0].name,a[0].type,!1)}},n.onDrop=function(e){var t=n.props.controller;if(e.dataTransfer){var a=e.dataTransfer.files.item(0);if(a){if(!We.isAllowedMimetype(a.type))return Object(y.error)(Object(X.b)("Importer.DragAndDrop.ErrorToast.Message","Sorry - this file type is currently not supported."),{timeout:5e3}),void Object(K.a)("imageUploadFailed",{action:"dragDrop",error:"incorrectFileFormat",doc:{mimeType:a.type}});t.startReadFile(a,a.name,a.type,!1),Object(K.a)("imageUploadSuccess",{action:"dragDrop",doc:{action:"store",mimeType:a.type}})}}},n.onSampleImageClick=function(e){var t=n.props.controller,a=e.currentTarget.dataset.fullimg||"",r=a.split("/")[a.split("/").length-1],i=e.currentTarget.dataset.position,o=parseInt(i||"0",10);Object(K.a)("sampleImageClick",{doc:{action:"store",mimeType:"image/jpeg",isSampleImage:!0,sampleImagePosition:o}}),t.startReadFile(a,r,"image/jpeg",!0)},n.onFileInputClick=function(){Object(K.a)("chooseFile"),null!==n.inputFileRef.current&&n.inputFileRef.current.click()},n.state={previousDoc:void 0},n.inputFileRef=v.a.createRef(),n.mounted=!1,n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.controller;t.viewDidMount(this),this.mounted=!0,t.getPreviousDocument().then((function(t){var a={dataURI:t.dataURI,fileName:t.fileName,sessionDBName:t.sessionDBName,timestamp:t.timestamp,isSampleImage:t.isSampleImage,isRestoring:!1};e.mounted&&e.setState({previousDoc:a})})).catch((function(){})),Object(K.b)("importer:modal")}},{key:"componentWillUnmount",value:function(){var e=this.props.controller;this.mounted=!1,e.viewWillUnmount(this),this.setState({previousDoc:void 0}),Object(K.c)("importer:modal")}},{key:"refresh",value:function(){}},{key:"renderSampleImages",value:function(){var e=this,t=this.getSampleImages();return t?t.map((function(t,a){return v.a.createElement("button",{type:"button",key:t.thumb,className:"sample-image",onClick:e.onSampleImageClick,"data-fullimg":t.full,"data-position":a+1},v.a.createElement("img",{alt:t.alt,width:"100",height:"100",src:t.thumb}))})):[]}},{key:"getSampleImages",value:function(){return[{alt:"Sample 1",thumb:"https://static-assets.photoshop.adobe.com/sample/thumbs/photos/waterfall_100x100.jpg",full:"https://static-assets.photoshop.adobe.com/sample/photos/waterfall.jpg"},{alt:"Sample 2",thumb:"https://static-assets.photoshop.adobe.com/sample/thumbs/photos/waterlily_100x100.jpg",full:"https://static-assets.photoshop.adobe.com/sample/photos/waterlily.jpg"},{alt:"Sample 3",thumb:"https://static-assets.photoshop.adobe.com/sample/thumbs/photos/portrait_100x100.jpg",full:"https://static-assets.photoshop.adobe.com/sample/photos/portrait.jpg"}]}},{key:"getImporterHeadingText",value:function(){var e=this.props,t=e.importInitMode,a=e.sourceFormat,n=e.editorId;switch(t){case Q.CONVERT:switch(a){case E.b.JPG:return Object(X.b)("Importer.Title.DragAndDropYourFiles.Convert.JPG","Select a jpeg image to convert");case E.b.PNG:return Object(X.b)("Importer.Title.DragAndDropYourFiles.Convert.PNG","Select a png image to convert");case E.b.SVG:return Object(X.b)("Importer.Title.DragAndDropYourFiles.Convert.SVG","Select an svg image to convert");default:return Object(X.b)("Importer.Title.DragAndDropYourFiles.Convert.Default","Select an image to convert")}case Q.COMPRESS:return Object(X.b)("Importer.Title.DragAndDropYourFiles.Compress","Select an image to compress")}switch(n){case He.a.crop:return Object(X.b)("Importer.Title.DragAndDropYourFiles.Crop","Select an image to crop");case He.a.resize:return Object(X.b)("Importer.Title.DragAndDropYourFiles.Resize","Select an image to resize");case He.a.adjust:return Object(X.b)("Importer.Title.DragAndDropYourFiles.Adjust","Select an image to adjust");case He.a.spotheal:return Object(X.b)("Importer.Title.DragAndDropYourFiles.SpotHeal","Select an image to retouch");case He.a.cutout:return Object(X.b)("Importer.Title.DragAndDropYourFiles.Cutout","Select an image to remove background");case He.a.effects:return Object(X.b)("Importer.Title.DragAndDropYourFiles.Effects","Select an image for art effects");default:return Object(X.b)("Importer.Title.DragAndDropYourFiles.NoEditorSelected","Select an image to edit")}}},{key:"getImporterTitleText",value:function(){return this.props.editorId?Object(X.b)("Importer.Description.DragAndDropYourFiles.WithSelectedEditor","Drag and drop a file here, or select a file from your device."):Object(X.b)("Importer.Description.DragAndDropYourFiles.NoEditorSelected","Drag and drop a file here, or select a file from your device.")}},{key:"importPreviousEdit",value:function(){var e=this,t=this.state.previousDoc,a=this.props.controller;t&&!t.isRestoring&&(t.isRestoring=!0,this.setState({previousDoc:t}),a.restorePreviousDocument(t.sessionDBName).catch((function(){e.mounted&&(t.isRestoring=!1,e.setState({previousDoc:t}))})))}},{key:"render",value:function(){var e=this.props,t=e.controller;return e.dialog?v.a.createElement(B.a,{className:"importer-dialog"},v.a.createElement("div",{className:"dialog-close"},v.a.createElement(U.a,{variant:"tool",onClick:function(){return t.close()},icon:v.a.createElement(W.a,{style:{color:"var(--spectrum-global-color-gray-50)"}})})),this.renderImporter()):v.a.createElement(v.a.Fragment,null,v.a.createElement("div",{className:"outer-container"},this.renderImporter(!0)),v.a.createElement("div",{className:"legal-notice-importer"},v.a.createElement(U.a,{quiet:!0,variant:"action",onClick:function(){return t.toggleFooter()},className:"button-legal-notice"},Object(X.b)("Footer.title","Legal Notices"))))}},{key:"renderImporter",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this.state.previousDoc,n=this.props,r=n.importInitMode,i=n.sourceFormat;return v.a.createElement("div",{className:"drop"},v.a.createElement(Ue.a,{onDrop:this.onDrop,className:"drop-zone"},v.a.createElement("h1",null,this.getImporterHeadingText()),v.a.createElement("p",{className:"subtitle"},this.getImporterTitleText()),v.a.createElement(U.a,{className:"button-choosefile",variant:"cta",onClick:this.onFileInputClick},Object(X.b)("Importer.Button.ChooseFile","Upload file")),v.a.createElement("input",{type:"file",id:"file-upload",accept:We.getAcceptedFileExt(i),ref:this.inputFileRef,onChange:this.handleFileInputChange,style:{display:"none"}}),!r&&v.a.createElement("div",{className:"sample-files"},v.a.createElement("p",null,Object(X.b)("Importer.Title.OrSelectSampleImage","Or select a sample image")),this.renderSampleImages()),!r&&t&&a&&v.a.createElement("div",null,v.a.createElement("p",null,Object(X.b)("Importer.LandingPage.PreviousEdit","Or continue working on your previous edit")),v.a.createElement("button",{type:"button",onClick:function(){return e.importPreviousEdit()},className:"previous-image"},v.a.createElement("img",{src:a.dataURI,alt:a.fileName,style:{objectFit:"cover"}})),a.isRestoring&&v.a.createElement(Be.a,{centered:!0}))))}}]),a}(m.PureComponent)),Ge=new r.UAParser,We=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e,n){var r;return Object(l.a)(this,a),(r=t.call(this)).app=void 0,r.dialogId=void 0,r.editorId=void 0,r.app=e,r.editorId=n,r}return Object(c.a)(a,[{key:"createView",value:function(e){var t,n;Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e);var r=D.a.getParams(),i=Q.DEFAULT;switch(null===(t=r.globalAction)||void 0===t?void 0:t.action){case"convert":i=Q.CONVERT;break;case"compress":i=Q.COMPRESS}b.a.render(v.a.createElement(ze,{controller:this,dialog:!1,editorId:this.editorId,sourceFormat:null===(n=r.globalAction)||void 0===n?void 0:n.sourceFormat,importInitMode:i}),e)}},{key:"destroyView",value:function(){this.container&&b.a.unmountComponentAtNode(this.container),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"show",value:function(){this.dialogId=T.a.show(v.a.createElement(ze,{controller:this,dialog:!0,editorId:this.editorId}))}},{key:"close",value:function(){this.dialogId&&T.a.hide(this.dialogId)}},{key:"toggleFooter",value:function(){this.app.getFooter().toggleFooter()}},{key:"startReadFile",value:function(){var e=Object(s.a)(o.a.mark((function e(t,n,r,i){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.close(),e.abrupt("return",a.readFile(this.app,t,n,r,i));case 2:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"restorePreviousDocument",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var a,n,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new De(10),e.next=3,a.restore(t);case 3:if(!(n=e.sent)){e.next=9;break}for(r=new Me.a(n.imageDatas[0],10),i=1;i<n.imageDatas.length;i+=1)r.add(n.imageDatas[i]);return r.setCurrentStep(n.currentIndex),e.abrupt("return",this.app.createDocument(n.imageDatas[0],n.fileName,n.fileType,n.isSampleImage,new Ee(r,a)));case 9:return e.abrupt("return",Promise.reject());case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPreviousDocument",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,a,n,r,i,s,l,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,De.getLastStoredDocument();case 3:if(t=e.sent,!(a=x.a.resizeImageData(t.imageData,t.imageData.width,t.imageData.height))){e.next=12;break}return e.next=8,x.a.createBlob(a);case 8:return n=e.sent,r=URL.createObjectURL(n),i=t.fileName,s=t.sessionDBName,l=t.timestamp,c=t.isSampleImage,e.abrupt("return",Promise.resolve({dataURI:r,fileName:i,sessionDBName:s,timestamp:l,isSampleImage:c}));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.debug("Error while retrieving document data: ".concat(e.t0));case 17:return e.abrupt("return",Promise.reject());case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}()}],[{key:"getAllowedMimetypes",value:function(){return a.ALLOWED_MIMETYPES.join(",")}},{key:"isAllowedMimetype",value:function(e){return-1!==a.ALLOWED_MIMETYPES.indexOf(e)}},{key:"showOpenFileError",value:function(){Object(y.error)(Object(X.b)("Importer.ReadFile.ErrorFileOpen","Sorry! Your image could not be opened."),{timeout:5e3}),Object(K.a)("imageUploadFailed",{action:"readFile",error:"fileNotOpen"})}},{key:"readFile",value:function(){var e=Object(s.a)(o.a.mark((function e(t,n,r,i,s){var l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=Ie.getMaxCanvasSizes(),Ne.getInstance().track({"event.workflow":t.hasDoc()?"Canvas":"Home","event.subcategory":"Select Image","event.type":"click","event.subtype":s?"image":"upload"}),a.loadData(n,r,!0,{onSuccess:function(e,o,c,u,d){t.createDocument(e,o,i,s);var h=c&&c>l[0]||u&&u>l[1];h&&(Object(y.error)(Object(X.b)("Importer.ReadFile.AutoScale","The image resolution has been adapted to realize the best working experience for you."),{timeout:5e3}),Object(K.a)("imageUploadScaled",{action:"readFile",error:"resolutionAboveMaxLimits originalWidth: ".concat(c," originalHeight: ").concat(u)})),Object(K.a)("imageUploadSuccess",{action:"fileInput",doc:{action:"store",mimeType:i,resolution:a.getResolutionBucket(e),resolutionShrinked:h,fileSize:a.getFileSizeBucket(d||0)}}),Ne.getInstance().track({"event.workflow":"Canvas","event.subcategory":"Load Image","event.type":"success","event.subtype":"image"},{"content.name":r,"content.mimetype":i,"content.size":n instanceof Blob?n.size.toString():void 0,"content.extension":r.split(".").pop()})},onError:function(){Ne.getInstance().track({"event.workflow":"Canvas","event.subcategory":"Load Image","event.type":"error","event.subtype":"image"},{"content.name":r,"content.mimetype":i,"content.size":n instanceof Blob?n.size.toString():void 0,"content.extension":r.split(".").pop()},{},{"event.error_code":"L1001","event.error_type":"max_resolution_exceeds","event.error_desc":"The image exceeds the max resolution"})}});case 3:case"end":return e.stop()}}),e)})));return function(t,a,n,r,i){return e.apply(this,arguments)}}()},{key:"loadData",value:function(e,t,n,r){var i=n?Ie.getMaxCanvasSizes():[];e instanceof File&&"image/svg+xml"===e.type&&"Firefox"===Ge.getBrowser().name?this.fixFFLoadSVG(e,t,r):j()(e,(function(n,i){if(n instanceof Event&&"error"===n.type||!i||i.originalWidth&&i.originalWidth>=32767||i.originalHeight&&i.originalHeight>=32767)return a.showOpenFileError(),(null===r||void 0===r?void 0:r.onError)&&r.onError(n),void console.error(n);var o=n,s=o.getContext("2d"),l=null===s||void 0===s?void 0:s.getImageData(0,0,o.width,o.height);if(!l||x.a.isEmptyImage(l))return a.showOpenFileError(),void((null===r||void 0===r?void 0:r.onEmptyData)&&r.onEmptyData());var c=a.trimFileName(t);(null===r||void 0===r?void 0:r.onSuccess)&&r.onSuccess(l,c,i.originalWidth,i.originalHeight,e instanceof Blob?e.size:void 0)}),{canvas:!0,orientation:!0,maxWidth:n?i[0]:void 0,maxHeight:n?i[1]:void 0,crossOrigin:"anonymous"})}},{key:"fixFFLoadSVG",value:function(){var e=Object(s.a)(o.a.mark((function e(t,n,r){var i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=new FileReader).onload=function(){var e=Object(s.a)(o.a.mark((function e(){var s,l,c,u,d,h,f,p,m,v,g,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((s=i.result)&&!(s instanceof ArrayBuffer)){e.next=3;break}return e.abrupt("return");case 3:if(l=(new DOMParser).parseFromString(s,"image/svg+xml"),null!==(c=l.documentElement).getAttribute("width")&&null!==c.getAttribute("height")||null!==c.getAttribute("viewBox")){e.next=8;break}return a.showOpenFileError(),e.abrupt("return");case 8:if(null!==c.getAttribute("width")&&null!==c.getAttribute("height")||!c.getAttribute("viewBox")){e.next=20;break}if((d=null===(u=c.getAttribute("viewBox"))||void 0===u?void 0:u.split(/\s+|,/))&&4===d.length){e.next=13;break}return a.showOpenFileError(),e.abrupt("return");case 13:if(h=d.pop(),(f=d.pop())&&h){e.next=18;break}return a.showOpenFileError(),e.abrupt("return");case 18:c.setAttribute("width","".concat(Math.round(parseFloat(f)),"px")),c.setAttribute("height","".concat(Math.round(parseFloat(h)),"px"));case 20:return"data:image/svg+xml;",p=(new XMLSerializer).serializeToString(c),m=encodeURIComponent(p),v="".concat("data:image/svg+xml;","charset=utf8,").concat(m),e.next=26,x.a.createImageData(v);case 26:if((g=e.sent)&&!x.a.isEmptyImage(g)){e.next=31;break}return a.showOpenFileError(),(null===r||void 0===r?void 0:r.onEmptyData)&&r.onEmptyData(),e.abrupt("return");case 31:b=a.trimFileName(n),(null===r||void 0===r?void 0:r.onSuccess)&&r.onSuccess(g,b,g.width,g.height,t.size);case 33:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i.readAsText(t);case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"trimFileName",value:function(e){var t=e.split(".").slice(0,-1).join(".");if(t.length>a.MAX_FILENAME_LENGTH){var n=(t.length-a.MAX_FILENAME_LENGTH+"...".length)/2;t="".concat(t.substring(0,t.length/2-n),"...").concat(t.substring(t.length/2+n))}return t}},{key:"getAcceptedFileExt",value:function(e){switch(e){case E.b.JPG:return".jpg,.jpeg";case E.b.PNG:return".png";case E.b.SVG:return".svg";default:return".jpg,.jpeg,.png,.svg"}}},{key:"getAcceptedMimeType",value:function(e){switch(e){case E.b.JPG:return"image/jpeg";case E.b.PNG:return"image/png";case E.b.SVG:return"image/svg+xml";default:return""}}},{key:"getFileSizeBucket",value:function(e){return e/1024<=500?"S":e/1024<=3072?"M":"L"}},{key:"getResolutionBucket",value:function(e){for(var t=Math.max(e.width,e.height),a=["XS","S","M","L","XL","XXL"],n=0;n<5;n+=1)if(t<=1e3*n+500)return a[n];return a[a.length-1]}}]),a}(L.a);We.ALLOWED_MIMETYPES=["image/jpeg","image/png","image/svg+xml"],We.MAX_FILENAME_LENGTH=120;var Ze,Ye=a(205),Ke=a.n(Ye),Xe=a(206),qe=a.n(Xe),Je=a(207),Qe=a.n(Je),$e=(a(492),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={isUndoEnabled:!1,isRedoEnabled:!1},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"setUndoRedoEnabled",value:function(e,t){this.setState({isUndoEnabled:e,isRedoEnabled:t})}},{key:"render",value:function(){var e=this.props.controller,t=this.state,a=t.isUndoEnabled,n=t.isRedoEnabled;return v.a.createElement("div",null,v.a.createElement(U.a,{quiet:!0,variant:"action",icon:v.a.createElement(Qe.a,null),disabled:!a,onClick:function(){Object(K.a)("headerUndoClick",{action:"headerClick"}),Ne.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"undo"},{},{"ui.view_type":"button"}),e.undo()}},Object(X.b)("GlobalNav.Button.Undo","Undo")),v.a.createElement(U.a,{quiet:!0,variant:"action",icon:v.a.createElement(qe.a,null),disabled:!n,onClick:function(){Object(K.a)("headerRedoClick",{action:"headerClick"}),Ne.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"redo"},{},{"ui.view_type":"button"}),e.redo()}},Object(X.b)("GlobalNav.Button.Redo","Redo")),v.a.createElement("div",{className:"button-divider"}),v.a.createElement(U.a,{quiet:!0,variant:"action",icon:v.a.createElement(re.a,null),onClick:function(){Object(K.a)("headerDownloadClick",{action:"headerClick"}),Ne.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"download"},{},{"ui.view_type":"button"}),e.saveImage(),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}},Object(X.b)("GlobalNav.ImageAction.Button.Download","Download")),v.a.createElement("div",{className:"button-divider"}),v.a.createElement(U.a,{quiet:!0,variant:"action",icon:v.a.createElement(Ke.a,null),onClick:function(){Object(K.a)("headerOpenImageClick",{action:"headerClick"}),Ne.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"open-image"},{},{"ui.view_type":"button"}),e.openImage()}},Object(X.b)("GlobalNav.ImageAction.Button.OpenImage","Open image")),v.a.createElement("div",{className:"button-divider"}))}}]),a}(m.PureComponent)),et=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).doc=void 0,n.doc=e,n}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e),b.a.render(v.a.createElement($e,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&b.a.unmountComponentAtNode(this.container),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"update",value:function(){var e;null===(e=this.getDocActionsView())||void 0===e||e.setUndoRedoEnabled(this.doc.canUndo(),this.doc.canRedo())}},{key:"undo",value:function(){this.doc.undo()}},{key:"redo",value:function(){this.doc.redo()}},{key:"saveImage",value:function(){this.doc.showSaveImage()}},{key:"openImage",value:function(){this.doc.showOpenImage()}},{key:"disableUndoRedo",value:function(){var e;null===(e=this.getDocActionsView())||void 0===e||e.setUndoRedoEnabled(!1,!1)}},{key:"getDocActionsView",value:function(){return this.view}}]),a}(L.a),tt=(a(493),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.controller,a=e.message,n=e.title,r=e.confirmLabel,i=e.secondaryLabel,o=e.cancelLabel;return v.a.createElement(B.a,{className:"nav-confirm",title:n,role:"dialog",confirmLabel:r,secondaryLabel:i,cancelLabel:o,keyboardConfirm:!0,onConfirm:function(e){t.confirm(e&&"primary"!==e?"discard":"apply")},onCancel:function(){t.cancel()},variant:"confirmation"},a)}}]),a}(m.PureComponent));!function(e){e[e.apply=0]="apply",e[e.discard=1]="discard",e[e.cancel=2]="cancel"}(Ze||(Ze={}));var at,nt=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e,n){var r;return Object(l.a)(this,a),(r=t.call(this)).dialogId=void 0,r.editorName=void 0,r.onUserInteraction=void 0,r.editorName=e,r.onUserInteraction=n,r}return Object(c.a)(a,[{key:"show",value:function(){this.dialogId=T.a.show(v.a.createElement(tt,{controller:this,message:this.getDialogMessage(),title:this.getDialogTitle(),confirmLabel:this.getDialogConfirmLabel(),secondaryLabel:this.getDialogSecondaryLabel(),cancelLabel:this.getDialogCancelLabel()}))}},{key:"close",value:function(){this.dialogId&&T.a.hide(this.dialogId),this.dialogId=void 0}},{key:"cancel",value:function(){this.trackEvent(Ze.cancel),this.onUserInteraction&&this.onUserInteraction(Ze.cancel),this.close()}},{key:"confirm",value:function(e){"apply"===e?(this.trackEvent(Ze.apply),this.onUserInteraction&&this.onUserInteraction(Ze.apply)):(this.trackEvent(Ze.discard),this.onUserInteraction&&this.onUserInteraction(Ze.discard)),this.close()}},{key:"getDialogMessage",value:function(){return"Do you want to apply the edits?"}},{key:"getDialogConfirmLabel",value:function(){return Object(X.b)("ApplyEdits.Dialog.Warn.Button.Confirm","Apply")}},{key:"getDialogSecondaryLabel",value:function(){return"Discard"}},{key:"getDialogCancelLabel",value:function(){return Object(X.b)("ApplyEdits.Dialog.Warn.Button.Cancel","Cancel")}},{key:"getDialogTitle",value:function(){return Object(X.b)("ApplyEdits.Dialog.Warn.Title","Apply edits?")}},{key:"trackEvent",value:function(e){}}]),a}(L.a),rt=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"getDialogMessage",value:function(){return Object(X.b)("ApplyEdits.Dialog.Warn.Download.Message","Do you want to apply the edits you just made before downloading your photo?")}},{key:"getDialogSecondaryLabel",value:function(){return Object(X.b)("ApplyEdits.Dialog.Warn.Download.utton.Discard","Download without saving")}},{key:"trackEvent",value:function(e){switch(e){case Ze.apply:Object(K.a)("".concat(this.editorName,":applyEditsConfirm"),{action:"applyEditsBeforeDownload"});break;case Ze.discard:Object(K.a)("".concat(this.editorName,":applyEditsDiscard"),{action:"applyEditsBeforeDownload"});break;case Ze.cancel:Object(K.a)("".concat(this.editorName,":applyEditsCancel"),{action:"applyEditsBeforeDownload"})}}}]),a}(nt),it=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"getDialogMessage",value:function(){return Object(X.b)("ApplyEdits.Dialog.SwitchEditor.Warn.Message","Do you want to apply the edits you just made before switching to a new editing space?")}},{key:"getDialogConfirmLabel",value:function(){return Object(X.b)("ApplyEdits.Dialog.SwitchEditor.Warn.Button.Confirm","Apply edits to image")}},{key:"getDialogSecondaryLabel",value:function(){return Object(X.b)("ApplyEdits.Dialog.SwitchEditor.Warn.Button.Discard","Discard edits")}},{key:"getDialogTitle",value:function(){return Object(X.b)("ApplyEdits.Dialog.SwitchEditor.Warn.Title","Apply edits?")}},{key:"trackEvent",value:function(e){switch(e){case Ze.apply:Object(K.a)("".concat(this.editorName,":applyEditsConfirm"),{action:"applyEditsBeforeSwitchEditor"});break;case Ze.discard:Object(K.a)("".concat(this.editorName,":applyEditsDiscard"),{action:"applyEditsBeforeSwitchEditor"});break;case Ze.cancel:Object(K.a)("".concat(this.editorName,":applyEditsCancel"),{action:"applyEditsBeforeSwitchEditor"})}}}]),a}(nt),ot=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"getDialogMessage",value:function(){return Object(X.b)("ApplyEdits.Dialog.Warn.OpenImage.Message","If you open a new photo, you\u2019ll lose the changes you just made...")}},{key:"getDialogConfirmLabel",value:function(){return Object(X.b)("ApplyEdits.Dialog.Warn.OpenImage.Button.Confirm","Open new photo")}},{key:"getDialogSecondaryLabel",value:function(){}},{key:"getDialogCancelLabel",value:function(){return Object(X.b)("ApplyEdits.Dialog.Warn.OpenImage.Button.Cancel","Keep Editing")}},{key:"getDialogTitle",value:function(){return Object(X.b)("ApplyEdits.Dialog.Warn.OpenImage.Title","Open new image?")}},{key:"trackEvent",value:function(e){switch(e){case Ze.apply:Object(K.a)("".concat(this.editorName,":discardChangeContinue"),{action:"discardChangeBeforeOpenImage"});break;case Ze.cancel:Object(K.a)("".concat(this.editorName,":discardChangeCancel"),{action:"discardChangeBeforeOpenImage"})}}}]),a}(nt),st=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"getDialogMessage",value:function(){return Object(X.b)("ApplyEdits.Dialog.Warn.SignIn.Message","Do you want to apply the edits you just made before signing in?")}},{key:"getDialogSecondaryLabel",value:function(){return Object(X.b)("ApplyEdits.Dialog.Warn.SignIn.Button.Discard","Sign in without saving")}},{key:"trackEvent",value:function(e){switch(e){case Ze.apply:Object(K.a)("".concat(this.editorName,":applyEditsConfirm"),{action:"applyEditsBeforeSignIn"});break;case Ze.discard:Object(K.a)("".concat(this.editorName,":applyEditsDiscard"),{action:"applyEditsBeforeSignIn"});break;case Ze.cancel:Object(K.a)("".concat(this.editorName,":applyEditsCancel"),{action:"applyEditsBeforeSignIn"})}}}]),a}(nt),lt=a(74),ct=(a(495),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={loading:e.loading},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"setLoading",value:function(e){this.setState({loading:e})}},{key:"setEditorId",value:function(e){this.setState({editorId:e})}},{key:"render",value:function(){var e=this.state,t=e.loading,a=e.editorId;return v.a.createElement(v.a.Fragment,null,v.a.createElement("div",{id:"doc-container",className:a},t&&v.a.createElement(Be.a,{centered:!0}),v.a.createElement("div",{id:"toolbar-container"}),v.a.createElement("div",{id:"stage-container"}),v.a.createElement("div",{id:"editor-container"}),v.a.createElement("div",{id:"layers-container"})))}}]),a}(m.PureComponent)),ut=a(85),dt=a(111),ht=["number","text"];!function(e){e.PAN="pan",e.ZOOM="zoom",e.UNDOREDO="undoredo",e.APPLYCANCEL="applycancel"}(at||(at={}));var ft,pt=function(){function e(t){Object(l.a)(this,e),this.doc=void 0,this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.doc=t}return Object(c.a)(e,[{key:"addEventListener",value:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)}},{key:"removeEventListener",value:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}},{key:"onKeyDown",value:function(e){if(!this.ignoreKeyEvent(e)&&this.doc){var t=this.doc.getEditorIds(),a=this.doc.getCurrentEditor(),n=this.doc.getHotKeysEnabled();switch(e.key.toLowerCase()){case"c":if(!this.isIgnoredInputEvent(e)&&this.isSingleKey(e)&&(null===t||void 0===t?void 0:t.includes("crop")))return void this.doc.setEditor(He.a.crop);break;case"j":if(!this.isIgnoredInputEvent(e)&&this.isSingleKey(e)&&(null===t||void 0===t?void 0:t.includes("spotheal")))return void this.doc.setEditor(He.a.spotheal);break;case"r":if(!this.isIgnoredInputEvent(e)&&this.isSingleKey(e)&&(null===t||void 0===t?void 0:t.includes("resize")))return void this.doc.setEditor(He.a.resize);break;case"e":if(!this.isIgnoredInputEvent(e)&&this.isSingleKey(e)&&(null===t||void 0===t?void 0:t.includes("adjust")))return void this.doc.setEditor(He.a.adjust);break;case"b":if(!this.isIgnoredInputEvent(e)&&this.isSingleKey(e)&&(null===t||void 0===t?void 0:t.includes("cutout")))return void this.doc.setEditor(He.a.cutout);break;case"f":if(!this.isIgnoredInputEvent(e)&&this.isSingleKey(e)&&(null===t||void 0===t?void 0:t.includes("effects")))return void this.doc.setEditor(He.a.effects);break;case"z":if(e.metaKey||e.ctrlKey){if(e.shiftKey&&this.doc.canRedo()&&n.includes(at.UNDOREDO))return this.doc.redo(),void Ne.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"redo"},{},{"ui.view_type":"shortcut"});if(!e.shiftKey&&this.doc.canUndo()&&n.includes(at.UNDOREDO))return this.doc.undo(),void Ne.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"undo"},{},{"ui.view_type":"shortcut"})}else{if(this.isSingleKey(e)&&this.doc.getStage().getZoomMode()===ye.NONE&&n.includes(at.ZOOM))return this.doc.getStage().setZoomMode(ye.ZOOMIN),void e.preventDefault();if(this.isSingleKey(e)&&this.doc.getStage().getZoomMode()!==ye.NONE&&n.includes(at.ZOOM))return this.doc.getStage().setZoomMode(ye.NONE),void e.preventDefault()}break;case"o":if(e.metaKey||e.ctrlKey)return Ne.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"open-image"},{},{"ui.view_type":"shortcut"}),this.doc.showOpenImage(),void e.preventDefault();break;case"s":if(e.metaKey||e.ctrlKey)return Ne.getInstance().track({"event.workflow":"Home","event.subcategory":"Actions","event.type":"click","event.subtype":"download"},{},{"ui.view_type":"shortcut"}),this.doc.showSaveImage(),void e.preventDefault();break;case"enter":if((e.metaKey||e.ctrlKey)&&n.includes(at.APPLYCANCEL))return void(null===a||void 0===a||a.apply());break;case"escape":if(n.includes(at.APPLYCANCEL))return null===a||void 0===a||a.cancel(),void(document.activeElement instanceof HTMLElement&&document.activeElement.blur());break;case" ":if(!this.isIgnoredInputEvent(e)&&!this.doc.getStage().isPanningMode()&&n.includes(at.PAN))return this.doc.getStage().togglePanning(),void e.preventDefault();break;case"+":if((e.metaKey||e.ctrlKey)&&n.includes(at.ZOOM))return this.doc.getStage().zoomIn(),void e.preventDefault();break;case"-":if((e.metaKey||e.ctrlKey)&&n.includes(at.ZOOM))return this.doc.getStage().zoomOut(),void e.preventDefault();break;case"0":if((e.metaKey||e.ctrlKey)&&n.includes(at.ZOOM))return this.doc.getStage().zoomToggleFit(),void e.preventDefault();break;case"alt":if(!this.isIgnoredInputEvent(e)&&this.doc.getStage().getZoomMode()===ye.ZOOMIN&&n.includes(at.ZOOM))return this.doc.getStage().setZoomMode(ye.ZOOMOUT),void e.preventDefault()}null===a||void 0===a||a.onKeyDown(e)}}},{key:"onKeyUp",value:function(e){if(!this.ignoreKeyEvent(e)&&this.doc){var t=this.doc.getCurrentEditor(),a=this.doc.getHotKeysEnabled();switch(e.key.toLowerCase()){case" ":if(!this.isIgnoredInputEvent(e)&&this.doc.getStage().isPanningMode()&&a.includes(at.PAN))return this.doc.getStage().togglePanning(),void e.preventDefault();break;case"alt":if(!this.isIgnoredInputEvent(e)&&this.doc.getStage().getZoomMode()===ye.ZOOMOUT&&a.includes(at.ZOOM))return this.doc.getStage().setZoomMode(ye.ZOOMIN),void e.preventDefault()}null===t||void 0===t||t.onKeyUp(e)}}},{key:"isIgnoredInputEvent",value:function(e){if(e.target instanceof HTMLInputElement){var t=e.target;return ht.some((function(e){return t.type.includes(e)}))}return!1}},{key:"ignoreKeyEvent",value:function(e){if(e.target instanceof HTMLDivElement&&"dialog"===e.target.getAttribute("role"))return!0;var t=document.getElementsByClassName("spectrum-Underlay is-open");if(t&&t.length>0)return!0;var a=document.getElementsByClassName("spectrum-Popover spectrum-Dialog--default is-open");return!!(a&&a.length>0)}},{key:"isSingleKey",value:function(e){return!e.ctrlKey&&!e.metaKey&&!e.shiftKey}}]),e}(),mt=a(214),vt=a(35),gt=(a(582),a(62)),bt=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).cropContainer=void 0,n.cropBox=void 0,n.cropOverlay=void 0,n.cropHandleTL=void 0,n.cropHandleT=void 0,n.cropHandleTR=void 0,n.cropHandleR=void 0,n.cropHandleBR=void 0,n.cropHandleB=void 0,n.cropHandleBL=void 0,n.cropHandleL=void 0,n.state={isStraightening:!1,hideHorizontalEdgeHandles:!1,hideVerticalEdgeHandles:!1},n.cropContainer=v.a.createRef(),n.cropBox=v.a.createRef(),n.cropOverlay=v.a.createRef(),n.cropHandleTL=v.a.createRef(),n.cropHandleT=v.a.createRef(),n.cropHandleTR=v.a.createRef(),n.cropHandleR=v.a.createRef(),n.cropHandleBR=v.a.createRef(),n.cropHandleB=v.a.createRef(),n.cropHandleBL=v.a.createRef(),n.cropHandleL=v.a.createRef(),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),this.refresh()}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"setIsStraighening",value:function(e){this.setState({isStraightening:e})}},{key:"checkHit",value:function(e,t){return this.isHit(this.cropHandleTL.current,e,t)?ft.TL:this.isHit(this.cropHandleTR.current,e,t)?ft.TR:this.isHit(this.cropHandleBL.current,e,t)?ft.BL:this.isHit(this.cropHandleBR.current,e,t)?ft.BR:this.isHit(this.cropHandleT.current,e,t)?ft.T:this.isHit(this.cropHandleL.current,e,t)?ft.L:this.isHit(this.cropHandleR.current,e,t)?ft.R:this.isHit(this.cropHandleB.current,e,t)?ft.B:this.isHit(this.cropBox.current,e,t)?ft.BOX_INSIDE:ft.BOX_OUTSIDE}},{key:"isHit",value:function(e,t,a){var n=null===e||void 0===e?void 0:e.getBoundingClientRect();return void 0!==n&&n.left<=t&&n.right>=t&&n.top<=a&&n.bottom>=a}},{key:"refresh",value:function(){}},{key:"draw",value:function(e,t,a,n){var r,i,o,s,l={width:null!==(r=null===(i=this.cropContainer.current)||void 0===i?void 0:i.clientWidth)&&void 0!==r?r:0,height:null!==(o=null===(s=this.cropContainer.current)||void 0===s?void 0:s.clientHeight)&&void 0!==o?o:0};if(this.cropBox.current&&(this.cropBox.current.style.left="".concat(t[0],"px"),this.cropBox.current.style.top="".concat(t[1],"px"),this.cropBox.current.style.width="".concat(Math.floor(e[0]),"px"),this.cropBox.current.style.height="".concat(Math.floor(e[1]),"px")),this.cropOverlay.current){this.cropOverlay.current.width=l.width,this.cropOverlay.current.height=l.height;var c=this.cropOverlay.current.getContext("2d");if(c)switch(c.clearRect(0,0,l.width,l.height),c.globalAlpha=.5,c.globalCompositeOperation="source-over",c.fillStyle="var(--spectrum-global-color-gray-700)",c.fillRect(0,0,l.width,l.height),c.globalAlpha=1,c.globalCompositeOperation="destination-out",n){case vt.a.RECT:c.fillRect(t[0]+0,t[1]+0,e[0],e[1]);break;case vt.a.ELLIPSE:var u=t[0]+e[0]/2+0,d=t[1]+e[1]/2+0,h=Math.abs(e[0]/2),f=Math.abs(e[1]/2);c.beginPath(),c.ellipse(u,d,h,f,0,0,2*Math.PI,!1),c.fill();break;case vt.a.HEART:case vt.a.OCTAGON:case vt.a.ROUNDED_RECT:case vt.a.STAR:gt.c.applyShape(c,n,gt.b.CUTOUT,t[0],t[1],e[0],e[1])}}this.setState({hideHorizontalEdgeHandles:e[0]<100,hideVerticalEdgeHandles:e[1]<100})}},{key:"render",value:function(){var e=this.state,t=e.isStraightening,a=e.hideHorizontalEdgeHandles,n=e.hideVerticalEdgeHandles,r=t?["crop-box","straightening"]:["crop-box"];return a&&r.push("hide-horizontal"),n&&r.push("hide-vertical"),v.a.createElement(v.a.Fragment,null,v.a.createElement("canvas",{id:"cropOverlay",className:"crop-overlay",ref:this.cropOverlay}),v.a.createElement("div",{id:"cropContainer",className:"crop-container",ref:this.cropContainer},v.a.createElement("div",{className:"crop-center"}),v.a.createElement("div",{id:"cropBox",className:r.join(" "),ref:this.cropBox},v.a.createElement("div",{className:"crop-corner crop-tl",ref:this.cropHandleTL},v.a.createElement("div",null)),v.a.createElement("div",{className:"crop-edge horizontal crop-t",ref:this.cropHandleT},v.a.createElement("div",null)),v.a.createElement("div",{className:"crop-corner crop-tr",ref:this.cropHandleTR},v.a.createElement("div",null)),v.a.createElement("div",{className:"crop-edge vertical crop-l",ref:this.cropHandleL},v.a.createElement("div",null)),v.a.createElement("div",{className:"crop-edge vertical crop-r",ref:this.cropHandleR},v.a.createElement("div",null)),v.a.createElement("div",{className:"crop-corner crop-bl",ref:this.cropHandleBL},v.a.createElement("div",null)),v.a.createElement("div",{className:"crop-edge horizontal crop-b",ref:this.cropHandleB},v.a.createElement("div",null)),v.a.createElement("div",{className:"crop-corner crop-br",ref:this.cropHandleBR},v.a.createElement("div",null)),v.a.createElement("div",{className:"crop-rough-grid horizontal"}),v.a.createElement("div",{className:"crop-rough-grid vertical"}),v.a.createElement("div",{className:"crop-fine-grid"}),v.a.createElement("div",{className:"crop-center"}))))}}]),a}(m.PureComponent);!function(e){e[e.TL=1]="TL",e[e.TR=2]="TR",e[e.BL=3]="BL",e[e.BR=4]="BR",e[e.T=5]="T",e[e.R=6]="R",e[e.B=7]="B",e[e.L=8]="L",e[e.BOX_INSIDE=9]="BOX_INSIDE",e[e.BOX_OUTSIDE=10]="BOX_OUTSIDE"}(ft||(ft={}));var yt,Et=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).editor=void 0,n.editor=e,n}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e),b.a.render(v.a.createElement(bt,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&b.a.unmountComponentAtNode(this.container),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"getCropToolView",value:function(){return this.view}},{key:"refresh",value:function(){var e,t=this.editor.getEditorState(),a=this.editor.getCropBoxDetails();null===(e=this.getCropToolView())||void 0===e||e.draw(a.dimensions,a.offset,a.editorCenter,t.cropShape)}},{key:"checkHit",value:function(e){var t;return null===(t=this.getCropToolView())||void 0===t?void 0:t.checkHit(e[0],e[1])}},{key:"setIsStraighening",value:function(e){var t;null===(t=this.getCropToolView())||void 0===t||t.setIsStraighening(e)}}]),a}(L.a);!function(e){e[e.NONE=1]="NONE",e[e.CROP_EDGE=2]="CROP_EDGE",e[e.CROP_CORNER=3]="CROP_CORNER",e[e.MOVE_CANVAS=4]="MOVE_CANVAS",e[e.STRAIGHTENING=5]="STRAIGHTENING",e[e.STRAIGHTENING_CONSTRAINED=6]="STRAIGHTENING_CONSTRAINED"}(yt||(yt={}));var wt=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,He.a.crop,e)).undostack=void 0,n.cropTool=void 0,n.toolLayerWidth=void 0,n.toolLayerHeight=void 0,n.initialToolLayerWidth=void 0,n.initialToolLayerHeight=void 0,n.stageZoomFactor=void 0,n.editorState=void 0,n.originalImageDimensions=void 0,n.maxEdgeLength=0,n.currentAction=void 0,n.cropTool=new Et(Object(u.a)(n)),n.toolLayerWidth=0,n.toolLayerHeight=0,n.stageZoomFactor=1,n.initialToolLayerWidth=0,n.initialToolLayerHeight=0;var r=n.doc.getImageData(),i=r.width,o=r.height;return n.originalImageDimensions=we.e.fromValues(i,o),n.editorState={straightening:0,orientation:0,flipScaleXFactor:1,flipScaleYFactor:1,aspectRatio:0,aspectRatioKey:gt.a,aspectRatioRotated:!1,cropShape:vt.a.RECT,cropBoxDimensions:we.e.create(),stageOffset:we.e.create(),stageRotationRadian:0},n.maxEdgeLength=Math.min.apply(Math,Object(dt.a)(Ie.getMaxCanvasSizes())),n}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e),b.a.render(v.a.createElement(mt.a,{controller:this,imageAspectRatio:this.originalImageDimensions[0]/this.originalImageDimensions[1]}),e);var t=this.doc.getStage().getToolLayer();t&&this.cropTool.createView(t)}},{key:"destroyView",value:function(){this.cropTool.destroyView(),this.container&&b.a.unmountComponentAtNode(this.container),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"startEditor",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"startEditor",this).call(this,e);var t,n=this.doc.getStage(),r=n.getToolLayer();r&&(this.toolLayerWidth=r.clientWidth,this.toolLayerHeight=r.clientHeight,this.initialToolLayerWidth=this.toolLayerWidth,this.initialToolLayerHeight=this.toolLayerHeight,n.setStageActionsVisible(!1),n.setTransformMode(be.CORE),this.stageZoomFactor=this.getMaximumStageZoomFactor(this.toolLayerWidth,this.toolLayerHeight),this.editorState=this.getInitialEditorState(),this.undostack=new Me.a(this.getEditorState(),100),this.updateStage(),this.cropTool.refresh(),null===(t=this.view)||void 0===t||t.refresh());this.doc.setHotKeysDisabled([at.PAN,at.ZOOM])}},{key:"endEditor",value:function(){Object(d.a)(Object(h.a)(a.prototype),"endEditor",this).call(this);var e=this.doc.getStage();e.setTransformMode(be.NORMAL),e.setStageActionsVisible(!0),this.doc.setHotKeysEnabled([at.PAN,at.ZOOM])}},{key:"hasUndoStack",value:function(){return!0}},{key:"canUndo",value:function(){var e,t;return null!==(e=null===(t=this.undostack)||void 0===t?void 0:t.canUndo())&&void 0!==e&&e}},{key:"canRedo",value:function(){var e,t;return null!==(e=null===(t=this.undostack)||void 0===t?void 0:t.canRedo())&&void 0!==e&&e}},{key:"undo",value:function(){var e;this.undostack&&(this.undostack.undo(),this.setEditorState(this.undostack.getCurrent())),this.doc.getDocActions().update(),null===(e=this.view)||void 0===e||e.refresh(),this.cropTool.refresh(),this.updateStage()}},{key:"redo",value:function(){var e;this.undostack&&(this.undostack.redo(),this.setEditorState(this.undostack.getCurrent())),this.doc.getDocActions().update(),null===(e=this.view)||void 0===e||e.refresh(),this.cropTool.refresh(),this.updateStage()}},{key:"isDirty",value:function(){return!Object(I.isEqual)(this.editorState,this.getInitialEditorState())}},{key:"reset",value:function(){var e;this.editorState=this.getInitialEditorState(),this.addUndoStep(),null===(e=this.view)||void 0===e||e.refresh(),this.cropTool.refresh(),this.updateStage()}},{key:"apply",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDirty()){e.next=3;break}return this.cancel(),e.abrupt("return");case 3:return e.next=5,new Promise((function(e,a){t.view.showProcessing(Object(s.a)(o.a.mark((function n(){var r;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.getCroppedImageData())){n.next=9;break}return t.doc.getStage().setImageData(r),t.doc.getStage().setTransformMode(be.NORMAL),t.doc.getStage().centerContent(),n.next=7,t.doc.editorApply(r,Object(X.b)("CropView.InfoToast.Message","Your image was cropped"));case 7:(new N.a).showSurveyEditor(He.a.crop),e();case 9:a();case 10:case"end":return n.stop()}}),n)}))))}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.isDirty()&&(new N.a).showSurveyEditor(He.a.crop),this.doc.editorCancel()}},{key:"onPointerDown",value:function(e){if(0===e.button){var t=this.doc.getStage().eventToLocal(e),a=we.e.fromValues(e.clientX,e.clientY),n=this.cropTool.checkHit(a),r=this.getCropBoxDetails(),i=this.getEditorState();if(n){var o;switch(this.currentAction={target:n,startPoint:t,startCropBox:this.getRect(r.offset,r.dimensions),startCropBoxOffset:r.offset,startCropBoxDimensions:r.dimensions,startStageBoundingBox:this.doc.getStage().getBoundingBox(),startStageOffset:i.stageOffset,startStageRotationRadian:i.stageRotationRadian,startStageImageDimensions:this.getScaledImageDimensions(),mode:yt.NONE,pointerTrackingEnabled:!1},n){case ft.TR:case ft.TL:case ft.BL:case ft.BR:this.currentAction.mode=yt.CROP_CORNER,this.currentAction.pointerTrackingEnabled=!0;break;case ft.T:case ft.L:case ft.R:case ft.B:this.currentAction.mode=yt.CROP_EDGE,this.currentAction.pointerTrackingEnabled=!0;break;case ft.BOX_INSIDE:case ft.BOX_OUTSIDE:this.currentAction.mode=yt.MOVE_CANVAS,this.currentAction.pointerTrackingEnabled=!0;break;default:this.currentAction.mode=yt.NONE}this.cropTool.refresh(),null===(o=this.view)||void 0===o||o.refresh()}}}},{key:"onPointerMove",value:function(e){if(this.currentAction&&this.currentAction.pointerTrackingEnabled){var t=this.doc.getStage().eventToLocal(e),a=we.e.fromValues(t[0]-this.currentAction.startPoint[0],t[1]-this.currentAction.startPoint[1]),n=e.shiftKey?this.currentAction.startCropBoxDimensions[0]/this.currentAction.startCropBoxDimensions[1]:this.editorState.aspectRatio;if(this.currentAction.mode===yt.CROP_CORNER||this.currentAction.mode===yt.CROP_EDGE){var r=[ft.TR,ft.R,ft.BR].indexOf(this.currentAction.target)>-1,i=[ft.BL,ft.B,ft.BR].indexOf(this.currentAction.target)>-1,o=[ft.T,ft.B].indexOf(this.currentAction.target)>-1,s=[ft.L,ft.R].indexOf(this.currentAction.target)>-1,l=r?-1:1,c=i?-1:1;o&&(a[0]=0),s&&(a[1]=0),!e.ctrlKey&&Math.abs(a[0])<8&&(a[0]=0),!e.ctrlKey&&Math.abs(a[1])<8&&(a[1]=0);var u=this.getCurrentEditorCenter(),d=this.getCropBoxDetails().offset,h=we.e.create();e.shiftKey||this.editorState.aspectRatioKey!==gt.a?(this.currentAction.mode===yt.CROP_CORNER&&(d[1]=this.currentAction.startCropBoxOffset[1]+a[1]*c,(h=this.getCropBoxDimensions(d,u))[0]=h[1]*n,h=this.constrainCropBoxMinMaxSize(h,n)),this.currentAction.mode===yt.CROP_EDGE&&(o&&(d[1]=this.currentAction.startCropBoxOffset[1]+a[1]*c,(h=this.getCropBoxDimensions(d,u))[0]=h[1]*n,h=this.constrainCropBoxMinMaxSize(h,n)),s&&(d[0]=this.currentAction.startCropBoxOffset[0]+a[0]*l,(h=this.getCropBoxDimensions(d,u))[1]=h[0]/n,h=this.constrainCropBoxMinMaxSize(h,n)))):(d=we.e.fromValues(this.currentAction.startCropBoxOffset[0]+a[0]*l,this.currentAction.startCropBoxOffset[1]+a[1]*c),h=this.getCropBoxDimensions(d,u),h=this.constrainCropBoxMinMaxSize(h,n)),e.altKey?(a[0]=0,a[1]=0):(o||(a[0]=(this.currentAction.startCropBoxDimensions[0]-h[0])/2*l),s||(a[1]=(this.currentAction.startCropBoxDimensions[1]-h[1])/2*c)),we.e.copy(this.editorState.cropBoxDimensions,h)}var f=this.currentAction.mode===yt.MOVE_CANVAS?-1:1,p=we.e.fromValues(this.currentAction.startStageOffset[0]-a[0]*f,this.currentAction.startStageOffset[1]-a[1]*f);if(this.currentAction.mode===yt.MOVE_CANVAS){e.shiftKey&&(Math.abs(a[0])>Math.abs(a[1])?p[1]=this.currentAction.startStageOffset[1]:p[0]=this.currentAction.startStageOffset[0]);var m=Object(I.cloneDeep)(this.currentAction.startStageBoundingBox);if(m&&(m.left+=a[0],m.right+=a[0],m.top+=a[1],m.bottom+=a[1]),!e.ctrlKey&&m){var v={left:m.left-this.currentAction.startCropBox.left,right:m.right-this.currentAction.startCropBox.right,top:m.top-this.currentAction.startCropBox.top,bottom:m.bottom-this.currentAction.startCropBox.bottom};Math.abs(v.left)<8?p[0]-=v.left:Math.abs(v.right)<8&&(p[0]-=v.right),Math.abs(v.top)<8?p[1]-=v.top:Math.abs(v.bottom)<8&&(p[1]-=v.bottom)}}we.e.copy(this.editorState.stageOffset,p),this.updateStage(),this.cropTool.refresh()}}},{key:"onPointerUp",value:function(){var e;this.currentAction&&this.currentAction.pointerTrackingEnabled&&this.addUndoStep(),this.currentAction=void 0,null===(e=this.view)||void 0===e||e.refresh()}},{key:"onContainerSizeChanged",value:function(){this.doc.getStage().getToolLayer()&&this.cropTool.refresh()}},{key:"getEditorState",value:function(){return Object(I.cloneDeep)(this.editorState)}},{key:"setEditorState",value:function(e){this.editorState=Object(I.cloneDeep)(e)}},{key:"startStraightening",value:function(){var e=this.getCropBoxDetails();this.currentAction={mode:this.cropBoxInImage(e.offset,e.dimensions)?yt.STRAIGHTENING_CONSTRAINED:yt.STRAIGHTENING,pointerTrackingEnabled:!1,startCropBoxOffset:e.offset,startCropBoxDimensions:e.dimensions,startCropBox:this.getRect(e.offset,e.dimensions),startPoint:we.e.create(),startStageBoundingBox:this.doc.getStage().getBoundingBox(),startStageImageDimensions:this.getScaledImageDimensions(),startStageOffset:this.getEditorState().stageOffset,startStageRotationRadian:0,target:ft.BOX_OUTSIDE},this.cropTool.setIsStraighening(!0)}},{key:"endStraightening",value:function(){this.currentAction=void 0,this.cropTool.setIsStraighening(!1)}},{key:"setStraightening",value:function(e){var t,a,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.currentAction||this.startStraightening(),this.editorState.straightening=e;var r=this.getCurrentRadian();this.editorState.stageOffset=this.calculateRotatedStageOffset(r),this.editorState.stageRotationRadian=r,(null===(t=this.currentAction)||void 0===t?void 0:t.mode)===yt.STRAIGHTENING_CONSTRAINED&&this.constrainCropBoxInImage(this.currentAction.startCropBoxDimensions,this.currentAction.startCropBoxOffset),n&&(this.endStraightening(),this.addUndoStep()),this.updateStage(),null===(a=this.view)||void 0===a||a.refresh(),this.cropTool.refresh()}},{key:"changeOrientation",value:function(e){var t;this.editorState.orientation+=e*this.editorState.flipScaleXFactor*this.editorState.flipScaleYFactor;var a=this.getCurrentRadian();this.calculateAspectRatioRotation(),this.editorState.stageOffset=this.calculateRotatedStageOffset(a),this.editorState.stageRotationRadian=a,this.addUndoStep(),this.updateStage(),null===(t=this.view)||void 0===t||t.refresh(),this.cropTool.refresh()}},{key:"rotateAspectRatio",value:function(){var e;this.calculateAspectRatioRotation(),this.addUndoStep(),null===(e=this.view)||void 0===e||e.refresh(),this.cropTool.refresh()}},{key:"flipHorizontally",value:function(){var e;this.editorState.flipScaleXFactor*=-1;var t=we.e.ceil(we.e.create(),we.e.fromValues(this.getCurrentEditorCenter()[0],this.editorState.stageOffset[1]));this.editorState.stageOffset=we.e.round(we.e.create(),we.e.rotate(this.editorState.stageOffset,this.editorState.stageOffset,t,we.a.toRadian(180))),this.editorState.stageRotationRadian*=-1,this.addUndoStep(),this.updateStage(),null===(e=this.view)||void 0===e||e.refresh()}},{key:"flipVertically",value:function(){var e;this.editorState.flipScaleYFactor*=-1;var t=we.e.fromValues(this.editorState.stageOffset[0],this.getCurrentEditorCenter()[1]);this.editorState.stageOffset=we.e.round(we.e.create(),we.e.rotate(this.editorState.stageOffset,this.editorState.stageOffset,t,we.a.toRadian(180))),this.editorState.stageRotationRadian*=-1,this.addUndoStep(),this.updateStage(),null===(e=this.view)||void 0===e||e.refresh()}},{key:"setCropShape",value:function(e){var t;this.editorState.cropShape=e,this.addUndoStep(),this.cropTool.refresh(),null===(t=this.view)||void 0===t||t.refresh()}},{key:"changeAspectRatio",value:function(e,t){var a;if(0!==t){var n=null;n=we.e.clone(this.editorState.cropBoxDimensions);var r=we.e.create();t>n[0]/n[1]?(r[1]=n[0]/t,r[0]=n[0]):(r[0]=n[1]*t,r[1]=n[1]),r=this.constrainCropBoxMinMaxSize(r,t),this.editorState.cropBoxDimensions=r}this.editorState.aspectRatio=t,this.editorState.aspectRatioKey=e,this.addUndoStep(),null===(a=this.view)||void 0===a||a.refresh(),this.cropTool.refresh()}},{key:"getCurrentEditorCenter",value:function(){return we.e.fromValues(this.toolLayerWidth/2,this.toolLayerHeight/2)}},{key:"getCropBoxDetails",value:function(){var e=this.getCurrentEditorCenter(),t=we.e.clone(this.editorState.cropBoxDimensions);return{dimensions:t,offset:this.getCropBoxOffsetFromDimensions(t,e),editorCenter:e}}},{key:"getInitialEditorState",value:function(){var e=this.getScaledImageDimensions(),t=this.getCropBoxOffsetFromDimensions(e,this.getCurrentEditorCenter());return{straightening:0,orientation:0,flipScaleXFactor:1,flipScaleYFactor:1,aspectRatio:0,aspectRatioKey:gt.a,aspectRatioRotated:!1,cropShape:vt.a.RECT,cropBoxDimensions:we.e.clone(e),stageOffset:we.e.clone(t),stageRotationRadian:0}}},{key:"getMaximumStageZoomFactor",value:function(e,t){return this.floorDecimalNumber(Math.min(e,t)/Math.sqrt(Math.pow(this.originalImageDimensions[0],2)+Math.pow(this.originalImageDimensions[1],2))*.95,2)}},{key:"getScaledImageDimensions",value:function(){return we.e.fromValues(this.roundDecimalNumber(this.originalImageDimensions[0]*this.stageZoomFactor,2),this.roundDecimalNumber(this.originalImageDimensions[1]*this.stageZoomFactor,2))}},{key:"getCropBoxDimensions",value:function(e,t){var a=we.e.subtract(we.e.create(),t,e);return we.e.round(we.e.create(),we.e.scale(a,a,2))}},{key:"getCropBoxOffsetFromDimensions",value:function(e,t){var a=we.e.fromValues(t[0]-e[0]/2,t[1]-e[1]/2);return we.e.round(a,a)}},{key:"constrainCropBoxMinMaxSize",value:function(e,t){var a=we.e.clone(e),n=Math.min(this.maxEdgeLength*this.stageZoomFactor,this.toolLayerWidth),r=Math.min(this.maxEdgeLength*this.stageZoomFactor,this.toolLayerHeight),i=a[0]/n,o=a[1]/r;(i>1||o>1)&&(a=0===t?we.e.fromValues(Math.min(a[0],n),Math.min(a[1],r)):t<1?we.e.scale(a,a,1/o):we.e.scale(a,a,1/i));var s=Math.max(32*this.stageZoomFactor,32),l=a[0]/s,c=a[1]/s;return(l<1||c<1)&&(a=0===t?we.e.fromValues(Math.max(a[0],s),Math.max(a[1],s)):t<1?we.e.fromValues(s,s/t):we.e.fromValues(s*t,s)),a}},{key:"calculateAspectRatioRotation",value:function(){var e=1/(this.editorState.cropBoxDimensions[0]/this.editorState.cropBoxDimensions[1]);this.editorState.cropBoxDimensions=we.e.fromValues(this.editorState.cropBoxDimensions[1],this.editorState.cropBoxDimensions[0]),this.editorState.aspectRatioKey!==gt.a&&(this.editorState.aspectRatio=e)}},{key:"addUndoStep",value:function(){var e;null===(e=this.undostack)||void 0===e||e.add(this.getEditorState()),this.doc.getDocActions().update()}},{key:"calculateRotatedStageOffset",value:function(e){var t=we.e.ceil(we.e.create(),this.getCurrentEditorCenter()),a=we.e.clone(this.editorState.stageOffset);return a=we.e.subtract(a,a,t),a=we.e.rotate(a,a,we.e.create(),e-this.editorState.stageRotationRadian),a=we.e.add(a,a,t),we.e.clone(a)}},{key:"constrainPointToStage",value:function(e,t,a){var n=this.pointToStage(e);return n[0]<2&&(n[0]=0),n[0]>t-2&&(n[0]=t),n[1]<2&&(n[1]=0),n[1]>a-2&&(n[1]=a),this.pointFromStage(n)}},{key:"testPointInStage",value:function(e,t,a){var n=this.pointToStage(e);return!(n[0]<-2)&&(!(n[0]>t+2)&&(!(n[1]<-2)&&!(n[1]>a+2)))}},{key:"cropBoxInImage",value:function(e,t){var a=this.originalImageDimensions[0],n=this.originalImageDimensions[1],r=we.e.fromValues(e[0],e[1]),i=we.e.fromValues(e[0]+t[0],e[1]),o=we.e.fromValues(e[0]+t[0],e[1]+t[1]),s=we.e.fromValues(e[0],e[1]+t[1]);return this.testPointInStage(r,a,n)&&this.testPointInStage(i,a,n)&&this.testPointInStage(o,a,n)&&this.testPointInStage(s,a,n)}},{key:"constrainCropBoxInImage",value:function(e,t){var a=this.originalImageDimensions[0],n=this.originalImageDimensions[1],r=we.e.fromValues(t[0],t[1]),i=we.e.fromValues(t[0]+e[0],t[1]),o=we.e.fromValues(t[0]+e[0],t[1]+e[1]),s=we.e.fromValues(t[0],t[1]+e[1]),l=this.constrainPointToStage(r,a,n);we.e.copy(r,l),l=this.constrainPointToStage(i,a,n),we.e.copy(i,l),l=this.constrainPointToStage(o,a,n),we.e.copy(o,l),l=this.constrainPointToStage(s,a,n),we.e.copy(s,l);var c=Math.max(r[0],s[0]),u=Math.max(r[1],i[1]),d=Math.min(i[0],o[0]),h=Math.min(s[1],o[1]),f=t[0]+e[0]/2,p=t[1]+e[1]/2,m=we.e.fromValues(c,u),v=d-c,g=h-u,b=we.e.fromValues(v,g),y=m[0]+b[0]/2-f,E=m[1]+b[1]/2-p;this.editorState.cropBoxDimensions[0]=b[0],this.editorState.cropBoxDimensions[1]=b[1],this.editorState.stageOffset[0]-=y,this.editorState.stageOffset[1]-=E}},{key:"pointRectDist",value:function(e,t,a){var n=Math.max(Math.min(e[0],t[0]+a[0]),t[0]),r=Math.max(Math.min(e[1],t[1]+a[1]),t[1]);return Math.sqrt((e[0]-n)*(e[0]-n)+(e[1]-r)*(e[1]-r))}},{key:"pointToStage",value:function(e){var t=this.calculateTransformMatrix();return we.b.invert(t,t),we.e.transformMat2d(we.e.create(),e,t)}},{key:"pointFromStage",value:function(e){var t=this.calculateTransformMatrix();return we.e.transformMat2d(we.e.create(),e,t)}},{key:"calculateTransformMatrix",value:function(){var e=we.b.create();return e=we.b.translate(e,e,we.e.round(we.e.create(),this.editorState.stageOffset)),e=we.b.scale(e,e,we.e.fromValues(this.stageZoomFactor*this.editorState.flipScaleXFactor,this.stageZoomFactor*this.editorState.flipScaleYFactor)),e=we.b.rotate(e,e,this.editorState.stageRotationRadian*this.editorState.flipScaleXFactor*this.editorState.flipScaleYFactor)}},{key:"getCroppedImageData",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d"),a=this.getCropBoxDetails();e.width=Math.floor(a.dimensions[0]/this.stageZoomFactor),e.height=Math.floor(a.dimensions[1]/this.stageZoomFactor);var n=this.doc.getStage().getCanvas();if(t&&n){var r=we.b.fromTranslation(we.b.create(),we.e.fromValues(-a.offset[0],-a.offset[1])),i=we.b.fromScaling(we.b.create(),we.e.fromValues(1/this.stageZoomFactor,1/this.stageZoomFactor)),o=this.calculateTransformMatrix();switch(we.b.multiply(o,r,o),we.b.multiply(o,i,o),t.save(),t.transform(o[0],o[1],o[2],o[3],o[4],o[5]),t.drawImage(n,0,0),t.restore(),this.editorState.cropShape){case vt.a.RECT:break;case vt.a.ELLIPSE:var s=e.width/2,l=e.height/2,c=s,u=l;t.globalAlpha=1,t.globalCompositeOperation="destination-in",t.beginPath(),t.ellipse(s,l,c,u,0,0,2*Math.PI,!1),t.fill();break;case vt.a.HEART:case vt.a.OCTAGON:case vt.a.ROUNDED_RECT:case vt.a.STAR:gt.c.applyShape(t,this.editorState.cropShape,gt.b.KEEP,0,0,e.width,e.height)}return t.getImageData(0,0,e.width,e.height)}}},{key:"updateStage",value:function(){var e=this.calculateTransformMatrix();this.doc.getStage().setTransformMatrix(e),this.doc.getStage().updateTransform()}},{key:"getCurrentRadian",value:function(){return we.a.toRadian((this.editorState.orientation+this.editorState.straightening)*this.editorState.flipScaleXFactor*this.editorState.flipScaleYFactor)}},{key:"roundDecimalNumber",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}},{key:"floorDecimalNumber",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;return Math.floor(e*Math.pow(10,t))/Math.pow(10,t)}},{key:"getRect",value:function(e,t){return{left:e[0],top:e[1],right:e[0]+t[0],bottom:e[1]+t[1]}}}]),a}(He.b),xt=a(110),kt=a(113),St=function(){function e(t){Object(l.a)(this,e),this.imsToken=void 0,this.storageService=void 0,this.imsToken=t,this.storageService=new kt.a(t)}return Object(c.a)(e,[{key:"createInput",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a){var n,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=R()(),r="/temp/ps_upload_".concat(n,".jpg"),e.next=4,x.a.createBlob(t,"image/jpeg",.75);case 4:return i=e.sent,e.next=7,this.storageService.createOrUpdateResource(r,"image/jpeg",i,a);case 7:return e.abrupt("return",{href:r,storage:"adobe"});case 8:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"runAction",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a,n,r){var i,s,l,c,u,d,h,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return s=R()(),l="/temp/ps_result_".concat(s,".jpg"),r&&r(Object(X.b)("PhotoshopService.ProgressState.Process","Process"),25),c={inputs:[t],options:{actions:[a]},outputs:[{href:l,storage:"adobe",type:"image/jpeg",overwrite:!0,width:0,quality:7}]},e.next=8,fetch("".concat("https://image.adobe.io","/pie/psdService/batchPlay"),{method:"POST",headers:{"x-api-key":"ps-frictionless-web",authorization:this.imsToken,"content-type":"application/json"},body:JSON.stringify(c),signal:n.signal});case 8:if(202===(u=e.sent).status){e.next=11;break}return e.abrupt("return",null);case 11:return e.next=13,u.json();case 13:return d=e.sent,e.next=16,this.checkJobFinished(d._links.self.href,n,r);case 16:if(h=e.sent){e.next=19;break}return e.abrupt("return",Promise.resolve(null));case 19:if("succeeded"!==h.outputs[0].status){e.next=25;break}return r&&r(Object(X.b)("PhotoshopService.ProgressState.Download","Download"),75),e.next=23,this.storageService.getResource(l);case 23:return f=e.sent,e.abrupt("return",x.a.createImageData(f));case 25:throw console.error((null===(i=h.outputs[0].errors)||void 0===i?void 0:i.title)||"Unknown error"),new Error("Job failed");case 27:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"getJobStatus",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return console.debug("getJobStatus",t),e.next=5,fetch(t,{method:"GET",headers:{"x-api-key":"ps-frictionless-web",authorization:this.imsToken},signal:a.signal});case 5:if(200===(n=e.sent).status){e.next=8;break}throw new Error(n.statusText);case 8:return e.abrupt("return",n.json());case 9:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"checkJobFinished",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getJobStatus(t,a);case 2:if((r=e.sent).outputs){e.next=5;break}return e.abrupt("return",r);case 5:if("running"!==r.outputs[0].status&&"pending"!==r.outputs[0].status){e.next=10;break}return n&&n("running"===r.outputs[0].status?Object(X.b)("PhotoshopService.ProgressState.Running","Running"):Object(X.b)("PhotoshopService.ProgressState.Pending","Pending"),30),e.next=9,this.wait(1e3);case 9:return e.abrupt("return",this.checkJobFinished(r._links.self.href,a));case 10:return e.abrupt("return",r);case 11:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"wait",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}]),e}(),Ot=function(e,t,a){var n=e.createShader(a);return null==n||(e.shaderSource(n,t),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))?n:(alert("An error occurred compiling the shaders: ".concat(e.getShaderInfoLog(n))),null)},Ct=function(e,t){e.clearColor(0,0,0,0),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.enable(e.BLEND),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0);var a=function(e,t,a){var n=e.createProgram();if(null!==n){var r=Ot(e,t,e.VERTEX_SHADER),i=Ot(e,a,e.FRAGMENT_SHADER);null!==r&&e.attachShader(n,r),null!==i&&e.attachShader(n,i),e.linkProgram(n)}return null!==n&&e.getProgramParameter(n,e.LINK_STATUS)||alert("Unable to initialize the shader program."),n}(e,"\nattribute vec4 a_position;\nvarying vec2 v_position;\n\nvoid main() {\n  v_position = vec2(a_position.z, 1.0 - a_position.w);\n  gl_Position = vec4(a_position.x, a_position.y, 0, 1);\n}\n","\nprecision highp float;\n\nuniform vec2 u_outsize;\nvarying vec2 v_position;\nuniform sampler2D textureData;\nuniform vec2 textureSize;\nuniform float intensity;\nuniform int filterID;\nuniform vec2 control1;\nuniform vec2 control2;\nuniform vec2 control3;\nuniform vec2 control4;\n\nvec4 getTextureColorAt(vec2 position) {\n  vec2 texPosition = position/textureSize;\n\n  return texture2D(textureData, texPosition);\n}\n\n@textureFunction\n\nvoid main(void)\n{\n  vec2 outPixelDelta = vec2(1.0, 1.0) / u_outsize;\n  vec2 outPos = v_position * u_outsize;\n\n  vec2 texDelta = vec2(1.0,1.0)/textureSize;\n\n  vec2 texPosition = v_position * u_outsize;\n  vec4 col = processPixelAt(texPosition);\n\n  gl_FragColor = col;\n}\n".replace("@textureFunction",t));if(a){e.useProgram(a);var n=e.getAttribLocation(a,"a_position");return e.enableVertexAttribArray(n),function(e){var t=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t);e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,-1,1,0,1,1,-1,1,0,1,1,1,1]),e.STATIC_DRAW)}(e),{shaderProgram:a,vertexPositionAttribute:n}}return null},Pt=function(){function e(t){if(Object(l.a)(this,e),this.canvas=void 0,this.gl=void 0,this.texture=void 0,this.textureData=void 0,this.shaderProgram=void 0,this.canvas=document.createElement("canvas"),this.textureData=document.createElement("canvas"),this.gl=function(e){var t=null;try{t=e.getContext("webgl",{alpha:!0})||e.getContext("experimental-webgl")}catch(a){alert("Error: No Web GL")}return t}(this.canvas),this.texture=null,this.gl){var a=Ct(this.gl,t);a&&(this.shaderProgram=a.shaderProgram,this.gl.vertexAttribPointer(a.vertexPositionAttribute,4,this.gl.FLOAT,!1,0,0))}}return Object(c.a)(e,[{key:"setImageData",value:function(e,t,a,n,r){var i;if(this.gl){var o=Math.floor(n),s=Math.floor(r);this.textureData.width===o&&this.textureData.height===s||(this.textureData.width=o,this.textureData.height=s),null===(i=this.textureData.getContext("2d"))||void 0===i||i.putImageData(a,Math.floor(e),Math.floor(t))}}},{key:"getImageData",value:function(){if(this.gl){var e=new ImageData(this.canvas.width,this.canvas.height);return this.gl.readPixels(0,0,this.canvas.width,this.canvas.height,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e.data),e}}},{key:"drawGL",value:function(e,t,a){if(this.gl&&this.shaderProgram){this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);var n=this.textureData;if(n){this.gl.useProgram(this.shaderProgram),this.texture=function(e,t){var a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),a}(this.gl,n);var r=this.gl.getUniformLocation(this.shaderProgram,"textureData");this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.uniform1i(r,0);var i=this.gl.getUniformLocation(this.shaderProgram,"textureSize");i&&this.gl.uniform2f(i,n.width,n.height);var o=this.gl.getUniformLocation(this.shaderProgram,"u_outsize");this.gl.uniform2f(o,this.canvas.width,this.canvas.height);var s=this.gl.getUniformLocation(this.shaderProgram,"intensity");this.gl.uniform1f(s,e);var l=this.gl.getUniformLocation(this.shaderProgram,"filterID");this.gl.uniform1i(l,t);for(var c=0;c<a.length;c++){var u=this.gl.getUniformLocation(this.shaderProgram,"control".concat(c+1));this.gl.uniform2f(u,a[c][0],a[c][1])}this.gl.drawArrays(this.gl.TRIANGLES,0,6)}}}}]),e}(),Tt=a(114),At=function(){function e(t,a){Object(l.a)(this,e),this.doc=void 0,this.id=void 0,this.title=void 0,this.creatorName=void 0,this.applyTitle=void 0,this.hasIntensity=void 0,this.intensityLabel=void 0,this.startIntensity=void 0,this.useTransparency=void 0,this.previewImgRef=void 0,this.deeplinkId=void 0,this.controlPoints=void 0,this.intensity=Rt,this.cachable=!0,this.progressDialogRef=void 0,this.canceled=!1,this.loginNeeded=!1,this.doc=t,this.id=a.id,this.title=a.title,this.creatorName=a.creatorName,this.applyTitle=a.applyTitle,this.hasIntensity=a.hasIntensity,this.intensityLabel=a.intensityLabel,this.startIntensity=a.startIntensity,a.startIntensity&&(this.intensity=a.startIntensity),this.useTransparency=a.useTransparency,this.deeplinkId=a.deeplinkId,this.controlPoints=a.controlPoints}return Object(c.a)(e,[{key:"hasLoginNeeded",value:function(){return this.loginNeeded}},{key:"setIntensity",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.intensity=t,this.useTransparency&&(a=this.doc.getStage().getMaskCanvas())&&(a.style.opacity="".concat(t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIntensity",value:function(){return this.intensity}},{key:"getId",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getCreatorName",value:function(){return this.creatorName}},{key:"hasIntensityEnabled",value:function(){return this.hasIntensity}},{key:"getIntensityLabel",value:function(){return this.intensityLabel}},{key:"getAriaIntensityValue",value:function(e){return"".concat(Math.round(100*e)," %")}},{key:"getDeepLinkId",value:function(){return this.deeplinkId}},{key:"getPreview",value:function(){throw new Error("NOT IMPLEMENTED")}},{key:"getControlPoints",value:function(){return this.controlPoints?this.controlPoints:[]}},{key:"isExperimental",value:function(){return!1}},{key:"reset",value:function(){this.startIntensity&&(this.intensity=this.startIntensity)}},{key:"isCancelled",value:function(){return this.canceled}},{key:"setControlPoints",value:function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.controlPoints=t;case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"apply",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve(this.doc.getImageData()));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"useCache",value:function(){return this.cachable}},{key:"drawEffectImageData",value:function(e){if(this.useTransparency){this.doc.getStage().setImageData(this.doc.getImageData()),this.adaptSize(e),this.doc.getStage().setMaskData(e);var t=this.doc.getStage().getMaskCanvas();t&&(t.style.opacity="".concat(this.intensity))}else this.doc.getStage().setImageData(e),this.doc.getStage().setMaskData(void 0);this.doc.getStage().centerContent()}},{key:"adaptSize",value:function(e){var t=this.doc.getStage().getCanvas();if(t&&(e.width!==t.width||e.height!==t.height)){var a=x.a.resizeImageData(this.doc.getImageData(),e.width,e.height);a&&this.doc.getStage().setImageData(a),this.doc.getStage().centerContent()}}},{key:"getFinalImageData",value:function(){if(this.useTransparency){var e=this.doc.getStage().getCanvas(),t=this.doc.getStage().getMaskCanvas();if(!e||!t)return;return x.a.renderIntoImageData(e,t,this.intensity)}var a=this.doc.getStage().getCanvas(),n=null===a||void 0===a?void 0:a.getContext("2d");if(a&&n)return n.getImageData(0,0,null===a||void 0===a?void 0:a.width,null===a||void 0===a?void 0:a.height)}},{key:"showProgressDialog",value:function(e){var t=this;this.progressDialogRef=new Tt.a(this.applyTitle||Object(X.b)("EffectsView.ProgressDialog.Title","Applying art effect"),(function(){t.canceled=!0,t.cancelEffectProcess()}),void 0,e),this.progressDialogRef.show()}},{key:"updateProgress",value:function(e){var t;null===(t=this.progressDialogRef)||void 0===t||t.setProgress(e.state,e.percentage)}},{key:"cancelEffectProcess",value:function(){}}],[{key:"getEffectType",value:function(){return jt.base}}]),e}();At.PREVIEW_IMAGE_SIZE=265;var jt,It=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e,n){var r;return Object(l.a)(this,a),(r=t.call(this,e,n)).previewData=void 0,r.glCanvas=void 0,r.shaderCode=void 0,r.ariaFunction=void 0,r.shaderCode="\n// getTextureColorAt(vec2 position)\n//\n// sampler2D textureData - current texture\n// vec2 position - current pixel position\n// vec2 textureSize - current texture size\n// float intensity - intensity\n// int effectID\n\nvec4 processPixelAt(vec2 position) {\n    return vec4(1.0, 0.0, 0.0, 1.0);\n}\n",n.shaderCode&&(r.shaderCode=n.shaderCode),r.ariaFunction=n.ariaFunction,r.cachable=!1,r}return Object(c.a)(a,null,[{key:"getEffectType",value:function(){return jt.gl}}]),Object(c.a)(a,[{key:"getPreview",value:function(){if(this.previewData)return this.previewData;var e=x.a.resizeImageDataToWidth(this.doc.getImageData(),a.PREVIEW_IMAGE_SIZE);if(e){var t=this.drawGL(e,this.id,this.startIntensity||ut.a);t&&(this.previewData=x.a.createDataUrl(t))}return this.previewData||x.a.createDataUrl(this.doc.getImageData())}},{key:"apply",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.drawGL(this.doc.getImageData(),this.id,this.intensity))){e.next=3;break}return e.abrupt("return",Promise.resolve(t));case 3:return e.abrupt("return",Promise.reject(new Error("No input given")));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAriaIntensityValue",value:function(e){return this.ariaFunction?this.ariaFunction(e):Object(d.a)(Object(h.a)(a.prototype),"getAriaIntensityValue",this).call(this,e)}},{key:"setIntensity",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(d.a)(Object(h.a)(a.prototype),"setIntensity",this).call(this,t),e.next=3,this.apply();case 3:(n=e.sent)&&this.drawEffectImageData(n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setControlPoints",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(d.a)(Object(h.a)(a.prototype),"setControlPoints",this).call(this,t),e.next=3,this.apply();case 3:(n=e.sent)&&this.drawEffectImageData(n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"drawGL",value:function(e,t,a){return this.glCanvas||(this.glCanvas=new Pt(this.shaderCode)),this.glCanvas.canvas.width=e.width,this.glCanvas.canvas.height=e.height,this.glCanvas.setImageData(0,0,e,e.width,e.height),this.glCanvas.drawGL(a,t,this.controlPoints||[]),this.glCanvas.getImageData()}}]),a}(At),Mt=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e,n){var r;return Object(l.a)(this,a),(r=t.call(this,e,{id:n,title:Object(X.b)("EffectsView.Custom.Pixelate.Title","Pixelate"),hasIntensity:!0,intensityLabel:Object(X.b)("EffectsView.Custom.Pixelate.Pixelsize","Pixel size"),startIntensity:.1,useTransparency:!1,deeplinkId:"pixelate"})).previewData=void 0,r.cachable=!1,r}return Object(c.a)(a,null,[{key:"getEffectType",value:function(){return jt.pixelate}}]),Object(c.a)(a,[{key:"getPreview",value:function(){if(this.previewData)return this.previewData;var e=x.a.resizeImageDataToWidth(this.doc.getImageData(),a.PREVIEW_IMAGE_SIZE);if(e){var t=this.pixelate(e,5);t&&(this.previewData=x.a.createDataUrl(t))}return this.previewData||x.a.createDataUrl(this.doc.getImageData())}},{key:"getAriaIntensityValue",value:function(e){return"".concat(Math.round(100*e))}},{key:"setIntensity",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(d.a)(Object(h.a)(a.prototype),"setIntensity",this).call(this,t),e.next=3,this.apply();case 3:(n=e.sent)&&this.drawEffectImageData(n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"apply",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.pixelate(this.doc.getImageData(),Math.round(100*this.intensity)))){e.next=3;break}return e.abrupt("return",Promise.resolve(t));case 3:return e.abrupt("return",Promise.reject(new Error("No input given")));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pixelate",value:function(e,t){if(0===t)return e;var a=e.width/t|0,n=e.height/t|0,r=x.a.createHTMLCanvasElementForSize(e.width,e.height).getContext("2d"),i=x.a.createHTMLCanvasElementForSize(a,n),o=i.getContext("2d");return r&&o?(r.imageSmoothingEnabled=!1,o.drawImage(x.a.createHTMLCanvasElement(e),0,0,a,n),r.drawImage(i,0,0,a,n,0,0,e.width,e.height),r.getImageData(0,0,e.width,e.height)):void 0}}]),a}(At);!function(e){e.base="base",e.psapi="psapi",e.pixelate="pixelate",e.gl="gl"}(jt||(jt={}));var Rt=1,_t=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"getEffects",value:function(e){return Object(I.filter)([new It(e,{id:1,title:Object(X.b)("EffectsView.GLEffect.InvertColor.Title","Invert color"),hasIntensity:!1,deeplinkId:"invertcolor",shaderCode:"\nvec4 processPixelAt(vec2 position) {\n  vec4 col = getTextureColorAt(position);\n\n  return vec4(1.0 - col.rgb, col.a);\n}\n"}),new Mt(e,2),new Dt(e,{id:3,title:Object(X.b)("EffectsView.PSAction.OilPaint.Title","Oil Paint"),applyTitle:Object(X.b)("EffectsView.PSAction.OilPaint.ApplyTitle","Applying Oil Paint"),actionUrl:"https://static-assets.photoshop.adobe.com/effects/psactions/OilPaint.atn",previewImageUrl:"https://static-assets.photoshop.adobe.com/sample/effects/OilPaint_Dog_510x272.jpg",hasIntensity:!0,intensityLabel:Object(X.b)("EffectsView.PSAction.Intensity","Intensity"),startIntensity:1,useTransparency:!0,deeplinkId:"oilpaint"}),new It(e,{id:4,title:Object(X.b)("EffectsView.GLEffect.Halftone.Title","Halftone"),hasIntensity:!0,intensityLabel:Object(X.b)("EffectsView.GLEffect.Halftone.Intensity","Tone Amount"),startIntensity:.5,deeplinkId:"halftone",shaderCode:"\nconst float PI = 3.14159265358979323846264338327950288;\nconst float angle = 45.0;\nfloat offset = 3.0 + intensity * textureSize.x / 100.0;\n\nvec4 processPixelAt(vec2 position) {\n\n  vec4 fragColor = getTextureColorAt(position);\n\n  vec2 coord = vec2(position.x, position.y);\n  vec2 rot;\n  vec2 center;\n  float pLen = offset/sqrt(2.0);\n\n  rot.x = coord.x * cos(PI * angle/180.0) + coord.y * sin(PI * angle/180.0);\n  rot.y = coord.x * -sin(PI * angle/180.0) + coord.y * cos(PI * angle/180.0);\n  center = floor(0.5 + rot/offset) * offset;\n  rot.x = center.x * cos(PI * -angle/180.0) + center.y * sin(PI * -angle/180.0);\n  rot.y = center.x * -sin(PI * -angle/180.0) + center.y * cos(PI * -angle/180.0);\n\n  vec4 col = fragColor;\n  vec4 dst;\n\n  vec2 dist = coord - rot;\n\n  float light = 1.0 - (col.r + col.g + col.b)/3.0;\n\n  if (light * pLen < length(dist))\n\n      dst = vec4(1,1,1,col.a);\n  else\n      dst = vec4(0,0,0,col.a);\n\n  return dst;\n}\n"}),new It(e,{id:5,title:Object(X.b)("EffectsView.GLEffect.ColorHalftone.Title","Color Halftone"),hasIntensity:!0,intensityLabel:Object(X.b)("EffectsView.GLEffect.ColorHalftone.Intensity","Color Halftone Amount"),startIntensity:.5,deeplinkId:"colorhalftone",shaderCode:"\nconst float PI = 3.14159265358979323846264338327950288;\nconst float angle = 45.0;\nfloat offset = 3.0 + intensity * textureSize.x / 100.0;\n\nvec4 processPixelAt(vec2 position) {\n\n  vec4 fragColor = getTextureColorAt(position);\n  vec2 coord = vec2(position.x, position.y);\n  vec4 col = fragColor;\n\n  vec2 rot;\n  vec2 center;\n  float pLen = offset/sqrt(2.0);\n  float a1 = angle;\n  float a2 = angle + 60.0;\n  float a3 = angle + 30.0;\n  float a4 = angle + 45.0;\n\n  rot.x = coord.x * cos(PI * a1/180.0) + coord.y * sin(PI * a1/180.0);\n  rot.y = coord.x * -sin(PI * a1/180.0) + coord.y * cos(PI * a1/180.0);\n  center = floor(0.5 + rot/offset) * offset;\n  rot.x = center.x * cos(PI * -a1/180.0) + center.y * sin(PI * -a1/180.0);\n  rot.y = center.x * -sin(PI * -a1/180.0) + center.y * cos(PI * -a1/180.0);\n  vec2 dist1 = coord - rot;\n\n  rot.x = coord.x * cos(PI * a2/180.0) + coord.y * sin(PI * a2/180.0);\n  rot.y = coord.x * -sin(PI * a2/180.0) + coord.y * cos(PI * a2/180.0);\n  center = floor(0.5 + rot/offset) * offset;\n  rot.x = center.x * cos(PI * -a2/180.0) + center.y * sin(PI * -a2/180.0);\n  rot.y = center.x * -sin(PI * -a2/180.0) + center.y * cos(PI * -a2/180.0);\n  vec2 dist2 = coord - rot;\n\n  rot.x = coord.x * cos(PI * a3/180.0) + coord.y * sin(PI * a3/180.0);\n  rot.y = coord.x * -sin(PI * a3/180.0) + coord.y * cos(PI * a3/180.0);\n  center = floor(0.5 + rot/offset) * offset;\n  rot.x = center.x * cos(PI * -a3/180.0) + center.y * sin(PI * -a3/180.0);\n  rot.y = center.x * -sin(PI * -a3/180.0) + center.y * cos(PI * -a3/180.0);\n  vec2 dist3 = coord - rot;\n\n  rot.x = coord.x * cos(PI * a4/180.0) + coord.y * sin(PI * a4/180.0);\n  rot.y = coord.x * -sin(PI * a4/180.0) + coord.y * cos(PI * a4/180.0);\n  center = floor(0.5 + rot/offset) * offset;\n  rot.x = center.x * cos(PI * -a4/180.0) + center.y * sin(PI * -a4/180.0);\n  rot.y = center.x * -sin(PI * -a4/180.0) + center.y * cos(PI * -a4/180.0);\n  vec2 dist4 = coord - rot;\n\n  float k = 0.1;\n  vec4 cmyk = vec4(0.0, 1.0 - col.r, 1.0 - col.g,1.0 - col.b);\n  cmyk[0] = cmyk[1] * k;\n  if (cmyk[2] * k < cmyk[0])\n      cmyk[0] = cmyk[2] * k;\n  if (cmyk[3] * k < cmyk[0])\n      cmyk[0] = cmyk[3] * k;\n  cmyk[1] -= cmyk[0];\n  cmyk[2] -= cmyk[0];\n  cmyk[3] -= cmyk[0];\n\n  vec4 v = vec4(1.0);\n  if (cmyk[0] * pLen < length(dist1))\n      v[0] = 0.0;\n\n  if (cmyk[1] * pLen < length(dist2))\n      v[1] = 0.0;\n  if (cmyk[2] * pLen < length(dist3))\n      v[2] = 0.0;\n  if (cmyk[3] * pLen < length(dist4))\n      v[3] = 0.0;\n\n  vec4 dst = col;\n  dst.r = 1.0 - clamp(v[0] + v[1], 0.0, 1.0);\n  dst.g = 1.0 - clamp(v[0] + v[2], 0.0, 1.0);\n  dst.b = 1.0 - clamp(v[0] + v[3], 0.0, 1.0);\n\n  return dst;\n}\n"}),new It(e,{id:6,title:Object(X.b)("EffectsView.GLEffect.Posterize.Title","Posterize"),hasIntensity:!0,intensityLabel:Object(X.b)("EffectsView.GLEffect.Posterize.Intensity","Posterize Amount"),startIntensity:.25,deeplinkId:"posterize",shaderCode:"\nvec4 processPixelAt(vec2 position) {\n  vec4 col = getTextureColorAt(position);\n\n  mat4 YIQMatrix = mat4(\n      0.299,  0.596,  0.212, 0.000,\n      0.587, -0.275, -0.523, 0.000,\n      0.114, -0.321,  0.311, 0.000,\n      0.000,  0.000,  0.000, 1.000\n  );\n\n  mat4 inverseYIQ = mat4(\n      1.0,    1.0,    1.0,    0.0,\n      0.956, -0.272, -1.10,  0.0,\n      0.621, -0.647,  1.70,   0.0,\n      0.0,    0.0,    0.0,    1.0\n  );\n\n  float numColors = 1.0 + (1.0 - intensity) * 20.0;\n  vec4 yiq = YIQMatrix * col;\n\n  yiq[0] = floor(yiq[0] * numColors + 0.5)/numColors + 0.1;\n\n  vec4 dst = inverseYIQ * yiq;\n  return dst;\n}\n"}),new It(e,{id:7,title:Object(X.b)("EffectsView.GLEffect.ColorCycle.Title","Color Cycle"),hasIntensity:!0,intensityLabel:Object(X.b)("EffectsView.GLEffect.ColorCycle.Angle","Color Angle"),startIntensity:.25,deeplinkId:"colorcycle",shaderCode:"\n\nvec3 rgb2hsb( in vec3 c ){\n  vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p = mix(vec4(c.bg, K.wz),\n               vec4(c.gb, K.xy),\n               step(c.b, c.g));\n  vec4 q = mix(vec4(p.xyw, c.r),\n               vec4(c.r, p.yzx),\n               step(p.x, c.r));\n  float d = q.x - min(q.w, q.y);\n  float e = 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)),\n              d / (q.x + e),\n              q.x);\n}\n\nvec3 hsb2rgb( in vec3 c ){\n  vec3 rgb = clamp(abs(mod(c.x*6.0+vec3(0.0,4.0,2.0),\n                           6.0)-3.0)-1.0,\n                   0.0,\n                   1.0 );\n  rgb = rgb*rgb*(3.0-2.0*rgb);\n  return c.z * mix(vec3(1.0), rgb, c.y);\n}\n\nvec4 processPixelAt(vec2 position) {\n  vec4 col = getTextureColorAt(position);\n\n  vec3 hsb = rgb2hsb(col.rgb);\n\n  // hsb.x = intensity;\n  hsb.x = mod(hsb.x + intensity, 1.0);\n\n  col.rgb = hsb2rgb(hsb);\n\n  return col;\n}\n",ariaFunction:function(e){return"".concat(Math.floor(360*e),"\xb0")}}),new It(e,{id:8,title:Object(X.b)("EffectsView.GLEffect.LensFlare.Title","Lens Flare"),hasIntensity:!0,intensityLabel:Object(X.b)("EffectsView.GLEffect.LensFlare.Intensity","Intensity"),startIntensity:.95,deeplinkId:"lensflare",shaderCode:"\n\nconst float PI = 3.14159265358979323846264338327950288;\nconst int octaves = 3;\nconst float persistence = 0.5;\nfloat imageScale = min(textureSize.x, textureSize.y);\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n  return mod289(((x * 34.0) + 1.0) * x);\n}\n\nvec4 taylorInvSqrt(vec4 r) {\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v) {\n  const vec2 C = vec2(1.0 / 6.0, 1.0 / 3.0);\n  const vec4 D = vec4(0.0, 0.5, 1.0, 2.0);\n  const float n_ = 1.0 / 7.0;\n  vec3 i = floor(v + dot(v, C.yyy));\n  vec3 x0 = v - i + dot(i, C.xxx);\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min(g.xyz, l.zxy);\n  vec3 i2 = max(g.xyz, l.zxy);\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy;\n  vec3 x3 = x0 - D.yyy;\n  i = mod289(i);\n  vec4 p = permute(permute(permute(i.z + vec4(0.0, i1.z, i2.z, 1.0)) + i.y + vec4(0.0, i1.y, i2.y, 1.0)) + i.x + vec4(0.0, i1.x, i2.x, 1.0));\n  vec3  ns = n_ * D.wyz - D.xzx;\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_);\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n  vec4 b0 = vec4(x.xy, y.xy);\n  vec4 b1 = vec4(x.zw, y.zw);\n  vec4 s0 = floor(b0) * 2.0 + 1.0;\n  vec4 s1 = floor(b1) * 2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n  vec4 a0 = b0.xzyw + s0.xzyw * sh.xxyy;\n  vec4 a1 = b1.xzyw + s1.xzyw * sh.zzww;\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n  vec4 m = max(0.6 - vec4(dot(x0, x0), dot(x1, x1), dot(x2, x2), dot(x3, x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot(m * m, vec4(dot(p0, x0), dot(p1, x1), dot(p2, x2), dot(p3, x3)));\n}\n\nfloat onoise(vec3 v) {\n  float total = 0.0;\n  float frequency = 1.0;\n  float amplitude = 1.0;\n  float maxValue = 0.0;\n  for (int i = 0; i < octaves; i++) {\n    total += snoise(v * frequency) * amplitude;\n    maxValue += amplitude;\n    amplitude *= persistence;\n    frequency *= 2.0;\n  }\n  return total / maxValue;\n}\n\nfloat angleForVec(vec2 pos)\n{\n    if (pos.x == 0.0)\n        return (pos.y < 0.0) ? -(PI/2.0) : (PI/2.0);\n\n    if (pos.x < 0.0)\n        return PI - atan(pos.y/-pos.x);\n    else\n        return atan(pos.y/pos.x);\n}\n\nfloat glow(float val) {\n  return clamp(1.0 - pow(val, 0.2), 0.0, 1.0);\n}\n\nfloat rays(float angle, float len, float rand) {\n  return clamp(0.5 + onoise(vec3(angle * 3.9, len * 0.8, rand)), 0.0, 1.0);\n}\n\nvec3 flare(vec2 circlePos, vec2 position) {\n  vec2 circleVec = position - circlePos;\n\n  float len = length(circleVec)/imageScale;\n  float angle = angleForVec(circleVec);\n\n  float rayLight = rays(angle, len, intensity);\n  float rayComp = rayLight * glow(len) * 0.5;\n  float glowComp = glow(len * 2.4) * 3.0 * pow(0.5, 0.1);\n\n  vec3 rayCol = vec3(1.0, 1.0, 0.5);\n  vec3 glowCol = vec3(1.0, 1.0, 0.8);\n\n  return clamp(rayComp * rayCol + glowComp * glowCol, 0.0, 1.0) * intensity;\n}\n\nvec3 spot(vec2 circlePos, vec3 color, float size, vec2 position) {\n  vec2 circleVec = position - circlePos;\n\n  float len = length(circleVec)/imageScale;\n  float x = len / (size * 0.5);\n  float f = clamp(1.0 - pow(x, 0.2), 0.0, 1.0);\n\n  return color * f * intensity;\n}\n\nvec3 circle(vec2 circlePos, vec3 color, float size, float amp, vec2 position) {\n  vec2 circleVec = position - circlePos;\n\n  float len = length(circleVec)/imageScale;\n  float x = pow(len / (size * 0.5), amp);\n\n  float f = clamp(1.2 * (pow(x, 2.0) - pow(x, 13.0) + 0.1), 0.0, 1.0);\n\n  return color * f * intensity;\n}\n\nvec2 linePos(float pos) {\n  vec2 p1 = vec2(control1.x * textureSize.x, (1.0 - control1.y) * textureSize.y);\n  vec2 p2 = vec2(control2.x * textureSize.x, (1.0 - control2.y) * textureSize.y);\n\n  return mix(p1, p2, pos);\n}\n\nvec3 blendModeScreen(vec3 a, vec3 b) {\n  return 1.0 - (1.0 - a) * (1.0 - b);\n}\n\nvec4 processPixelAt(vec2 position) {\n  vec4 col = getTextureColorAt(position);\n\n  vec3 light = flare(linePos(0.0), position);\n  col.rgb = blendModeScreen(col.rgb, light);\n\n  light = circle(linePos(0.3), vec3(1.0, 0.9, 0.2) * 0.15, 0.2, 3.0, position);\n  col.rgb = blendModeScreen(col.rgb, light);\n\n  light = circle(linePos(0.43), vec3(0.5, 0.9, 0.43) * 0.4, 0.12, 1.0, position);\n  col.rgb = blendModeScreen(col.rgb, light);\n\n  light = spot(linePos(0.6), vec3(1.0, 0.3, 0.0) * 2.5, 0.4, position);\n  col.rgb = blendModeScreen(col.rgb, light);\n\n  light = circle(linePos(0.82), vec3(1.0, 0.9, 0.6) * 0.4, 0.35, 2.0, position);\n  col.rgb = blendModeScreen(col.rgb, light);\n\n  light = circle(linePos(1.0), vec3(0.5, 0.7, 1.0) * 0.3, 0.5, 5.0, position);\n  col.rgb = blendModeScreen(col.rgb, light);\n\n  return col;\n}\n",controlPoints:[we.e.fromValues(.35,.35),we.e.fromValues(.65,.65)]}),new Dt(e,{id:9,title:Object(X.b)("EffectsView.PSAction.Cartoon.Title","Cartoon"),applyTitle:Object(X.b)("EffectsView.PSAction.Cartoon.ApplyTitle","Applying Cartoon"),creatorName:"Yuji Sakai",actionUrl:"https://static-assets.photoshop.adobe.com/effects/psactions/Airbrush_v2.atn",previewImageUrl:"https://static-assets.photoshop.adobe.com/sample/effects/Airbrush_Men_400x266.jpg",hasIntensity:!0,intensityLabel:Object(X.b)("EffectsView.PSAction.Intensity","Intensity"),startIntensity:1,useTransparency:!0,deeplinkId:"cartoon"}),new Dt(e,{id:10,title:Object(X.b)("EffectsView.PSAction.PopArt.Title","Pop Art"),applyTitle:Object(X.b)("EffectsView.PSAction.PopArt.ApplyTitle","Applying Pop Art"),creatorName:"Yuji Sakai",actionUrl:"https://static-assets.photoshop.adobe.com/effects/psactions/PopArt.atn",previewImageUrl:"https://static-assets.photoshop.adobe.com/sample/effects/PopArt_Woman_Back_400x267.jpg",hasIntensity:!1,deeplinkId:"popart"}),new Dt(e,{id:11,title:Object(X.b)("EffectsView.PSAction.Colorize.Title","Colorize"),applyTitle:Object(X.b)("EffectsView.PSAction.Colorize.ApplyTitle","Applying Colorize"),actionUrl:"https://static-assets.photoshop.adobe.com/effects/psactions/Colorize.atn",previewImageUrl:"https://static-assets.photoshop.adobe.com/sample/effects/Colorize_bridge_427x320.jpg",hasIntensity:!0,intensityLabel:Object(X.b)("EffectsView.PSAction.Intensity","Intensity"),startIntensity:1,useTransparency:!0,deeplinkId:"colorize"}),new Dt(e,{id:12,title:Object(X.b)("EffectsView.PSAction.Stylize.Title","Stylize"),applyTitle:Object(X.b)("EffectsView.PSAction.Stylize.ApplyTitle","Apply Stylize"),actionUrl:"https://static-assets.photoshop.adobe.com/effects/psactions/StyleHiRes.atn",previewImageUrl:"https://static-assets.photoshop.adobe.com/sample/effects/StyleHiRes_Flower_400x300.jpg",hasIntensity:!0,intensityLabel:Object(X.b)("EffectsView.PSAction.Intensity","Intensity"),startIntensity:1,useTransparency:!0,deeplinkId:"highresstyle"})])||[]}}]),e}(),Dt=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e,n){var r;return Object(l.a)(this,a),(r=t.call(this,e,n)).psService=void 0,r.actionUrl=void 0,r.previewImageUrl=void 0,r.abortController=void 0,r.actionUrl=n.actionUrl,r.previewImageUrl=n.previewImageUrl,r.loginNeeded=!0,r}return Object(c.a)(a,null,[{key:"getEffectType",value:function(){return jt.psapi}}]),Object(c.a)(a,[{key:"getPreview",value:function(){return this.previewImageUrl}},{key:"isProcessing",value:function(){return void 0!==this.psService}},{key:"apply",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,n,r,i,s,l=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canceled=!1,this.abortController=new AbortController,w.b.getInstance().isSignedInUser()){e.next=4;break}return e.abrupt("return",Promise.reject(new Error("Unauthenticated user.")));case 4:if(this.actionUrl){e.next=6;break}return e.abrupt("return",Promise.reject(new Error("No effect url given")));case 6:if(this.isProcessing()){e.next=39;break}if(e.prev=7,t=w.b.getInstance().getUserAccessToken()){e.next=11;break}return e.abrupt("return",Promise.reject(new Error("Unauthenticated user.")));case 11:if(this.psService=new St(t),this.showProgressDialog(Object(X.b)("PhotoshopService.ProgressState.Upload","Upload")),a.input){e.next=18;break}return e.next=16,this.psService.createInput(this.doc.getImageData(),this.abortController);case 16:(n=e.sent)&&(a.input=n);case 18:if(a.input){e.next=20;break}return e.abrupt("return",Promise.reject(new Error("No input given")));case 20:return r={href:this.actionUrl,storage:"external"},e.next=23,this.psService.runAction(a.input,r,this.abortController,(function(e,t){l.updateProgress({state:e,percentage:t})}));case 23:return i=e.sent,e.abrupt("return",Promise.resolve(i));case 27:if(e.prev=27,e.t0=e.catch(7),"AbortError"!==e.t0.name){e.next=32;break}return console.debug("Fetch aborted"),e.abrupt("return",Promise.resolve(null));case 32:console.error(e.t0);case 33:return e.prev=33,this.psService=void 0,null===(s=this.progressDialogRef)||void 0===s||s.close(),this.progressDialogRef=void 0,this.abortController=void 0,e.finish(33);case 39:return e.abrupt("return",Promise.reject(new Error("Output error")));case 40:case"end":return e.stop()}}),e,this,[[7,27,33,39]])})));return function(){return e.apply(this,arguments)}}()},{key:"cancelEffectProcess",value:function(){var e;null===(e=this.abortController)||void 0===e||e.abort(),this.psService=void 0}}],[{key:"resetInput",value:function(){a.input=void 0}}]),a}(At);Dt.input=void 0;var Lt=a(232),Nt=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"getEffectsGroups",value:function(){return[{id:1,deepLinkId:"popular",title:Object(X.b)("EffectsView.Groups.Popular","Popular"),effectIds:[3,9,10,11,12]},{id:2,deepLinkId:"effects",title:Object(X.b)("EffectsView.Groups.Effects","Effects"),effectIds:[8,1,2,4,5,6,7]}]}}]),e}(),Vt=(a(602),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).effectsContainer=void 0,n.pointList=void 0,n.pointList=[],n.state={points:new Array},n.effectsContainer=v.a.createRef(),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),this.refresh()}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"setEffectPoints",value:function(e){if(0===this.pointList.length)for(var t=0;t<e.length;t++)this.pointList.push(v.a.createRef());var a=this.state.points;e.length>0?a=e:a.splice(0,a.length),this.setState({points:a})}},{key:"refresh",value:function(){var e=this.state.points.slice();this.setState({points:e})}},{key:"render",value:function(){var e=this,t=this.state.points,a=this.props.controller.getEditor().getStage();return v.a.createElement("div",{id:"effectsContainer",className:"effects-container",ref:this.effectsContainer},t.map((function(t,n){var r=a.getCanvas(),i=r?r.width:100,o=r?r.height:100,s=we.e.fromValues(t[0]*i,t[1]*o),l=a.pointFromStage(s);return l[0]-=8,l[1]-=8,v.a.createElement("div",{key:t[0]+t[1],className:"effects-point",style:{transform:"translate(".concat(l[0],"px, ").concat(l[1],"px)")},ref:e.pointList[n]})})))}}]),a}(m.PureComponent)),Ut=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).editor=void 0,n.editor=e,n}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e),b.a.render(v.a.createElement(Vt,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&b.a.unmountComponentAtNode(this.container),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"getEffectsToolView",value:function(){return this.view}},{key:"getEditor",value:function(){return this.editor}},{key:"refresh",value:function(){var e;null===(e=this.getEffectsToolView())||void 0===e||e.refresh()}},{key:"move",value:function(){}}]),a}(L.a),Ft=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,He.a.effects,e)).effectsTool=void 0,n.undostack=void 0,n.effects=void 0,n.effectsGroups=void 0,n.currentEffect=void 0,n.params=void 0,n.effectImageCache=void 0,n.trackPointData=void 0,n.effectsTool=new Ut(Object(u.a)(n)),n.effectsGroups=Nt.getEffectsGroups(),n.effects=_t.getEffects(e),n.params={},n.params.groupId=n.effectsGroups[0].id,n.effectImageCache=[],n.undostack=new Me.a(Object(I.clone)(n.params),50),n.checkDeepLinks(),n}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e),b.a.render(v.a.createElement(Lt.a,{controller:this}),e);var t=this.doc.getStage().getToolLayer();t&&this.effectsTool.createView(t)}},{key:"destroyView",value:function(){this.effectsTool.destroyView(),this.container&&b.a.unmountComponentAtNode(this.container),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"isDirty",value:function(){return this.canUndo()&&void 0!==this.params.effectId}},{key:"startEditor",value:function(e){if(Object(d.a)(Object(h.a)(a.prototype),"startEditor",this).call(this,e),Dt.resetInput(),this.params.effectId){var t=this.params.effectId,n=Object(I.find)(this.effects,(function(e){return e.getId()===t}));n&&this.setEffect(n,!0)}}},{key:"endEditor",value:function(){this.doc.getStage().setMaskData(void 0),Dt.resetInput(),Object(d.a)(Object(h.a)(a.prototype),"endEditor",this).call(this)}},{key:"hasUndoStack",value:function(){return!0}},{key:"undo",value:function(){var e;null===(e=this.undostack)||void 0===e||e.undo(),this.handleUndoRedo()}},{key:"redo",value:function(){var e;null===(e=this.undostack)||void 0===e||e.redo(),this.handleUndoRedo()}},{key:"handleUndoRedo",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.params=Object(I.clone)(this.undostack.getCurrent()),t=this.params.effectId,this.currentEffect=Object(I.find)(this.effects,(function(e){return e.getId()===t})),this.currentEffect){e.next=9;break}return null===(a=this.effectsTool.getEffectsToolView())||void 0===a||a.setEffectPoints([]),this.doc.getStage().setImageData(this.doc.getImageData()),this.doc.getStage().setMaskData(void 0),this.update(!0),e.abrupt("return");case 9:if(this.currentEffect.setIntensity(this.params.intensity||Rt),this.updateControlPoints((this.params.controlPoints||[]).slice()),!this.currentEffect.useCache()){e.next=15;break}n=this.loadFromCache(this.currentEffect.getId()),e.next=18;break;case 15:return e.next=17,this.currentEffect.apply();case 17:n=e.sent;case 18:n&&this.currentEffect.drawEffectImageData(n),this.update(!0);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"canUndo",value:function(){var e,t,a;return null!==(e=(null===(t=this.undostack)||void 0===t?void 0:t.canUndo())&&(null===(a=this.undostack)||void 0===a?void 0:a.getLength())>1)&&void 0!==e&&e}},{key:"canRedo",value:function(){var e,t;return null!==(e=null===(t=this.undostack)||void 0===t?void 0:t.canRedo())&&void 0!==e&&e}},{key:"canReset",value:function(){return this.canUndo()}},{key:"reset",value:function(){var e;this.isDirty()&&(this.params={},this.effects.forEach((function(e){return e.reset()})),this.addUndoStep(),null===(e=this.effectsTool.getEffectsToolView())||void 0===e||e.setEffectPoints([]),this.doc.getStage().setImageData(this.doc.getImageData()),this.doc.getStage().setMaskData(void 0),this.update())}},{key:"updateControlPoints",value:function(e){var t,a;null===(t=this.currentEffect)||void 0===t||t.setControlPoints(e),null===(a=this.effectsTool.getEffectsToolView())||void 0===a||a.setEffectPoints(e)}},{key:"addUndoStep",value:function(){this.undostack.add(Object(I.clone)(this.params))}},{key:"apply",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDirty()){e.next=3;break}return this.cancel(),e.abrupt("return");case 3:if(this.currentEffect){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,new Promise((function(e,a){t.view.showProcessing(Object(s.a)(o.a.mark((function n(){var r,i;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=null===(r=t.currentEffect)||void 0===r?void 0:r.getFinalImageData()){n.next=3;break}return n.abrupt("return",a());case 3:return t.doc.getStage().setImageData(i),n.next=6,t.doc.editorApply(i,Object(X.b)("EffectsView.InfoToast.Message","Art effects were applied to your image"));case 6:t.doc.getStage().setMaskData(void 0),(new N.a).showSurveyEditor(He.a.effects),e();case 9:case"end":return n.stop()}}),n)}))))}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.isDirty()&&(new N.a).showSurveyEditor(He.a.effects),this.doc.editorCancel()}},{key:"update",value:function(e){var t;if(null===(t=this.getEffectsEditorView())||void 0===t||t.setParams(this.getParams()),this.doc.getDocActions().update(),this.effectsTool.refresh(),e&&this.params.effectId){var a=this.params.effectId,n=this.params.groupId;window.requestAnimationFrame((function(){var e;null===(e=document.getElementById("".concat(n,"-").concat(a)))||void 0===e||e.scrollIntoView()}))}}},{key:"getParams",value:function(){return{effectId:this.params.effectId,groupId:this.params.groupId,intensity:this.params.intensity,controlPoints:(this.params.controlPoints||[]).slice()}}},{key:"getEffects",value:function(){return this.effects}},{key:"getEffectsGroups",value:function(){return this.effectsGroups}},{key:"setGroup",value:function(e){var t;this.params.groupId=null===e||void 0===e?void 0:e.id,null===(t=this.getEffectsEditorView())||void 0===t||t.setParams(Object(I.clone)(this.params))}},{key:"setIntensity",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.params.intensity=t,null===(n=this.currentEffect)||void 0===n||n.setIntensity(t),a&&this.addUndoStep(),this.update();case 4:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"setEffect",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===t||void 0===t?void 0:t.hasLoginNeeded())||w.b.getInstance().isSignedInUser()){e.next=3;break}return new lt.a(Object(X.b)("SigninDialog.Message.PSignin","Please sign in to use this feature"),He.a.effects).show(),e.abrupt("return");case 3:if(!this.isDirty()||this.params.effectId!==t.getId()){e.next=5;break}return e.abrupt("return");case 5:if(n=this.loadFromCache(t.getId())){e.next=22;break}return e.prev=7,e.next=10,t.apply();case 10:if(n=e.sent,!t.isCancelled()&&n){e.next=13;break}return e.abrupt("return");case 13:n&&t.useCache()&&this.addToCache(t.getId(),n),e.next=22;break;case 16:return e.prev=16,e.t0=e.catch(7),console.error(e.t0),r=Object(X.b)("EffectsView.ModalDialog.Error.GenericErrorMessageTryAgain","An error has occurred. Please try again later."),Object(y.error)(r,{timeout:3e3}),e.abrupt("return");case 22:this.params.intensity=t.getIntensity(),this.params.effectId=t.getId(),this.params.controlPoints=t.getControlPoints().slice(),this.currentEffect=t,n&&t.drawEffectImageData(n),this.addUndoStep(),this.updateControlPoints(t.getControlPoints()),this.update(a);case 30:case"end":return e.stop()}}),e,this,[[7,16]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"addToCache",value:function(e,t){this.effectImageCache.push({effectId:e,imageData:t})}},{key:"loadFromCache",value:function(e){var t;if(0!==this.effectImageCache.length)return null===(t=Object(I.find)(this.effectImageCache,{effectId:e}))||void 0===t?void 0:t.imageData}},{key:"checkDeepLinks",value:function(){var e,t=D.a.getParams();if(null===(e=t.effects)||void 0===e?void 0:e.effect){var a=Object(I.find)(this.effects,(function(e){var a;return e.getDeepLinkId()===(null===(a=t.effects)||void 0===a?void 0:a.effect)})),n=Object(I.find)(this.effectsGroups,(function(e){return void 0!==(null===a||void 0===a?void 0:a.getId())&&e.effectIds.includes(null===a||void 0===a?void 0:a.getId())}));n&&a&&(this.params.effectId=a.getId(),this.params.groupId=n.id,t.effects.effect=void 0,D.a.setParams(t))}}},{key:"getEffectsEditorView",value:function(){return this.view}},{key:"getStage",value:function(){return this.doc.getStage()}},{key:"onStageTransformChanged",value:function(){this.effectsTool.refresh()}},{key:"getControlPointIdxForPosition",value:function(e){for(var t,a=(null===(t=this.currentEffect)||void 0===t?void 0:t.getControlPoints())||[],n=0;n<a.length;n++){var r=we.e.clone(a[n]),i=this.getStage().getCanvas();if(r[0]*=i?i.width:100,r[1]*=i?i.height:100,we.e.distance(e,r)<=16)return n}return-1}},{key:"onPointerDown",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"onPointerDown",this).call(this,e);var t=this.getStage().eventToStage(e),n=this.getControlPointIdxForPosition(t);-1!==n&&(this.trackPointData={idx:n,startPoint:t})}},{key:"onPointerMove",value:function(e){if(Object(d.a)(Object(h.a)(a.prototype),"onPointerMove",this).call(this,e),this.trackPointData){var t,n=this.getStage().eventToStage(e),r=(null===(t=this.currentEffect)||void 0===t?void 0:t.getControlPoints().slice())||[],i=this.getStage().getCanvas(),o=i?i.width:100,s=i?i.height:100;r[this.trackPointData.idx]=we.e.fromValues(n[0]/o,n[1]/s),this.updateControlPoints(r),this.update()}}},{key:"onPointerUp",value:function(e){if(Object(d.a)(Object(h.a)(a.prototype),"onPointerUp",this).call(this,e),this.trackPointData){var t,n=this.getStage().eventToStage(e),r=(null===(t=this.currentEffect)||void 0===t?void 0:t.getControlPoints().slice())||[],i=this.getStage().getCanvas(),o=i?i.width:100,s=i?i.height:100;r[this.trackPointData.idx]=we.e.fromValues(n[0]/o,n[1]/s),this.updateControlPoints(r.slice()),this.params.controlPoints=r.slice(),this.addUndoStep(),this.update()}this.trackPointData=void 0}},{key:"showSignInRequired",value:function(){new lt.a(Object(X.b)("SigninDialog.Message.PSignin","Please sign in to use this feature"),He.a.effects).show()}}]),a}(He.b),Bt=a(243),Ht=a(235),zt=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,He.a.resize,e)).maxEdgeLength=0,n.undostack=void 0,n.imageParams=void 0,n.originalImageParams=void 0,n.aspectRatio=void 0;var r=n.doc.getImageData();n.originalImageParams={width:r.width,height:r.height,scaleX:100,scaleY:100,hasAspectRatioFixed:!0,imageSize:k.a.humanFileSize(x.a.calcUncompressedImageSize(r.width,r.height))},n.aspectRatio=r.width/r.height,n.imageParams=Object(I.clone)(n.originalImageParams),n.undostack=new Me.a(Object(I.clone)(n.originalImageParams),50);var i=Ie.getMaxCanvasSizes(),o=Object(Bt.a)(i,1)[0];return n.maxEdgeLength=o,n}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e),b.a.render(v.a.createElement(Ht.a,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&b.a.unmountComponentAtNode(this.container),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"startEditor",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"startEditor",this).call(this,e)}},{key:"endEditor",value:function(){Object(d.a)(Object(h.a)(a.prototype),"endEditor",this).call(this)}},{key:"hasUndoStack",value:function(){return!0}},{key:"canUndo",value:function(){return this.undostack.canUndo()}},{key:"canRedo",value:function(){return this.undostack.canRedo()}},{key:"isDirty",value:function(){return this.originalImageParams.width!==this.imageParams.width||this.originalImageParams.height!==this.imageParams.height}},{key:"canReset",value:function(){return this.isDirty()&&(this.canUndo()||this.canRedo())}},{key:"reset",value:function(){this.imageParams=Object(I.clone)(this.originalImageParams),this.aspectRatio=this.originalImageParams.width/this.originalImageParams.height,this.doc.getStage().setImageData(this.doc.getImageData()),this.doc.getStage().centerContent(),this.addUndoStep(),this.update()}},{key:"apply",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDirty()){e.next=3;break}return this.cancel(),e.abrupt("return");case 3:return e.next=5,new Promise((function(e,a){t.view.showProcessing(Object(s.a)(o.a.mark((function n(){var r,i;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(i=null===(r=t.doc.getStage().getCanvas())||void 0===r?void 0:r.getContext("2d"))){n.next=6;break}return n.next=4,t.doc.editorApply(i.getImageData(0,0,t.imageParams.width,t.imageParams.height),Object(X.b)("ResizeView.InfoToast.Message","Your image was resized"));case 4:(new N.a).showSurveyEditor(He.a.resize),e();case 6:a();case 7:case"end":return n.stop()}}),n)}))))}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.isDirty()&&(new N.a).showSurveyEditor(He.a.resize),this.doc.editorCancel()}},{key:"getParams",value:function(){return this.imageParams}},{key:"addUndoStep",value:function(){this.undostack.add(Object(I.clone)(this.imageParams)),this.update()}},{key:"undo",value:function(){this.undostack.undo(),this.imageParams=Object(I.clone)(this.undostack.getCurrent()),this.doResize(!1),this.update()}},{key:"redo",value:function(){this.undostack.redo(),this.imageParams=Object(I.clone)(this.undostack.getCurrent()),this.doResize(!1),this.update()}},{key:"changeWidth",value:function(e,t){if(e!==this.imageParams.width){var a=this.enforceEdgeLimits(e),n=this.imageParams.height;if(this.imageParams.hasAspectRatioFixed){n=this.calcHeight(a);var r=this.enforceEdgeLimits(n);r!==n&&(n=r,a=this.enforceEdgeLimits(this.calcWidth(n)))}this.imageParams.width=a,this.imageParams.height=n,this.imageParams.scaleX=this.calcScalePercent(this.imageParams.width,this.originalImageParams.width),this.imageParams.hasAspectRatioFixed&&(this.imageParams.scaleY=this.imageParams.scaleX),t&&this.doResize(!0),this.update()}}},{key:"changeHeight",value:function(e,t){if(e!==this.imageParams.height){var a=this.imageParams.width,n=this.enforceEdgeLimits(e);if(this.imageParams.hasAspectRatioFixed){a=this.calcWidth(n);var r=this.enforceEdgeLimits(a);r!==a&&(a=r,n=this.enforceEdgeLimits(this.calcHeight(a)))}this.imageParams.width=a,this.imageParams.height=n,this.imageParams.scaleY=this.calcScalePercent(this.imageParams.height,this.originalImageParams.height),this.imageParams.hasAspectRatioFixed&&(this.imageParams.scaleX=this.imageParams.scaleY),t&&this.doResize(!0),this.update()}}},{key:"changeScaleX",value:function(e,t){e!==this.imageParams.scaleX&&this.changeWidth(Math.floor(this.originalImageParams.width*e/100),t)}},{key:"changeScaleY",value:function(e,t){e!==this.imageParams.scaleY&&this.changeHeight(Math.floor(this.originalImageParams.height*e/100),t)}},{key:"toogleAspectRatio",value:function(){this.imageParams.hasAspectRatioFixed=!this.imageParams.hasAspectRatioFixed,this.imageParams.hasAspectRatioFixed&&(this.aspectRatio=this.imageParams.width/this.imageParams.height),this.update()}},{key:"calcWidth",value:function(e){return 0===this.imageParams.height||e<1?0:Math.max(1,Math.floor(this.aspectRatio*e))}},{key:"calcHeight",value:function(e){return 0===this.imageParams.width||e<1?0:Math.max(1,Math.floor(e/this.aspectRatio))}},{key:"calcScalePercent",value:function(e,t){return 0===t?0:Math.max(1,Math.round(e/t*100))}},{key:"update",value:function(){this.imageParams.imageSize=k.a.humanFileSize(x.a.calcUncompressedImageSize(this.imageParams.width,this.imageParams.height)),this.view.setParams(Object(I.clone)(this.imageParams),this.canReset()),this.doc.getDocActions().update()}},{key:"enforceEdgeLimits",value:function(e){return Math.max(Math.min(this.maxEdgeLength,e),32)}},{key:"doResize",value:function(e){var t=this.doc.getStage().getCanvas();if(this.imageParams.width!==(null===t||void 0===t?void 0:t.width)||this.imageParams.height!==(null===t||void 0===t?void 0:t.height)){var a=x.a.resizeImageData(this.doc.getImageData(),this.imageParams.width,this.imageParams.height);a&&(this.doc.getStage().setImageData(a),this.doc.getStage().centerContent(),e&&this.addUndoStep())}}},{key:"finishResize",value:function(){var e,t=null===(e=this.undostack)||void 0===e?void 0:e.getCurrent();t&&t.width===this.imageParams.width&&t.height===this.imageParams.height||(this.addUndoStep(),this.update())}}]),a}(He.b),Gt=a(61),Wt=a.n(Gt),Zt=(a(652),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).brushCursorPanelRef=void 0,n.state={params:e.controller.getParams()},n.brushCursorPanelRef=Object(m.createRef)(),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"getCursorView",value:function(){return this.brushCursorPanelRef.current}},{key:"updateView",value:function(e){this.setState({params:e})}},{key:"refresh",value:function(){}},{key:"render",value:function(){var e,t=this.props.controller,a=this.state.params,n=null===(e=D.a.getParams().spotheal)||void 0===e?void 0:e.enableTooltips;return v.a.createElement("div",{className:"editor-panel"},(a.processing||!a.patchmatchReady)&&v.a.createElement(Be.a,{centered:!0}),v.a.createElement("div",{className:"settings-right spotheal-settings-right"},v.a.createElement("div",{className:"settings-scrolling-content"},v.a.createElement("div",{className:"settings-header"},n?v.a.createElement(le.a,{placement:"left",delayShow:500},v.a.createElement("div",{className:"title",style:{cursor:"help"}},Object(X.b)("SpotHealView.Title.TouchUp","Touch Up")),v.a.createElement(fe.a,{variant:"info"},Object(X.b)("SpotHealView.Help.Hover","Hover your mouse over the area you would like to touch up and click to remove unwanted pixels."))):v.a.createElement("div",{className:"title"},Object(X.b)("SpotHealView.Title.TouchUp","Touch Up")),v.a.createElement("div",{className:"reset-button"},v.a.createElement(U.a,{quiet:!0,variant:"action",onClick:function(){t.reset()},icon:v.a.createElement(Wt.a,null),hidden:!0},Object(X.b)("SpotHealView.Button.Reset","Reset")))),v.a.createElement("section",null,n?v.a.createElement(le.a,{placement:"left",delayShow:1500},v.a.createElement("div",null,v.a.createElement(me.a,{renderLabel:!0,label:Object(X.b)("SpotHealView.Controls.Slider.Label.BrushSize","Brush size"),min:5,max:100,step:1,value:a.brushSize,onChange:function(e){return t.changeBrushSize(e)}})),v.a.createElement(fe.a,{variant:"info"},Object(X.b)("SpotHealView.Help.Brushsize","You can adjust your brush size by using this slider."))):v.a.createElement(me.a,{renderLabel:!0,label:Object(X.b)("SpotHealView.Controls.Slider.Label.BrushSize","Brush size"),min:Kt,max:Yt,step:1,value:a.brushSize,onChange:function(e){return t.changeBrushSize(e)}})))))}}]),a}(m.PureComponent)),Yt=100,Kt=5,Xt=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,He.a.spotheal,e)).worker=void 0,n.isWorkerReady=void 0,n.isImageProcessing=void 0,n.hasDrawMask=void 0,n.brushSize=void 0,n.spotsHealed=void 0,n.cursor=void 0,n.alwaysPointerTracking=!0,n.isWorkerReady=!1,n.isImageProcessing=!1,n.hasDrawMask=!1,n.spotsHealed=0,n.brushSize=20,n.cursor=document.createElement("div"),n.cursor.id="brush-cursor",n.cursor.className="brush-cursor-panel",n}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e),b.a.render(v.a.createElement(Zt,{controller:this}),e),this.setCursor(),this.showCursor(!1);var t=this.doc.getStage().getToolLayer();t&&t.appendChild(this.cursor)}},{key:"destroyView",value:function(){this.container&&b.a.unmountComponentAtNode(this.container);var e=this.doc.getStage().getToolLayer();e&&e.removeChild(this.cursor),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"startEditor",value:function(e){var t=this;Object(d.a)(Object(h.a)(a.prototype),"startEditor",this).call(this,e),this.doc.getStage().setMaskData(new ImageData(this.doc.getImageData().width,this.doc.getImageData().height)),this.worker=new Worker("/wasm/pm.worker.js"),this.worker.onmessage=function(e){if(t.worker&&t.worker===e.target){if("ready"===e.data.message){var a=e.data.binary;crypto.subtle.digest("SHA-256",a).then((function(e){"a888ee0586ced614e2b443c111d9b1882cb0c3061b15b473ec822c76ad6f47c8"!==Array.from(new Uint8Array(e)).map((function(e){return e.toString(16).padStart(2,"0")})).join("")?(console.debug("The WASM hash is incorrect"),t.worker&&t.worker.postMessage({type:"close"})):(console.debug("PM worker ready"),t.isWorkerReady=!0,t.updateViewParams())}))}if("spotheal_done"===e.data.message){var n=new ImageData(new Uint8ClampedArray(e.data.pixels),e.data.width,e.data.height);t.doc.addToUndoStack(n).then((function(){t.spotsHealed+=1,t.doc.getStage().setImageData(n),t.isImageProcessing=!1;var e=t.doc.getStage().getMaskCanvas();if(e){var a=null===e||void 0===e?void 0:e.getContext("2d");null===a||void 0===a||a.clearRect(0,0,e.width,e.height),e.style.opacity="1"}t.updateViewParams(),t.doc.getDocActions().update(),Object(K.a)("spotheal"),5===t.spotsHealed&&(new N.a).showSurveyEditor(He.a.spotheal)}))}}if("closed"===e.data.message){var r=e.target;r.onerror=null,r.onmessage=null,r.terminate(),console.debug("PM worker terminated")}},this.worker.onerror=function(e){t.doc.getDocActions().update(),console.error("PM worker failed: ".concat(e.message))}}},{key:"endEditor",value:function(){this.worker&&(this.worker.postMessage({type:"close"}),this.worker=void 0),this.isWorkerReady=!1,this.spotsHealed=0,this.resetParams(),this.doc.getStage().setMaskData(void 0),Object(d.a)(Object(h.a)(a.prototype),"endEditor",this).call(this)}},{key:"hasUndoStack",value:function(){return!1}},{key:"reset",value:function(){this.brushSize=20,this.updateViewParams()}},{key:"cancel",value:function(){this.isDirty()&&(new N.a).showSurveyEditor(He.a.spotheal),this.reset();var e=this.doc.getStage().getMaskCanvas();e&&(e.style.zIndex="auto",e.style.cursor="auto"),this.showCursor(!1),this.doc.getStage().setMaskData(void 0),this.doc.editorCancel(),Object(K.a)("spothealCancel")}},{key:"changeBrushSize",value:function(e){this.brushSize=e,this.setCursor(),this.updateViewParams()}},{key:"onPointerDown",value:function(e){if(Object(d.a)(Object(h.a)(a.prototype),"onPointerDown",this).call(this,e),this.doc.getStage().getZoomMode()===ye.NONE&&!this.isImageProcessing){var t=this.doc.getStage().getMaskCanvas();this.isWorkerReady&&t&&1===e.buttons&&(t.style.opacity="0.5",this.drawMask(e))}}},{key:"onPointerMove",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"onPointerMove",this).call(this,e);var t=this.doc.getStage().getMaskCanvas();t&&"none"!==t.style.cursor&&(t.style.zIndex="1",t.style.cursor="none",this.showCursor(!0)),this.updateCursorPos(e);var n=document.getElementById("cursor-circle");if(this.doc.getStage().isPanningMode()||this.doc.getStage().getZoomMode()!==ye.NONE?null===n||void 0===n||n.classList.remove("cursor-none"):null===n||void 0===n||n.classList.add("cursor-none"),1===e.buttons&&!this.doc.getStage().isPanningMode()&&this.doc.getStage().getZoomMode()===ye.NONE){if(this.isImageProcessing)return;if(!this.isWorkerReady)return;this.drawMask(e)}}},{key:"onPointerUp",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"onPointerUp",this).call(this,e),this.hasDrawMask&&this.applyMask()}},{key:"onPointerEnter",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"onPointerEnter",this).call(this,e);var t=this.doc.getStage().getMaskCanvas();t&&(t.style.zIndex="1",t.style.cursor="none"),this.showCursor(!0),this.updateCursorPos(e)}},{key:"onPointerLeave",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"onPointerLeave",this).call(this,e),this.hasDrawMask&&this.applyMask();var t=this.doc.getStage().getMaskCanvas();t&&(t.style.zIndex="auto",t.style.cursor="auto"),this.showCursor(!1)}},{key:"onGestureStart",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"onGestureStart",this).call(this,e)}},{key:"onGestureChange",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"onGestureChange",this).call(this,e)}},{key:"onGestureEnd",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"onGestureEnd",this).call(this,e)}},{key:"onZoomChange",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"onZoomChange",this).call(this,e),this.setCursor()}},{key:"onPanModeStart",value:function(){var e;this.cursor.style.opacity="0",null===(e=document.getElementById("cursor-circle"))||void 0===e||e.classList.remove("cursor-none")}},{key:"onPanModeEnd",value:function(){var e;this.cursor.style.opacity="1",null===(e=document.getElementById("cursor-circle"))||void 0===e||e.classList.add("cursor-none")}},{key:"onZoomModeStart",value:function(){var e;null===(e=document.getElementById("cursor-circle"))||void 0===e||e.classList.remove("cursor-none"),this.cursor.style.opacity="0"}},{key:"onZoomModeEnd",value:function(){var e;this.cursor.style.opacity="1",null===(e=document.getElementById("cursor-circle"))||void 0===e||e.classList.add("cursor-none")}},{key:"onKeyDown",value:function(e){switch(e.key){case"[":this.brushSize<Yt&&this.changeBrushSize(this.brushSize+1);break;case"]":this.brushSize>Kt&&this.changeBrushSize(this.brushSize-1)}}},{key:"getParams",value:function(){return{brushSize:this.brushSize,patchmatchReady:this.isWorkerReady,processing:this.isImageProcessing}}},{key:"resetParams",value:function(){this.isImageProcessing=!1,this.hasDrawMask=!1}},{key:"applyMask",value:function(){var e,t=this.doc.getStage().getMaskCanvas(),a=this.doc.getStage().getCanvas();if(a&&t&&this.isWorkerReady&&this.hasDrawMask){var n=t.getContext("2d"),r=a.getContext("2d");if(n&&r){this.hasDrawMask=!1,this.isImageProcessing=!0,this.doc.getDocActions().disableUndoRedo();var i=r.getImageData(0,0,this.doc.getImageData().width,this.doc.getImageData().height),o=n.getImageData(0,0,t.width,t.height),s=x.a.createBitmask(o);null===(e=this.worker)||void 0===e||e.postMessage({type:"spotheal",width:i.width,height:i.height,pixels:i.data.buffer,mask:s.buffer},[i.data.buffer,s.buffer]),this.updateViewParams()}}}},{key:"drawMask",value:function(e){var t=this.doc.getStage().getMaskCanvas();if(t){var a=this.doc.getStage().eventToStage(e),n=a[0],r=a[1],i=this.brushSize/2;if(!(n<0-i||r<0-i||n>(null===t||void 0===t?void 0:t.width)+i||r>(null===t||void 0===t?void 0:t.height)+i)){var o=t.getContext("2d");o&&(this.hasDrawMask||o.beginPath(),o.strokeStyle="rgba(48, 48, 48)",o.lineWidth=2*i,o.lineTo(n,r),o.stroke(),o.beginPath(),o.arc(n,r,i,0,2*Math.PI),o.fillStyle="rgba(48, 48, 48)",o.fill(),o.beginPath(),o.moveTo(n,r),this.hasDrawMask=!0)}}}},{key:"updateViewParams",value:function(){this.view.updateView(this.getParams())}},{key:"updateCursorPos",value:function(e){var t=this.doc.getStage().getZoomFactor(),a=this.doc.getStage().eventToLocal(e),n=a[0]-this.brushSize*t,r=a[1]-this.brushSize*t;this.cursor.style.left="".concat(n,"px"),this.cursor.style.top="".concat(r,"px")}},{key:"setCursor",value:function(){var e=this.doc.getStage().getZoomFactor(),t=2*this.brushSize*e+10,a=this.brushSize*e,n=3;this.brushSize<8&&(n=1),this.brushSize<10&&(n=2),this.cursor.innerHTML="<div id='cursor-circle'><svg height=\"".concat(t,'" width="').concat(t,'" xmlns="http://www.w3.org/2000/svg">      <circle cx="').concat(a,'" cy="').concat(a,'" r="').concat(a/2,'" stroke="#303030" stroke-width="1px" fill="none"></circle>      <circle cx="').concat(a,'" cy="').concat(a,'" r="').concat(a/2-1,'" stroke="#eeeeee" stroke-width="1px" fill="none"></circle>      <line x1="').concat(a,'" y1="').concat(a-n,'" x2="').concat(a,'" y2="').concat(a+n,'" stroke="#888888" stroke-width="1px"></line>      <line x1="').concat(a-n,'" y1="').concat(a,'" x2="').concat(a+n,'" y2="').concat(a,'" stroke="#888888" stroke-width="1px"></line>    </svg></div>')}},{key:"showCursor",value:function(e){this.cursor.style.visibility=e?"visible":"hidden"}}]),a}(He.b),qt=(a(653),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"handleClose",value:function(){this.props.controller.close()}},{key:"render",value:function(){var e=this;return v.a.createElement(B.a,{title:"Settings"},v.a.createElement("div",{className:"dialog-close"},v.a.createElement(U.a,{variant:"tool",onClick:function(){return e.handleClose()},icon:v.a.createElement(W.a,{style:{color:"var(--spectrum-global-color-gray-50)"}})})),v.a.createElement("div",null,v.a.createElement("span",null,"settings go here")))}}]),a}(m.PureComponent)),Jt=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).dialogId=void 0,e}return Object(c.a)(a,[{key:"show",value:function(){this.dialogId=T.a.show(v.a.createElement(qt,{controller:this}))}},{key:"close",value:function(){this.dialogId&&T.a.hide(this.dialogId)}}]),a}(L.a),Qt=a(68),$t=a.n(Qt),ea=a(239),ta=a.n(ea),aa=a(76);function na(){return(na=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ra(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var ia=v.a.createElement("path",{className:"fill",d:"M34,14a12,12,0,0,0-23.483-3.483,12.038,12.038,0,0,1,2.3-.457A10,10,0,1,1,25.94,23.185a12.038,12.038,0,0,1-.457,2.3A12,12,0,0,0,34,14Z"}),oa=v.a.createElement("rect",{className:"fill",x:14,y:12,width:2,height:2}),sa=v.a.createElement("rect",{className:"fill",x:12,y:14,width:2,height:2}),la=v.a.createElement("rect",{className:"fill",x:14,y:16,width:2,height:2}),ca=v.a.createElement("rect",{className:"fill",x:12,y:18,width:2,height:2}),ua=v.a.createElement("rect",{className:"fill",x:14,y:20,width:2,height:2}),da=v.a.createElement("rect",{className:"fill",x:16,y:22,width:2,height:2}),ha=v.a.createElement("rect",{className:"fill",x:16,y:18,width:2,height:2}),fa=v.a.createElement("rect",{className:"fill",x:16,y:14,width:2,height:2}),pa=v.a.createElement("rect",{className:"fill",x:18,y:16,width:2,height:2}),ma=v.a.createElement("rect",{className:"fill",x:18,y:20,width:2,height:2}),va=v.a.createElement("path",{className:"fill",d:"M24,25.817V24H22v2a11.986,11.986,0,0,1-2-.18V24H18v1.3a11.939,11.939,0,0,1-2-.922V24h-.628A11.886,11.886,0,0,1,14,22.926V22h-.926A12.173,12.173,0,0,1,12,20.628V20h-.381a11.856,11.856,0,0,1-.921-2H12V16H10.18A11.986,11.986,0,0,1,10,14h2V12H10.183a12.068,12.068,0,0,1,.334-1.482A12,12,0,1,0,25.483,25.482,12.128,12.128,0,0,1,24,25.817Z"}),ga=v.a.createElement("rect",{className:"fill",x:20,y:22,width:2,height:2}),ba=v.a.createElement("rect",{className:"fill",x:22,y:20,width:2,height:2}),ya=v.a.createElement("rect",{className:"fill",x:20,y:18,width:2,height:2}),Ea=v.a.createElement("rect",{className:"fill",x:22,y:16,width:2,height:2}),wa=v.a.createElement("rect",{className:"fill",x:20,y:14,width:2,height:2}),xa=v.a.createElement("rect",{className:"fill",x:18,y:12,width:2,height:2}),ka=v.a.createElement("path",{className:"fill",d:"M26,22H24v2h1.817A11.881,11.881,0,0,0,26,22Z"}),Sa=v.a.createElement("path",{className:"fill",d:"M25.3,18H24v2h1.82A11.908,11.908,0,0,0,25.3,18Z"}),Oa=v.a.createElement("path",{className:"fill",d:"M24,15.372V16h.381C24.259,15.788,24.135,15.576,24,15.372Z"}),Ca=v.a.createElement("path",{className:"fill",d:"M12,12h2V10a11.881,11.881,0,0,0-2,.183Z"}),Pa=v.a.createElement("path",{className:"fill",d:"M16,10.18V12h2V10.7A11.908,11.908,0,0,0,16,10.18Z"}),Ta=v.a.createElement("path",{className:"fill",d:"M20,11.619V12h.628C20.424,11.865,20.212,11.741,20,11.619Z"}),Aa=v.a.createElement("path",{className:"fill",d:"M22,13.074V14h.926A11.9,11.9,0,0,0,22,13.074Z"}),ja=function(e){var t=e.svgRef,a=e.title,n=ra(e,["svgRef","title"]);return v.a.createElement("svg",na({id:"spectrum-icon-18-Adjust",width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?v.a.createElement("title",null,a):null,ia,oa,sa,la,ca,ua,da,ha,fa,pa,ma,va,ga,ba,ya,Ea,wa,xa,ka,Sa,Oa,Ca,Pa,Ta,Aa)},Ia=v.a.forwardRef((function(e,t){return v.a.createElement(ja,na({svgRef:t},e))}));a.p;function Ma(){return(Ma=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Ra(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var _a=v.a.createElement("path",{className:"fill",d:"M24,22h4V9a1,1,0,0,0-1-1H14v4H24Z"}),Da=v.a.createElement("path",{className:"fill",d:"M12,24V3a1,1,0,0,0-1-1H9A1,1,0,0,0,8,3V8H3A1,1,0,0,0,2,9v2a1,1,0,0,0,1,1H8V27a1,1,0,0,0,1,1H24v5a1,1,0,0,0,1,1h2a1,1,0,0,0,1-1V28h5a1,1,0,0,0,1-1V25a1,1,0,0,0-1-1Z"}),La=function(e){var t=e.svgRef,a=e.title,n=Ra(e,["svgRef","title"]);return v.a.createElement("svg",Ma({id:"spectrum-icon-18-Crop",width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?v.a.createElement("title",null,a):null,_a,Da)},Na=v.a.forwardRef((function(e,t){return v.a.createElement(La,Ma({svgRef:t},e))}));a.p;function Va(){return(Va=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Ua(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Fa=v.a.createElement("path",{className:"fill",d:"M29.912,22.12c0-.007.035-.028.026-.028A8.481,8.481,0,0,1,22.8,18.074c-.017-.028-.046-.047-.065-.074.019-.027.048-.046.065-.074a8.481,8.481,0,0,1,7.142-4.018c.009,0-.023-.021-.026-.028a5.917,5.917,0,1,0-3.93-1.588l-6.47,3.444-12.6-6.7a4,4,0,0,0-3.8.023L.822,10.313,15.26,18,.822,25.687l2.292,1.255a4,4,0,0,0,3.8.023l12.6-6.7,6.47,3.444a5.892,5.892,0,1,0,3.93-1.588Zm.367-18.038a3.933,3.933,0,1,1-4.2,3.641A3.932,3.932,0,0,1,30.279,4.082Zm0,27.836a3.933,3.933,0,1,1,3.641-4.2A3.933,3.933,0,0,1,30.279,31.918Z"}),Ba=function(e){var t=e.svgRef,a=e.title,n=Ua(e,["svgRef","title"]);return v.a.createElement("svg",Va({id:"spectrum-icon-18-Cutout",width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?v.a.createElement("title",null,a):null,Fa)},Ha=v.a.forwardRef((function(e,t){return v.a.createElement(Ba,Va({svgRef:t},e))}));a.p;function za(){return(za=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Ga(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Wa=v.a.createElement("path",{className:"fill",d:"M33,4H11a1,1,0,0,0-1,1V16H3a1,1,0,0,0-1,1V29a1,1,0,0,0,1,1H18a1,1,0,0,0,1-1V24H33a1,1,0,0,0,1-1V5A1,1,0,0,0,33,4ZM17,28H4V18h6v5a1,1,0,0,0,1,1h6Zm0-6H12V18h5Zm15,0H19V17a1,1,0,0,0-1-1H12V6H32Z"}),Za=v.a.createElement("path",{id:"arrow_fill","data-name":"arrow fill",className:"fill",d:"M20.49,16.1l5.131-5.132L23.646,8.99A.5.5,0,0,1,24,8.136h5.863V14a.5.5,0,0,1-.854.354l-1.975-1.975L21.9,17.511a.5.5,0,0,1-.707,0l-.7-.711A.5.5,0,0,1,20.49,16.1Z"}),Ya=function(e){var t=e.svgRef,a=e.title,n=Ga(e,["svgRef","title"]);return v.a.createElement("svg",za({id:"spectrum-icon-18-Resize",width:36,height:36,viewBox:"0 0 36 36",ref:t},n),a?v.a.createElement("title",null,a):null,Wa,Za)},Ka=v.a.forwardRef((function(e,t){return v.a.createElement(Ya,za({svgRef:t},e))}));a.p;function Xa(){return(Xa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function qa(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Ja=v.a.createElement("path",{className:"fill",d:"M32.728,3.272a6,6,0,0,0-8.485,0L17.787,9.728,3.272,24.243a6,6,0,0,0,8.485,8.485L17.7,26.781,32.728,11.757a6,6,0,0,0,0-8.485ZM19,11a2,2,0,1,1-2,2A2,2,0,0,1,19,11ZM13,21a2,2,0,1,1,2-2A2,2,0,0,1,13,21Zm4,4a2,2,0,1,1,2-2A2,2,0,0,1,17,25Zm6-6a2,2,0,1,1,2-2A2,2,0,0,1,23,19Z"}),Qa=v.a.createElement("path",{className:"fill",d:"M18.453,4.343l1.309-1.512A11.923,11.923,0,0,0,14.449.182l-.42,1.955A9.98,9.98,0,0,1,18.453,4.343ZM10.711,1.985,10.472,0h-.007A12.1,12.1,0,0,0,4.946,2.144l-.006,0,0,0L6.1,3.776A9.988,9.988,0,0,1,10.711,1.985ZM1.986,10.746A9.99,9.99,0,0,1,3.757,6.13L2.127,4.971A11.958,11.958,0,0,0,0,10.514Zm2.389,7.732a9.979,9.979,0,0,1-2.224-4.416L.2,14.49a11.933,11.933,0,0,0,2.671,5.3Z"}),$a=function(e){var t=e.svgRef,a=e.title,n=qa(e,["svgRef","title"]);return v.a.createElement("svg",Xa({id:"spectrum-icon-18-SpotHeal",viewBox:"0 0 36 36",ref:t},n),a?v.a.createElement("title",null,a):null,Ja,Qa)},en=v.a.forwardRef((function(e,t){return v.a.createElement($a,Xa({svgRef:t},e))})),tn=(a.p,a(661),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={selectedEditorId:e.selectedEditorId},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"setSelectedEditorId",value:function(e){e!==this.state.selectedEditorId&&this.setState({selectedEditorId:e})}},{key:"onSelect",value:function(e){e!==this.state.selectedEditorId&&this.props.controller.onSelect(e),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}},{key:"render",value:function(){var e=this,t=this.props,a=t.editorIds,n=t.controller,r=this.state.selectedEditorId;return v.a.createElement("div",{className:"nav-container"},v.a.createElement("nav",{className:"app-sidenav"},v.a.createElement("h2",{className:"leftNav-heading"},Object(X.b)("App.Navigation.Left.Headline.Label","Edit image")),v.a.createElement(aa.SideNav,{onSelect:function(t){return e.onSelect(t)},value:r,className:"customSidebar"},a.map((function(e){switch(e){case He.a.spotheal:return v.a.createElement(aa.SideNavItem,{key:e,value:e,icon:v.a.createElement($t.a,null,v.a.createElement(en,null)),className:"sidenav-item"},Object(X.b)("App.Navigation.Left.TouchUp","Touch Up"));case He.a.crop:return v.a.createElement(aa.SideNavItem,{key:e,value:e,icon:v.a.createElement($t.a,null,v.a.createElement(Na,null)),className:"sidenav-item"},Object(X.b)("App.Navigation.Left.Crop","Crop and straighten"));case He.a.resize:return v.a.createElement(aa.SideNavItem,{key:e,value:e,icon:v.a.createElement($t.a,null,v.a.createElement(Ka,null)),className:"sidenav-item"},Object(X.b)("App.Navigation.Left.Resize","Resize image"));case He.a.cutout:return v.a.createElement(aa.SideNavItem,{key:e,value:e,icon:v.a.createElement($t.a,null,v.a.createElement(Ha,null)),className:"sidenav-item"},Object(X.b)("App.Navigation.Left.CutOut","Remove background"));case He.a.adjust:return v.a.createElement(aa.SideNavItem,{key:e,value:e,icon:v.a.createElement($t.a,null,v.a.createElement(Ia,null)),className:"sidenav-item"},Object(X.b)("App.Navigation.Left.AdjustImage","Adjust image"));case He.a.effects:return v.a.createElement(aa.SideNavItem,{key:e,value:e,icon:v.a.createElement($t.a,null,v.a.createElement(ta.a,null)),className:"sidenav-item"},Object(X.b)("App.Navigation.Left.Filters","Art effects"));default:throw new Error("unknown editor")}})))),v.a.createElement("div",{className:"legal-notice"},v.a.createElement(U.a,{quiet:!0,variant:"action",onClick:function(){return n.toggleFooter()},className:"button-legal-notice"},Object(X.b)("Footer.title","Legal Notices"))))}}]),a}(m.PureComponent)),an=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).doc=void 0,n.doc=e,n}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e),b.a.render(v.a.createElement(tn,{controller:this,editorIds:this.doc.getEditorIds()}),e)}},{key:"destroyView",value:function(){this.container&&b.a.unmountComponentAtNode(this.container),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"viewDidMount",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"viewDidMount",this).call(this,e)}},{key:"viewWillUnmount",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"viewWillUnmount",this).call(this,e)}},{key:"setSelectedEditorId",value:function(e){var t;null===(t=this.getToolbarView())||void 0===t||t.setSelectedEditorId(e)}},{key:"onSelect",value:function(e){this.doc.setEditor(e)}},{key:"showSettings",value:function(){(new Jt).show()}},{key:"toggleFooter",value:function(){this.doc.toggleFooter()}},{key:"getToolbarView",value:function(){return this.view}}]),a}(L.a),nn=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e,n,r,i,o,s){var c;if(Object(l.a)(this,a),(c=t.call(this)).app=void 0,c.stage=void 0,c.toolbar=void 0,c.docActions=void 0,c.undostack=void 0,c.currentEditor=void 0,c.fileName=void 0,c.fileType=void 0,c.isSampleImage=void 0,c.hotkeys=void 0,c.hotkeysEnabled=void 0,c.app=e,c.fileName=r,c.fileType=i,c.isSampleImage=o,c.stage=new Ie(Object(u.a)(c)),c.toolbar=new an(Object(u.a)(c)),c.docActions=new et(Object(u.a)(c)),c.hotkeys=new pt(Object(u.a)(c)),s)c.undostack=s;else{var d=new De(10);d.add(n,r,i,o,!0);var h=new Me.a(n,10);c.undostack=new Ee(h,d)}return c.hotkeysEnabled=new Map(Object.values(at).map((function(e){return[e,!0]}))),c}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e),b.a.render(v.a.createElement(ct,{controller:this,loading:!0}),e),this.app.getNavBar().setActionsController(this.docActions),this.hotkeys.addEventListener()}},{key:"destroyView",value:function(){this.container&&b.a.unmountComponentAtNode(this.container),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this),this.hotkeys.removeEventListener()}},{key:"viewDidMount",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"viewDidMount",this).call(this,e),this.createViews()}},{key:"viewWillUnmount",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"viewWillUnmount",this).call(this,e)}},{key:"createViews",value:function(){this.toolbar.createView(this.ensureHTMLElement("toolbar-container")),this.stage.createView(this.ensureHTMLElement("stage-container"));var e=this;window.requestAnimationFrame((function(){e.stage.zoomFit(),e.stage.centerContent(),e.setLoading(!1)}))}},{key:"close",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getFileName",value:function(){return this.fileName}},{key:"getFileType",value:function(){return this.fileType}},{key:"isFileSampleImage",value:function(){return this.isSampleImage}},{key:"getStage",value:function(){return this.stage}},{key:"getDocActions",value:function(){return this.docActions}},{key:"getImageData",value:function(){return this.undostack.getCurrent()}},{key:"undo",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.currentEditor||!this.currentEditor.hasUndoStack()){e.next=4;break}return this.currentEditor.undo(),this.docActions.update(),e.abrupt("return");case 4:if(!this.canUndo()){e.next=10;break}return e.next=7,this.undostack.undo();case 7:this.stage.setImageData(this.undostack.getCurrent()),this.stage.centerContent(),this.docActions.update();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"redo",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.currentEditor||!this.currentEditor.hasUndoStack()){e.next=4;break}return this.currentEditor.redo(),this.docActions.update(),e.abrupt("return");case 4:if(!this.canRedo()){e.next=10;break}return e.next=7,this.undostack.redo();case 7:this.stage.setImageData(this.undostack.getCurrent()),this.stage.centerContent(),this.docActions.update();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"canUndo",value:function(){return this.currentEditor&&this.currentEditor.hasUndoStack()?this.currentEditor.canUndo():this.undostack.canUndo()}},{key:"canRedo",value:function(){return this.currentEditor&&this.currentEditor.hasUndoStack()?this.currentEditor.canRedo():this.undostack.canRedo()}},{key:"showSaveImage",value:function(){var e=this;if(this.currentEditor&&this.currentEditor.isDirty()){var t=this.currentEditor.getId();new rt(t,(function(t){var a;t===Ze.apply?null===(a=e.currentEditor)||void 0===a||a.apply().then((function(){new ge(e).show()})):t===Ze.discard&&new ge(e).show()})).show()}else new ge(this).show()}},{key:"saveImage",value:function(e,t,a){var n,r=new C(this);return r.canDownload()?(r.download(e,t,a),!0):(Object(K.a)("signInToTryMore"),new lt.a(Object(X.b)("SigninDialog.UnlimitedDownloads.Message","Sign in or create a free account to get access to unlimited downloads."),null===(n=this.getCurrentEditor())||void 0===n?void 0:n.getId()).show(),!1)}},{key:"showOpenImage",value:function(){var e,t=this,a=(null===(e=this.currentEditor)||void 0===e?void 0:e.isDirty())||this.undostack.canUndo()||this.undostack.canRedo();if(this.currentEditor&&a){var n=this.currentEditor.getId();new ot(n,(function(e){var a;e===Ze.apply&&new We(t.app,null===(a=t.currentEditor)||void 0===a?void 0:a.getId()).show()})).show()}else{var r;new We(this.app,null===(r=this.currentEditor)||void 0===r?void 0:r.getId()).show()}}},{key:"openDragImage",value:function(e){var t,a=this,n=(null===(t=this.currentEditor)||void 0===t?void 0:t.isDirty())||this.undostack.canUndo()||this.undostack.canRedo();if(this.currentEditor&&n){var r=this.currentEditor.getId();new ot(r,(function(t){t===Ze.apply&&We.readFile(a.app,e,e.name,e.type,!1)})).show()}else We.readFile(this.app,e,e.name,e.type,!1)}},{key:"showLogin",value:function(){var e=this;if(this.currentEditor&&this.currentEditor.isDirty()){var t=this.currentEditor.getId();new st(t,(function(t){var a;if(t===Ze.apply)null===(a=e.currentEditor)||void 0===a||a.apply().then((function(){var t;w.b.getInstance().loginUser(null===(t=e.currentEditor)||void 0===t?void 0:t.getId())}));else if(t===Ze.discard){var n;w.b.getInstance().loginUser(null===(n=e.currentEditor)||void 0===n?void 0:n.getId())}})).show()}else{var a;w.b.getInstance().loginUser(null===(a=this.currentEditor)||void 0===a?void 0:a.getId())}}},{key:"addToUndoStack",value:function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.undostack.add(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"editorApply",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.undostack.add(t);case 2:this.setEditor(null,!1),a&&a.length>0&&Object(y.info)(a,{timeout:3e3});case 4:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"editorCancel",value:function(){this.setEditor(null,!1),this.stage.setImageData(this.getImageData()),this.stage.centerContent()}},{key:"getEditorIds",value:function(){return"".concat("resize,crop,spotheal,adjust,cutout,effects").split(",")}},{key:"setEditor",value:function(e){var t,a,n=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e!==this.currentEditor&&e!==(null===(t=this.currentEditor)||void 0===t?void 0:t.getId()))if(r&&(null===(a=this.currentEditor)||void 0===a?void 0:a.isDirty())){var i=this.currentEditor.getId();new it(i,(function(t){var a;if(t===Ze.apply)null===(a=n.currentEditor)||void 0===a||a.apply().then((function(){n.switchEditor(e)}));else if(t===Ze.discard){var r;null===(r=n.currentEditor)||void 0===r||r.cancel(),n.switchEditor(e)}})).show()}else this.switchEditor(e)}},{key:"switchEditor",value:function(e){var t,a,n;if(void 0!==this.currentEditor&&window.history.replaceState(null,"",e?"/".concat(He.a[e]):"/"),this.currentEditor&&(this.currentEditor.endEditor(),Object(K.c)("editor:".concat(this.currentEditor.getId()))),this.currentEditor=null,e){var r;this.currentEditor=this.createEditor(e);var i=this.ensureHTMLElement("editor-container");null===(r=this.currentEditor)||void 0===r||r.startEditor(i)}this.docActions.update(),this.toolbar.setSelectedEditorId(null===(t=this.currentEditor)||void 0===t?void 0:t.getId()),this.getStage().setZoomMode(ye.NONE),null===(a=this.getDocView())||void 0===a||a.setEditorId(null===(n=this.currentEditor)||void 0===n?void 0:n.getId());var o=this;window.requestAnimationFrame((function(){o.stage.editorChanged()})),this.currentEditor&&(Object(K.b)("editor:".concat(this.currentEditor.getId())),Ne.getInstance().track({"event.workflow":"Home","event.subcategory":"Editor","event.type":"click","event.subtype":"editor","event.value":this.currentEditor.getId()}))}},{key:"createEditor",value:function(e){switch(e){case He.a.spotheal:return new Xt(this);case He.a.crop:return new wt(this);case He.a.resize:return new zt(this);case He.a.adjust:return new ut.b(this);case He.a.cutout:return new xt.b(this);case He.a.effects:return new Ft(this);default:return null}}},{key:"getCurrentEditor",value:function(){return this.currentEditor||void 0}},{key:"evalDeeplinkActions",value:function(){var e,t,a=D.a.getParams();("convert"===(null===(e=a.globalAction)||void 0===e?void 0:e.action)||"compress"===(null===(t=a.globalAction)||void 0===t?void 0:t.action))&&(this.showSaveImage(),a.globalAction.action=void 0,D.a.setParams(a))}},{key:"toggleFooter",value:function(){this.app.getFooter().toggleFooter()}},{key:"getHotKeysEnabled",value:function(){var e=[];return this.hotkeysEnabled.forEach((function(t,a){t&&e.push(a)})),e}},{key:"setHotKeysEnabled",value:function(e){var t=this;this.hotkeysEnabled.forEach((function(a,n){e.includes(n)&&t.hotkeysEnabled.set(n,e.includes(n))}))}},{key:"setHotKeysDisabled",value:function(e){var t=this;this.hotkeysEnabled.forEach((function(a,n){t.hotkeysEnabled.set(n,!e.includes(n)),e.includes(n)&&t.hotkeysEnabled.set(n,!e.includes(n))}))}},{key:"setLoading",value:function(e){var t;null===(t=this.getDocView())||void 0===t||t.setLoading(e)}},{key:"onPointerDown",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onPointerDown(e)}},{key:"onPointerMove",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onPointerMove(e)}},{key:"onPointerUp",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onPointerUp(e)}},{key:"onPointerEnter",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onPointerEnter(e)}},{key:"onPointerOut",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onPointerOut(e)}},{key:"onPointerLeave",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onPointerLeave(e)}},{key:"onGestureStart",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onGestureStart(e)}},{key:"onGestureChange",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onGestureChange(e)}},{key:"onGestureEnd",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onGestureEnd(e)}},{key:"onZoomChange",value:function(e){var t;null===(t=this.currentEditor)||void 0===t||t.onZoomChange(e)}},{key:"onContainerSizeChanged",value:function(e,t){var a;null===(a=this.currentEditor)||void 0===a||a.onContainerSizeChanged(e,t)}},{key:"onPanModeStart",value:function(){var e;null===(e=this.currentEditor)||void 0===e||e.onPanModeStart()}},{key:"onPanModeEnd",value:function(){var e;null===(e=this.currentEditor)||void 0===e||e.onPanModeEnd()}},{key:"onZoomModeStart",value:function(){var e;null===(e=this.currentEditor)||void 0===e||e.onZoomModeStart()}},{key:"onZoomModeEnd",value:function(){var e;null===(e=this.currentEditor)||void 0===e||e.onZoomModeEnd()}},{key:"getDocView",value:function(){return this.view}}]),a}(L.a),rn=a(73),on=a.n(rn),sn=(a(672),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(l.a)(this,a),n=t.call(this,e);var r=D.a.getParam("theme")||"light",i=D.a.getParam("scale")||"medium";return n.state={theme:r,scale:i,loading:e.loading},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),Object(K.b)("editor:home")}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this),Object(K.c)("editor:home")}},{key:"refresh",value:function(){}},{key:"setTheme",value:function(e){this.setState({theme:e})}},{key:"setLoading",value:function(e){this.setState({loading:e})}},{key:"render",value:function(){var e=this.state,t=e.theme,a=e.scale,n=e.loading;return v.a.createElement(on.a,{theme:t,scale:a,typekitId:"glm4yoq",className:"vars-provider"},n&&v.a.createElement(Be.a,{centered:!0}),v.a.createElement("div",{id:"navbar-container"}),v.a.createElement("div",{id:"app-container"}),v.a.createElement("div",{id:"footer-container"}))}}]),a}(m.PureComponent)),ln=a(240),cn=a.n(ln),un=a(53),dn=a.n(un),hn=(a(675),"https://www.adobe.com/go/"),fn=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={footerVisible:e.controller.isFooterVisible()},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){this.setState({footerVisible:this.props.controller.isFooterVisible()})}},{key:"render",value:function(){var e=this.state.footerVisible,t=this.props.controller;return v.a.createElement("div",{className:"footer-layer",style:e?{bottom:"0px"}:{bottom:"-42px"}},v.a.createElement("div",{"aria-label":Object(X.b)("Footer.aria-label","Footer"),className:"footer-content",onClick:function(){return t.toggleFooter()}},v.a.createElement("ul",{className:"footer-left"},v.a.createElement("li",null,v.a.createElement(dn.a,{href:"".concat(hn).concat(Object(X.b)("Footer.tou.url","cc-home-legal-terms")),target:"_blank",rel:"noopener noreferrer","aria-label":Object(X.b)("Footer.tou.title","Terms of Use")},Object(X.b)("Footer.tou.title","Terms of Use"))),v.a.createElement("li",null,v.a.createElement(dn.a,{href:"".concat(hn).concat(Object(X.b)("Footer.privacyPolicy.url","cc-home-privacy-center")),target:"_blank",rel:"noopener noreferrer","aria-label":Object(X.b)("Footer.privacyPolicy.title","Privacy Policy")},Object(X.b)("Footer.privacyPolicy.title","Privacy Policy"))),v.a.createElement("li",null,v.a.createElement(dn.a,{href:"".concat(hn).concat(Object(X.b)("Footer.cookies.url","cc-home-privacy-cookies")),target:"_blank",rel:"noopener noreferrer","aria-label":Object(X.b)("Footer.cookies.title","Cookies")},Object(X.b)("Footer.cookies.title","Cookies"))),v.a.createElement("li",null,v.a.createElement("div",{className:"privacy-notice-link"},v.a.createElement(dn.a,{onClick:function(){return t.onClickCookiePref()},"aria-label":Object(X.b)("Footer.cookiePreferences.title","Cookie Preferences")},Object(X.b)("Footer.cookiePreferences.title","Cookie Preferences")),v.a.createElement("div",{className:"consent-link-hidden"}))),v.a.createElement("li",{className:"recaptcha"},Object(X.b)("Footer.captchaPolicy.title","This site is protected by reCAPTCHA."),v.a.createElement(dn.a,{href:"https://policies.google.com/privacy",target:"_blank",rel:"noopener noreferrer","aria-label":Object(X.b)("Footer.privacyPolicy.google","Google Privacy Policy"),className:"google-first-link"},Object(X.b)("Footer.privacyPolicy.google","Google Privacy Policy"))," ",v.a.createElement(dn.a,{href:"https://policies.google.com/terms",target:"_blank",rel:"noopener noreferrer","aria-label":Object(X.b)("Footer.tou.google","Google Terms of Use")},Object(X.b)("Footer.tou.google","Google Terms of Use")))),v.a.createElement("ul",{className:"footer-right"},v.a.createElement("li",{className:"footer-copyright"},"\xa9",Object(X.b)("Footer.copyright2021","2021 Adobe. All Rights Reserved.")),v.a.createElement("li",null,v.a.createElement(U.a,{variant:"tool",icon:v.a.createElement(cn.a,{size:"S"}),style:{height:"18px",marginLeft:"10px"}}))),v.a.createElement("div",{id:"g-recaptcha"})))}}]),a}(m.PureComponent);window.fedsConfig=window.fedsConfig||{},window.fedsConfig.privacy=window.fedsConfig.privacy||{},window.fedsConfig.privacy.otDomainId="7a5eb705-95ed-4cc4-a11d-0cc5760e93db",window.fedsConfig.privacy.footerLinkSelector=".consent-link-hidden";var pn=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).app=void 0,n.footerVisible=!1,n.app=e,n}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e),b.a.render(v.a.createElement(fn,{controller:this}),e)}},{key:"destroyView",value:function(){this.container&&b.a.unmountComponentAtNode(this.container),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"viewDidMount",value:function(e){var t;if(Object(d.a)(Object(h.a)(a.prototype),"viewDidMount",this).call(this,e),!k.a.isLocalhost()){window.captchaOnLoad=this.onCaptchaLoad;var n=k.a.loadScript("privacyjs",null!==(t="https://www.adobe.com/etc/beagle/public/globalnav/adobe-privacy/latest/privacy.min.js")?t:"https://www.adobe.com/etc/beagle/public/globalnav/adobe-privacy/latest/privacy.min.js"),r=k.a.loadScript("gcaptcha","".concat("https://www.google.com/recaptcha/api.js","?onload=captchaOnLoad&render=explicit"));Promise.all([n,r]).then((function(){console.debug("Privacy and captcha script loaded")})).catch((function(e){console.error(e)}))}}},{key:"viewWillUnmount",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"viewWillUnmount",this).call(this,e)}},{key:"isFooterVisible",value:function(){return this.footerVisible}},{key:"toggleFooter",value:function(){var e;this.footerVisible=!this.footerVisible,null===(e=this.view)||void 0===e||e.refresh()}},{key:"onClickCookiePref",value:function(){window.adobePrivacy&&window.adobePrivacy.showConsentPopup&&window.adobePrivacy.showConsentPopup()}},{key:"onCaptchaLoad",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:window.grecaptcha.render("g-recaptcha",{sitekey:"6Lch52caAAAAAMm2P5EFnvVbOzzX9oVXtUC0r1A-",size:"invisible"}),window.grecaptcha.ready((function(){console.debug("RECAPTCHA READY"),window.grecaptcha.recaptchaReady=!0}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),a}(L.a),mn=a(241),vn=a.n(mn),gn=a(33);function bn(){return(bn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function yn(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var En=v.a.createElement("defs",null,v.a.createElement("style",null,".cls-1{fill:#001e36;}.cls-2{fill:#31a8ff;}")),wn=v.a.createElement("title",null,"Asset 131"),xn=v.a.createElement("g",{id:"Layer_2","data-name":"Layer 2"},v.a.createElement("g",{id:"Surfaces"},v.a.createElement("g",{id:"Photo_Surface","data-name":"Photo Surface"},v.a.createElement("g",{id:"Outline_no_shadow","data-name":"Outline no shadow"},v.a.createElement("rect",{className:"cls-1",width:240,height:234,rx:42.5})))),v.a.createElement("g",{id:"Outlined_Mnemonics_Logos","data-name":"Outlined Mnemonics & Logos"},v.a.createElement("g",{id:"PsX"},v.a.createElement("path",{className:"cls-2",d:"M81.01333,71.42888a31.83047,31.83047,0,0,0-12.09216-8.20669q-7.53095-3.055-18.53769-3.05709-4.056,0-8.1824.08064-4.12738.08219-7.82055.16024-3.69317.0822-6.87975.16128-3.18684.0822-5.50292.07961c-.5787,0-.86921.37839-.86921,1.12689V164.09738c0,.85913.337,1.28611,1.01421,1.28611h17.668q1.30342,0,1.3042-1.44739V132.7382q2.60763,0,3.91.08064,1.30343.0822,4.48949.07961a52.47429,52.47429,0,0,0,20.27585-3.78079A30.84641,30.84641,0,0,0,84.272,116.9689q5.35638-8.36487,5.35947-21.24146a41.409,41.409,0,0,0-2.02841-12.95413A32.0492,32.0492,0,0,0,81.01333,71.42888ZM67.11064,106.50842a15.57359,15.57359,0,0,1-7.38633,5.31088,31.01214,31.01214,0,0,1-10.354,1.6097h-4.78q-1.595,0-3.47529-.16128V79.9571a35.26634,35.26634,0,0,1,3.69239-.24088q2.67975-.0791,6.1558-.08064a24.45892,24.45892,0,0,1,10.57188,2.01187,13.9266,13.9266,0,0,1,6.29925,5.712,17.66748,17.66748,0,0,1,2.101,8.85078Q69.93538,102.81035,67.11064,106.50842Z"}),v.a.createElement("path",{className:"cls-2",d:"M136.33511,122.92633a60.58927,60.58927,0,0,0-13.83135-7.32172,58.06366,58.06366,0,0,1-6.37265-3.3,10.10386,10.10386,0,0,1-3.0408-2.65492,4.57229,4.57229,0,0,1-.86921-2.57429,5.48814,5.48814,0,0,1,.72421-2.73556,4.88082,4.88082,0,0,1,2.82473-2.01187,16.98789,16.98789,0,0,1,5.43-.7237,41.41966,41.41966,0,0,1,10.06607,1.28714,28.00184,28.00184,0,0,1,8.10335,3.37966.87006.87006,0,0,0,1.01343,0,1.12223,1.12223,0,0,0,.43525-.96562V89.05329a4.92326,4.92326,0,0,0-.14525-1.20753,1.39068,1.39068,0,0,0-.869-.885,21.38725,21.38725,0,0,0-7.01756-2.33339,63.60354,63.60354,0,0,0-11.15058-.885q-9.55935,0-15.93161,3.5399a23.05024,23.05024,0,0,0-9.41346,9.17231,25.02389,25.02389,0,0,0-3.04184,12.06915A24.24565,24.24565,0,0,0,95.3492,118.7413a23.91723,23.91723,0,0,0,6.80634,8.44862,51.52851,51.52851,0,0,0,12.81818,7.24108q6.65863,2.73867,8.83372,4.66679a5.4648,5.4648,0,0,1,2.17264,4.02271,4.61736,4.61736,0,0,1-2.39026,4.184q-2.38974,1.44842-7.45871,1.44842a41.6417,41.6417,0,0,1-10.57214-1.52906A31.98543,31.98543,0,0,1,95.275,142.31617a.64748.64748,0,0,0-.79658-.08064.9862.9862,0,0,0-.36081.885v17.379a2.12973,2.12973,0,0,0,1.01317,1.93123,29.24629,29.24629,0,0,0,8.32918,3.21838,53.24883,53.24883,0,0,0,12.23742,1.28714q9.70008,0,16.29242-3.21837a23.49634,23.49634,0,0,0,10.06582-8.93039,25.02838,25.02838,0,0,0,3.47606-13.27669,24.1285,24.1285,0,0,0-2.10079-10.29817A22.5497,22.5497,0,0,0,136.33511,122.92633Z"}),v.a.createElement("path",{className:"cls-2",d:"M218.68463,162.66309,193.08585,116.6115,216.9864,73.21162a1.63016,1.63016,0,0,0,.23013-1.63659,1.46389,1.46389,0,0,0-1.46091-.83165H198.78977a2.23891,2.23891,0,0,0-1.46708.37036,2.59759,2.59759,0,0,0-.70374,1.1753c-1.74446,3.77453-3.55056,7.14018-5.368,10.85306q-2.7893,5.69031-5.444,11.30509c-1.58316,3.34612-3.15811,6.79035-4.692,10.25667-1.502-3.42882-3.12831-6.83247-4.844-10.13441-1.98281-3.82282-3.92041-7.64409-5.75733-11.358-1.878-3.79045-3.61324-7.21825-5.22722-11.16281a2.56381,2.56381,0,0,0-2.50471-1.30526H144.51835A1.56111,1.56111,0,0,0,143.19,71.387a1.36123,1.36123,0,0,0,.08116,1.64892l24.179,45.0113-24.80976,44.73862a2.22962,2.22962,0,0,0-.28458,1.43061,1.22031,1.22031,0,0,0,1.25646,1.17941h17.7446a2.47073,2.47073,0,0,0,2.41841-1.66793c1.91706-3.7776,3.793-7.04318,5.57652-10.77147q2.7184-5.6826,5.50255-11.43865c1.63659-3.38,3.265-6.85456,4.84915-10.34553,1.69617,3.50022,3.44474,7.02715,5.20461,10.50015,1.91706,3.7884,3.76528,7.583,5.49536,11.27838,1.726,3.69388,3.45194,6.87007,5.19845,10.6487a3.48086,3.48086,0,0,0,3.31838,1.79635l18.512-.01079a1.60479,1.60479,0,0,0,1.44241-1.1491A2.32834,2.32834,0,0,0,218.68463,162.66309Z"})))),kn=function(e){var t=e.svgRef,a=e.title,n=yn(e,["svgRef","title"]);return v.a.createElement("svg",bn({viewBox:"0 0 240 234",ref:t},n),En,void 0===a?wn:a?v.a.createElement("title",null,a):null,xn)},Sn=v.a.forwardRef((function(e,t){return v.a.createElement(kn,bn({svgRef:t},e))})),On=(a.p,a(678),a(55)),Cn=(a(679),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={theme:D.a.getParam("theme")||"light"},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setConfigInWindow();var t=k.a.loadScript("utilnavjs",("https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.js","https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.js")),a=k.a.loadCSS("utilnavcss",("https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.css","https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.css"));Promise.all([t,a]).then((function(){e.renderUtilityNav()})).catch((function(e){console.error(e)}))}},{key:"componentWillUnmount",value:function(){}},{key:"refresh",value:function(){}},{key:"setConfigInWindow",value:function(){var e=this,t=this.props.signedin,a=document.getElementById("utilNavParent");if(a){var n=this.state.theme.toLowerCase().startsWith("light")?"light":"dark",r=Object(On.getAppLocale)("utilitynav",k.a.getCurrentLanguage(),"en"),i=[{name:"help",attributes:{children:[{type:"LearnMore",title:Object(X.b)("GlobalNav.UtilityNav.Help.LearnMore","Learn more")}],callback:function(){e.learnMore(),Object(K.a)("headerLearnMoreClick",{action:"headerClick"})}}}];t&&i.push({name:"nav-profile",events:{signin:function(){return Object(K.a)("headerSignInClick",{action:"headerClick"})},signout:function(){return Object(K.a)("headerSignOutClick",{action:"headerClick"})}}}),window.utilityNavConfig={theme:n,env:"prod",locale:r,target:a,analyticsContext:{consumer:{name:"frictionless-web",version:"0.1.0",platform:"Web",client_id:"ps-frictionless-web"}},children:i}}}},{key:"learnMore",value:function(){var e=k.a.getLocalizedURL("https://www.adobe.com/creativecloud/photography.html");k.a.openInNewTab(e)}},{key:"renderUtilityNav",value:function(){window.UtilityNav(window.utilityNavConfig)}},{key:"render",value:function(){var e=this.props.signedin;return v.a.createElement("div",{id:"utilNavParent",className:e?"global-utilnav-signin":"global-utilnav-signout"})}}]),a}(m.PureComponent)),Pn=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this)}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this)}},{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.controller,a=e.loggedIn;return v.a.createElement("div",{className:"navbar-row"},v.a.createElement("div",{className:"navbar-content"},v.a.createElement("div",{"aria-label":"Creative Cloud, link",className:"left-header"},v.a.createElement(U.a,{quiet:!0,variant:"action",className:"navbar-title-link",onClick:function(){t.home(),Object(K.a)("headerLogoClick",{action:"headerClick"})}},v.a.createElement("div",{className:"logo"},v.a.createElement(gn.a,{icon:v.a.createElement(Sn,null)})),v.a.createElement("div",{className:"navbar-title"},v.a.createElement("div",{className:"title"},v.a.createElement("span",null,"Adobe Photoshop Express"))))),v.a.createElement("div",{className:"actions"},v.a.createElement("div",{id:"actions-container"}),v.a.createElement("div",{className:"profile-container"},a?v.a.createElement("div",{className:"utilNavParent-placeholder-signin"},v.a.createElement(Cn,{signedin:!0})):v.a.createElement(v.a.Fragment,null,v.a.createElement("div",{className:"utilNavParent-placeholder-signout"},v.a.createElement(Cn,{signedin:!1})),v.a.createElement(U.a,{variant:"cta",icon:v.a.createElement(vn.a,null),onClick:function(){Object(K.a)("headerSignInClick",{action:"headerClick"}),t.login()}},Object(X.b)("GlobalNav.Button.SignIn","Sign in")))))))}}]),a}(m.PureComponent),Tn=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).app=void 0,n.actionsController=void 0,n.app=e,n}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e),b.a.render(v.a.createElement(Pn,{controller:this,loggedIn:w.b.getInstance().isSignedInUser()}),e)}},{key:"destroyView",value:function(){this.container&&b.a.unmountComponentAtNode(this.container),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"viewDidMount",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"viewDidMount",this).call(this,e),this.createActionsControllerView()}},{key:"viewWillUnmount",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"viewWillUnmount",this).call(this,e)}},{key:"home",value:function(){this.app.home()}},{key:"login",value:function(){this.app.login()}},{key:"setActionsController",value:function(e){this.actionsController&&this.actionsController.destroyView(),this.actionsController=e,this.createActionsControllerView()}},{key:"createActionsControllerView",value:function(){this.actionsController&&this.view&&this.actionsController.createView(this.ensureHTMLElement("actions-container"))}}]),a}(L.a),An=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).navbar=void 0,e.footer=void 0,e.doc=void 0,e.navbar=new Tn(Object(u.a)(e)),e.footer=new pn(Object(u.a)(e)),Object(K.a)("launch"),e}return Object(c.a)(a,[{key:"createView",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,e),b.a.render(v.a.createElement(sn,{controller:this,loading:!0}),e)}},{key:"destroyView",value:function(){this.container&&b.a.unmountComponentAtNode(this.container),Object(d.a)(Object(h.a)(a.prototype),"destroyView",this).call(this)}},{key:"viewDidMount",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n,r,i,s,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(d.a)(Object(h.a)(a.prototype),"viewDidMount",this).call(this,t),e.prev=1,e.next=4,Promise.all([w.b.getInstance().load(),X.a.getInstance().init(),_.getInstance().loadTests()]);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:if(null===(n=this.getAppView())||void 0===n||n.setLoading(!1),Ne.getInstance().track({"event.workflow":"Home","event.subcategory":"Launch","event.type":"render","event.subtype":"page"}),this.navbar.createView(this.ensureHTMLElement("navbar-container")),this.footer.createView(this.ensureHTMLElement("footer-container")),i=D.a.getParams(),s=new We(this,null===i||void 0===i?void 0:i.editor),"authorize"!==(null===(r=i.ims)||void 0===r?void 0:r.redirectAPI)){e.next=27;break}return e.prev=16,e.next=19,s.getPreviousDocument();case 19:return l=e.sent,e.next=22,s.restorePreviousDocument(l.sessionDBName);case 22:return e.abrupt("return",Promise.resolve());case 25:e.prev=25,e.t1=e.catch(16);case 27:return e.abrupt("return",s.createView(this.ensureHTMLElement("app-container")));case 28:case"end":return e.stop()}}),e,this,[[1,6],[16,25]])})));return function(t){return e.apply(this,arguments)}}()},{key:"viewWillUnmount",value:function(e){Object(d.a)(Object(h.a)(a.prototype),"viewWillUnmount",this).call(this,e)}},{key:"getNavBar",value:function(){return this.navbar}},{key:"getFooter",value:function(){return this.footer}},{key:"createDocument",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a,n,r,i){var s,l,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.doc){e.next=4;break}return e.next=3,this.doc.close();case 3:this.doc.destroyView();case 4:u=null!==(s=null===(l=this.doc)||void 0===l||null===(c=l.getCurrentEditor())||void 0===c?void 0:c.getId())&&void 0!==s?s:null,this.doc||u||(u=this.getInitialEditor()),this.doc=new nn(this,t,a,a,r,i),this.doc.createView(this.ensureHTMLElement("app-container")),this.doc.setEditor(u),i&&this.doc.getDocActions().update(),this.doc.evalDeeplinkActions();case 11:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r,i){return e.apply(this,arguments)}}()},{key:"home",value:function(){var e;null===(e=this.doc)||void 0===e||e.setEditor(null)}},{key:"login",value:function(){this.doc?this.doc.showLogin():w.b.getInstance().loginUser()}},{key:"hasDoc",value:function(){return void 0!==this.doc}},{key:"getInitialEditor",value:function(){var e,t=D.a.getParams();return(null===(e=t.ims)||void 0===e?void 0:e.lastEditor)?t.ims.lastEditor:D.a.getParams().editor||null}},{key:"getAppView",value:function(){return this.view}}]),a}(L.a),jn=a(63),In=a(242),Mn=a.n(In),Rn=a(109),_n=a.n(Rn),Dn=(a(686),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(l.a)(this,a),n=t.call(this,e);var r=D.a.getParam("theme")||"light",i=D.a.getParam("scale")||"medium";return n.state={theme:r,scale:i},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),Object(K.b)("unsupportedBrowser")}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this),Object(K.c)("unsupportedBrowser")}},{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.theme,a=e.scale;return v.a.createElement(on.a,{theme:t,scale:a,typekitId:"glm4yoq",className:"vars-provider unsupported-browser"},v.a.createElement("div",null,v.a.createElement(_n.a,{className:"browser-message",heading:Object(X.b)("UnsupportedBrowserApp.Recommendation.Header","The browser you are using is not supported."),description:Object(X.b)("UnsupportedBrowserApp.Recommendation.Description","You can still access the tool by downloading the latest version of any of the following browsers:"),illustration:v.a.createElement(Mn.a,{size:"XXL"})}),v.a.createElement(jn.Grid,{variant:"fixed"},v.a.createElement(jn.GridRow,{align:"center"},v.a.createElement(jn.GridColumn,{className:"browser-column chrome",size:2},v.a.createElement(dn.a,{className:"browser-link",key:"chrome",href:"https://www.google.com/chrome/browser/desktop/index.html",target:"_blank",rel:"noopener noreferrer"},Object(X.b)("UnsupportedBrowserApp.Recommendation.LinkText.Chrome","Chrome"))),v.a.createElement(jn.GridColumn,{className:"browser-column safari",size:2},v.a.createElement(dn.a,{className:"browser-link",key:"safari",href:"https://support.apple.com/downloads/safari",target:"_blank",rel:"noopener noreferrer"},Object(X.b)("UnsupportedBrowserApp.Recommendation.LinkText.Safari","Safari"))),v.a.createElement(jn.GridColumn,{className:"browser-column firefox",size:2},v.a.createElement(dn.a,{className:"browser-link",key:"firefox",href:"https://www.mozilla.org/firefox",target:"_blank",rel:"noopener noreferrer"},Object(X.b)("UnsupportedBrowserApp.Recommendation.LinkText.Firefox","Firefox"))),v.a.createElement(jn.GridColumn,{className:"browser-column edge",size:2},v.a.createElement(dn.a,{className:"browser-link",key:"edge",href:"https://www.microsoft.com/windows/microsoft-edge",target:"_blank",rel:"noopener noreferrer"},Object(X.b)("UnsupportedBrowserApp.Recommendation.LinkText.Edge","Edge")))))))}}]),a}(m.PureComponent)),Ln=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"createView",value:function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,t),e.prev=1,e.next=4,X.a.getInstance().init();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:b.a.render(v.a.createElement(Dn,{controller:this}),t);case 10:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()}],[{key:"isUnSupportedBrowser",value:function(){var e=new r.UAParser;return void 0!==a.UNSUPPORTED_BROWSERS.find((function(t){return e.getBrowser().name===t.name&&(void 0===t.maxVersion||parseInt(e.getBrowser().version||"999",10)<=t.maxVersion)}))}}]),a}(L.a);function Nn(){return(Nn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Vn(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}Ln.UNSUPPORTED_BROWSERS=[{name:"IE"},{name:"Edge",maxVersion:18}];var Un=v.a.createElement("circle",{className:"path circle",fill:"none",stroke:"#44b556",strokeWidth:8,strokeMiterlimit:10,cx:65,cy:65,r:60,transform:"rotate(-40 65 65)"}),Fn=v.a.createElement("polyline",{className:"path check",fill:"none",stroke:"#44b556",strokeWidth:8,strokeLinecap:"round",strokeMiterlimit:10,points:"100,40 51,88 29,67 "}),Bn=function(e){var t=e.svgRef,a=e.title,n=Vn(e,["svgRef","title"]);return v.a.createElement("svg",Nn({width:64,height:64,viewBox:"0 0 130 130",className:"CheckMarkIcon__icon___3BHDg",ref:t},n),a?v.a.createElement("title",null,a):null,Un,Fn)},Hn=v.a.forwardRef((function(e,t){return v.a.createElement(Bn,Nn({svgRef:t},e))}));a.p;function zn(){return(zn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Gn(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Wn,Zn=v.a.createElement("g",{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:10,strokeWidth:"3px"},v.a.createElement("path",{d:"M110.53,85.66,100.26,95.89a1.09,1.09,0,0,1-1.52,0L88.47,85.66"}),v.a.createElement("line",{x1:99.5,y1:95.5,x2:99.5,y2:58.5}),v.a.createElement("path",{d:"M105.5,73.5h19a2,2,0,0,0,2-2v-43"}),v.a.createElement("path",{d:"M126.5,22.5h-19a2,2,0,0,1-2-2V1.5h-31a2,2,0,0,0-2,2v68a2,2,0,0,0,2,2h19"}),v.a.createElement("line",{x1:105.5,y1:1.5,x2:126.5,y2:22.5}),v.a.createElement("path",{d:"M139.5,36.5H196A1.49,1.49,0,0,1,197.5,38V72A1.49,1.49,0,0,1,196,73.5H141A1.49,1.49,0,0,1,139.5,72V32A1.49,1.49,0,0,1,141,30.5H154a2.43,2.43,0,0,1,1.67.66l6,5.66"}),v.a.createElement("rect",{x:1.5,y:34.5,width:58,height:39,rx:2,ry:2}),v.a.createElement("path",{strokeWidth:"2px",d:"M47.93,50.49a5,5,0,1,0-4.83-5A4.93,4.93,0,0,0,47.93,50.49Z"}),v.a.createElement("path",{strokeWidth:"2px",d:"M36.6,65.93,42.05,60A2.06,2.06,0,0,1,45,60l12.68,13.2"}),v.a.createElement("path",{strokeWidth:"2px",d:"M3.14,73.23,22.42,53.76a1.65,1.65,0,0,1,2.38,0l19.05,19.7"})),Yn=function(e){var t=e.svgRef,a=e.title,n=Gn(e,["svgRef","title"]);return v.a.createElement("svg",zn({viewBox:"0 0 199 97.7",height:110,className:"spectrum-IllustratedMessage-illustration","aria-hidden":"true",ref:t},n),a?v.a.createElement("title",null,a):null,Zn)},Kn=v.a.forwardRef((function(e,t){return v.a.createElement(Yn,zn({svgRef:t},e))})),Xn=(a.p,a(687),function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,e)).inputFileRef=void 0,n.imgRef=Object(m.createRef)(),n.handleFileInputChange=function(e){var t=n.props.controller,a=e.target.files;if(a&&a[0]){if(!n.hasCorrectMimetype(a[0].type))return void Object(K.a)("converter:imageUploadFailed",{action:"fileInput",error:"incorrectFileFormat",doc:{mimeType:a[0].type}});n.setState({loading:!0}),t.readFile(a[0])}},n.onDrop=function(e){var t=n.props.controller;if(e.dataTransfer){var a=e.dataTransfer.files.item(0);a&&(n.hasCorrectMimetype(a.type)?(n.setState({loading:!0}),t.readFile(a),Object(K.a)("converter:imageUploadSuccess",{action:"dragDrop",doc:{action:"store",mimeType:a.type}})):Object(K.a)("converter:imageUploadFailed",{action:"dragDrop",error:"incorrectFileFormat",doc:{mimeType:a.type}}))}},n.onFileInputClick=function(){Object(K.a)("chooseFile"),null!==n.inputFileRef.current&&n.inputFileRef.current.click()};var r=D.a.getParam("theme")||"light",i=D.a.getParam("scale")||"medium";return n.state={theme:r,scale:i,mode:Wn.init,loading:!1},n.inputFileRef=v.a.createRef(),n}return Object(c.a)(a,[{key:"refresh",value:function(){}},{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),Object(K.b)("getConverterApp")}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this),Object(K.c)("getConverterApp")}},{key:"setParams",value:function(e,t){this.setState({loading:e}),t&&this.setState({mode:t})}},{key:"getImporterTitleText",value:function(){var e=this.props,t=e.sourceFormat,a=e.targetFormat;return t===E.b.JPG&&a===E.a.PNG?Object(X.b)("Converter.Title.Jpeg2Png","Convert JPEG to PNG"):t===E.b.SVG&&a===E.a.PNG?Object(X.b)("Converter.Title.Svg2Png","Convert SVG to PNG"):t===E.b.PNG&&a===E.a.JPG?Object(X.b)("Converter.Title.Png2Jpeg","Convert PNG to JPEG"):t===E.b.SVG&&a===E.a.JPG?Object(X.b)("Converter.Title.Svg2Jpeg","Convert SVG to JPEG"):a===E.a.JPG?Object(X.b)("Converter.Title.Files2Jpeg","Convert image to JPEG"):Object(X.b)("Converter.Title.Files2Png","Convert image to PNG")}},{key:"getImporterSubtitleText",value:function(){var e=this.props,t=e.sourceFormat,a=e.targetFormat;return t===E.b.JPG&&a===E.a.PNG?Object(X.b)("Converter.Subtitle.Jpeg2Png","Drag and drop a JPEG image (JPEG or JPG) to convert to PNG, or select an image to upload below."):t===E.b.SVG&&a===E.a.PNG?Object(X.b)("Converter.Subtitle.Svg2Png","Drag and drop an SVG image to convert to PNG, or select an image to upload below."):t===E.b.PNG&&a===E.a.JPG?Object(X.b)("Converter.Subtitle.Png2Jpeg","Drag and drop a PNG image to convert to JPG, or select an image to upload below."):t===E.b.SVG&&a===E.a.JPG?Object(X.b)("Converter.Subtitle.Svg2Jpeg","Drag and drop an SVG image to convert to JPG, or select an image to upload below."):a===E.a.JPG?Object(X.b)("Converter.Subtitle.Files2Jpeg","Drag and drop an image to convert to JPG, or select an image to upload below."):Object(X.b)("Converter.Subtitle.Files2Png","Drag and drop an image to convert to PNG, or select an image to upload below.")}},{key:"getDownloaderTitleText",value:function(){return this.props.targetFormat===E.a.PNG?Object(X.b)("Converter.Download.Title.PNG","Your PNG is ready"):Object(X.b)("Converter.Download.Title.JPEG","Your JPEG is ready")}},{key:"hasCorrectMimetype",value:function(e){var t=this.props,a=t.sourceFormat,n=t.targetFormat;if(a&&We.getAcceptedMimeType(a)!==e){switch(a){case E.b.JPG:Object(y.error)(Object(X.b)("Converter.ErrorToast.Message.JPG","Please select a valid JPEG image."),{timeout:5e3});break;case E.b.PNG:Object(y.error)(Object(X.b)("Converter.ErrorToast.Message.PNG","Please select a valid PNG image."),{timeout:5e3});break;case E.b.SVG:Object(y.error)(Object(X.b)("Converter.ErrorToast.Message.SVG","Please select a valid SVG image."),{timeout:5e3})}return!1}switch(n){case E.a.JPG:if(We.getAcceptedMimeType(E.b.JPG)===e||We.getAcceptedMimeType(E.b.PNG)!==e&&We.getAcceptedMimeType(E.b.SVG)!==e)return Object(y.error)(Object(X.b)("Converter.ErrorToast.Message.TargetJPG","Please select a valid PNG or SVG image."),{timeout:5e3}),!1;break;case E.a.PNG:if(We.getAcceptedMimeType(E.b.PNG)===e||We.getAcceptedMimeType(E.b.JPG)!==e&&We.getAcceptedMimeType(E.b.SVG)!==e)return Object(y.error)(Object(X.b)("Converter.ErrorToast.Message.TargetPNG","Please select a valid JPEG or SVG image."),{timeout:5e3}),!1}return!0}},{key:"getAcceptedFileExt",value:function(){var e=this.props,t=e.sourceFormat,a=e.targetFormat;if(t)return We.getAcceptedFileExt(t);switch(a){case E.a.JPG:return".png,.svg";case E.a.PNG:return".jpg,.jpeg,.svg";default:return".jpg,.jpeg,.png,.svg"}}},{key:"loadImageData",value:function(e){var t=x.a.resizeImageDataToWidth(e,400);if(t){var a=document.createElement("canvas");a.width=t.width,a.height=t.height;var n=a.getContext("2d");if(n){n.putImageData(t,0,0);var r=a.toDataURL();this.imgRef&&this.imgRef.current&&(this.imgRef.current.style.backgroundImage="url(".concat(r,")"))}}}},{key:"renderUpload",value:function(){var e=this,t=this.state.loading;return v.a.createElement(v.a.Fragment,null,v.a.createElement(Ue.a,{onDrop:this.onDrop,className:"drop-zone"},v.a.createElement(_n.a,{heading:this.getImporterTitleText(),description:this.getImporterSubtitleText(),illustration:v.a.createElement(Kn,null)}),v.a.createElement(U.a,{variant:"cta",onClick:function(){e.onFileInputClick(),Object(K.a)("converter:selectfile")},className:"button-selectfile",disabled:t},Object(X.b)("Converter.Button.SelectFile","Select a file")),v.a.createElement("input",{type:"file",id:"file-upload",accept:this.getAcceptedFileExt(),ref:this.inputFileRef,onChange:this.handleFileInputChange,style:{display:"none"}})),t&&v.a.createElement(Be.a,{centered:!0}))}},{key:"renderDownload",value:function(){var e=this,t=this.props.controller,a=this.state,n=a.mode,r=a.loading;return v.a.createElement("div",{className:"download-containter"},v.a.createElement("div",{className:"left",ref:this.imgRef}),v.a.createElement("div",{className:"right"},v.a.createElement("div",null,v.a.createElement(Hn,null),v.a.createElement("h1",null,this.getDownloaderTitleText()),v.a.createElement("section",null,v.a.createElement("div",{className:"action-buttons"},n===Wn.uploaded?v.a.createElement(U.a,{disabled:r,onClick:function(){Object(K.a)("converter:downloadimage"),t.download()},variant:"cta"},Object(X.b)("Converter.Button.Download","Download")):v.a.createElement(v.a.Fragment,null,v.a.createElement(U.a,{onClick:function(){Object(K.a)("converter:convertagain"),e.setState({mode:Wn.init})},variant:"cta"},Object(X.b)("Converter.Button.ConvertAgain","Convert again"))))),r&&v.a.createElement(Be.a,{className:"wait-download"}))))}},{key:"render",value:function(){var e=this.state,t=e.theme,a=e.scale,n=e.mode;return v.a.createElement(on.a,{theme:t,scale:a,typekitId:"glm4yoq",className:"vars-provider"},v.a.createElement("div",{className:"converter-container"},n===Wn.init&&this.renderUpload(),n!==Wn.init&&this.renderDownload()))}}]),a}(m.PureComponent));!function(e){e[e.init=0]="init",e[e.uploaded=1]="uploaded",e[e.downloaded=2]="downloaded"}(Wn||(Wn={}));var qn,Jn=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){var e,n;Object(l.a)(this,a),(n=t.call(this)).imageData=void 0,n.fileName=void 0,n.outputFormat=void 0;var r=D.a.getParams();return n.outputFormat=(null===(e=r.globalAction)||void 0===e?void 0:e.targetFormat)||E.a.JPG,n}return Object(c.a)(a,[{key:"createView",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,t),e.prev=1,e.next=4,X.a.getInstance().init();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:r=D.a.getParams(),b.a.render(v.a.createElement(Xn,{controller:this,sourceFormat:null===(n=r.globalAction)||void 0===n?void 0:n.sourceFormat,targetFormat:this.outputFormat}),t);case 11:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(e,t){this.view.setParams(e,t)}},{key:"readFile",value:function(e){var t=this;We.loadData(e,e.name,!1,{onSuccess:function(e,a){t.imageData=e,t.fileName=a,t.update(!1,Wn.uploaded),t.view.loadImageData(e)},onEmptyData:function(){t.update(!1)},onError:function(){t.update(!1)}})}},{key:"download",value:function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.imageData&&this.fileName&&this.outputFormat){e.next=2;break}return e.abrupt("return");case 2:return this.update(!0),e.next=5,C.downloadImageData(this.imageData,this.fileName,this.outputFormat,t);case 5:this.update(!1,Wn.downloaded);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),a}(L.a);a(688);qn||(qn=!0,a(689)),window.NREUM,a(690);var Qn=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(l.a)(this,a),n=t.call(this,e);var r=D.a.getParam("theme")||"light",i=D.a.getParam("scale")||"medium";return n.state={theme:r,scale:i},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),Object(K.b)("getMobileApp")}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this),Object(K.c)("getMobileApp")}},{key:"refresh",value:function(){}},{key:"getPSX",value:function(){Object(K.a)("getPhotoshopExpress"),window.location.href="https://photoshopexpress.app.link/63TYhKmVL4"}},{key:"render",value:function(){var e=this,t=this.state,a=t.theme,n=t.scale;return v.a.createElement(on.a,{theme:a,scale:n,typekitId:"glm4yoq",className:"vars-provider"},v.a.createElement("div",{className:"landingpage-content"},v.a.createElement("div",{className:"teaser-text"},Object(X.b)("Mobile.Landingpage.Teasertext1","This web app is only available on desktops. But our free Adobe Photoshop Express mobile app offers an easy way to retouch your photos and edit them in fun ways \u2015 right from your smartphone or tablet.")),v.a.createElement(U.a,{variant:"cta",onClick:function(){e.getPSX()}},Object(X.b)("Mobile.Landingpage.Button","Get Photoshop Express")),v.a.createElement("div",{className:"teaser-image"},v.a.createElement("img",{src:"/assets/photoshop_express_teaser.jpg",alt:"Photoshop Express"})),v.a.createElement("div",{className:"teaser-text"},Object(X.b)("Mobile.Landingpage.Teasertext2","Photoshop Express makes it easy to edit, get creative, and share photos so they stand out on social and everywhere else."))))}}]),a}(m.PureComponent),$n=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"createView",value:function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(d.a)(Object(h.a)(a.prototype),"createView",this).call(this,t),e.prev=1,e.next=4,X.a.getInstance().init();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:b.a.render(v.a.createElement(Qn,{controller:this}),t);case 10:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()}]),a}(L.a),er=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function tr(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(console.debug("Service worker state changes to ".concat(a.state)),navigator.serviceWorker.controller?(er&&window.confirm("There is a newer version of the App available. Reload?")&&window.location.reload(),t&&t.onUpdate&&t.onUpdate(e)):t&&t.onSuccess&&t.onSuccess(e))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}a(691),a(692),a(693);var ar,nr,rr=document.getElementById("root");if(!rr)throw new Error("missing element root");D.a.parseParams();var ir=D.a.getParams(),or=(new r.UAParser).getDevice(),sr=!1;if((null===(ar=ir.globalAction)||void 0===ar?void 0:ar.isEmbed)&&"convert"===(null===(nr=ir.globalAction)||void 0===nr?void 0:nr.action))(new Jn).createView(rr);else if(void 0!==or.type&&"tablet"!==or.type){(new $n).createView(rr)}else if(Ln.isUnSupportedBrowser()){(new Ln).createView(rr)}else{(new An).createView(rr),sr=!0}sr?function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");er?("storage"in navigator&&"estimate"in navigator.storage&&navigator.storage.estimate().then((function(e){var t=e.usage,a=e.quota;if(t&&a){var n=Math.round(t/a*100),r=Math.round(t/1048576),i=Math.round(a/1048576);console.debug("".concat(r," out of ").concat(i," MiB used (").concat(n,"%)"))}})),function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||!Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_GOOGLE_CAPTCHA_URL:"https://www.google.com/recaptcha/api.js",REACT_APP_STORAGE_API_URL:"https://cc-api-storage-creativesdk.adobe.io",REACT_APP_PM_WASM_HASH:"a888ee0586ced614e2b443c111d9b1882cb0c3061b15b473ec822c76ad6f47c8",REACT_APP_IMS_ENV:"prod",REACT_APP_RUNNING_ENV:"production",REACT_APP_NAME:"frictionless-web",REACT_APP_PRIVACY_OTDOMAINID:"7a5eb705-95ed-4cc4-a11d-0cc5760e93db",REACT_APP_IMS_API_KEY:"ps-frictionless-web",REACT_APP_UTILITYNAV_CSS_URL:"https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.css",REACT_APP_CC_COMPARE_PLANS:"https://www.adobe.com/products/photoshop-lightroom/compare-plans.html",REACT_APP_UTILITYNAV_JS_URL:"https://prod.adobeccstatic.com/utilnav/9.0/utilitynav.js",REACT_APP_USERTESTS:"agedashi:app:available_editors",REACT_APP_BUILD_SHA:"020e20bc1941",REACT_APP_IMAGE_API_KEY:"ps-frictionless-web",REACT_APP_TARGET_CLIENT:"adobeinternalmobiles",REACT_APP_IMS_LIB_URL:"https://static.adobelogin.com/imslib/imslib.min.js",REACT_APP_CROP_FLIP_AXIS_REFERENCE:"cropbox",REACT_APP_BUILD_TIME:"Wed Apr  7 14:34:54 UTC 2021",REACT_APP_IMS_API_URL:"https://ims-na1.adobelogin.com",REACT_APP_AVAILABLE_EDITORS:"resize,crop,spotheal,adjust,cutout,effects",REACT_APP_CC_LEARN_MORE:"https://www.adobe.com/creativecloud/photography.html",REACT_APP_GLOBAL_TESTING_PROPERTY_TOKEN:"2bb70f5a-cc1f-79c3-a659-66e4e32dc3fc",REACT_APP_GLOBAL_TESTING_MBOXES:"agedashi:app:downloads",REACT_APP_DUNAMIS_PROJECT:"",REACT_APP_IMAGE_API_URL:"https://image.adobe.io",REACT_APP_ANONYMOUS_USER_DOWNLOADS_EACH_MS:"31536000000",REACT_APP_ANONYMOUS_USER_DOWNLOADS:"1",REACT_APP_WHITELISTED_LANGUAGES:"cs,da,de,en,es,fi,fr,it,ja,ko,nb,nl,pl,pt,ru,sv,tr,zh_CN,zh_TW,zh_cn,zh_tw",REACT_APP_CROP_ROTATE_PIVOT:"cropcenter",REACT_APP_APERITIF_API_URL:"https://image.adobe.io/utils/aperitif",REACT_APP_FREE_USER_DOWNLOADS_EACH_MS:"86400000",REACT_APP_DUNAMIS_ENV:"prod",REACT_APP_GOOGLE_CAPTCHA_SITEKEY:"6Lch52caAAAAAMm2P5EFnvVbOzzX9oVXtUC0r1A-",REACT_APP_FREE_USER_DOWNLOADS:"1",REACT_APP_DUNAMIS_API_KEY:"",REACT_APP_PRIVACY_JS_URL:"https://www.adobe.com/etc/beagle/public/globalnav/adobe-privacy/latest/privacy.min.js",REACT_APP_CROP_ROTATE_WITH_CROPBOX:"true",REACT_APP_NEWRELIC_AGENT_FILE:"agedashi-prod",REACT_APP_VERSION:"0.1.0",REACT_APP_STORAGE_API_KEY:"FrictionlessPSWebApp1",REACT_APP_ADOBE_BASE_GOURL:"https://www.adobe.com/go/",REACT_APP_GLOBAL_TRACKING_ENV:"production",REACT_APP_CROP_RATIOCHANGE_REFERENCE:"cropbox",REACT_APP_DUNAMIS_API_URL:"https://cc-api-data.adobe.io"}).REACT_APP_DEBUG_SW||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){t&&t.onUnregister&&t.onUnregister(),window.location.reload()}))})):tr(e,t)})).catch((function(){console.debug("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.debug("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):tr(t,e)}))}}({onSuccess:function(){console.debug("Content is cached for offline use")},onUpdate:function(){console.debug("New content is available and cached")},onUnregister:function(){console.debug("Service Worker un-registred")}}):(console.debug("unregister SW"),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})))},74:function(e,t,a){"use strict";var n=a(3),r=a(4),i=a(6),o=a(7),s=a(41),l=a.n(s),c=a(0),u=a.n(c),d=a(36),h=a(9),f=a(32),p=a(49),m=a.n(p),v=a(1),g=(a(494),function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"componentDidMount",value:function(){this.props.controller.viewDidMount(this),Object(h.b)("signinRequired:modal")}},{key:"componentWillUnmount",value:function(){this.props.controller.viewWillUnmount(this),Object(h.c)("signinRequired:modal")}},{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.controller,a=e.message;return u.a.createElement(m.a,{title:Object(v.b)("SigninDialog.Title","Sign In Required"),cancelLabel:Object(v.b)("SigninDialog.Button.Cancel","Cancel"),confirmLabel:Object(v.b)("SigninDialog.Button.SigninCTA","Sign in"),onConfirm:function(){return t.signin()},onCancel:function(){Object(h.a)("signinRequired:cancel"),t.close()},disableEscKey:!1},u.a.createElement("span",null,a))}}]),a}(c.PureComponent));a.d(t,"a",(function(){return b}));var b=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e,r,i){var o;return Object(n.a)(this,a),(o=t.call(this)).dialogId=void 0,o.message=void 0,o.targetSigninEditor=void 0,o.onCancel=void 0,o.message=e,o.targetSigninEditor=r,o.onCancel=i,o}return Object(r.a)(a,[{key:"show",value:function(){this.dialogId=l.a.show(u.a.createElement(g,{controller:this,message:this.message}))}},{key:"close",value:function(){this.dialogId&&(l.a.hide(this.dialogId),this.onCancel&&this.onCancel(),this.dialogId=void 0)}},{key:"signin",value:function(){Object(h.a)("signinRequired:signin"),d.b.getInstance().loginUser(this.targetSigninEditor)}}]),a}(f.a)},85:function(e,t,a){"use strict";var n=a(2),r=a.n(n),i=a(8),o=a(3),s=a(4),l=a(11),c=a(10),u=a(6),d=a(7),h=a(47),f=a(20),p=a(0),m=a.n(p),v=a(15),g=a.n(v),b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,50,75,0,0,0,0,0,0,0,50,50,0,0];function y(e){var t=document.createElement("canvas");t.width=256,t.height=256;var a=e.width>e.height?256/e.width:256/e.height,n=Math.floor(e.width*a),r=Math.floor(e.height*a);t.width=256,t.height=256;var i=t.getContext("2d");if(null!==i){i.drawImage(e,0,0,n,r);var o=i.getImageData(0,0,n,r);return function(e){var t=0,a=0,n=0,r=e.width,i=e.height,o=[.10986328125,.10577392578125,.0943603515625,.07806396484375,.05987548828125,.0426025390625,.028076171875,.01715087890625,.00970458984375,.005126953125,.00250244140625,.0010986328125,.00048828125,.00018310546875,6103515625e-14],s=o.length,l=new Array(65536),c=new Array(256);for(a=0;a<e.data.length;a++){var u=4*a;l[a]=(e.data[u]+2*e.data[u+1]+e.data[u+2])/4}for(a=0;a<i;a++){for(t=0;t<r;t++)c[t]=l[t+a*r];for(t=0;t<r;t++){var d=c[t]*o[0];for(n=1;n<s;n++){var h=Math.min(t+n,r-1);d+=c[h]*o[n],d+=c[h=Math.max(t-n,0)]*o[n]}l[t+a*r]=d}}for(t=0;t<r;t++){for(a=0;a<i;a++)c[a]=l[t+a*r];for(a=0;a<i;a++){var f=c[a]*o[0];for(n=1;n<s;n++){var p=Math.min(a+n,i-1);f+=c[p]*o[n],f+=c[p=Math.max(a-n,0)]*o[n]}l[t+a*r]=f}}for(a=0;a<e.data.length;a++){var m=l[a],v=Math.floor(m),g=Math.floor(256*(m-v));e.data[4*a]=v,e.data[4*a+1]=g,e.data[4*a+2]=0}}(o),o}return null}var E=[0,.18006,.26352,-.24341,10,.18066,.26589,-.25479,20,.18133,.26846,-.26876,30,.18208,.27119,-.28539,40,.18293,.27407,-.3047,50,.18388,.27709,-.32675,60,.18494,.28021,-.35156,70,.18611,.28342,-.37915,80,.1874,.28668,-.40955,90,.1888,.28997,-.44278,100,.19032,.29326,-.47888,125,.19462,.30141,-.58204,150,.19962,.30921,-.70471,175,.20525,.31647,-.84901,200,.21142,.32312,-1.0182,225,.21807,.32909,-1.2168,250,.22511,.33439,-1.4512,275,.23247,.33904,-1.7298,300,.2401,.34308,-2.0637,325,.24702,.34655,-2.4681,350,.25591,.34951,-2.9641,375,.264,.352,-3.5814,400,.27218,.35407,-4.3633,425,.28039,.35577,-5.3762,450,.28863,.35714,-6.7262,475,.29685,.35823,-8.5955,500,.30505,.35907,-11.324,525,.3132,.35968,-15.628,550,.32129,.36011,-23.325,575,.32931,.36038,-40.77,600,.33724,.36051,-116.45];function w(e,t){var a=new Array(3);return a[0]=e[0]*t[0]+e[1]*t[1]+e[2]*t[2],a[1]=e[3]*t[0]+e[4]*t[1]+e[5]*t[2],a[2]=e[6]*t[0]+e[7]*t[1]+e[8]*t[2],a}function x(e,t){var a=new Array(9);return a[0]=e[0]*t[0]+e[1]*t[3]+e[2]*t[6],a[1]=e[0]*t[1]+e[1]*t[4]+e[2]*t[7],a[2]=e[0]*t[2]+e[1]*t[5]+e[2]*t[8],a[3]=e[3]*t[0]+e[4]*t[3]+e[5]*t[6],a[4]=e[3]*t[1]+e[4]*t[4]+e[5]*t[7],a[5]=e[3]*t[2]+e[4]*t[5]+e[5]*t[8],a[6]=e[6]*t[0]+e[7]*t[3]+e[8]*t[6],a[7]=e[6]*t[1]+e[7]*t[4]+e[8]*t[7],a[8]=e[6]*t[2]+e[7]*t[5]+e[8]*t[8],a}function k(){var e=new Array(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function S(e){var t=new Array(9),a=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],d=new Array(9);d[0]=o*u-c*s,d[1]=c*r-n*u,d[2]=n*s-o*r,d[3]=l*s-i*u,d[4]=a*u-l*r,d[5]=i*r-a*s,d[6]=i*c-l*o,d[7]=l*n-a*c,d[8]=a*o-i*n;var h=a*d[0]+n*d[3]+r*d[6];if(Math.abs(h)<1e-10)return k();for(var f=0;f<3;f++)for(var p=0;p<3;p++)t[3*f+p]=d[3*f+p]/h;return t}function O(e,t){if(e=Math.max(1e-6,e),e=Math.min(.999999,e),t=Math.max(1e-6,t),e+(t=Math.min(.999999,t))>.999999){var a=.999999/(e+t);e*=a,t*=a}return[e/t,1,(1-e-t)/t]}function C(e,t,a,n,r){var i=[1.3458,-.2556,-.051,-.5444,1.5081,.0205,0,0,1.212],o=function(e,t){e=5e4/(10+(e/=100)*(3*e-12)),t=9.562965+(t=.5*(t/=100)*(1+Math.abs(t)))*(150+-9.562965*t);var a={x:0,y:0};a.x=0,a.y=0;for(var n=1e6/e,r=t*(1/-3e3),i=0;i<=29;i++)if(n<E[4*(i+1)]||29===i){var o=(E[4*(i+1)]-n)/(E[4*(i+1)]-E[4*i]),s=E[4*i+1]*o+E[4*(i+1)+1]*(1-o),l=E[4*i+2]*o+E[4*(i+1)+2]*(1-o),c=1,u=E[4*i+3],d=1,h=E[4*(i+1)+3],f=Math.sqrt(1+u*u),p=Math.sqrt(1+h*h),m=(c/=f)*o+(d/=p)*(1-o),v=(u/=f)*o+(h/=p)*(1-o),g=Math.sqrt(m*m+v*v);s+=(m/=g)*r,l+=(v/=g)*r,a.x=1.5*s/(s-4*l+2),a.y=l/(s-4*l+2);break}return a}(n,r),s=0,l=0,c=O(o.x,o.y);c=w(i,c);var u=1/Math.max(Math.max(c[0],c[1]),c[2]);for(s=0;s<3;s++){var d=c[s];d*=u,d=Math.max(.001,Math.min(1,d)),c[s]=d}var h=function(e,t,a,n){var r=[.8951,.2664,-.1614,-.7502,1.7135,.0367,.0389,-.0685,1.0296],i=O(e,t),o=O(a,n);i=w(r,i),o=w(r,o),i[0]=Math.max(i[0],0),i[1]=Math.max(i[1],0),i[2]=Math.max(i[2],0),o[0]=Math.max(o[0],0),o[1]=Math.max(o[1],0),o[2]=Math.max(o[2],0);var s=k();s[0]=Math.max(.1,Math.min(i[0]>0?o[0]/i[0]:10,10)),s[4]=Math.max(.1,Math.min(i[1]>0?o[1]/i[1]:10,10)),s[8]=Math.max(.1,Math.min(i[2]>0?o[2]/i[2]:10,10));var l=S(r);return null!=l&&(l=x(l,s),l=x(l,r)),l}(.3457,.3585,o.x,o.y),f=w(h=x(i,h),[.96429567642957,1,.82510460251046]);!function(e,t){for(var a=0;a<e.length;a++)e[a]*=t}(h,1/Math.max(Math.max(f[0],f[1]),f[2]));var p=x(i,S(h));p=x(p,function(e){var t=new Array(9);return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=e[2],t}(c));var m=new Array(3);m[0]=1/c[0],m[1]=1/c[1],m[2]=1/c[2];var v=new Array(3);for(v[0]=0,v[1]=1,v[2]=2,s=0;s<3;s++)for(t[3*s]=0,t[3*s+1]=0,t[3*s+2]=0,l=0;l<2;l++)if(m[v[l]]<m[v[l+1]]){var g=v[l];v[l]=v[l+1],v[l+1]=g}t[3*v[0]]=1,t[3*v[1]+1]=1,t[3*v[2]+2]=1,e[0]=p[v[0]],e[3]=p[v[1]],e[6]=p[v[2]],e[1]=p[3+v[0]],e[4]=p[3+v[1]],e[7]=p[3+v[2]],e[2]=p[6+v[0]],e[5]=p[6+v[1]],e[8]=p[6+v[2]],a[0]=m[v[0]],a[1]=m[v[1]],a[2]=m[v[2]]}function P(e){return e<0?-1:e>0?1:0}function T(e,t,a){var n=P(Math.max(t,0)),r=1/a,i=e=Math.pow(e,a),o=e,s=P(Math.max(e-.5,0)),l=4*(i-(.5*s+.25));i+=(l=(1-2*s)*(l*l-1))*(.095*t);var c=1-Math.pow(2,t);return o=.5*(1-c*s)*(o-=.5*s)/(.5*(1-c*(1-s))+(1-2*s)*c*o),e=(i-(o+=.5*s))*n+o,e=Math.pow(e,r)}function A(e){var t=e/100;return.5*t*t+1.5*t+1}function j(e){var t=0,a=0;if(e<0)if(e>=-50)t=A(90*e/50),a=1;else{var n=2*(e+50);t=A((e+50)/5-90),a=A(n)}else t=A(e),a=1;return[t,a]}function I(e,t,a){return e*((1-e)*(t+(3-a-t)*e)+e*e)}var M=function e(){Object(o.a)(this,e),this.fDarksSlope=1,this.fDarksExtraSlope=1,this.fLightsSlope=1,this.fLightsExtraSlope=1,this.fShadowsSlope=1,this.fShadowsExtraSlope=1,this.fHighlightsSlope=1,this.fHighlightsExtraSlope=1,this.fMidtonesSplitLinear=.21404114048223255,this.fMapDarks=3.2071068781954066,this.fMapMidtones=3.6719990266684714,this.fMapLights=1.5478403981490734},R=function e(){Object(o.a)(this,e),this.darks=0,this.lights=0,this.shadows=0,this.highlights=0,this.shadowSplit=25,this.midtoneSplit=50,this.highlightSplit=75};function _(e,t){t.darks=e[11],t.lights=e[12],t.shadows=e[13],t.highlights=e[14],t.shadowSplit=e[15],t.midtoneSplit=e[16],t.highlightSplit=e[17]}function D(e,t){var a=null;a=j(e.darks),t.fDarksSlope=a[0],t.fDarksExtraSlope=a[1],a=j(-e.lights),t.fLightsSlope=a[0],t.fLightsExtraSlope=a[1],a=j(e.shadows),t.fShadowsSlope=a[0],t.fShadowsExtraSlope=a[1],a=j(-e.highlights),t.fHighlightsSlope=a[0],t.fHighlightsExtraSlope=a[1];var n=function(e){var t,a=.01*e.shadowSplit,n=.01*e.midtoneSplit,r=.01*e.highlightSplit;n<a&&(t=n,n=a,a=t),r<n&&(t=n,n=r,r=t,n<a&&(t=n,n=a,a=t)),r-a<=0&&(a=n-.1,r=n+.1),n=(n-a)/(r-a);var i=Math.min(a,.1),o=.8/(Math.max(r,.9)-i);return(r=.1+(r-i)*o)-(a=.1+(a-i)*o)<.2&&(r=(a=.6*(a-.1)/(.8-(r-a))+.1)+.2),n=a+n*(r-a),n=Math.max(n,r-.1),[a,n=Math.min(n,a+.1),r]}(e);t.fMidtonesSplitLinear=U(n[1]);var r=t.fMidtonesSplitLinear,i=.5;t.fMapMidtones=i*(1-r)/(r*(1-i));var o=U(n[0]),s=U(n[2]);r=o/t.fMidtonesSplitLinear,i=.5,t.fMapDarks=i*(1-r)/(r*(1-i)),r=(s-t.fMidtonesSplitLinear)/(1-t.fMidtonesSplitLinear),i=.5,t.fMapLights=i*(1-r)/(r*(1-i))}function L(e,t){var a=t.fMidtonesSplitLinear,n=0;return e<a?(e/=a,e=I(e=(n=t.fMapDarks*e)/(1+n-e),t.fShadowsSlope,1),e=(n=(e=I(e,t.fShadowsExtraSlope,1))/t.fMapDarks)/(1+n-e),e*=a):(e=(e-a)/(1-a),e=I(e=(n=t.fMapLights*e)/(1+n-e),1,t.fHighlightsSlope),e=(e=(n=(e=I(e,1,t.fHighlightsExtraSlope))/t.fMapLights)/(1+n-e))*(1-a)+a),e=I(e=(n=t.fMapMidtones*e)/(1+n-e),t.fDarksSlope,t.fLightsSlope),e=(n=(e=I(e,t.fDarksExtraSlope,t.fLightsExtraSlope))/t.fMapMidtones)/(1+n-e)}var N=function e(){Object(o.a)(this,e),this.contrast=0,this.contrastKey=0,this.toneValues=new M};function V(e){var t,a=[0,.10433,.25961,.40389,.52069,.61436,.69035,.75289,.80486,.84825,.88453,.91478,.93986,.96042,.97702,.99009,1],n=new Array(17);for(t=0;t<17;t++)n[t]=T(a[t],e.contrast,Math.log(.5)/Math.log(e.contrastKey)),n[t]=L(n[t],e.toneValues);var r=function(e){var t,a,n,r,i,o=[];t=e[0],a=e[1],n=e[2],o[0]=.5*(5*t-4*a+n),o[1]=.5*(4*a-t-n),o[2]=.5*(t-4*a+5*n),r=o[1],i=o[2];for(var s=1;s<8;s++){var l=2*s,c=.5*(5*(t=e[l])-4*(a=e[l+1])+(n=e[l+2])),u=.5*(4*a-t-n),d=.5*(t-4*a+5*n);o.push(d),o[o.length-3]=(c+2*r)/3,o[o.length-2]=(u+i)/2,r=u,i=d}return o[0]=e[0]-(o[1]-e[0]),o}(n),i=new Float32Array(24);for(t=0;t<8;t++){var o=r[t],s=r[t+1],l=r[t+2];i[3*t]=.5*(o+s),i[3*t+1]=s-o,i[3*t+2]=.5*(o-2*s+l)}return i}function U(e){return e<=.040449936?e*(1/12.92):(e+.055)*Math.pow(1/1.055,2.4)}function F(e,t,a,n){var r=new Array(3),i=[.2880859375,.7119140625,0];e<0&&(e+=360),e>=360&&(e-=360);var o=0,s=0,l=0,c=0;e<60?(o=e/60,s=0,l=1,c=2):e<120?(o=(120-e)/60,s=1,l=0,c=2):e<180?(o=(e-120)/60,s=1,l=2,c=0):e<240?(o=(240-e)/60,s=2,l=1,c=0):e<300?(o=(e-240)/60,s=2,l=0,c=1):(o=(360-e)/60,s=0,l=2,c=1);var u=a*(2.5-n)*t,d=1-u*(i[s]+o*i[l]);return d=Math.min(Math.max(n,d),2.5),d=Math.min(Math.max(n-u,d),2.5-u),r[s]=d+u,r[l]=d+u*o,r[c]=d,r}function B(e,t,a,n,r){var i=new Array(7),o=null;return i[0]=function(e){var t=.5-.4*e;return.5*(1-(t=U(t)))/(.5*t)}(a/100),o=F(e,t/100,1,.05),i[1]=o[0],i[2]=o[1],i[3]=o[2],o=F(n,r/100,-1,.2),i[4]=3-o[0]-i[1],i[5]=3-o[1]-i[2],i[6]=3-o[2]-i[3],i}var H=a(5),z=a(108),G=new Map([["add-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSamplers[2];\nuniform float uScales[2];\n\nvoid main()\n{\n    gl_FragColor = vec4( uScales[0] * texture2D( uSamplers[0], vTexCoord ).xyz + uScales[1] * texture2D( uSamplers[1], vTexCoord ).xyz, 1.0 );\n}\n"],["blit-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    gl_FragColor = texture2D( uSampler, vec2( vTexCoord.s, vTexCoord.t ) );\n}\n"],["blitscale-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uScale;\n\nvoid main()\n{\n    gl_FragColor = uScale * abs( texture2D( uSampler, vec2( vTexCoord.s, vTexCoord.t ) ) );\n}\n"],["blitx-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    gl_FragColor = vec4( vec3( texture2D( uSampler, vec2( vTexCoord.s, vTexCoord.t ) ).x ), 1.0 );\n}\n"],["deltamask-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSamplers[2]; // 0: original, 1: compressed\nuniform float uDiffMid;\n\n#define ToneMapLimitShadowGain 1\n\nvoid main()\n{\n    float src = texture2D( uSamplers[0], vTexCoord ).x;\n    float dst = texture2D( uSamplers[1], vTexCoord ).x + uDiffMid;\n#if ToneMapLimitShadowGain\n    float diff = min( dst - src, 4.0 );\n#else\n    float diff = dst - src;\n#endif\n    gl_FragColor = vec4( vec3( diff ), 1.0 );\n}\n"],["gaussian-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D uSampler;\nvarying vec2 vTexCoords[5];\n\nvoid main()\n{\n    gl_FragColor =\n        vec4(\n        0.00456569 * (texture2D( uSampler, vTexCoords[0] ).xyz + texture2D( uSampler, vTexCoords[4] ).xyz) +\n        0.29596257 * (texture2D( uSampler, vTexCoords[1] ).xyz + texture2D( uSampler, vTexCoords[3] ).xyz) +\n        0.39894347 * texture2D( uSampler, vTexCoords[2] ).xyz,\n        1.0 );\n}\n"],["gaussian-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoords[5];\n\nuniform mat3 uPositionTransform;\nuniform vec2 uTextureUnit;\n\nvoid main()\n{\n    // Hardcoded: gaussian weights with sigma = 1.00 sampled at [-4,4], see dng_resample_gaussian\n    // Linear filtering taken advantage of to reduce sample count\n    // kernel.py 4 1.00\n\n    vTexCoords[0] = aTexCoord + (-3.02931223 * uTextureUnit);\n    vTexCoords[1] = aTexCoord + (-1.18242552 * uTextureUnit);\n    vTexCoords[2] = aTexCoord;\n    vTexCoords[3] = aTexCoord + (1.18242552 * uTextureUnit);\n    vTexCoords[4] = aTexCoord + (3.02931223 * uTextureUnit);\n\n    vec3 pos = uPositionTransform * vec3( aPosition, 1.0 );\n    gl_Position = vec4( pos.x, pos.y, 0.0, 1.0 );\n}\n"],["gaussianbigsigma-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D uSampler;\nvarying vec2 vTexCoords[15];\n\nvoid main()\n{\n    // Hardcoded: gaussian weights with sigma = 3.50 sampled at [-14,14], see dng_resample_gaussian\n    // Linear filtering taken advantage of to reduce sample count\n    // kernel.py 14 3.50\n\n    gl_FragColor =      \n        vec4(\n        0.00015335 * (texture2D( uSampler, vTexCoords[0] ).xyz + texture2D( uSampler, vTexCoords[14] ).xyz) +\n        0.00113588 * (texture2D( uSampler, vTexCoords[1] ).xyz + texture2D( uSampler, vTexCoords[13] ).xyz) +\n        0.00610264 * (texture2D( uSampler, vTexCoords[2] ).xyz + texture2D( uSampler, vTexCoords[12] ).xyz) +\n        0.02378969 * (texture2D( uSampler, vTexCoords[3] ).xyz + texture2D( uSampler, vTexCoords[11] ).xyz) +\n        0.06731104 * (texture2D( uSampler, vTexCoords[4] ).xyz + texture2D( uSampler, vTexCoords[10] ).xyz) +\n        0.13826867 * (texture2D( uSampler, vTexCoords[5] ).xyz + texture2D( uSampler, vTexCoords[9] ).xyz) +\n        0.20624514 * (texture2D( uSampler, vTexCoords[6] ).xyz + texture2D( uSampler, vTexCoords[8] ).xyz) +\n        0.11398719 * texture2D( uSampler, vTexCoords[7] ).xyz,\n        1.0 );\n}\n"],["gaussianbigsigma-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoords[15];\n\nuniform mat3 uPositionTransform;\nuniform vec2 uTextureUnit;\n\nvoid main()\n{\n    // Hardcoded: gaussian weights with sigma = 3.50 sampled at [-14,14], see dng_resample_gaussian\n    // Linear filtering taken advantage of to reduce sample count\n    // kernel.py 14 3.50\n\n    vTexCoords[0] = aTexCoord + (-13.24935770 * uTextureUnit);\n    vTexCoords[1] = aTexCoord + (-11.28114775 * uTextureUnit);\n    vTexCoords[2] = aTexCoord + (-9.31528835 * uTextureUnit);\n    vTexCoords[3] = aTexCoord + (-7.35154728 * uTextureUnit);\n    vTexCoords[4] = aTexCoord + (-5.38960340 * uTextureUnit);\n    vTexCoords[5] = aTexCoord + (-3.42905340 * uTextureUnit);\n    vTexCoords[6] = aTexCoord + (-1.46942595 * uTextureUnit);\n    vTexCoords[7] = aTexCoord;\n    vTexCoords[8] = aTexCoord + (1.46942595 * uTextureUnit);\n    vTexCoords[9] = aTexCoord + (3.42905340 * uTextureUnit);\n    vTexCoords[10] = aTexCoord + (5.38960340 * uTextureUnit);\n    vTexCoords[11] = aTexCoord + (7.35154728 * uTextureUnit);\n    vTexCoords[12] = aTexCoord + (9.31528835 * uTextureUnit);\n    vTexCoords[13] = aTexCoord + (11.28114775 * uTextureUnit);\n    vTexCoords[14] = aTexCoord + (13.24935770 * uTextureUnit);\n\n    vec3 pos = uPositionTransform * vec3( aPosition, 1.0 );\n    gl_Position = vec4( pos.x, pos.y, 0.0, 1.0 );\n}\n\n"],["greylog2-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvec3 evalUndoRenderCurveGrey(vec3 col)\n{\n    vec2 fMinMax;\n    vec2 nMinMax;\n    \n    float eps = 0.00001;\n    \n    \n    fMinMax.x = min(min(col.r,col.g),col.b);\n    fMinMax.y = max(max(col.r,col.g),col.b);\n    \n    vec2 t = pow(fMinMax,vec2(3.14453125));\n    \n    nMinMax = pow(fMinMax,vec2(0.8125))*0.3828125*(1.0-t) + (1.0-pow(1.0-fMinMax,vec2(0.69140625)))*t;\n\n    fMinMax.y = (nMinMax.y-nMinMax.x)/(fMinMax.y-fMinMax.x+eps);\n    \n    return (col-fMinMax.x)*fMinMax.y + nMinMax.x;\n}\n\nvoid main()\n{\n    vec3 col = clamp( texture2D( uSampler, vec2( vTexCoord.s, vTexCoord.t ) ).xyz, 0.0, 1.0 );\n    col = mix( col / 12.92, pow( (col + 0.055)/1.055, vec3( 2.4 ) ), step( 0.04045, col ) );\n\n    const float eps = 1.0/255.0;\n\n    // RGB linear -> Prophoto\n    const mat3 rgb2proPhotoMatrix = mat3(0.52932378745827813, 0.098426540365603984, 0.016845769297481432,\n                                     0.33005506400369466, 0.87350872697710469, 0.11769549131351224,\n                                     0.14064019169871309, 0.028111560975330636, 0.86547398998538982);\n    col = rgb2proPhotoMatrix * col;\n    \n    col = evalUndoRenderCurveGrey(col);\n    \n    /*\n    // Undo render curve\n    vec2 minmax0 = vec2( min( min( col.r, col.g ), col.b ), max( max( col.r, col.g ), col.b ) );\n    vec2 minmax1 = vec2( texture2D( uUndoRenderCurveSampler, vec2( minmax0.x, 0.0 ) ).x, texture2D( uUndoRenderCurveSampler, vec2( minmax0.y, 0.0 ) ).x );\n    col = ((minmax1.y - minmax1.x) * (col - minmax0.x) / max( (minmax0.y - minmax0.x), eps ) + minmax1.x);\n    */\n\n    // !!! Ignore white balance for now !!!\n\n    // To grey\n    float lum = max( dot( col, vec3( 0.30, 0.59, 0.11 ) ), 0.0 );\n\n    const float kMaxFlareLinear_real64 = 0.000244140625;    // ~ 2^-12\n\n    gl_FragColor = vec4( vec3( log2( lum + kMaxFlareLinear_real64 ) ), 1.0 );\n}\n"],["lin2srgb-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    vec3 cl = clamp( texture2D( uSampler, vec2( vTexCoord.s, vTexCoord.t ) ).xyz, 0.0, 1.0 );\n    gl_FragColor = vec4( mix( 12.92 * cl, 1.055 * pow( cl, vec3( 0.41666 ) ) - 0.055, step( 0.0031308, cl ) ), 1.0 );\n}\n"],["llf-fs",'\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSamplers[3]; // 0: gaussian level, 1: laplacian level, 2: pingpong result from last render\nuniform float reference;        // Value in log space at which image was tone mapped\nuniform float inv_ds;           // Inverse of difference in stops between samples, "stops per sample"\n\nvoid main()\n{\n    float g = texture2D( uSamplers[0], vTexCoord ).x;   // Its grey => just care about one of the 3 identical channels\n\n    // Triangle function blending between samples: __//\\__\n    float line0 = inv_ds * (g - reference) + 1.0;   // for da/ds: da always 1\n    float line1 = inv_ds * (reference - g) + 1.0;   // for da/ds: da always 1\n    float alpha = max( min( line0, line1 ), 0.0 );\n\n    // No programmable blending... result ping ponged\n    float result = texture2D( uSamplers[2], vTexCoord ).x;\n\n    gl_FragColor = vec4( vec3( alpha * texture2D( uSamplers[1], vTexCoord ).x + result ), 1.0 );\n}\n'],["log2lin-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    const float kMaxFlareLinear_real64 = 0.000244140625;    // 2^-12\n    gl_FragColor = vec4( exp2( texture2D( uSampler, vTexCoord ).xyz ) - kMaxFlareLinear_real64, 1.0 );\n}\n"],["lum-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    vec3 col = texture2D( uSampler, vTexCoord ).xyz;\n    const vec3 weights = vec3( 0.25, 0.5, 0.25 );\n    gl_FragColor = vec4( vec3( dot( col, weights ) ), 1.0 );\n}\n"],["minmaxmean-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoords[4];\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    vec3 samples[4];\n    samples[0] = texture2D( uSampler, vTexCoords[0] ).xyz;\n    samples[1] = texture2D( uSampler, vTexCoords[1] ).xyz;\n    samples[2] = texture2D( uSampler, vTexCoords[2] ).xyz;\n    samples[3] = texture2D( uSampler, vTexCoords[3] ).xyz;\n\n    float minVal = min( min( min( samples[0].x, samples[1].x ), samples[2].x ), samples[3].x );\n    float maxVal = max( max( max( samples[0].y, samples[1].y ), samples[2].y ), samples[3].y );\n    float meanVal = 0.25 * (samples[0].z + samples[1].z + samples[2].z + samples[3].z);\n    gl_FragColor = vec4( minVal, maxVal, meanVal, 0.0 );\n}\n"],["minmaxmean-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoords[4];\n\nuniform mat3 uPositionTransform;\nuniform vec2 uTextureUnit;\n\nvoid main()\n{\n    vTexCoords[0] = aTexCoord + vec2( uTextureUnit.x, uTextureUnit.y );\n    vTexCoords[1] = aTexCoord + vec2( uTextureUnit.x, -uTextureUnit.y );\n    vTexCoords[2] = aTexCoord + vec2( -uTextureUnit.x, -uTextureUnit.y );\n    vTexCoords[3] = aTexCoord + vec2( -uTextureUnit.x, uTextureUnit.y );\n\n    vec3 pos = uPositionTransform * vec3( aPosition, 1.0 );\n    gl_Position = vec4( pos.x, pos.y, 0.0, 1.0 );\n}\n"],["moments-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoords[4];\n\nuniform sampler2D uSampler;\nuniform float uMean;\n\nvoid main()\n{\n    float samples[4];\n    samples[0] = texture2D( uSampler, vTexCoords[0] ).x;\n    samples[1] = texture2D( uSampler, vTexCoords[1] ).x;\n    samples[2] = texture2D( uSampler, vTexCoords[2] ).x;\n    samples[3] = texture2D( uSampler, vTexCoords[3] ).x;\n\n    vec4 diff = vec4( samples[0], samples[1], samples[2], samples[3] ) - vec4( uMean );\n    vec4 diff2 = diff * diff;\n    vec4 diff3 = diff2 * diff;            \n    float variance = 0.25*dot( diff2, vec4( 1.0 ) );\n    float moment3 = 0.25*dot( diff3, vec4( 1.0 ) );\n    gl_FragColor = vec4( variance, moment3, 0.0, 0.0 );\n}\n"],["moments-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoords[4];\n\nuniform mat3 uPositionTransform;\nuniform vec2 uTextureUnit;\n\nvoid main()\n{\n    vTexCoords[0] = aTexCoord + vec2( uTextureUnit.x, uTextureUnit.y );\n    vTexCoords[1] = aTexCoord + vec2( uTextureUnit.x, -uTextureUnit.y );\n    vTexCoords[2] = aTexCoord + vec2( -uTextureUnit.x, -uTextureUnit.y );\n    vTexCoords[3] = aTexCoord + vec2( -uTextureUnit.x, uTextureUnit.y );\n\n    vec3 pos = uPositionTransform * vec3( aPosition, 1.0 );\n    gl_Position = vec4( pos.x, pos.y, 0.0, 1.0 );\n}\n"],["reductionsum-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoords[4];\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    vec4 samples[4];\n    samples[0] = texture2D( uSampler, vTexCoords[0] );\n    samples[1] = texture2D( uSampler, vTexCoords[1] );\n    samples[2] = texture2D( uSampler, vTexCoords[2] );\n    samples[3] = texture2D( uSampler, vTexCoords[3] );\n    float val0 = 0.25*(samples[0].x + samples[1].x + samples[2].x + samples[3].x);\n    float val1 = 0.25*(samples[0].y + samples[1].y + samples[2].y + samples[3].y);\n    gl_FragColor = vec4( val0, val1, 0.0, 0.0 );\n}\n"],["reductionsum-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoords[4];\n\nuniform mat3 uPositionTransform;\nuniform vec2 uTextureUnit;\n\nvoid main()\n{\n    vTexCoords[0] = aTexCoord + vec2( uTextureUnit.x, uTextureUnit.y );\n    vTexCoords[1] = aTexCoord + vec2( uTextureUnit.x, -uTextureUnit.y );\n    vTexCoords[2] = aTexCoord + vec2( -uTextureUnit.x, -uTextureUnit.y );\n    vTexCoords[3] = aTexCoord + vec2( -uTextureUnit.x, uTextureUnit.y );\n\n    vec3 pos = uPositionTransform * vec3( aPosition, 1.0 );\n    gl_Position = vec4( pos.x, pos.y, 0.0, 1.0 );\n}\n"],["shader-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n}\n"],["shaderTemplate","\n\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D lcSampler;\nuniform sampler2D toneMapMask;\n\nuniform float exposure;\nuniform float exposureGain;\nuniform vec3 undoCurve[8];\nuniform vec3 renderCurve[8];\n\nuniform float blacks;\nuniform float whites;\n\n//***uniforms\n\nuniform float uGlobalAmtHighlights;\nuniform float uGlobalAmtShadows;\nuniform float uGlobalAmtClarity;\n\nuniform float uToneMapMid;\n\nuniform vec4 lineLumWeightScale;\nuniform vec4 lineLumWeightOffset;\n\nuniform float uCompressionScale;\nuniform float uCompressionOffset;\n\nuniform float uHighlightPinAmount;\n\nuniform float uToneMapMaxAbsOffset;\n\n#define ToneMap 1\n\nvec2 EndpointPinMask (vec2 x)\n{\n\n    x = 1.0 - x;\n\n    x *= x;     // 2\n    x *= x;     // 4\n    x *= x;     // 8\n\n    x = 1.0 - x;\n\n    return x;\n\n}\n\nconst vec3 kGrayWeights = vec3 (0.30, 0.59, 0.11);\n\nvec3 DoToneMap( vec3 rgb, vec2 pt )\n{       \n    // const kMaxFlareLinear_real64 = 0.000244140625;\n    // const flareLinear = kMaxFlareLinear_real64;\n    // const flareLog = Math.log2( flareLinear );\n    // const eps = flareLinear / 128.0;\n\n    const float flareLog = -12.0;\n    const float eps = 0.00000190734;\n    \n    vec2 absGlobalAmtHS = abs(vec2(uGlobalAmtHighlights,uGlobalAmtShadows));\n    \n    float mask = texture2D (toneMapMask, pt).x;\n    float srcGrayLinear = dot (rgb, kGrayWeights);\n    float srcGrayLog = log2 (srcGrayLinear);\n    \n    vec4 lineLumWeightResult = lineLumWeightScale * srcGrayLog + lineLumWeightOffset;\n    \n    float partSwitch = step(srcGrayLog,uToneMapMid);\n    \n    float baseCompressed = mix(lineLumWeightResult.y, lineLumWeightResult.x, partSwitch);\n    \n    float localContrastSignal = srcGrayLog + mask - baseCompressed;\n    localContrastSignal *= max(uGlobalAmtClarity, 0.0);\n    localContrastSignal *= clamp(uCompressionScale * 0.5*(-uGlobalAmtHighlights + uGlobalAmtShadows) + uCompressionOffset, 1.0, 2.0);\n    \n    vec2 localContrastSignal2 = vec2(max(localContrastSignal, 0.0),min(localContrastSignal, 0.0));\n    \n    vec2 lumWeight;\n    lumWeight.x = mix(lineLumWeightResult.w, lineLumWeightResult.z, partSwitch);\n                            \n    lumWeight.x = clamp(lumWeight.x,0.0,1.0);\n    lumWeight.y = 1.0-lumWeight.x;\n    \n    vec2 claritySHPinMask = EndpointPinMask(lumWeight);\n    \n    vec2 hsPinMask;\n    hsPinMask.y =  mix(0.5 + 0.5*max(1.0-sign(uGlobalAmtShadows),0.0), 1.0, claritySHPinMask.x);\n    hsPinMask.x = mix (1.0, 0.5, (1.0-claritySHPinMask.y)*max(-sign(uGlobalAmtHighlights),0.0));\n    hsPinMask.x = mix(1.0, hsPinMask.x, max(uHighlightPinAmount,0.0));\n    \n    float baseOffset = uToneMapMaxAbsOffset * (uGlobalAmtHighlights + uGlobalAmtShadows)/ max(max(absGlobalAmtHS.x, absGlobalAmtHS.y), eps);\n    vec2 offsetHS = lumWeight * absGlobalAmtHS * baseOffset;\n    vec2 deltaHS = vec2(-uGlobalAmtHighlights, uGlobalAmtShadows);\n    deltaHS = clamp(deltaHS,-1.0,1.0);\n    deltaHS *= vec2(min(mask, 0.0),max(mask, 0.0));\n    deltaHS += offsetHS;\n    \n    float delta = dot(deltaHS,hsPinMask);\n    delta += dot(localContrastSignal2,claritySHPinMask);\n    \n    float startpoint;\n    float t;\n    \n    partSwitch = sign(delta);\n    float zeroSwitch = 1.0 - abs(partSwitch);\n    partSwitch = 1.0-max(partSwitch,0.0);\n    \n    float flare = partSwitch*flareLog;\n    startpoint = flare - (delta + delta);\n    \n    float t1 = step(startpoint,srcGrayLog);\n    float t2 = step(srcGrayLog,startpoint);\n    \n    t = clamp((srcGrayLog - startpoint) / (flare - startpoint + zeroSwitch),0.0,1.0);\n    t *= t * (1.0-mix(t2,t1,partSwitch));\n    delta = mix (delta, 0.0, t);\n    \n    rgb *= exp2 (srcGrayLog + delta) / max(srcGrayLinear, eps);\n\n    return max (rgb, 0.0);\n}\n\nvec3 sRGBGamma(in vec3 col)\n{\n        vec3 sV = step(col,vec3(0.0031308));\n        return mix((1.055 * pow (col, vec3(1.0/2.4)) - 0.055),(col*12.92),sV);\n}\n\nvec3 invSRGBGamma(in vec3 col)\n{\n    vec3 sV = step(col,vec3(0.040449936));\n    return mix(pow ((col + 0.055)/1.055, vec3(2.4)),(col/12.92),sV);\n}\n\nfloat calcProtection(in float hue, in float sat)\n{\n    float val = mod(hue + 1.0,6.0);\n    float minSide = min(val,1.0);\n    float maxSide = clamp(1.0 - (val - 1.5) * 4.0,0.0,1.0);\n    val = min(minSide, maxSide);\n    return val * (1.0 - sat*sat);\n}\n\nvec3 rgb2HSL(in vec3 rgbCol)\n{\n    vec3 colFactors;\n    vec3 outVal;\n    \n    outVal.y = min(min(rgbCol.r, rgbCol.g), rgbCol.b);\n    outVal.z = max(max(rgbCol.r, rgbCol.g), rgbCol.b);\n    \n    float delta = outVal.z - outVal.y;\n    \n    float deltaFactor = sign(delta);\n    \n    delta += 1.0 - deltaFactor;\n\n    colFactors.xyz = 1.0 - sign(outVal.z - rgbCol.rgb);\n    colFactors.yzx *= 1.0 - colFactors.xyz;\n\n    outVal.x = ((rgbCol.g - rgbCol.b) / delta)*colFactors.x;\n    outVal.x += (2.0+(rgbCol.b - rgbCol.r) / delta)*colFactors.y;\n    outVal.x += (4.0+(rgbCol.r - rgbCol.g) / delta)*colFactors.z;\n    \n    outVal.x *= deltaFactor;\n    outVal.x = mod(outVal.x+6.0,6.0);\n    \n    return outVal;\n}\n\nvec3 hsl2RGB(in vec3 hslCol)\n{\n    float dH = floor(hslCol.x);\n    float h = fract(hslCol.x);\n\n    if(mod(dH,2.0) > 0.5)\n        h = 1.0 - h;\n\n    vec3 cCol;\n    vec3 outCol;\n    \n    cCol.x = hslCol.y;\n    cCol.y = hslCol.z;\n    cCol.z = (cCol.y - cCol.x) * h + cCol.x;\n    \n    outCol = mix(cCol.yzx,cCol.zyx,float(dH == 1.0));\n    outCol = mix(outCol,cCol.xyz, float(dH == 2.0));\n    outCol = mix(outCol,cCol.xzy, float(dH == 3.0));\n    outCol = mix(outCol,cCol.zxy, float(dH == 4.0));\n    outCol = mix(outCol,cCol.yxz, float(dH == 5.0));\n    \n    return outCol;\n}\nfloat spline6Value(in vec3 curve[6], in float t)\n{\n    float checkT;\n    vec3 tVec;\n    float tMask;\n    float outVal;\n    \n    t *= 6.0;\n    checkT = t;\n    t = fract(t);\n    tVec.x = 1.0;\n    tVec.y = t;\n    tVec.z = t*t;\n    \n    tMask = step(checkT,1.0); outVal = dot(curve[0],tVec)*tMask;\n    tMask = step(checkT,2.0)*step(1.0,checkT); outVal += dot(curve[1],tVec)*tMask;\n    tMask = step(checkT,3.0)*step(2.0,checkT); outVal += dot(curve[2],tVec)*tMask;\n    tMask = step(checkT,4.0)*step(3.0,checkT); outVal += dot(curve[3],tVec)*tMask;\n    tMask = step(checkT,5.0)*step(4.0,checkT); outVal += dot(curve[4],tVec)*tMask;\n    tMask = step(5.0,checkT); outVal += dot(curve[5],tVec)*tMask;\n    \n    return outVal;\n}\n\nfloat spline8Value(in vec3 curve[8], in float t)\n{\n    float checkT; vec3 tVec; float tMask; float outVal;\n    \n        t *= 8.0;\n    checkT = t;\n    t = fract(t);\n    tVec.x = 1.0;\n    tVec.y = t;\n    tVec.z = t*t;\n    \n    tMask = step(checkT,1.0);\n    outVal = dot(curve[0],tVec)*tMask;\n\n    tMask = step(checkT,2.0)*step(1.0,checkT);  outVal += dot(curve[1],tVec)*tMask;\n    tMask = step(checkT,3.0)*step(2.0,checkT);  outVal += dot(curve[2],tVec)*tMask;\n    tMask = step(checkT,4.0)*step(3.0,checkT);  outVal += dot(curve[3],tVec)*tMask;\n    tMask = step(checkT,5.0)*step(4.0,checkT);  outVal += dot(curve[4],tVec)*tMask;\n    tMask = step(checkT,6.0)*step(5.0,checkT);  outVal += dot(curve[5],tVec)*tMask;\n    tMask = step(checkT,7.0)*step(6.0,checkT);  outVal += dot(curve[6],tVec)*tMask;\n    tMask = step(7.0,checkT);                   outVal += dot(curve[7],tVec)*tMask;\n    \n    return outVal;\n}\n\nvec3 evalUndoRenderCurve(vec3 col)\n{\n    vec2 fMinMax;\n    vec2 nMinMax;\n    \n    float eps = 0.00001;\n    \n    \n    fMinMax.x = min(min(col.r,col.g),col.b);\n    fMinMax.y = max(max(col.r,col.g),col.b);\n    \n    vec2 t = pow(fMinMax,vec2(3.14453125));\n    \n    nMinMax = pow(fMinMax,vec2(0.8125))*0.3828125*(1.0-t) + (1.0-pow(1.0-fMinMax,vec2(0.69140625)))*t;\n\n    fMinMax.y = (nMinMax.y-nMinMax.x)/(fMinMax.y-fMinMax.x+eps);\n    \n    return (col-fMinMax.x)*fMinMax.y + nMinMax.x;\n}\n\nvec3 evalToneCurve(vec3 curve[8],vec3 col)\n{\n    float fMin,fMax;\n    float nMin,nMax;\n    float eps = 0.00001;\n    \n    fMin = min(min(col.r,col.g),col.b);\n    fMax = max(max(col.r,col.g),col.b);\n    \n    nMin = spline8Value(curve,fMin);\n    nMax = spline8Value(curve,fMax);\n    \n    fMax = (nMax-nMin)/(fMax-fMin+eps);\n    \n    return (col-fMin)*fMax + nMin;\n}\n\nfloat calcPosBlacks(float x,float blacks)  // scale\n{\n    float pVal = 1.0/(1.0+blacks*0.18);\n    return (1.0 - x*x)*pow(x,pVal) + x*x*x;\n}\n\nfloat calcNegWhites(float x,float whites) // scale\n{\n    float smallX = x;\n    float pVal = 1.0/(1.0-whites*0.72);\n    return smallX*pow(x,pVal) + (1.0-smallX)*x;\n}\n\nvec2 calcPosWhites(vec2 x,float whites)\n{\n    float val = 1.0 - (0.8*whites);\n    //(x/(1.0+x))*(1.0+x/(val*val))\n    //x+2.0*whites*x*x\n\n    return min((x/(1.0+x))*(1.0+x/(val*val)), vec2(1.0,1.0));\n}\n\nvec3 calcNegBlacks(vec3 x,float blacks)\n{\n    float n = 0.04*blacks*blacks;\n    \n    float m = max(min(0.05,n),0.000001);\n    float a = 1.0/(4.0*m*(1.0-n));\n    vec3 b = (n-m)-x;\n    b = b*b;\n\n    vec3 roundY = a*b;\n    vec3 straightY = 1.0/(1.0-n)*(x-n);\n\n    float sect = (n-m)+((1.0/(1.0-n))/(2.0*a));\n    \n    //step(edge,x) -> x < edge ? 0.0 : 1.0\n    \n    vec3 zeroFactor = step(vec3(n-m,n-m,n-m),x);\n    vec3 straightFactor = step(sect,x);\n\n    return mix(roundY,straightY,straightFactor)*zeroFactor;\n\n    //return max(vec3(0.0,0.0,0.0),straightY);\n}\n\n//***functions\n\nvoid main(void)\n{\n    vec2 fMinMax;\n    vec2 nMinMax;\n    vec2 endPin;\n    \n    float pinWeight;\n    float eps = 0.00001;\n    \n    const highp mat3 fromSRGBMatr = mat3(0.529285,0.098394,0.016823,\n                                    0.330046,0.873493,0.117671,\n                                    0.140669,0.028113,0.865506);\n    \n    const highp mat3 toSRGBMatr = mat3(2.034302,-0.228882,-0.00842285,\n                                    -0.727295,1.23168945,-0.15332,\n                                    -0.307007,-0.00280762,1.16174316);\n\n    highp vec4 col = texture2D(uSampler, vTextureCoord.st);\n    highp vec3 rgbCol = col.rgb;\n    float grayVal = dot(rgbCol,vec3(0.25,0.5,0.25)); \n    \n    rgbCol = clamp(rgbCol,0.0001,0.999);\n    \n    rgbCol = invSRGBGamma(rgbCol);\n    rgbCol = fromSRGBMatr * rgbCol;\n\n    //rgbCol = evalToneCurve(undoCurve,rgbCol);\n    rgbCol = evalUndoRenderCurve(rgbCol);\n    \n    //***stagesPreExposure\n    \n    float negWhites = max(-whites,0.0);\n    float posWhites = max(whites,0.0);\n    float negBlacks = max(-blacks,0.0);\n    float posBlacks = max(blacks,0.0);\n\n    rgbCol *= exposureGain;\n    \n\n    pinWeight = max(exposure,0.0)/8.488339269336635;\n    pinWeight *= pinWeight;\n    pinWeight *= pinWeight;\n    fMinMax.x = min(min(rgbCol.r,rgbCol.g),rgbCol.b);\n    fMinMax.y = max(max(rgbCol.r,rgbCol.g),rgbCol.b);\n    \n    nMinMax = fMinMax;\n\n    nMinMax = calcPosWhites(nMinMax,posWhites);\n    \n    nMinMax = min(nMinMax,1.0);\n    nMinMax = pow(nMinMax,vec2(1.0/2.2));\n    endPin = pow(1.0-nMinMax,vec2(exposure));\n    nMinMax = 1.0-endPin;\n    endPin *= endPin;\n    endPin = 1.0-endPin*pinWeight;\n    nMinMax *= endPin;\n    \n    nMinMax = pow(nMinMax,vec2(2.2));\n    fMinMax.y = (nMinMax.y-nMinMax.x)/(fMinMax.y-fMinMax.x+eps);\n    \n    rgbCol = (rgbCol-fMinMax.x)*fMinMax.y + nMinMax.x;\n    \n    float curLum = dot(rgbCol,vec3(0.25,0.5,0.25));\n    float newLum = calcNegWhites(curLum,negWhites);\n    float lumScale = newLum/(curLum+0.00000190734863);\n    rgbCol *= lumScale;\n\n    rgbCol = calcNegBlacks(rgbCol,negBlacks);\n\n    curLum = dot(rgbCol,vec3(0.25,0.5,0.25));\n    newLum = calcPosBlacks(curLum,posBlacks);\n    lumScale = newLum/(curLum+0.00000190734863);\n    rgbCol *= lumScale;\n    \n    //***stagesPreTone\n    \n    rgbCol = evalToneCurve(renderCurve,rgbCol);\n    \n    //***stagesPostTone\n    \n    rgbCol = toSRGBMatr * rgbCol;\n    col.rgb = sRGBGamma(rgbCol);\n    \n    gl_FragColor = col;\n}"],["srgb2lin-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\n\nvoid main()\n{\n    vec3 cs = clamp( texture2D( uSampler, vec2( vTexCoord.s, vTexCoord.t ) ).xyz, 0.0, 1.0 );\n    gl_FragColor = vec4( mix( cs / 12.92, pow( (cs + 0.055)/1.055, vec3( 2.4 ) ), step( 0.04045, cs ) ), 1.0 );\n}\n"],["standard-vs","\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying highp vec2 vTexCoord;\n\nuniform mat3 uPositionTransform;\n\nvoid main()\n{\n    vTexCoord = aTexCoord;\n    vec3 pos = uPositionTransform * vec3( aPosition, 1.0 );\n    gl_Position = vec4( pos.x, pos.y, 0.0, 1.0 );\n}\n"],["tonemap-fs","\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 minmax;\n\nvoid main()\n{\n    gl_FragColor = vec4( clamp( texture2D( uSampler, vTexCoord ).xyz, minmax.x, minmax.y ), 1.0 );\n}\n"]]);function W(e,t,a){var n,r=t,i=G.get(r);if(void 0===i&&(i=G.get(a),r=a),-1!==r.indexOf("-fs"))n=e.createShader(e.FRAGMENT_SHADER);else{if(-1===r.indexOf("-vs"))return null;n=e.createShader(e.VERTEX_SHADER)}return null==n||void 0===i?null:(e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:null)}function Z(e,t,a){switch(t){case e.FLOAT_VEC2:return[e.FLOAT,2*a];case e.FLOAT_VEC3:return[e.FLOAT,3*a];case e.FLOAT_VEC4:return[e.FLOAT,4*a];case e.INT_VEC2:return[e.INT,2*a];case e.INT_VEC3:return[e.INT,3*a];case e.INT_VEC4:return[e.INT,4*a];case e.FLOAT_MAT2:return[e.FLOAT,2*a*2];case e.FLOAT_MAT3:return[e.FLOAT,3*a*3];case e.FLOAT_MAT4:return[e.FLOAT,4*a*4];case e.INT:case e.FLOAT:case e.SAMPLER_2D:case e.SAMPLER_CUBE:return[t,a];default:return[e.FLOAT,0]}}var Y=function(){function e(t,a,n){if(Object(o.a)(this,e),this.glContext=t,this.program=null,this.attributes=null,this.uniforms=null,this.indexBuffer=null,this.filename=n,n in a){var r=a.get(n);void 0!==r&&(this.program=r)}else{var i=W(this.glContext,"".concat(n,"-fs"),""),s=W(this.glContext,"".concat(n,"-vs"),"standard-vs"),l=this.glContext.createProgram();null!==l&&null!=s&&null!=i&&(this.program=l,this.glContext.attachShader(this.program,s),this.glContext.attachShader(this.program,i),this.glContext.linkProgram(this.program),this.glContext.getProgramParameter(this.program,this.glContext.LINK_STATUS),this.glContext.deleteShader(i),this.glContext.deleteShader(s),a.set(n,this.program))}if(this.glContext.useProgram(this.program),this.attributes=new Map,null!==this.program){for(var c=this.glContext.getProgramParameter(this.program,this.glContext.ACTIVE_ATTRIBUTES),u=0;u<c;++u){var d=this.glContext.getActiveAttrib(this.program,u);if(null===d)return;var h=Z(this.glContext,d.type,d.size),f=this.glContext.getAttribLocation(this.program,d.name);if(this.glContext.enableVertexAttribArray(f),this.attributes.set(d.name,{location:f,buffer:null,type:h[0],size:h[1]}),"aPosition"===d.name){var p=this.attributes.get(d.name);if(void 0===p)return;p.buffer=this.glContext.createBuffer(),this.glContext.bindBuffer(this.glContext.ARRAY_BUFFER,p.buffer);this.glContext.bufferData(this.glContext.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.glContext.STATIC_DRAW)}else if("aTexCoord"===d.name){var m=this.attributes.get(d.name);if(void 0===m)return;m.buffer=this.glContext.createBuffer(),this.glContext.bindBuffer(this.glContext.ARRAY_BUFFER,m.buffer);this.glContext.bufferData(this.glContext.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),this.glContext.STATIC_DRAW)}}this.uniforms=new Map;for(var v=this.glContext.getProgramParameter(this.program,this.glContext.ACTIVE_UNIFORMS),g=0;g<v;++g){var b=this.glContext.getActiveUniform(this.program,g);if(null===b)return;var y=this.glContext.getUniformLocation(this.program,b.name);if(null===y)return;if(this.uniforms.set(b.name,{location:y,buffer:null,type:b.type,size:b.size,name:b.name}),"uPositionTransform"===b.name){var E=H.c.create(),w=this.uniforms.get(b.name);if(void 0===w)return;w.buffer=new Float32Array(E)}}this.indexBuffer=this.glContext.createBuffer(),this.glContext.bindBuffer(this.glContext.ELEMENT_ARRAY_BUFFER,this.indexBuffer);this.glContext.bufferData(this.glContext.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,3]),this.glContext.STATIC_DRAW)}}return Object(s.a)(e,[{key:"destroy",value:function(){if(this.glContext.deleteBuffer(this.indexBuffer),null!=this.attributes){var e,t=Object(z.a)(this.attributes);try{for(t.s();!(e=t.n()).done;){var a=e.value[1];null!=a&&this.glContext.deleteBuffer(a.buffer)}}catch(n){t.e(n)}finally{t.f()}}}},{key:"getUniform",value:function(e){if(null==this.uniforms)return null;var t=this.uniforms.get(e);return void 0===t?null:t}},{key:"render",value:function(e){var t=this.glContext.getParameter(this.glContext.CURRENT_PROGRAM);this.glContext.useProgram(this.program),this.updateProgram(e),this.glContext.bindBuffer(this.glContext.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.glContext.drawElements(this.glContext.TRIANGLE_STRIP,4,this.glContext.UNSIGNED_SHORT,0),this.glContext.useProgram(t)}},{key:"updateProgram",value:function(e){var t=this;if(void 0!==e&&(e.soso=2),null!=this.attributes){this.attributes.forEach((function(e){if(null!=t.attributes){var a=e;void 0!==a&&(t.glContext.bindBuffer(t.glContext.ARRAY_BUFFER,a.buffer),t.glContext.vertexAttribPointer(a.location,a.size,a.type,!1,0,0))}}));var a=[],n=0;if(null!=this.uniforms){this.uniforms.forEach((function(e){null!=t.uniforms&&a.push(e)}));for(var r=0,i=a;r<i.length;r++){var o=i[r];if(void 0===o)return;if(null==o.buffer)return;switch(o.type){case this.glContext.FLOAT:this.glContext.uniform1fv(o.location,o.buffer);break;case this.glContext.FLOAT_VEC2:this.glContext.uniform2fv(o.location,o.buffer);break;case this.glContext.FLOAT_VEC3:this.glContext.uniform3fv(o.location,o.buffer);break;case this.glContext.FLOAT_VEC4:this.glContext.uniform4fv(o.location,o.buffer);break;case this.glContext.INT:this.glContext.uniform1iv(o.location,o.buffer);break;case this.glContext.INT_VEC2:this.glContext.uniform2iv(o.location,o.buffer);break;case this.glContext.INT_VEC3:this.glContext.uniform3iv(o.location,o.buffer);break;case this.glContext.INT_VEC4:this.glContext.uniform4iv(o.location,o.buffer);break;case this.glContext.FLOAT_MAT2:this.glContext.uniformMatrix2fv(o.location,!1,o.buffer);break;case this.glContext.FLOAT_MAT3:this.glContext.uniformMatrix3fv(o.location,!1,o.buffer);break;case this.glContext.FLOAT_MAT4:this.glContext.uniformMatrix4fv(o.location,!1,o.buffer);break;case this.glContext.SAMPLER_2D:for(var s=Array.isArray(o.buffer)?o.buffer:[o.buffer],l=[],c=0;c<s.length;++c)this.glContext.activeTexture(this.glContext.TEXTURE0+n),this.glContext.bindTexture(this.glContext.TEXTURE_2D,s[c]),l.push(n++);this.glContext.uniform1iv(o.location,l)}}}}}}]),e}(),K=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e,n,r){var i;return Object(o.a)(this,a),(i=t.call(this,e,n,r?"gaussianbigsigma":"gaussian")).horizontal=!0,i}return Object(s.a)(a,[{key:"updateProgram",value:function(e){if(null!=this.uniforms&&void 0!==e){var t=this.uniforms.get("uTextureUnit");void 0!==t&&(t.buffer=this.horizontal?[1/e.width,0]:[0,1/e.height])}Object(l.a)(Object(c.a)(a.prototype),"updateProgram",this).call(this,e)}}]),a}(Y);function X(e,t,a,n,r){if(void 0===e.toneMappingShaders)return null;var i=r;"undefined"===typeof r&&void 0!==e.toneMappingShaders.gaussianShader&&(i=e.toneMappingShaders.gaussianShader),a=Math.round(a),n=Math.round(n),i.horizontal=!0;var o=se(e.gl);if(null==o)return null;ue(e.gl,i,H.c.create(),t,a,n,t.type,o),i.horizontal=!1;var s=se(e.gl);return null==s?null:(ue(e.gl,i,H.c.create(),o,o.width,o.height,t.type,s),oe(e.gl,o),s)}var q=function(){function e(t,a){Object(o.a)(this,e),this.context=t,this.levels=[a];var n=a.width,r=a.height;do{n=Math.max(n/2,1),r=Math.max(r/2,1);var i=Math.round(n),s=Math.round(r),l=X(this.context,this.levels[this.levels.length-1],i,s);null!=l&&this.levels.push(l)}while(1!==this.levels[this.levels.length-1].width||1!==this.levels[this.levels.length-1].height)}return Object(s.a)(e,[{key:"destroy",value:function(){for(var e in this.levels)oe(this.context.gl,this.levels[e])}}]),e}(),J=(new Float32Array([0,.00237489,.00496978,.00739292,.00952519,.01140722,.01313902,.01473082,.01622254,.01765395,.01901583,.02032755,.02159865,.02283053,.02402233,.02520346,.0263457,.02747726,.02858875,.02969016,.03076227,.03183356,.03289564,.03394681,.03497884,.0360099,.0370319,.03804284,.03904479,.04003675,.04102753,.04200945,.04298137,.043952,.04491387,.04586576,.04681623,.04775806,.0486999,.04963174,.05056202,.05148382,.05240397,.05331742,.05422749,.05513102,.05603102,.05693094,.05782266,.05871438,.05959611,.06047783,.06134955,.0622292,.06310088,.06397256,.06483425,.0656937,.06654761,.06740698,.06825098,.06910266,.06995191,.07079356,.0716252,.07246685,.07329849,.07413014,.07495912,.07578073,.07661232,.07743116,.07824554,.07906429,.07987585,.08069035,.08149898,.08230357,.08311211,.08391368,.08471525,.08551364,.08630517,.08709995,.0878915,.08867975,.08947127,.0902528,.09104433,.09182585,.09260738,.0933789,.09415683,.09493196,.09570348,.09647502,.09724654,.09801427,.09877575,.09954111,.10030873,.10107022,.1018217,.10258319,.10334061,.10409617,.10484765,.10559914,.10635063,.10709785,.10784361,.10859074,.10933219,.11007807,.11082509,.11157654,.11232252,.11307401,.1138255,.11457699,.11533378,.11608996,.11684145,.11760294,.11836442,.11912592,.1198874,.12064889,.12141538,.12218186,.12295336,.12371997,.12449148,.12526301,.12603454,.12681606,.12758759,.12836911,.12915064,.12993218,.1307137,.13150522,.13229232,.13307828,.1338698,.13466132,.13545857,.13625439,.1370517,.13785326,.13865484,.13945641,.14026797,.14107552,.14188111,.14269266,.14350423,.14432193,.14514354,.14595515,.14677675,.14760464,.14842996,.14926156,.15008959,.15092123,.15175289,.15259452,.15342958,.1542678,.15511611,.1559611,.15680946,.15765439,.15850604,.15936452,.16021621,.16107789,.16193959,.16280125,.16367294,.16454171,.1654163,.16628799,.16716687,.16804135,.16892031,.16981204,.17069376,.17158547,.17247722,.1733764,.17426816,.17516991,.17607929,.17698345,.1778852,.17879698,.17971648,.18063048,.18155007,.18247187,.18340158,.18432549,.18525729,.1861971,.18713894,.18808079,.18902262,.18996447,.19091631,.1918664,.19282827,.19379015,.19475204,.19571391,.19668424,.19765617,.19862808,.19960999,.20059192,.20157383,.20256576,.20355769,.20455834,.20555151,.20656112,.20756422,.2085751,.2095871,.21060909,.21163109,.21265309,.21368422,.21471626,.21574828,.2167903,.21783234,.21888372,.21993577,.22098784,.22204992,.223112,.22417407,.22524615,.22631821,.22739993,.22848204,.22957414,.230666,.23176816,.23286031,.23397246,.23507462,.23619671,.2373089,.2384311,.23956327,.24069546,.24182779,.24297006,.24411251,.2452645,.24641703,.24757929,.24874194,.24991423,.25108653,.25226888,.25345117,.25463405,.25582638,.25702873,.25824109,.25944418,.26066577,.26187897,.26311135,.26434374,.26557702,.26681945,.26806289,.26931533,.27057779,.27184027,.27310392,.27438641,.27566013,.27695143,.27824521,.27953911,.28085029,.28216287,.28347689,.28479946,.28612357,.28746462,.28880045,.29015142,.29150575,.29285842,.29422286,.29560378,.29697829,.29836285,.2997556,.30115834,.30256107,.30397385,.30538869,.30682147,.3082464,.30968919,.31113428,.31258714,.31404999,.31551525,.31699574,.31847346,.31996641,.32145932,.32296482,.32447779,.32600075,.3275238,.32905945,.3306025,.33214828,.33371133,.33527437,.33685035,.33843341,.34001955,.34162268,.34322581,.34484205,.3464652,.34809154,.34973475,.35138124,.35304451,.35470778,.3563844,.35806769,.35975787,.36146772,.36317107,.36489153,.36662501,.36836475,.37011179,.37186894,.37364239,.3754096,.37720311,.37900048,.380808,.38262755,.38445508,.38629267,.38814038,.38999811,.39187181,.39374968,.39564344,.39754716,.39945519,.40138894,.40331709,.40526533,.40722916,.40919751,.41118145,.4131799,.41518378,.41720238,.41923106,.42127502,.42332903,.42540267,.42747679,.4295758,.43168485,.43380398,.43593812,.4380874,.44024649,.44242096,.44461048,.44681478,.44903433,.45126867,.45351368,.45577347,.45805794,.46034241,.46265793,.46497798,.46732253,.46967274,.47204298,.47443333,.47683805,.47925848,.48170492,.48415971,.48663044,.4891212,.49162608,.49415696,.49670398,.49926898,.50185633,.50446141,.50708264,.50973028,.51239175,.51506698,.51777858,.52051026,.52325207,.52602041,.52881229,.53163093,.53446651,.53732866,.54021758,.54311997,.54605252,.54901183,.55199766,.55500412,.55804002,.56109285,.56417584,.56730592,.57044625,.57360953,.57681572,.58004349,.58330703,.58660066,.58992165,.59328014,.59667158,.60008085,.60354996,.60703915,.61055356,.6141156,.61771262,.62135255,.62502515,.62874556,.63249284,.63629138,.64012671,.64401996,.64794135,.65191495,.65593082,.66000885,.66412306,.66828924,.67251003,.67678469,.68112421,.68549275,.68995309,.69445014,.69902092,.70365524,.70833129,.71310455,.7179395,.72285187,.72783619,.73289204,.73804551,.74327189,.74857479,.75397295,.75947785,.76506311,.77078569,.77658296,.78249043,.78854442,.79470003,.80099618,.80740523,.81398237,.82068944,.82757771,.83464378,.84187275,.84929043,.85691893,.86478841,.87286919,.88120967,.88983017,.89875185,.90803343,.91766715,.92768061,.93817639,.94917262,.960751,.97300148,.98602414,1]),new Float32Array([0,.00160321,.00314556,.00460928,.00624393,.00807957,.01014583,.01241315,.01489102,.01755896,.02038753,.0233763,.02650562,.02975497,.03312425,.03658333,.04013209,.04374176,.04743104,.05117055,.05498029,.05884027,.06276049,.06673094,.07075975,.07483058,.07895064,.08312086,.08733123,.09158289,.09588362,.10022449,.10460429,.10901673,.11347675,.11796822,.12249985,.12706162,.13166356,.13630413,.14097634,.1456771,.15040959,.15517223,.15997502,.16480622,.16966748,.17455068,.17947404,.18442562,.18939923,.19440901,.19944288,.20450482,.20958894,.21471107,.21985109,.22497112,.23007658,.23516423,.24022178,.24525926,.25027424,.25526151,.26022869,.26516584,.2700803,.27496725,.27982408,.28465816,.2894648,.2942414,.29899505,.30372146,.30841774,.31309104,.31772712,.32234317,.32692602,.33148882,.33601451,.34052014,.34499249,.34943795,.35385001,.35823524,.36260039,.36693209,.37123707,.37550849,.37975323,.38397795,.38816896,.39233345,.39646786,.4005785,.40465271,.4087069,.41273713,.41673112,.42070496,.42465481,.42856848,.43246207,.43632558,.44016495,.44397825,.44776732,.45152044,.45525926,.45896649,.46265504,.46630782,.46994051,.47354865,.47713119,.48069358,.48422596,.4877336,.49121577,.49467781,.49810985,.50152695,.50491363,.50828052,.51162219,.51494366,.51823521,.52150655,.52475798,.52798915,.53119522,.53437626,.53753722,.54067814,.54378903,.54688966,.54996037,.55301559,.55604601,.5590564,.56204677,.56501698,.56796718,.57089287,.57380283,.57669288,.57956272,.58241254,.58524638,.58806193,.59085149,.59363097,.59638637,.59911972,.60184503,.60454816,.60723341,.6098963,.61255145,.61518037,.61779916,.62039429,.6229766,.62554157,.62809014,.63061869,.63313705,.63563532,.63812023,.6405884,.64303654,.64547455,.64789927,.65030724,.65269506,.65507281,.65743053,.65977818,.66211271,.6644302,.66673464,.66902208,.67129654,.67355663,.67580098,.67803806,.68025506,.68245935,.68465626,.68683314,.68899739,.69115412,.69329071,.69541484,.6975314,.69963545,.70172185,.70379817,.70586222,.70790845,.70995241,.7119785,.71399248,.71599847,.71798432,.7199682,.72193396,.7238878,.72583348,.72776735,.72968453,.73159832,.73349363,.73538733,.737261,.73912621,.74098134,.74282497,.74466002,.74648356,.74829715,.75009328,.75188679,.75367028,.75544381,.75719959,.75895298,.76069635,.76242077,.76414418,.76585752,.76755273,.76924604,.77092934,.77260256,.77425742,.77591062,.77755451,.77918774,.78082091,.78243405,.78403777,.78564084,.78722441,.78880751,.79037106,.79193407,.79348737,.79503042,.79656363,.7980966,.79960972,.80112267,.8026256,.80411857,.80560142,.80707431,.80854702,.81,.81145269,.81289554,.81432831,.81576085,.8171736,.81858605,.81998873,.82138145,.82277375,.82415593,.82552856,.82689124,.82824391,.82959592,.8309378,.83227032,.83359295,.83491552,.83622724,.83752978,.83883131,.84011388,.84139633,.84267777,.84394026,.84520274,.84646404,.84770644,.84894884,.85017997,.8514024,.85262477,.85383713,.85504812,.85624039,.85744119,.8586235,.85980415,.86097646,.86213875,.86330104,.86445332,.86560369,.8667441,.86787629,.86899853,.87012064,.87124079,.872343,.87344515,.87454522,.87563729,.87671942,.87779927,.87887132,.87993342,.88099551,.88204515,.88309723,.8841393,.88517123,.88620073,.88722277,.88824469,.88925672,.890266,.8912679,.89225996,.89324903,.89423096,.89521289,.8961848,.89715374,.89811563,.89906752,.90001935,.90096807,.90190673,.90284169,.90377033,.90469217,.90561402,.90652573,.90743411,.9083358,.90923417,.91012585,.9110111,.91188931,.91277099,.91364276,.91451073,.91537243,.91622406,.91707575,.91792357,.91876525,.91960287,.92043447,.92125607,.92207766,.92289931,.92371094,.92451829,.92531985,.92611718,.92690861,.92770016,.9284817,.92925882,.93003476,.93080175,.93156326,.93232477,.93308163,.933833,.93457925,.93532121,.93605739,.9367888,.93751544,.93824685,.93895829,.93967962,.94038606,.94109738,.94179875,.9424901,.94318628,.94387287,.94455898,.94524038,.94591165,.94658756,.94724888,.9479202,.94857144,.94922727,.94987851,.95052969,.95117092,.95180655,.95243776,.95306891,.95369601,.95432138,.95493257,.95554793,.95615906,.95676017,.95736146,.95796257,.95855761,.95914876,.95972991,.96031106,.9608922,.96146703,.9620381,.9626056,.96317029,.96372485,.96428251,.96483362,.96537805,.96592569,.96646345,.9670012,.96753228,.96806335,.96858752,.96910858,.96962965,.97014058,.97065163,.97115564,.97166663,.97216046,.97265857,.97314954,.97364056,.97412425,.9746052,.97508609,.97555965,.97603059,.97650146,.97696239,.97742325,.97788423,.97833741,.97878832,.97923923,.97968006,.9801209,.98056185,.98099267,.98142344,.98184645,.98227727,.98269808,.9831109,.98352969,.98394054,.98434323,.98474401,.98514479,.98554558,.98593807,.98632878,.98671949,.98710871,.98749101,.98786318,.98824245,.98861325,.98898393,.98934603,.98970675,.99006742,.99042821,.99078006,.99113071,.99148136,.99182206,.9921627,.99250335,.99283499,.99317467,.99349624,.99382687,.99414748,.99446815,.99478871,.99509931,.99541062,.99572116,.99602175,.99633235,.99663293,.99692351,.9972145,.99750507,.99779564,.99808592,.99836671,.99864727,.998918,.99919832,.99946886,.99973947,1]),function(){function e(t,a){Object(o.a)(this,e),this.context=t.context,this.levels=[];for(var n=0;n<t.levels.length-1;++n){var r=null;if(a)r=le(this.context.gl,t.levels[n].format,t.levels[n].type,t.levels[n].width,t.levels[n].height);else{var i=X(this.context,t.levels[n+1],t.levels[n].width,t.levels[n].height);if(null==i)return;r=he(this.context,1,t.levels[n],-1,i),oe(this.context.gl,i)}null!=r&&this.levels.push(r)}this.levels.push(t.levels[t.levels.length-1])}return Object(s.a)(e,[{key:"collapse",value:function(){for(var e=this.levels[this.levels.length-1],t=this.levels.length-2;t>=0;--t){var a=X(this.context,e,this.levels[t].width,this.levels[t].height);if(null==a)return null;e!==this.levels[this.levels.length-1]&&oe(this.context.gl,e);var n=he(this.context,1,a,1,this.levels[t]);if(null==n)return null;e=n,oe(this.context.gl,a)}return e}},{key:"destroy",value:function(){for(var e=0;e<this.levels.length-1;e++)oe(this.context.gl,this.levels[e])}}]),e}());var Q=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e,n){return Object(o.a)(this,a),t.call(this,e,n,"minmaxmean")}return Object(s.a)(a,[{key:"updateProgram",value:function(e){if(null!=this.uniforms&&void 0!==e){var t=this.uniforms.get("uTextureUnit");void 0!==t&&(t.buffer=[.5/e.width,.5/e.height])}Object(l.a)(Object(c.a)(a.prototype),"updateProgram",this).call(this,e)}}]),a}(Y),$=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e,n){return Object(o.a)(this,a),t.call(this,e,n,"moments")}return Object(s.a)(a,[{key:"updateProgram",value:function(e){if(null!=this.uniforms&&void 0!==e){var t=this.uniforms.get("uTextureUnit");void 0!==t&&(t.buffer=[.5/e.width,.5/e.height])}Object(l.a)(Object(c.a)(a.prototype),"updateProgram",this).call(this,e)}}]),a}(Y),ee=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e,n){return Object(o.a)(this,a),t.call(this,e,n,"reductionsum")}return Object(s.a)(a,[{key:"updateProgram",value:function(e){if(null!=this.uniforms&&void 0!==e){var t=this.uniforms.get("uTextureUnit");void 0!==t&&(t.buffer=[.5/e.width,.5/e.height])}Object(l.a)(Object(c.a)(a.prototype),"updateProgram",this).call(this,e)}}]),a}(Y),te=function(){function e(t){Object(o.a)(this,e),this.min=0,this.max=0,this.mean=0,this.absskew=0,this.median=0,void 0!==t&&(this.min=t.min,this.max=t.max,this.mean=t.mean,this.absskew=t.absskew,this.median=t.median)}return Object(s.a)(e,[{key:"clone",value:function(){return new e({min:this.min,max:this.max,mean:this.mean,absskew:this.absskew,median:this.median})}}]),e}();function ae(e,t){var a=function(e,t){if(void 0===e.toneMappingShaders)return null;var a=t,n=null,r=a.width,i=a.height;if(null==e.toneMappingShaders.minmaxmeanShader)return null;if(null==e.toneMappingShaders.log2linShader)return null;do{if(null==(n=se(e.gl)))return null;r=Math.max(r/2,1),i=Math.max(i/2,1);var o=Math.round(r),s=Math.round(i);ue(e.gl,e.toneMappingShaders.minmaxmeanShader,H.c.create(),a,o,s,e.texFloatFormat,n),a!==t&&oe(e.gl,a),a=n}while(n.width>1||n.height>1);var l=se(e.gl);if(null==l)return null;ue(e.gl,e.toneMappingShaders.log2linShader,H.c.create(),n,n.width,n.height,e.gl.UNSIGNED_BYTE,l);var c=e.gl.createFramebuffer();e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,c),e.gl.framebufferTexture2D(e.gl.FRAMEBUFFER,e.gl.COLOR_ATTACHMENT0,e.gl.TEXTURE_2D,l,0);var u=new Uint8Array(4);e.gl.readPixels(0,0,1,1,e.gl.RGBA,e.gl.UNSIGNED_BYTE,u),e.gl.deleteFramebuffer(c),oe(e.gl,n),oe(e.gl,l);var d=new te;return d.min=Math.log2(u[0]/255+.000244140625),d.max=Math.log2(u[1]/255+.000244140625),d.mean=Math.log2(u[2]/255+.000244140625),d}(e,t);if(null==a)return null;var n=function(e,t,a,n,r){if(void 0===e.toneMappingShaders)return null;if(null==e.toneMappingShaders.momentsShader)return null;if(null==e.toneMappingShaders.reductionsumShader)return null;if(null==e.toneMappingShaders.blitscaleShader)return null;var i=e.toneMappingShaders.momentsShader.getUniform("uMean");if(null==i)return null;i.buffer=[r];var o=t,s=null,l=o.width,c=o.height,u=!0;do{if(null==(s=se(e.gl)))return null;l=Math.max(l/2,1),c=Math.max(c/2,1);var d=Math.round(l),h=Math.round(c);ue(e.gl,u?e.toneMappingShaders.momentsShader:e.toneMappingShaders.reductionsumShader,H.c.create(),o,d,h,e.texFloatFormat,s),u=!1,o!==t&&oe(e.gl,o),o=s}while(s.width>1||s.height>1);var f,p=Math.pow(n-a,2)/4,m=se(e.gl);if(null==m)return null;if(null==(i=e.toneMappingShaders.blitscaleShader.getUniform("uScale")))return null;i.buffer=[1/p,1,1,1],ue(e.gl,e.toneMappingShaders.blitscaleShader,H.c.create(),s,s.width,s.height,e.gl.UNSIGNED_BYTE,m);var v=e.gl.createFramebuffer();e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,v),e.gl.framebufferTexture2D(e.gl.FRAMEBUFFER,e.gl.COLOR_ATTACHMENT0,e.gl.TEXTURE_2D,m,0);var g=new Uint8Array(4);e.gl.readPixels(0,0,1,1,e.gl.RGBA,e.gl.UNSIGNED_BYTE,g),f=g[0]/255*p,e.gl.deleteFramebuffer(v),oe(e.gl,m);var b,y=1.5*Math.pow(f,1.5);if(null==(m=se(e.gl)))return null;if(null==(i=e.toneMappingShaders.blitscaleShader.getUniform("uScale")))return null;i.buffer=[1,1/y,1,1],ue(e.gl,e.toneMappingShaders.blitscaleShader,H.c.create(),s,s.width,s.height,e.gl.UNSIGNED_BYTE,m),v=e.gl.createFramebuffer(),e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,v),e.gl.framebufferTexture2D(e.gl.FRAMEBUFFER,e.gl.COLOR_ATTACHMENT0,e.gl.TEXTURE_2D,m,0),g=new Uint8Array(4),e.gl.readPixels(0,0,1,1,e.gl.RGBA,e.gl.UNSIGNED_BYTE,g),b=g[1]/255*y/Math.pow(f,1.5),e.gl.deleteFramebuffer(v),oe(e.gl,m),oe(e.gl,s);var E={variance:0,absskew:0};return E.variance=f,E.absskew=b,E}(e,t,a.min,a.max,a.mean);return null==n?null:(a.absskew=n.absskew,a)}var ne=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e,n){return Object(o.a)(this,a),t.call(this,e,n,"greylog2")}return Object(s.a)(a,[{key:"destroy",value:function(){Object(l.a)(Object(c.a)(a.prototype),"destroy",this).call(this)}}]),a}(Y),re=function(){function e(t,a){Object(o.a)(this,e),this.shaderProgramIndex=new Map,this.greyShader=new ne(t,this.shaderProgramIndex),this.blitShader=new Y(t,this.shaderProgramIndex,"blit"),this.log2linShader=new Y(t,this.shaderProgramIndex,"log2lin"),this.lin2srgbShader=new Y(t,this.shaderProgramIndex,"lin2srgb"),this.srgb2linShader=new Y(t,this.shaderProgramIndex,"srgb2lin"),this.gaussianShader=new K(t,this.shaderProgramIndex,!1),a&&(this.gaussianbigsigmaShader=new K(t,this.shaderProgramIndex,!0)),this.addShader=new Y(t,this.shaderProgramIndex,"add"),this.minmaxmeanShader=new Q(t,this.shaderProgramIndex),this.momentsShader=new $(t,this.shaderProgramIndex),this.reductionsumShader=new ee(t,this.shaderProgramIndex),this.tonemapShader=new Y(t,this.shaderProgramIndex,"tonemap"),this.llfShader=new Y(t,this.shaderProgramIndex,"llf"),this.deltaMaskShader=new Y(t,this.shaderProgramIndex,"deltamask"),this.blitscaleShader=new Y(t,this.shaderProgramIndex,"blitscale"),this.lumShader=new Y(t,this.shaderProgramIndex,"lum"),this.blitxShader=new Y(t,this.shaderProgramIndex,"blitx")}return Object(s.a)(e,[{key:"destroy",value:function(e){if(void 0!==this.shaderProgramIndex){var t,a=Object(z.a)(this.shaderProgramIndex);try{for(a.s();!(t=a.n()).done;){var n=t.value;e.deleteProgram(n[1])}}catch(r){a.e(r)}finally{a.f()}}this.greyShader&&this.greyShader.destroy(),this.log2linShader&&this.log2linShader.destroy(),this.lin2srgbShader&&this.lin2srgbShader.destroy(),this.srgb2linShader&&this.srgb2linShader.destroy(),this.blitShader&&this.blitShader.destroy(),this.gaussianShader&&this.gaussianShader.destroy(),this.gaussianbigsigmaShader&&this.gaussianbigsigmaShader.destroy(),this.addShader&&this.addShader.destroy(),this.minmaxmeanShader&&this.minmaxmeanShader.destroy(),this.momentsShader&&this.momentsShader.destroy(),this.reductionsumShader&&this.reductionsumShader.destroy(),this.tonemapShader&&this.tonemapShader.destroy(),this.llfShader&&this.llfShader.destroy(),this.deltaMaskShader&&this.deltaMaskShader.destroy(),this.blitscaleShader&&this.blitscaleShader.destroy(),this.lumShader&&this.lumShader.destroy(),this.blitxShader&&this.blitxShader.destroy()}}]),e}(),ie=0;function oe(e,t){e.deleteTexture(t),ie--}function se(e,t,a){ie++;var n=e.createTexture();return n.type="undefined"!==typeof t?t:e.UNSIGNED_BYTE,n.format="undefined"!==typeof a?a:e.RGBA,e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n}function le(e,t,a,n,r){var i=se(e,a,t);i.width=n,i.height=r;var o=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),e.texImage2D(e.TEXTURE_2D,0,i.format,i.width,i.height,0,i.format,i.type,null),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.deleteFramebuffer(o),i}function ce(e,t){var a=se(e);return a.width=t.width,a.height=t.height,e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,a.format,a.format,e.UNSIGNED_BYTE,t),a}!function(){var e=new Float32Array(1),t=new Int32Array(e.buffer)}();function ue(e,t,a,n,r,i,o,s){r=Math.round(r),i=Math.round(i);var l=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,l),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s,0),e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,s.format,r,i,0,s.format,o,null),s.width=r,s.height=i,s.type=o,e.viewport(0,0,r,i);var c=t.uniforms;if(null!=c){if(Array.isArray(n)){var u=c.get("uSamplers[0]");void 0!==u&&(u.buffer=n)}else{var d=c.get("uSampler");void 0!==d&&(d.buffer=n)}var h="undefined"!==typeof a?a:H.c.create(),f=c.get("uPositionTransform");void 0!==f&&(f.buffer=new Float32Array(h))}t.render(s),e.deleteFramebuffer(l),e.bindFramebuffer(e.FRAMEBUFFER,null),e.flush()}function de(e,t,a,n,r,i){var o=Math.min(2048/Math.max(a,n),1);a*=o,n*=o,a=Math.round(a),n=Math.round(n);var s=document.createElement("canvas");s.width=a,s.height=n;var l=H.c.create();H.c.set(l,1,0,0,0,-1,0,0,0,1);var c=se(e.gl);if(null==c)return null;if(void 0===e.toneMappingShaders)return null;if(void 0===e.toneMappingShaders.blitxShader)return null;if(void 0===e.toneMappingShaders.blitShader)return null;if(void 0===e.toneMappingShaders.log2linShader)return null;r?ue(e.gl,"undefined"!==typeof i&&i?e.toneMappingShaders.blitxShader:e.toneMappingShaders.blitShader,l,t,a,n,e.texFloatFormat,c):ue(e.gl,e.toneMappingShaders.log2linShader,l,t,a,n,e.gl.FLOAT,c);var u=se(e.gl);if(null==u)return null;if(void 0===e.toneMappingShaders.lin2srgbShader)return null;ue(e.gl,e.toneMappingShaders.lin2srgbShader,H.c.create(),c,a,n,e.gl.UNSIGNED_BYTE,u);var d=e.gl.createFramebuffer();e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,d),e.gl.framebufferTexture2D(e.gl.FRAMEBUFFER,e.gl.COLOR_ATTACHMENT0,e.gl.TEXTURE_2D,u,0);var h=new Uint8Array(a*n*4);e.gl.readPixels(0,0,a,n,e.gl.RGBA,e.gl.UNSIGNED_BYTE,h),e.gl.deleteFramebuffer(d),oe(e.gl,c),oe(e.gl,u);var f=s.getContext("2d");if(null==f)return null;var p=f.createImageData(a,n);return p.data.set(h),f.putImageData(p,0,0),s}function he(e,t,a,n,r){var i=se(e.gl);if(null==i)return null;if(void 0===e.toneMappingShaders)return null;if(void 0===e.toneMappingShaders.addShader)return null;var o=e.toneMappingShaders.addShader.getUniform("uScales[0]");return null==o?null:(o.buffer=new Float32Array([t,n]),ue(e.gl,e.toneMappingShaders.addShader,H.c.create(),[a,r],a.width,a.height,a.type,i),i)}var fe=function(){function e(){Object(o.a)(this,e),this.toneMapMask=null}return Object(s.a)(e,[{key:"initWithBitmap",value:function(e,t,a,n){this.toneMapMask=ce(e.gl,t),this.srcStats=a.clone(),this.dstStats=n.clone()}},{key:"initWithTexture",value:function(e,t){var a=(new Date).getTime();if(this.toneMapMask=se(e.gl),null!=this.toneMapMask&&void 0!==e.toneMappingShaders&&void 0!==e.toneMappingShaders.blitShader&&void 0!==e.toneMappingShaders.greyShader){for(var n,r=t,i=t.width,o=t.height,s=0;s<2;s++){var l=se(e.gl);if(null==l)return;i/=2,o/=2,ue(e.gl,e.toneMappingShaders.blitShader,H.c.create(),r,i,o,e.gl.UNSIGNED_BYTE,l),r!==t&&oe(e.gl,r),r=l}n=r;var c=se(e.gl);if(null!=c){ue(e.gl,e.toneMappingShaders.greyShader,H.c.create(),n,n.width,n.height,e.texFloatFormat,c);var u=new q(e,c),d=ae(e,u.levels[0]);if(null!=d){this.srcStats=d;var h=function(e,t){var a=t.max-t.min,n=function(e,t){for(var a=0;a<e.length;++a)if(t<e[a][0]){if(0===a)return e[a][1];var n=(t-e[a-1][0])/(e[a][0]-e[a-1][0]);return e[a-1][1]*(1-n)+e[a][1]*n}return 0}([[2,1.4],[3.5,1.6],[5,2.3],[6.5,2.5],[12,2.5],[14,2]],a),r=Math.log2(n+.000244140625),i=t.min,o=t.max,s=Math.max(2,1+Math.ceil(a)),l=a/(s-1),c=[new J(e,!0),new J(e,!0)],u=0;if(void 0===e.context.toneMappingShaders)return null;if(null==e.context.toneMappingShaders.llfShader)return null;var d=e.context.toneMappingShaders.llfShader.getUniform("inv_ds");if(null==d)return null;d.buffer=[1/((o-i)/(s-1))];for(var h=0;h<s;++h){var f=i+h*l;if(null==e.context.toneMappingShaders.tonemapShader)return null;if(null==(d=e.context.toneMappingShaders.tonemapShader.getUniform("minmax")))return null;d.buffer=[f-r,f+r];var p=se(e.context.gl);if(null==p)return null;ue(e.context.gl,e.context.toneMappingShaders.tonemapShader,H.c.create(),e.levels[0],e.levels[0].width,e.levels[0].height,e.levels[0].type,p);var m=new q(e.context,p),v=new J(m,!1);if(null==(d=e.context.toneMappingShaders.llfShader.getUniform("reference")))return null;d.buffer=[f];for(var g=(u+1)%2,b=0;b<v.levels.length-1;++b){var y=c[u].levels[b],E=c[g].levels[b];ue(e.context.gl,e.context.toneMappingShaders.llfShader,H.c.create(),[e.levels[b],v.levels[b],y],E.width,E.height,E.type,E)}m.destroy(),v.destroy(),u=g}var w=c[u].collapse();return c[0].destroy(),c[1].destroy(),w}(u,this.srcStats);if(null!=h){var f=ae(e,h);if(null!=f&&(this.dstStats=f,null!=e.toneMappingShaders.deltaMaskShader)){var p=e.toneMappingShaders.deltaMaskShader.uniforms;if(null!=p){var m=p.get("uDiffMid");if(void 0!==m){m.buffer=new Float32Array([this.srcStats.mean-this.dstStats.mean]),ue(e.gl,e.toneMappingShaders.deltaMaskShader,H.c.create(),[c,h],c.width,c.height,c.type,this.toneMapMask),u.destroy(),oe(e.gl,c);var v=(new Date).getTime()-a;console.debug("Building tone map mask took ".concat(v,"ms, ").concat(ie," textures remaining"))}}}}}}}}},{key:"destroy",value:function(e){null!=this.toneMapMask&&e.deleteTexture(this.toneMapMask)}},{key:"getTonemappingBitmap",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var a,n,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.toneMapMask){e.next=2;break}return e.abrupt("return",null);case 2:if(null!=(a=de(t,this.toneMapMask,this.toneMapMask.width,this.toneMapMask.height,!0,!1))){e.next=5;break}return e.abrupt("return",null);case 5:if(n=a,null!=this.srcStats){e.next=8;break}return e.abrupt("return",null);case 8:if(null!=this.dstStats){e.next=10;break}return e.abrupt("return",null);case 10:return i=this.srcStats.clone(),o=this.dstStats.clone(),e.abrupt("return",{imageBitmap:n,srcStats:i,dstStats:o});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),pe=function(){function e(t){Object(o.a)(this,e),this.aspect=1,this.aspectX=1,this.aspectY=1,this.groupIdx=1,this.activeGroupMask=3,this.shaderCode="",this.exposureGain=1,this.finalExposure=0,this.abcIndexMatr=new Array(9),this.abcMatr=new Array(9),this.abcScale=H.f.create(),this.texture=null,this.lcTexture=null,this.cubeVertexPositionBuffer=null,this.cubeVertexTextureCoordBuffer=null,this.cubeVertexIndexBuffer=null,this.gl=t,this.toneControls=new R,this.toneValues=new M,this.mvMatrix=H.d.create(),this.pMatrix=H.d.create(),this.params=function(){for(var e=new Array(29),t=0;t<29;t++)e[t]=b[t];return e}(),this.texFloatFormat=t.FLOAT}return Object(s.a)(e,[{key:"destroy",value:function(){null!=this.texture&&this.gl.deleteTexture(this.texture),null!=this.lcTexture&&this.gl.deleteTexture(this.lcTexture),void 0!==this.shaderProgram&&this.gl.deleteProgram(this.shaderProgram),null!=this.cubeVertexPositionBuffer&&this.gl.deleteBuffer(this.cubeVertexPositionBuffer),null!=this.cubeVertexTextureCoordBuffer&&this.gl.deleteBuffer(this.cubeVertexTextureCoordBuffer),null!=this.cubeVertexIndexBuffer&&this.gl.deleteBuffer(this.cubeVertexIndexBuffer),void 0!==this.toneMappingMask&&this.toneMappingMask.destroy(this.gl),void 0!==this.toneMappingShaders&&this.toneMappingShaders.destroy(this.gl)}}]),e}();function me(e){!function(e){e.gl.clearColor(0,0,0,0),e.gl.disable(e.gl.DEPTH_TEST);var t=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;if(!e.gl.getExtension("OES_texture_float")||t){var a=e.gl.getExtension("OES_texture_half_float");e.gl.getExtension("OES_texture_half_float_linear"),null!=a?e.texFloatFormat=a.HALF_FLOAT_OES:alert("OES_texture_half_float extension not supported")}else e.gl.getExtension("OES_texture_float_linear")||alert("OES_texture_float_linear extension not supported");e.texFloatFormat,e.toneMappingShaders=new re(e.gl,!1)}(e)}function ve(e){var t="",a="",n="",r="";if(e.activeGroupMask=2,e.groupIdx=0,0===e.groupIdx&&(t+="uniform highp mat3 abcMatr;\n",t+="uniform highp mat3 indexMatr;\n",t+="uniform highp vec3 abcScale;\n",a+="rgbCol = indexMatr * rgbCol;\n",a+="rgbCol *= abcScale;\n",a+="vec3 colorThresh = abcScale*0.25;\n",a+="vec3 colorScale = 1.0/(abcScale*0.75);\n",a+="float t1 = max(rgbCol.r, rgbCol.g);\n",a+="vec2 recT;\n",a+="recT = max ((rgbCol.rg - colorThresh.xy) * colorScale.xy, 0.0);\n",a+="recT = recT * recT;\n",a+="rgbCol.rg = mix(rgbCol.rg, vec2(t1), recT);\n",a+="t1 = max(0.5 * (rgbCol.r + rgbCol.g), rgbCol.b);\n",a+="recT.x = max((rgbCol.b - colorThresh.z) * colorScale.z, 0.0);\n",a+="recT.x = recT.x * recT.x;\n",a+="rgbCol.b = mix(rgbCol.b, t1, recT.x);\n",a+="rgbCol = abcMatr * rgbCol;\n",a+="rgbCol = clamp(rgbCol,0.0,1.0);\n",e.activeGroupMask|=1),e.groupIdx=2,2===e.groupIdx&&(t+="uniform float saturation;\n",n+="const vec3 lumvec = vec3(0.2880859375, 0.7119140625,0.0);\n",n+="vec3 yuv;\n",n+="yuv.x = dot(rgbCol,lumvec);\n",n+="yuv.y = (rgbCol.r-yuv.x) * (saturation*0.70233196159122);\n",n+="yuv.z = (rgbCol.b-yuv.x) * saturation;\n",n+="yuv = yuv.yyz * vec3(1.423828125,-0.576171875,1.0) + yuv.x;\n",n+="rgbCol = clamp(yuv,0.0,1.0);\n",e.activeGroupMask|=4),e.groupIdx=2,2===e.groupIdx&&(t+="uniform float vibrance;\n",n+="vec3 hsl = rgb2HSL(rgbCol);\n",n+="float sFactor = step(0.0,-vibrance);\n",n+="float vibSat = (hsl.z - hsl.y) / hsl.z;\n",n+="float protection = calcProtection(hsl.x, vibSat);\n",n+="float shadowRolloff = min( 1.0, 16.0 * hsl.z );\n",n+="float saturationMask = vibSat * (1.0 - vibSat);\n",n+="saturationMask *= 2.0 - saturationMask;\n",n+="shadowRolloff *= 2.0 - shadowRolloff;\n",n+="float brightnessFactor = shadowRolloff * saturationMask;\n",n+="float shiftFactor = vibrance * (vibrance * protection + 1.0 - protection);\n",n+="float saturationFactor = (35.0 - 17.0*protection)/42.0 * shiftFactor * (1.0 - hsl.y)*shadowRolloff;\n",n+="float satPos = vibSat / (1.0 - saturationFactor * (1.0 - vibSat));\n",n+="float brightPos = brightnessFactor * shiftFactor * 0.25;\n",n+="saturationFactor = -vibrance;\n",n+="float satNeg = vibSat;\n",n+="satNeg *= 1.0 - saturationFactor + saturationFactor * vibSat * (0.5 + 0.5 * vibSat) * shadowRolloff;\n",n+="satNeg *= 1.0 - 0.25 * saturationFactor;\n",n+="float brightNeg = -(brightnessFactor*saturationFactor);\n",n+="vibSat = mix(satPos,satNeg,sFactor);\n",n+="brightnessFactor = mix(brightPos,brightNeg,sFactor);\n",n+="hsl.z *= 1.0 + brightnessFactor * (1.0 - hsl.z);\n",n+="hsl.y = hsl.z - vibSat * hsl.z;\n",n+="rgbCol = hsl2RGB(hsl);\n",e.activeGroupMask|=4),e.groupIdx=2,2===e.groupIdx&&(t+="uniform float negClarity;\n",n+="highp vec4 bwCol = texture2D(lcSampler, vTextureCoord.st);\n",n+="float lum = dot(rgbCol,vec3(0.25,0.5,0.25));\n",n+="float dLum = (sqrt(lum + 0.00390625) - 0.0625) * 1.0644512214;\n",n+="float x = dLum*2.0 - 1.0;\n",n+="x = x*x*x*x;\n",n+="x = 1.0-x;\n",n+="x = x*x*x*x;\n",n+="float delta = grayVal - (bwCol.r*256.0+bwCol.g)*0.00390625;\n",n+="dLum = clamp(dLum+delta*x*negClarity,0.0,1.0);\n",n+="dLum = dLum * 0.93945122137 + 0.0625;\n",n+="dLum = (dLum * dLum) - 0.00390625;\n",n+="float scale = dLum/max(lum,0.00001);\n",n+="rgbCol *= scale;\n",e.activeGroupMask|=4),e.groupIdx=2,2===e.groupIdx?(a+="rgbCol = DoToneMap( rgbCol, vTextureCoord );\n",e.activeGroupMask|=4):1===e.groupIdx&&(a+="rgbCol = DoToneMap( rgbCol, vTextureCoord );\n",e.activeGroupMask|=2),e.groupIdx=3,3===e.groupIdx&&(e.activeGroupMask|=8),4===e.groupIdx&&(t+="uniform float splttAlpha;\n",t+="uniform vec3 splttShadow;\n",t+="uniform vec3 splttDelta;\n",r+="vec3 tCol = rgbCol*splttAlpha;\n",r+="rgbCol = tCol/(1.0+tCol-rgbCol);\n",r+="rgbCol = rgbCol*((1.0-rgbCol) * (splttShadow + splttDelta * rgbCol) + rgbCol*rgbCol);\n",r+="tCol = rgbCol/splttAlpha;\n",r+="rgbCol = tCol/(1.0+tCol-rgbCol);\n",e.activeGroupMask|=16),e.groupIdx=5,5===e.groupIdx){t+="uniform float vignetteAmount;\n",t+="uniform float roundness;\n",t+="uniform float feather;\n",t+="uniform float midpoint;\n",t+="uniform float highlightContrast;\n",t+="uniform float highlightMask;\n",t+="uniform vec2 aspect;\n";var i="";switch(i+="vec2 pos = vTextureCoord - 0.5;\n",i+="float dlFactor = 1.0-max(sign(vignetteAmount),0.0);\n",i+="vec3 resultColor = mix(vec3(1.0,1.0,1.0),vec3(0.0,0.0,0.0),dlFactor);\n",i+="float blackShift = dlFactor*0.28;\n",i+="float maskShift = mix(2.4,0.334,dlFactor);\n",i+="float absAmount = abs(vignetteAmount);\n",i+="vec2 circlePos = pos*aspect;\n",i+="float circleLen = length(circlePos)*0.95;\n",i+="float elipseLen = length(pos)*1.15;\n",i+="float rectRadius = 1.0-(2.0*max(-roundness-0.5,0.0)*0.86);\n",i+="vec2 minValue = max(2.0*abs(circlePos)-aspect+rectRadius,0.0);\n",i+="float rectLen = length(minValue)*0.576;\n",i+="rectLen /= rectRadius;\n",i+="float rectFactor = min(1.0,max(-roundness,0.0)*2.0);\n",i+="elipseLen = mix(elipseLen,rectLen,rectFactor);\n",i+="elipseLen = mix(elipseLen,circleLen,max(roundness,0.0));\n",i+="elipseLen = pow(1.0-elipseLen,0.8125);\n",i+="float addVal = midpoint*0.3 + elipseLen*max(midpoint,0.0)*0.5 - feather*0.3;\n",i+="float start = mix(0.495,-0.25+blackShift,feather) - addVal;\n",i+="float end = mix(0.505,0.4+blackShift,feather) - addVal;\n",i+="float maskFactor = 1.0 - (1.0 - smoothstep(start,end,elipseLen))*pow(absAmount,maskShift);\n",i+="float maxScale = mix(maskFactor,1.0,highlightContrast);\n",i+="float v = max(max(rgbCol.r,rgbCol.g),rgbCol.b);\n",i+="v = max(v*1.21951219512195 - 0.21951219512195,0.0);\n",i+="maskFactor = mix(maskFactor,maxScale,v);\n",i+="rgbCol = mix(rgbCol,resultColor,1.0-maskFactor);\n",e.params[28]){case 0:a+=i;break;case 1:n+=i;break;case 2:r+=i}e.activeGroupMask|=32}var o=function(e,t,a,n,r,i,o){var s=e.gl.createShader(e.gl.FRAGMENT_SHADER);if(null==s)return null;var l=G.get(t);return null==l?null:(l=(l=(l=(l=(l=l.replace("//***uniforms",a)).replace("//***functions",n)).replace("//***stagesPreExposure",r)).replace("//***stagesPreTone",i)).replace("//***stagesPostTone",o),e.shaderCode=l,e.gl.shaderSource(s,l),e.gl.compileShader(s),e.gl.getShaderParameter(s,e.gl.COMPILE_STATUS)?s:null)}(e,"shaderTemplate",t,"",a,n,r);if(null!=o){var s=W(e.gl,"shader-vs","");if(null!=s){var l=e.gl.createProgram();if(null!=l){if(e.gl.attachShader(l,s),e.gl.attachShader(l,o),e.gl.linkProgram(l),!e.gl.getProgramParameter(l,e.gl.LINK_STATUS))throw new Error("Could not initialise shaders");e.gl.useProgram(l),e.shaderProgram=l,e.shaderProgram.vertexPositionAttribute=e.gl.getAttribLocation(e.shaderProgram,"aVertexPosition"),e.gl.enableVertexAttribArray(e.shaderProgram.vertexPositionAttribute),e.shaderProgram.textureCoordAttribute=e.gl.getAttribLocation(e.shaderProgram,"aTextureCoord"),e.gl.enableVertexAttribArray(e.shaderProgram.textureCoordAttribute),e.shaderProgram.pMatrixUniform=e.gl.getUniformLocation(e.shaderProgram,"uPMatrix"),e.shaderProgram.mvMatrixUniform=e.gl.getUniformLocation(e.shaderProgram,"uMVMatrix"),e.shaderProgram.samplerUniform=e.gl.getUniformLocation(e.shaderProgram,"uSampler"),e.shaderProgram.lcSamplerUniform=e.gl.getUniformLocation(e.shaderProgram,"lcSampler"),e.shaderProgram.toneMapMaskUniform=e.gl.getUniformLocation(e.shaderProgram,"toneMapMask"),xe(e,function(){for(var e=[-.04845666666666667,.04845666666666667,.097545,.14548333333333335,.20238666666666663,.27339166666666664,.36798000000000003,.5101999999999999,.699435,1.3165399999999998],t=new Float32Array(24),a=0;a<8;a++){var n=e[a],r=e[a+1],i=e[a+2];t[3*a]=.5*(n+r),t[3*a+1]=r-n,t[3*a+2]=.5*(n-2*r+i)}return t}(),"undoCurve")}}}}function ge(e){var t=190734e-11;if(void 0!==e.toneMappingMask&&null!=e.toneMappingMask.srcStats&&null!=e.toneMappingMask.dstStats){var a=e.toneMappingMask.srcStats.min,n=e.toneMappingMask.dstStats.min,r=e.toneMappingMask.srcStats.max,i=e.toneMappingMask.dstStats.max,o=e.toneMappingMask.srcStats.mean,s=e.params[7]/100,l=e.params[6]/100,c=e.params[8]/100;c=Math.max(c,0);var u=a-1*(n-a),d=r-0*(i-r),h=(o-n)/(o-u),f=n-h*u,p=(o-i)/(o-d),m=i-p*d,v=r-i,g=v-.5*(a-n+v);g*=function(e){var t=e.absskew;return Math.max(.125,Math.min(.375*t-.0625,.5))}(e.toneMappingMask.srcStats);var b=.5/(o-a),y=0-b*a,E=.5/(r-o),w=.5-E*o;a+t>=o&&(b=0,y=.5),r-t<=o&&(E=0,w=.5);var x=e.toneMappingMask.srcStats.max-e.toneMappingMask.srcStats.mean,k=Math.max(0,Math.min(1,-1*x+5));ye(e,s,"uGlobalAmtHighlights"),ye(e,l,"uGlobalAmtShadows"),ye(e,c,"uGlobalAmtClarity"),ye(e,e.toneMappingMask.srcStats.mean,"uToneMapMid"),ye(e,-1,"uCompressionScale"),ye(e,2,"uCompressionOffset"),we(e,h,p,b,E,"lineLumWeightScale"),we(e,f,m,y,w,"lineLumWeightOffset"),ye(e,k,"uHighlightPinAmount"),ye(e,g,"uToneMapMaxAbsOffset")}}function be(e){var t=!1;if(0!==(1&e.activeGroupMask)&&(ke(e,e.abcMatr,"abcMatr"),ke(e,e.abcIndexMatr,"indexMatr"),function(e,t,a){if(void 0===e.shaderProgram)return;var n=e.gl.getUniformLocation(e.shaderProgram,a);e.gl.uniform3f(n,t[0],t[1],t[2])}(e,e.abcScale,"abcScale")),0!==(2&e.activeGroupMask)){ye(e,e.exposureGain,"exposureGain"),ye(e,e.finalExposure,"exposure"),ye(e,e.params[4]/100,"blacks"),ye(e,e.params[5]/100,"whites");var a=new N;if(a.contrast=e.params[3]/100,a.contrastKey=.18,a.toneValues=e.toneValues,xe(e,V(a),"renderCurve"),t=!0,void 0===e.toneMappingMask)return;null!==e.toneMappingMask.srcStats&&null!==e.toneMappingMask.dstStats&&ge(e)}if(0!==(8&e.activeGroupMask)&&!t){var n=new N;n.contrast=e.params[3]/100,n.contrastKey=.18,n.toneValues=e.toneValues,xe(e,V(n),"renderCurve")}if(0!==(4&e.activeGroupMask)){ye(e,e.params[10]/100+1,"saturation"),ye(e,e.params[9]/100,"vibrance");var r=.5*Math.min(e.params[8]/100,0),i=1+.5*r,o=.5+.5*i;ye(e,r=i*o*o-1,"negClarity")}if(0!==(16&e.activeGroupMask)){var s=B(e.params[21],e.params[22],e.params[20],e.params[18],e.params[19]);Ee(e,s[1],s[2],s[3],"splttShadow"),ye(e,s[0],"splttAlpha"),Ee(e,s[4],s[5],s[6],"splttDelta")}0!==(32&e.activeGroupMask)&&(ye(e,e.params[23]/100,"vignetteAmount"),ye(e,e.params[24]/100,"roundness"),ye(e,e.params[26]/100,"feather"),ye(e,(e.params[25]-50)/100,"midpoint"),ye(e,e.params[27]/100,"highlightContrast"),ye(e,2===e.params[28]||0===e.params[27]?0:1,"highlightMask"),function(e,t,a,n){if(void 0===e.shaderProgram)return;var r=e.gl.getUniformLocation(e.shaderProgram,n);e.gl.uniform2f(r,t,a)}(e,e.aspectX,e.aspectY,"aspect"))}function ye(e,t,a){if(void 0!==e.shaderProgram){var n=e.gl.getUniformLocation(e.shaderProgram,a);e.gl.uniform1f(n,t)}}function Ee(e,t,a,n,r){if(void 0!==e.shaderProgram){var i=e.gl.getUniformLocation(e.shaderProgram,r);e.gl.uniform3f(i,t,a,n)}}function we(e,t,a,n,r,i){if(void 0!==e.shaderProgram){var o=e.gl.getUniformLocation(e.shaderProgram,i);e.gl.uniform4f(o,t,a,n,r)}}function xe(e,t,a){if(void 0!==e.shaderProgram){var n=e.gl.getUniformLocation(e.shaderProgram,a);e.gl.uniform3fv(n,t)}}function ke(e,t,a){if(void 0!==e.shaderProgram){for(var n=e.gl.getUniformLocation(e.shaderProgram,a),r=H.c.create(),i=0;i<9;i++)r[i]=t[i];e.gl.uniformMatrix3fv(n,!1,r)}}function Se(e,t){switch(e){default:C(t.abcMatr,t.abcIndexMatr,t.abcScale,t.params[0],t.params[1]),t.finalExposure=function(e,t,a){var n=1.26;if(e.exposureGain=1,(t+=.8*a)<0){var r=Math.min(t+1,0);r*=r,e.exposureGain*=1/(1+r),t=Math.max(-1,t)}var i=Math.abs(t),o=i/8;n+=.24*(o*=o);var s=Math.pow(i/8,1.26);return s=Math.pow(8*s,n)+1,t<0?1/s:Math.min(s,8.488339269336635)}(t,t.params[2],Math.log(t.abcScale[0])/Math.log(2)),t.abcScale[1]/=t.abcScale[0],t.abcScale[2]/=t.abcScale[0],t.abcScale[0]=1,_(t.params,t.toneControls),D(t.toneControls,t.toneValues);break;case 4:case 5:break;case 3:_(t.params,t.toneControls),D(t.toneControls,t.toneValues)}}function Oe(e){me(e),ve(e),function(e){if(e.cubeVertexPositionBuffer=e.gl.createBuffer(),null!=e.cubeVertexPositionBuffer){e.gl.bindBuffer(e.gl.ARRAY_BUFFER,e.cubeVertexPositionBuffer);e.gl.bufferData(e.gl.ARRAY_BUFFER,new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0]),e.gl.STATIC_DRAW),e.cubeVertexPositionBuffer.itemSize=3,e.cubeVertexPositionBuffer.numItems=4,e.cubeVertexTextureCoordBuffer=e.gl.createBuffer(),e.gl.bindBuffer(e.gl.ARRAY_BUFFER,e.cubeVertexTextureCoordBuffer);e.gl.bufferData(e.gl.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),e.gl.STATIC_DRAW),e.cubeVertexTextureCoordBuffer.itemSize=2,e.cubeVertexTextureCoordBuffer.numItems=4,e.cubeVertexIndexBuffer=e.gl.createBuffer(),e.gl.bindBuffer(e.gl.ELEMENT_ARRAY_BUFFER,e.cubeVertexIndexBuffer);e.gl.bufferData(e.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),e.gl.STATIC_DRAW),e.cubeVertexIndexBuffer.itemSize=1,e.cubeVertexIndexBuffer.numItems=6}}(e),Se(-1,e),e.gl.clearColor(.4,.4,.4,1),e.gl.enable(e.gl.DEPTH_TEST)}function Ce(e,t){return Pe.apply(this,arguments)}function Pe(){return(Pe=Object(i.a)(r.a.mark((function e(t,a){var n,i,o,s,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=y(a))){e.next=3;break}throw new Error("Cannot create blur data!");case 3:if(i=n,null!=(o=ce(t.gl,a))){e.next=7;break}throw new Error("Cannot create texture!");case 7:return(s=new fe).initWithTexture(t,o),e.next=11,s.getTonemappingBitmap(t);case 11:if(null!=(l=e.sent)){e.next=14;break}throw new Error("Cannot create tonemaps!");case 14:return s.destroy(t.gl),oe(t.gl,o),e.abrupt("return",{toneMap:l.imageBitmap,blurMap:i,srcStats:l.srcStats,dstStats:l.dstStats});case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Te(e,t,a,n,r,i){null!==e.texture&&(e.gl.deleteTexture(e.texture),e.gl.deleteTexture(e.lcTexture)),e.texture=e.gl.createTexture(),e.lcTexture=e.gl.createTexture(),e.texture.image=t,e.lcTexture.image=a,function(e){null!=e.texture&&null!=e.lcTexture&&(e.gl.bindTexture(e.gl.TEXTURE_2D,e.texture),e.gl.texImage2D(e.gl.TEXTURE_2D,0,e.gl.RGBA,e.gl.RGBA,e.gl.UNSIGNED_BYTE,e.texture.image),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_MAG_FILTER,e.gl.LINEAR),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_MIN_FILTER,e.gl.LINEAR),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_WRAP_S,e.gl.CLAMP_TO_EDGE),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_WRAP_T,e.gl.CLAMP_TO_EDGE),e.gl.bindTexture(e.gl.TEXTURE_2D,e.lcTexture),e.gl.texImage2D(e.gl.TEXTURE_2D,0,e.gl.RGBA,e.gl.RGBA,e.gl.UNSIGNED_BYTE,e.lcTexture.image),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_MAG_FILTER,e.gl.LINEAR),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_MIN_FILTER,e.gl.LINEAR),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_WRAP_S,e.gl.CLAMP_TO_EDGE),e.gl.texParameteri(e.gl.TEXTURE_2D,e.gl.TEXTURE_WRAP_T,e.gl.CLAMP_TO_EDGE),e.gl.bindTexture(e.gl.TEXTURE_2D,null),e.aspect=e.texture.image.width/e.texture.image.height,e.aspectX=Math.max(e.aspect,1),e.aspectY=Math.max(1/e.aspect,1),e.texture.type=e.gl.UNSIGNED_BYTE,e.texture.format=e.gl.RGBA,e.texture.width=e.texture.image.width,e.texture.height=e.texture.image.height,e.lcTexture.type=e.gl.UNSIGNED_BYTE,e.lcTexture.format=e.gl.RGBA,e.lcTexture.width=e.lcTexture.image.width,e.lcTexture.height=e.lcTexture.image.height)}(e),void 0!==e.toneMappingMask&&e.toneMappingMask.destroy(e.gl),e.toneMappingMask=new fe,e.toneMappingMask.initWithBitmap(e,n,r,i)}function Ae(e){!function(e){be(e);var t=e.gl.drawingBufferWidth,a=e.gl.drawingBufferHeight;if(e.gl.viewport(0,0,t,a),e.gl.clear(e.gl.COLOR_BUFFER_BIT|e.gl.DEPTH_BUFFER_BIT),H.d.ortho(e.pMatrix,-1,1,-1,1,.1,100),H.d.identity(e.mvMatrix),H.d.translate(e.mvMatrix,e.mvMatrix,[0,0,-1]),H.d.scale(e.mvMatrix,e.mvMatrix,[1,t/a,1]),e.aspect>0?H.d.scale(e.mvMatrix,e.mvMatrix,[1,1/e.aspect,1]):H.d.scale(e.mvMatrix,e.mvMatrix,[1/e.aspect,1,1]),e.gl.bindBuffer(e.gl.ARRAY_BUFFER,e.cubeVertexPositionBuffer),e.gl.vertexAttribPointer(e.shaderProgram.vertexPositionAttribute,e.cubeVertexPositionBuffer.itemSize,e.gl.FLOAT,!1,0,0),e.gl.bindBuffer(e.gl.ARRAY_BUFFER,e.cubeVertexTextureCoordBuffer),e.gl.vertexAttribPointer(e.shaderProgram.textureCoordAttribute,e.cubeVertexTextureCoordBuffer.itemSize,e.gl.FLOAT,!1,0,0),e.gl.activeTexture(e.gl.TEXTURE0),e.gl.bindTexture(e.gl.TEXTURE_2D,e.texture),e.gl.uniform1i(e.shaderProgram.samplerUniform,0),e.gl.activeTexture(e.gl.TEXTURE1),e.gl.bindTexture(e.gl.TEXTURE_2D,e.lcTexture),e.gl.uniform1i(e.shaderProgram.lcSamplerUniform,1),void 0===e.toneMappingMask)throw new Error("Tone mapping mask not set!");e.toneMappingMask.toneMapMask&&(e.gl.activeTexture(e.gl.TEXTURE2),e.gl.bindTexture(e.gl.TEXTURE_2D,e.toneMappingMask.toneMapMask),e.gl.uniform1i(e.shaderProgram.toneMapMaskUniform,2)),e.gl.bindBuffer(e.gl.ELEMENT_ARRAY_BUFFER,e.cubeVertexIndexBuffer),function(e){e.gl.uniformMatrix4fv(e.shaderProgram.pMatrixUniform,!1,e.pMatrix),e.gl.uniformMatrix4fv(e.shaderProgram.mvMatrixUniform,!1,e.mvMatrix)}(e),e.gl.drawElements(e.gl.TRIANGLES,e.cubeVertexIndexBuffer.numItems,e.gl.UNSIGNED_SHORT,0)}(e)}var je=function(){function e(){Object(o.a)(this,e),this.temperature=0,this.tint=0,this.exposure=0,this.contrast=0,this.highlights=0,this.shadows=0,this.whites=0,this.blacks=0,this.clarity=0,this.vibrance=0,this.saturation=0,this.vignette_amount=0,this.vignette_roundness=0,this.vignette_midpoint=50,this.vignette_feather=50,this.vignette_highlight=0,this.vignette_mode=0}return Object(s.a)(e,[{key:"reset",value:function(){this.temperature=0,this.tint=0,this.exposure=0,this.contrast=0,this.highlights=0,this.shadows=0,this.whites=0,this.blacks=0,this.clarity=0,this.vibrance=0,this.saturation=0,this.vignette_amount=0,this.vignette_roundness=0,this.vignette_midpoint=50,this.vignette_feather=50,this.vignette_highlight=0,this.vignette_mode=0}},{key:"setParam",value:function(e,t){this[e]=t}},{key:"getParam",value:function(e){return this[e]}}]),e}(),Ie=function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,[{key:"init",value:function(e){this.context=new pe(e),Oe(this.context),ve(this.context)}},{key:"destroy",value:function(){void 0!==this.context&&this.context.destroy()}},{key:"getMapsForImageBitmap",value:function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.context){e.next=2;break}throw new Error("Context not set!");case 2:return e.abrupt("return",Ce(this.context,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setImage",value:function(e,t,a,n,r){if(void 0===this.context)throw new Error("Context not initialized!");Te(this.context,e,t,a,n,r)}},{key:"setParams",value:function(e){if(void 0===this.context)throw new Error("Context not initialized!");this.context.params[0]=e.temperature,this.context.params[1]=e.tint,this.context.params[2]=e.exposure,this.context.params[3]=e.contrast,this.context.params[7]=e.highlights,this.context.params[6]=e.shadows,this.context.params[5]=e.whites,this.context.params[4]=e.blacks,this.context.params[8]=e.clarity,this.context.params[9]=e.vibrance,this.context.params[10]=e.saturation,this.context.params[23]=e.vignette_amount,this.context.params[24]=e.vignette_roundness,this.context.params[25]=e.vignette_midpoint,this.context.params[26]=e.vignette_feather,this.context.params[27]=e.vignette_highlight,this.context.params[28]=e.vignette_mode,Se(-1,this.context)}},{key:"drawFilter",value:function(){if(void 0===this.context)throw new Error("Context not initialized!");Ae(this.context)}}]),e}(),Me=a(18),Re=a(1),_e=a(21),De=a(54),Le=a(48),Ne=a(16),Ve=a(208),Ue=function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,null,[{key:"getAdjustmentsPresetGroups",value:function(){return[{id:1,deepLinkId:"popular",title:Object(Re.b)("AdjustView.Presets.Popular.Grouptitle","Popular"),presets:[4,7,16,22,25]},{id:2,deepLinkId:"color",title:Object(Re.b)("AdjustView.Presets.Color.Grouptitle","Color"),presets:[1,2,3,4,5,6]},{id:3,deepLinkId:"creative",title:Object(Re.b)("AdjustView.Presets.Creative.Grouptitle","Creative"),presets:[7,8,9,10,11,12,13,14,15,16]},{id:4,deepLinkId:"vintage",title:Object(Re.b)("AdjustView.Presets.Vintage.Grouptitle","Vintage / Old Photo Filters"),presets:[11,7,16,20,25,29]},{id:5,deepLinkId:"bw",title:Object(Re.b)("AdjustView.Presets.BW.Grouptitle","B&W"),presets:[17,18,19,20,21,22,23,24,25,26]},{id:6,deepLinkId:"vignette",title:Object(Re.b)("AdjustView.Presets.Vignetting.Grouptitle","Vignetting"),presets:[27,28,29,30]}]}}]),e}(),Fe=function(){function e(){Object(o.a)(this,e),this.glia=void 0,this.canvas=void 0,this.glia=new Ie,this.canvas=document.createElement("canvas")}return Object(s.a)(e,[{key:"init",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var a,n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.getGLContext()){e.next=3;break}return e.abrupt("return",Promise.reject(new Error("no GL context")));case 3:return e.prev=3,this.glia.init(a),n=Me.a.createHTMLCanvasElement(t),e.next=8,this.glia.getMapsForImageBitmap(n);case 8:i=e.sent,this.glia.setImage(n,i.blurMap,i.toneMap,i.srcStats,i.dstStats),e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(3),e.abrupt("return",Promise.reject(e.t0));case 15:return e.abrupt("return",Promise.resolve());case 16:case"end":return e.stop()}}),e,this,[[3,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this.glia.destroy()}},{key:"renderPreset",value:function(e,t){var a=Object(f.assign)(t||new je,e.params);this.glia.setParams(a),this.glia.drawFilter();var n=this.getGLContext();if(n){var r=n.drawingBufferWidth,i=n.drawingBufferHeight,o=new Uint8Array(r*i*4);return n.readPixels(0,0,r,i,n.RGBA,n.UNSIGNED_BYTE,o),Me.a.flipPixels(o,r,i),new ImageData(Uint8ClampedArray.from(o),r,i)}}},{key:"getGLContext",value:function(){return this.canvas.getContext("webgl",{preserveDrawingBuffer:!0,premultipliedAlpha:!1})}}]),e}(),Be=function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,null,[{key:"getAdjustmentsPresets",value:function(){return[{id:1,title:Object(Re.b)("AdjustView.Presets.Color.Natural","Natural"),additive:!1,hasIntensity:!0,params:{contrast:10,highlights:-10,shadows:15,whites:-10,blacks:-20,vibrance:10}},{id:2,title:Object(Re.b)("AdjustView.Presets.Color.Bright","Bright"),additive:!1,hasIntensity:!0,params:{highlights:-30,shadows:50,whites:40,blacks:-10}},{id:3,title:Object(Re.b)("AdjustView.Presets.Color.HighContrast","High Contrast"),additive:!1,hasIntensity:!0,params:{contrast:70}},{id:4,title:Object(Re.b)("AdjustView.Presets.Color.HighContrastDetail","High Contrast & Detail"),additive:!1,hasIntensity:!0,params:{contrast:50,highlights:20,blacks:-40,clarity:30}},{id:5,title:Object(Re.b)("AdjustView.Presets.Color.Vivid","Vivid"),additive:!1,hasIntensity:!0,params:{contrast:20,highlights:-10,shadows:25,whites:10,blacks:-10,vibrance:40,saturation:10,clarity:20}},{id:6,title:Object(Re.b)("AdjustView.Presets.Color.Matte","Matte"),additive:!1,hasIntensity:!0,params:{contrast:-10,highlights:-20,shadows:10,whites:20,blacks:-25,saturation:-25}},{id:7,title:Object(Re.b)("AdjustView.Presets.Creative.DesaturatedContrast","Desaturated Contrast"),additive:!1,hasIntensity:!0,params:{contrast:20,whites:20,blacks:-25,vibrance:-10,saturation:-50,clarity:40}},{id:8,title:Object(Re.b)("AdjustView.Presets.Creative.CoolLight","Cool Light"),additive:!1,hasIntensity:!0,params:{contrast:15,whites:45,blacks:-5,temperature:-20,tint:5,vibrance:-15,saturation:-20,clarity:10}},{id:9,title:Object(Re.b)("AdjustView.Presets.Creative.Turquoise&Red","Turquoise & Red"),additive:!1,hasIntensity:!0,params:{contrast:10,highlights:10,whites:45,blacks:-20,temperature:10,tint:45,vibrance:10,saturation:5,clarity:5}},{id:10,title:Object(Re.b)("AdjustView.Presets.Creative.SoftMist","Soft Mist"),additive:!1,hasIntensity:!0,params:{contrast:-30,highlights:-40,shadows:55,whites:-30,blacks:30,saturation:-5,clarity:-30}},{id:11,title:Object(Re.b)("AdjustView.Presets.Creative.VintageInstant","Vintage Instant"),additive:!1,hasIntensity:!0,params:{contrast:25,highlights:35,shadows:-10,whites:-40,blacks:-15,temperature:5,tint:-5,vibrance:10,saturation:10,clarity:5}},{id:12,title:Object(Re.b)("AdjustView.Presets.Creative.WarmContrast","Warm Contrast"),additive:!1,hasIntensity:!0,params:{contrast:70,highlights:-20,shadows:15,whites:20,blacks:-30,tint:10,vibrance:25,saturation:-15,clarity:-20}},{id:13,title:Object(Re.b)("AdjustView.Presets.Creative.Flat&Green","Flat & Green"),additive:!1,hasIntensity:!0,params:{contrast:20,highlights:-20,shadows:20,whites:-30,blacks:-20,temperature:5,tint:-25,vibrance:-10,saturation:-10,clarity:-20}},{id:14,title:Object(Re.b)("AdjustView.Presets.Creative.RedLiftMatte","Red Lift Matte"),additive:!1,hasIntensity:!0,params:{contrast:20,highlights:40,whites:50,blacks:-15,temperature:5,tint:20,vibrance:-40,saturation:0,clarity:-15}},{id:15,title:Object(Re.b)("AdjustView.Presets.Creative.WarmShadows","Warm Shadows"),additive:!1,hasIntensity:!0,params:{contrast:15,shadows:-50,whites:-60,blacks:20,temperature:15,tint:15,vibrance:30,saturation:-5,clarity:10}},{id:16,title:Object(Re.b)("AdjustView.Presets.Creative.AgedPhoto","Aged Photo"),additive:!1,hasIntensity:!0,params:{contrast:15,highlights:-25,shadows:20,blacks:-25,temperature:30,tint:10,vibrance:-40,saturation:-20,clarity:-35}},{id:17,title:Object(Re.b)("AdjustView.Presets.BW.Landscape","B&W Landscape"),additive:!1,hasIntensity:!0,params:{contrast:15,highlights:30,shadows:-25,whites:50,blacks:10,temperature:30,vibrance:10,saturation:-100,clarity:10}},{id:18,title:Object(Re.b)("AdjustView.Presets.BW.HighContrast","B&W High Contrast"),additive:!1,hasIntensity:!0,params:{contrast:90,highlights:-25,shadows:-60,whites:-10,blacks:-20,temperature:-15,saturation:-100,clarity:-20}},{id:19,title:Object(Re.b)("AdjustView.Presets.BW.Punch","B&W Punch"),additive:!1,hasIntensity:!0,params:{contrast:20,highlights:15,shadows:-25,whites:65,blacks:15,temperature:-15,tint:30,vibrance:5,saturation:-100,clarity:50}},{id:20,title:Object(Re.b)("AdjustView.Presets.BW.LowContrast","B&W Low Contrast"),additive:!1,hasIntensity:!0,params:{contrast:-40,highlights:15,shadows:-30,whites:40,tint:20,saturation:-100,clarity:-15}},{id:21,title:Object(Re.b)("AdjustView.Presets.BW.Flat","B&W Flat"),additive:!1,hasIntensity:!0,params:{contrast:20,highlights:-20,shadows:-65,whites:40,blacks:-75,temperature:-45,tint:-90,saturation:-100,clarity:20}},{id:22,title:Object(Re.b)("AdjustView.Presets.BW.Soft","B&W Soft"),additive:!1,hasIntensity:!0,params:{contrast:15,shadows:-15,whites:15,blacks:-60,temperature:-25,saturation:-100,clarity:-55}},{id:23,title:Object(Re.b)("AdjustView.Presets.BW.Infrared","B&W Infrared"),additive:!1,hasIntensity:!0,params:{contrast:15,highlights:-100,shadows:55,whites:70,blacks:-40,temperature:20,tint:70,saturation:-100,clarity:-40}},{id:24,title:Object(Re.b)("AdjustView.Presets.BW.SeleniumTone","B&W Selenium Tone"),additive:!1,hasIntensity:!0,params:{contrast:20,highlights:-25,shadows:-45,whites:-10,blacks:-45,temperature:-55,tint:10,vibrance:-25,saturation:-90,clarity:-5}},{id:25,title:Object(Re.b)("AdjustView.Presets.BW.SepiaTone","B&W Sepia Tone"),additive:!1,hasIntensity:!0,params:{contrast:25,highlights:-50,shadows:-40,whites:-50,blacks:-60,temperature:60,tint:100,vibrance:-30,saturation:-90,clarity:-10}},{id:26,title:Object(Re.b)("AdjustView.Presets.BW.SplitTone","B&W Split Tone"),additive:!1,hasIntensity:!0,params:{contrast:5,highlights:-35,shadows:-40,whites:-60,blacks:-70,temperature:40,tint:-90,vibrance:40,saturation:-90,clarity:-10}},{id:27,title:Object(Re.b)("AdjustView.Presets.Vignetting.None","None"),additive:!0,hasIntensity:!1,params:{vignette_amount:0}},{id:28,title:Object(Re.b)("AdjustView.Presets.Vignetting.VLight","Vignette Light"),additive:!0,hasIntensity:!1,params:{vignette_amount:-20}},{id:29,title:Object(Re.b)("AdjustView.Presets.Vignetting.VMedium","Vignette Medium"),additive:!0,hasIntensity:!1,params:{vignette_amount:-35}},{id:30,title:Object(Re.b)("AdjustView.Presets.Vignetting.VHeavy","Vignette Heavy"),additive:!0,hasIntensity:!1,params:{vignette_amount:-50}}]}}]),e}();a.d(t,"a",(function(){return He})),a.d(t,"b",(function(){return ze}));var He=1,ze=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,Ne.a.adjust,e)).undostack=void 0,n.glia=void 0,n.gliaDefaults=new je,n.params=void 0,n.presetGroups=void 0,n.presets=void 0,n.presetRenderer=void 0,n.hasShownCompareInfo=void 0,n.additivePreviewsNeedRefresh=void 0,n.adjustmentsParamsMinMax={temperature:{min:-100,max:100},tint:{min:-100,max:100},exposure:{min:-5,max:5},contrast:{min:-100,max:100},highlights:{min:-100,max:100},shadows:{min:-100,max:100},whites:{min:-100,max:100},blacks:{min:-100,max:100},clarity:{min:-100,max:100},vibrance:{min:-100,max:100},saturation:{min:-100,max:100},vignette_amount:{min:-100,max:100},vignette_roundness:{min:-100,max:100},vignette_midpoint:{min:-100,max:100},vignette_feather:{min:-100,max:100},vignette_highlight:{min:-100,max:100}},n.presetGroups=Ue.getAdjustmentsPresetGroups(),n.presets=Be.getAdjustmentsPresets(),n.glia=new Ie,n.params=Object(f.defaults)({},n.gliaDefaults),n.params.groupId=n.presetGroups[0].id,n.undostack=new De.a(Object(f.clone)(n.params),100),n.presetRenderer=new Fe,n.checkDeepLinks(),n.hasShownCompareInfo=null!==sessionStorage.getItem("fps_adjust_compare_info"),n.additivePreviewsNeedRefresh=!1,n}return Object(s.a)(a,[{key:"createView",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(l.a)(Object(c.a)(a.prototype),"createView",this).call(this,t),!(n=Me.a.resizeImageDataToWidth(this.doc.getImageData(),256))){e.next=5;break}return e.next=5,this.presetRenderer.init(n);case 5:g.a.render(m.a.createElement(Ve.a,{controller:this}),t);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroyView",value:function(){this.container&&g.a.unmountComponentAtNode(this.container),Object(l.a)(Object(c.a)(a.prototype),"destroyView",this).call(this)}},{key:"startEditor",value:function(e){Object(l.a)(Object(c.a)(a.prototype),"startEditor",this).call(this,e)}},{key:"endEditor",value:function(){this.presetRenderer.destroy(),Object(l.a)(Object(c.a)(a.prototype),"endEditor",this).call(this),this.clearMaskCanvas()}},{key:"initStage",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.doc.getStage().ensureWebGLCanvas({preserveDrawingBuffer:!0,premultipliedAlpha:!1}),e.next=3,this.initGlia();case 3:this.params.groupId&&this.params.presetId&&(t=Object(f.find)(this.presetGroups,{id:this.params.groupId}),a=Object(f.find)(this.presets,{id:this.params.presetId}),t&&a&&this.setPreset(t,a,He,!0,!0)),this.initMaskCanvas();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initMaskCanvas",value:function(){this.doc.getStage().setMaskData(this.doc.getImageData());var e=this.doc.getStage().getMaskCanvas();e&&(e.style.opacity="0")}},{key:"clearMaskCanvas",value:function(){this.doc.getStage().setMaskData()}},{key:"isDirty",value:function(){var e=this,t=!1;return Object(f.keys)(this.gliaDefaults).forEach((function(a){e.params[a]!==e.gliaDefaults.getParam(a)&&(t=!0)})),t}},{key:"hasUndoStack",value:function(){return!0}},{key:"undo",value:function(){this.undostack.undo(),this.params=Object(f.clone)(this.undostack.getCurrent()),this.update(!0)}},{key:"redo",value:function(){this.undostack.redo(),this.params=Object(f.clone)(this.undostack.getCurrent()),this.update(!0)}},{key:"canUndo",value:function(){return this.undostack.canUndo()}},{key:"canRedo",value:function(){return this.undostack.canRedo()}},{key:"reset",value:function(){if(this.isDirty()){var e=this.params.groupId;this.params=Object(f.defaults)({},this.gliaDefaults),this.params.groupId=e,this.addUndoStep(),this.update()}}},{key:"apply",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDirty()){e.next=3;break}return this.cancel(),e.abrupt("return");case 3:return this.hasShownCompareInfo=!0,e.next=6,new Promise((function(e,a){t.view.showProcessing(Object(i.a)(r.a.mark((function n(){var i,o,s,l,c,u;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(i=t.getGLContext())){n.next=13;break}if(o=i.drawingBufferWidth,s=i.drawingBufferHeight,l=Me.a.createHTMLCanvasElementForSize(o,s),null===(c=l.getContext("2d"))||void 0===c||c.drawImage(i.canvas,0,0),!(u=null===c||void 0===c?void 0:c.getImageData(0,0,o,s))){n.next=13;break}return n.next=11,t.doc.editorApply(u,Object(Re.b)("AdjustView.InfoToast.Message","Your image was adjusted"));case 11:(new Le.a).showSurveyEditor(Ne.a.adjust),e();case 13:a();case 14:case"end":return n.stop()}}),n)}))))}));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.isDirty()&&(new Le.a).showSurveyEditor(Ne.a.adjust),this.doc.editorCancel()}},{key:"onPointerMove",value:function(e){this.isDirty()&&!this.hasShownCompareInfo&&(Object(h.info)(Object(Re.b)("AdjustView.ClickCompare.Message","Click and hold image to compare"),{timeout:3e3}),this.hasShownCompareInfo=!0,sessionStorage.setItem("fps_adjust_compare_info","true"))}},{key:"onPointerDown",value:function(e){var t=this.doc.getStage().getMaskCanvas();t&&(t.style.opacity="1")}},{key:"onPointerUp",value:function(e){var t=this.doc.getStage().getMaskCanvas();t&&(t.style.opacity="0")}},{key:"getParams",value:function(){return this.params}},{key:"setAdjustParam",value:function(e,t,a){this.setParam(e,t,He),a&&this.addUndoStep(),this.update()}},{key:"setGroup",value:function(e){var t;this.params.groupId=null===e||void 0===e?void 0:e.id,null===(t=this.getAdjustmentsEditorView())||void 0===t||t.setParams(Object(f.clone)(this.params))}},{key:"setPreset",value:function(e,t,a,n,r){var i=this;this.params.groupId=e.id,this.params.presetId=t.id,this.params.intensity=a,this.additivePreviewsNeedRefresh=!1,t.additive||(Object(f.assign)(this.params,this.gliaDefaults),this.additivePreviewsNeedRefresh=!0),Object(f.keys)(t.params).forEach((function(e){var n=t.params[e];if(void 0===n)throw Error("unknown param key");i.setParam(e,n,a)})),n&&this.addUndoStep(),this.update(r)}},{key:"getPresetGroups",value:function(){return this.presetGroups}},{key:"getPresets",value:function(){return this.presets}},{key:"selectTab",value:function(e){var t;null===(t=this.getAdjustmentsEditorView())||void 0===t||t.selectTab(e)}},{key:"showPresets",value:function(){this.selectTab(0)}},{key:"showDetails",value:function(){this.selectTab(1)}},{key:"getPresetPreviewUrl",value:function(e){if(e.previewUrl&&(!e.additive||!this.additivePreviewsNeedRefresh))return e.previewUrl;var t=this.presetRenderer.renderPreset(e,e.additive&&this.additivePreviewsNeedRefresh?this.params:void 0);return t&&(e.previewUrl=Me.a.createDataUrl(t)),e.previewUrl}},{key:"setParam",value:function(e,t,a){var n=this.adjustmentsParamsMinMax[e];if(!n)throw Error("unknown minMax key");this.params[e]=Math.max(n.min,Math.min(n.max,t*a))}},{key:"addUndoStep",value:function(){this.undostack.add(Object(f.clone)(this.params))}},{key:"update",value:function(e){var t;if(this.applyParams(),null===(t=this.getAdjustmentsEditorView())||void 0===t||t.setParams(Object(f.clone)(this.params)),this.doc.getDocActions().update(),e&&this.params.groupId&&this.params.presetId){var a=this.params.groupId,n=this.params.presetId;window.requestAnimationFrame((function(){var e;null===(e=document.getElementById("".concat(a,"-").concat(n)))||void 0===e||e.scrollIntoView()}))}}},{key:"initGlia",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.getGLContext())){e.next=9;break}return this.glia.init(t),a=Me.a.createHTMLCanvasElement(this.doc.getImageData()),e.next=6,this.glia.getMapsForImageBitmap(a);case 6:(n=e.sent)&&this.glia.setImage(a,n.blurMap,n.toneMap,n.srcStats,n.dstStats),this.applyParams();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"applyParams",value:function(){this.glia.setParams(this.params),this.glia.drawFilter()}},{key:"getGLContext",value:function(){var e=this.doc.getStage().getCanvas();return e?e.getContext("webgl",{preserveDrawingBuffer:!0,premultipliedAlpha:!1}):null}},{key:"checkDeepLinks",value:function(){var e,t,a=_e.a.getParams();if(null===(e=a.adjustments)||void 0===e?void 0:e.group){var n,r=Object(f.find)(this.presetGroups,{deepLinkId:null===(n=a.adjustments)||void 0===n?void 0:n.group});r&&(this.params.groupId=r.id,a.adjustments.group=void 0,_e.a.setParams(a))}if(null===(t=a.adjustments)||void 0===t?void 0:t.presetid){var i,o=Object(f.find)(this.presets,{id:null===(i=a.adjustments)||void 0===i?void 0:i.presetid}),s=Object(f.find)(this.presetGroups,(function(e){return void 0!==(null===o||void 0===o?void 0:o.id)&&e.presets.includes(null===o||void 0===o?void 0:o.id)}));s&&o&&(this.params.presetId=o.id,this.params.groupId=s.id,a.adjustments.presetid=void 0,_e.a.setParams(a))}}},{key:"getAdjustmentsEditorView",value:function(){return this.view}}]),a}(Ne.b)},9:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return E})),a.d(t,"c",(function(){return x}));var n=a(2),r=a.n(n),i=a(44),o=a(8),s=a(55),l=a(31);function c(e){return new Promise((function(t){e(),t()}))}window.marketingtech={adobe:{launch:{property:"global",environment:"production"},analytics:{additionalAccounts:""},target:!0,audienceManager:!1,evidon:!0}},a(355);var u,d,h="webApp:photoshop.adobe.com",f=function(e){return"".concat(h,":").concat(e)},p=function(e){return"".concat(h,":").concat(e)};function m(e,t){return Object.keys(t).forEach((function(a){void 0!==e[a]&&t[a]instanceof Object?e[a]=m(e[a],t[a]):e[a]=t[a]})),e}function v(e){var t=window.digitalData._snapshot();return{digitalData:e?m(t,e):t}}function g(e){var t=e.action,a={},n=e;if("store"===t?localStorage.setItem("fps-track-doc",JSON.stringify(n)):"restore"===t&&(n=JSON.parse(localStorage.getItem("fps-track-doc")||"null")),n){var r,i,o,s,l,c,u={componentInfo:{componentType:"".concat((null===(r=n)||void 0===r?void 0:r.mimeType)||""),componentAction:(null===(i=n)||void 0===i?void 0:i.isSampleImage)?"stockImage":"uploadImage",componentPosition:"".concat((null===(o=n)||void 0===o?void 0:o.sampleImagePosition)||0),componentResolution:"".concat((null===(s=n)||void 0===s?void 0:s.resolution)||""),componentResolutionShrinked:"".concat((null===(l=n)||void 0===l?void 0:l.resolutionShrinked)||"false"),componentFilesize:"".concat((null===(c=n)||void 0===c?void 0:c.fileSize)||"")}};"store"===t||"restore"===t?(console.debug("GlobalTracking: primaryComponent: KEEP: ",u.componentInfo),window.digitalData._set("primaryComponent",u)):(console.debug("GlobalTracking: primaryComponent: TRANSIENT: ",u.componentInfo),a={primaryComponent:u})}return a}function b(e,t){return y.apply(this,arguments)}function y(){return(y=Object(o.a)(r.a.mark((function e(t,a){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p(t),e.abrupt("return",c((function(){var e=(null===a||void 0===a?void 0:a.action)?{eventAction:null===a||void 0===a?void 0:a.action}:void 0,t={eventInfo:Object(i.a)({eventName:n},e)},r=(null===a||void 0===a?void 0:a.error)?{name:a.error}:void 0,o=(null===a||void 0===a?void 0:a.errorCode)?{code:a.errorCode}:void 0,s=r||o?{error:{client:{primary:{errorInfo:Object(i.a)(Object(i.a)({},r),o)}}}}:void 0,l=(null===a||void 0===a?void 0:a.doc)?g(null===a||void 0===a?void 0:a.doc):{},c=v(Object(i.a)(Object(i.a)({primaryEvent:t},s),l));console.debug("GlobalTracking: trackEvent: ",n,c),window._satellite.track("event",c)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return w.apply(this,arguments)}function w(){return(w=Object(o.a)(r.a.mark((function e(t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=S(t),n=f(t),u!==n){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:return u=n,e.abrupt("return",c((function(){console.debug("GlobalTracking: trackView: ",n),window.digitalData._set("page.pageInfo.pageName","".concat(n)),a||(d=n),window._satellite.track("state",v())})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return k.apply(this,arguments)}function k(){return(k=Object(o.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=S(t),e.abrupt("return",a&&d?c((function(){console.debug("GlobalTracking: restored PageName after modal close: ",d),window.digitalData._set("page.pageInfo.pageName","".concat(d))})):Promise.resolve());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return e.endsWith(":modal")||e.startsWith("modal")}window.digitalData._set("page.pageInfo.pageName","loading"),window.digitalData._set("page.pageInfo.siteSection",h),window.digitalData._set("page.pageInfo.language",function(){var e=l.a.parseCookies();return void 0!==e.international?s.normalize(e.international,"adobedotcom"):void 0!==e["creative-cloud-loc"]?s.normalize(e["creative-cloud-loc"],"cchome"):s.normalize(l.a.getCurrentLanguage())}())},91:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,i,o=_(a(43)),s=_(a(14)),l=a(64),c=_(a(603)),u=_(a(604)),d=a(100),h=_(a(22)),f=_(a(42)),p=_(a(46)),m=_(a(34)),v=_(a(605)),g=_(a(610)),b=a(70),y=_(a(19)),E=function(e){if(e&&e.__esModule)return e;var t=O();if(t&&t.has(e))return t.get(e);var a={};if(null!=e){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=n?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(a,r,i):a[r]=e[r]}}a.default=e,t&&t.set(e,a);return a}(a(0)),w=_(a(15)),x=_(a(140)),k=0,S=null;function O(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return O=function(){return e},e}function C(e){return(C="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function T(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function A(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e,t){return!t||"object"!==C(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _(e){return e&&e.__esModule?e:{default:e}}var D={"cs-CZ":_(a(613)).default,"da-DK":_(a(614)).default,"de-DE":_(a(615)).default,"en-US":_(a(616)).default,"es-ES":_(a(617)).default,"fi-FI":_(a(618)).default,"fr-FR":_(a(619)).default,"hu-HU":_(a(620)).default,"it-IT":_(a(621)).default,"ja-JP":_(a(622)).default,"ko-KR":_(a(623)).default,"nb-NO":_(a(624)).default,"nl-NL":_(a(625)).default,"pl-PL":_(a(626)).default,"pt-BR":_(a(627)).default,"ru-RU":_(a(628)).default,"sv-SE":_(a(629)).default,"tr-TR":_(a(630)).default,"uk-UA":_(a(631)).default,"zh-Hans-CN":_(a(632)).default,"zh-Hant-TW":_(a(633)).default};a(634),a(635),a(636);var L=(0,f.default)(n=(0,o.default)((i=r=function(e){function t(e){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=j(this,I(t).call(this,e));var n=e.id,r=e.value,i=e.defaultValue;return a.state={focused:!1,valueInvalid:!1,inputId:n||(0,p.default)(),value:a.getValue(r,i)},a}var a,n,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(t,e),a=t,(n=[{key:"componentDidMount",value:function(){this.textfield&&w.default.findDOMNode(this.textfield).addEventListener("wheel",this.handleInputScrollWheel,{passive:!1,bubbles:!1,cancelable:!0})}},{key:"componentWillUnmount",value:function(){this.textfield&&w.default.findDOMNode(this.textfield).removeEventListener("wheel",this.handleInputScrollWheel)}},{key:"getValue",value:function(e,t){return e||0===e?e:t||0===t?t:""}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){"value"in e&&this.setState({value:this.getValue(e.value),valueInvalid:this.isInputValueInvalid(e.value)}),"defaultValue"in e&&this.setState({valueInvalid:this.isInputValueInvalid(e.defaultValue)})}},{key:"onMouseDown",value:function(e){e.preventDefault(),!this.flagTouchStart&&this.textfield.focus()}},{key:"onTouchStart",value:function(){this.flagTouchStart=!0}},{key:"handleDecrementButtonClick",value:function(e){e.preventDefault(),this.decrementValue()}},{key:"handleIncrementButtonClick",value:function(e){e.preventDefault(),this.incrementValue()}},{key:"startCheckForIncrement",value:function(e){e.preventDefault(),0===k&&(k=Date.now()),this.runIncrement(100)}},{key:"runIncrement",value:function(e){var t=this,a=this.props,n=a.min,r=a.max,i=(a.step,this.state.value);Number.isInteger(i)&&i>=n&&i<r&&0!==k?(Date.now()>k+500&&this.incrementValue(),e=Math.max(5,e-2),setTimeout((function(){t.runIncrement(e)}),e)):(0,this.props.onProgrammaticChangeStop)()}},{key:"stopCheckForIncrement",value:function(e){e.preventDefault(),k=0}},{key:"startCheckForDecrement",value:function(e){e.preventDefault(),0===k&&(k=Date.now()),this.runDecrement(100)}},{key:"runDecrement",value:function(e){var t=this,a=this.props,n=a.min,r=a.max,i=(a.step,this.state.value),o=this.props.onProgrammaticChangeStop;Number.isInteger(i)&&i>n&&i<=r&&0!==k?(Date.now()>k+500&&this.decrementValue(),e=Math.max(5,e-2),setTimeout((function(){t.runDecrement(e)}),e)):o()}},{key:"stopCheckForDecrement",value:function(e){e.preventDefault(),k=0}},{key:"handleTextfieldFocus",value:function(){w.default.findDOMNode(this.textfield).select(),this.setState({focused:!0})}},{key:"handleFocus",value:function(){this.setState({focused:!0})}},{key:"handleBlur",value:function(){this.flagTouchStart=!1,this.setState({focused:!1}),g.default.clearMessage()}},{key:"handleInputKeyDown",value:function(e){switch(e.keyCode){case 13:e.preventDefault(),this.evalValue();break;case 38:case 33:e.preventDefault(),this.incrementValue();break;case 40:case 34:e.preventDefault(),this.decrementValue();break;case 35:e.preventDefault(),this.decrementToMinValue();break;case 36:e.preventDefault(),this.incrementToMaxValue()}}},{key:"handleInputKeyUp",value:function(e){var t=this.props.onProgrammaticChangeStop;switch(e.keyCode){case 38:case 33:e.preventDefault();case 40:case 34:e.preventDefault();case 35:e.preventDefault();case 36:e.preventDefault(),t()}}},{key:"handleInputScrollWheel",value:function(e){var t=this.props.onProgrammaticChangeStop;e.preventDefault(),this.isInactive()||(e.deltaY<0?this.incrementValue():this.decrementValue(),clearTimeout(S),S=setTimeout((function(){S=void 0,t()}),500))}},{key:"handleInputChange",value:function(e,t){t.stopPropagation();var a=""===e?null:+e,n=Number.isInteger(a),r=this.props.max;(n&&a<=r||""===e)&&this.setState({value:e})}},{key:"isInactive",value:function(){var e=this.props,t=e.disabled,a=e.readOnly,n=this.state.focused;return t||a||!n}},{key:"incrementValue",value:function(){var e=this.props,t=e.min,a=e.max,n=e.step,r=this.state.value;isNaN(n)&&(n=1);var i=+r;i=isNaN(i)?null!=a?Math.min(n,a):n:(0,d.clamp)((0,d.handleDecimalOperation)("+",i,n),t,a),this.triggerChange(i)}},{key:"incrementToMaxValue",value:function(){var e=this.props.max;this.isInactive()||null!=e&&this.triggerChange(e)}},{key:"decrementValue",value:function(){var e=this.props,t=e.min,a=e.max,n=e.step,r=this.state.value;isNaN(n)&&(n=1);var i=+r;i=isNaN(i)?null!=t?Math.max(-n,t):-n:(0,d.clamp)((0,d.handleDecimalOperation)("-",i,n),t,a),this.triggerChange(i)}},{key:"decrementToMinValue",value:function(){var e=this.props.min;this.isInactive()||null!=e&&this.triggerChange(e)}},{key:"triggerChange",value:function(e){var t=this.props.onChange,a=this.props.min,n=this.props.onProgrammaticChange,r=this.state.value;""===r&&(r=a),r!==e&&(g.default.announceAssertive(e.toString()),this.setState({value:e,valueInvalid:this.isInputValueInvalid(e)}),t(e),n(e))}},{key:"evalValue",value:function(){var e=this.state.value,t=this.props.onChange,a=""===e?null:+e;Number.isInteger(a)&&a>0&&t(a)}},{key:"isInputValueInvalid",value:function(e){var t=this.props,a=t.max,n=t.min;return""!==e&&isNaN(+e)||null!==a&&e>a||null!==n&&e<n}},{key:"render",value:function(){var e=this,t=this.props.locale;b.setLocale(t);var a=(0,b.messageFormatter)(D),n=this.props,r=n.defaultValue,i=n.placeholder,o=void 0===i?a("Enter a number"):i,d=n.min,f=n.max,p=n.minStepper,g=n.maxStepper,y=n.step,w=n.decrementTitle,k=void 0===w?a("Decrement"):w,S=n.incrementTitle,O=void 0===S?a("Increment"):S,C=n.invalid,A=n.disabled,j=n.quiet,I=n.className,M=n.readOnly,R=n["aria-label"],_=n["aria-labelledby"],L=T(n,["defaultValue","placeholder","min","max","step","decrementTitle","incrementTitle","invalid","disabled","quiet","className","readOnly","aria-label","aria-labelledby"]),N=this.state,V=N.focused,U=N.value,F=N.valueInvalid,B=N.inputId;return E.default.createElement(v.default,{focused:V,invalid:C,quiet:j,disabled:A,className:(0,h.default)("spectrum-Stepper","react-spectrum-Stepper",{"spectrum-Stepper--quiet":j},I),role:"group","aria-label":R||null,"aria-labelledby":_||null},E.default.createElement(x.default,P({},(0,m.default)(L),{ref:function(t){return e.textfield=t},className:"spectrum-Stepper-input",id:B,value:U,defaultValue:r,type:"number",autoComplete:"off","aria-label":R||null,"aria-labelledby":_||null,"aria-valuenow":U||null,"aria-valuetext":U||null,"aria-valuemin":d,"aria-valuemax":f,style:{textAlign:"right",paddingRight:"23px"},validationState:C||F?"invalid":null,step:y,placeholder:o,locale:t,disabled:A,readOnly:M,quiet:j,onKeyDown:(0,l.chain)(L.onKeyDown,this.handleInputKeyDown),onKeyUp:(0,l.chain)(L.onKeyUp,this.handleInputKeyUp),onFocus:(0,l.chain)(L.onFocus,this.handleTextfieldFocus),onBlur:(0,l.chain)(L.onBlur,this.handleBlur),onChange:this.handleInputChange})),E.default.createElement("span",{className:"spectrum-Stepper-buttons",role:"presentation",onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchStart:this.onTouchStart},E.default.createElement(s.default,{className:"spectrum-Stepper-stepUp",type:"button",tabIndex:"-1","aria-controls":B,variant:"action",quiet:j,title:O,"aria-label":O,disabled:A||null!=g&&U>=g||M,onClick:this.handleIncrementButtonClick,onMouseDown:this.startCheckForIncrement,onMouseUp:this.stopCheckForIncrement,onMouseOut:this.stopCheckForIncrement,onFocus:this.handleFocus,onBlur:this.handleBlur},E.default.createElement(u.default,{size:null,className:"spectrum-Stepper-stepUpIcon"})),E.default.createElement(s.default,{className:"spectrum-Stepper-stepDown",type:"button",tabIndex:"-1","aria-controls":B,variant:"action",quiet:j,title:k,"aria-label":k,disabled:A||null!=p&&U<=p||M,onClick:this.handleDecrementButtonClick,onMouseDown:this.startCheckForDecrement,onMouseUp:this.stopCheckForDecrement,onMouseOut:this.stopCheckForDecrement,onFocus:this.handleFocus,onBlur:this.handleBlur},E.default.createElement(c.default,{size:null,className:"spectrum-Stepper-stepDownIcon"}))))}}])&&A(a.prototype,n),r&&A(a,r),t}(E.Component),R(r,"propTypes",{defaultValue:y.default.oneOfType([y.default.string,y.default.number]),value:y.default.oneOfType([y.default.string,y.default.number]),min:y.default.number,max:y.default.number,minStepper:y.default.number,maxStepper:y.default.number,placeholder:y.default.string,locale:y.default.string,step:y.default.oneOfType([y.default.number,y.default.oneOf(["any"])]),disabled:y.default.bool,invalid:y.default.bool,readOnly:y.default.bool,decrementTitle:y.default.string,incrementTitle:y.default.string,onChange:y.default.func,onProgrammaticChange:y.default.func,onProgrammaticChangeStop:y.default.func,quiet:y.default.bool}),R(r,"defaultProps",{placeholder:"",step:1,disabled:!1,invalid:!1,readOnly:!1,locale:"en-US",onChange:function(){},onProgrammaticChange:function(){},onProgrammaticChangeStop:function(){}}),n=i))||n)||n;t.default=L}},[[249,1,2]]]);
//# sourceMappingURL=main.e4aeb772.chunk.js.map